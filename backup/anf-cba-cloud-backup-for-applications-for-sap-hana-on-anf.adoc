---
sidebar: sidebar 
permalink: backup/anf-cba-cloud-backup-for-applications-for-sap-hana-on-anf.html 
keywords: sap hana releases, configurations, operations 
summary: SAP HANA基于文件的备份用于数据库块完整性检查、也可以按需或按计划执行备份操作。策略驱动型保留管理在文件系统级别和HANA备份目录中执行。 
---
= 适用于基于ANF的SAP HANA的Cloud Backup for Applications
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../media/


link:anf-cba-cloud-backup-for-applications-architecture.html["先前版本：Cloud Backup for Applications架构。"]



== 解决方案概述

Cloud Backup for Application支持对以下组件执行基于Snapshot的备份操作：

. * SAP HANA系统*数据卷。
. SAP HANA数据库的*非数据卷*。例如、 `/hana/shared` 卷和/或SAP应用程序服务器数据。
. 不属于特定HANA系统的*全局非数据卷*。例如、SAP传输目录 `/usr/sap/trans`。


这些组件的备份操作包括：

* 计划备份或按需备份
* 可选的前脚本和后脚本
* 策略驱动型保留管理
+
** 用于ANF卷级别的Snapshot
** 在SAP HANA备份目录中(适用于HANA数据卷备份)




SAP HANA基于文件的备份用于数据库块完整性检查、也可以按需或按计划执行备份操作。策略驱动型保留管理在文件系统级别和HANA备份目录中执行。

HANA数据库日志备份的保留管理是根据HANA数据库数据备份(基于Snapshot或文件)的定义保留进行的。

CBA支持对所有基于Snapshot的备份执行还原操作。基于文件的备份只能使用本机HANA工具进行还原。

image:anf-cba-image6.png["此图显示了HANA系统多租户数据库容器和全局非数据卷的备份和还原。"]



== 解决方案 操作

Snapshot数据备份通过触发SAP HANA数据库备份保存点来使用Cloud Backup for Applications执行、以便在存储层上创建的Snapshot副本基于SAP HANA数据库的一致映像。请参见 https://help.sap.com/docs/SAP_HANA_PLATFORM/6b94445c94ae495c83a19646e7c3fd56/b41a2823576f4726be649bc98e61d62c.html?q=sap%20hana%20snapshot%20backup["《SAP管理指南》"^] 有关详细信息 ...

为了对所有SAP HANA相关资源进行完整备份、Cloud Backup for Applications还支持您使用基于存储的Snapshot副本备份所有非数据卷。您可以独立于数据库数据备份计划非数据卷，以启用单个保留和保护策略。

SAP 建议将基于存储的 Snapshot 备份与每周基于文件的备份相结合，以执行块完整性检查。您可以从CBA中执行块完整性检查。块完整性检查（基于文件）备份也用于将备份卸载到另一个存储位置。

Cloud Backup for Applications会根据您可配置的保留策略管理数据备份、日志备份和SAP HANA备份目录的管理工作。

下图总结了备份解决方案。

image:anf-cba-image7.png["此图总结了备份解决方案。"]

在对非数据卷执行基于存储的Snapshot备份时、Cloud Backup for Applications会执行以下任务：

. 创建非数据卷的存储 Snapshot 副本。
. 根据定义的保留策略删除存储 Snapshot 副本。


在对SAP HANA数据库执行基于存储的Snapshot备份时、Cloud Backup for Applications会执行以下任务：

. 创建 SAP HANA 备份保存点，以便在持久性层上创建一致的映像。
. 创建数据卷的存储 Snapshot 副本。
. 在 SAP HANA 备份目录中注册存储 Snapshot 备份。
. 发布 SAP HANA 备份保存点。
. 根据定义的保留策略删除存储 Snapshot 副本。
. 根据定义的保留策略删除 SAP HANA 备份目录条目。
. 每当手动删除数据备份或根据保留策略删除数据备份时、Cloud Backup for Applications都会删除早于最旧数据备份的所有日志备份。日志备份会在文件系统和 SAP HANA 备份目录中删除。




== 支持的 SAP HANA 版本和配置

Cloud Backup for Applications支持包含一个或多个租户的HANA MDC系统、配置选项如下：

* SAP HANA 2.0 SPS4 及更高版本
* SAP HANA单主机系统
* SAP HANA多主机系统、如一节所述 link:anf-cba-backup-operations-with-hana-system-replication.html#backup-operations-with-hana-multiple-host-systems["《HANA多主机系统的备份操作》"]
* 配置了HANA系统复制(HSR)的SAP HANA系统、如一节所述 link:anf-cba-backup-operations-with-hana-system-replication.html["《使用HANA系统复制执行备份操作》"]


link:anf-cba-cloud-backup-for-applications-concepts-and-best-practices.html["接下来：Cloud Backup for Applications概念和最佳实践。"]
