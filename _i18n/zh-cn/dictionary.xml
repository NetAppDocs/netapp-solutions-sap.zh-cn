<?xml version="1.0" encoding="UTF-8"?>
<blocks>
  <block id="b89b4b47543b3482418589214b77fa25" category="summary">SAP HANA 主机通过使用冗余 10GbE 或速度更快的网络基础架构连接到存储控制器。</block>
  <block id="2d242bb36ec91b32005f9296ff03a912" category="doc">架构</block>
  <block id="52441936ba433391941cffd7494f2f8c" category="inline-link-macro">先前版本：《采用 NFS 的 NetApp 全闪存 FAS 系统上的 SAP HANA 配置指南》。</block>
  <block id="38f735300605cb2faec8b2f34618ab60" category="paragraph"><block ref="38f735300605cb2faec8b2f34618ab60" category="inline-link-macro-rx"></block></block>
  <block id="6a6f5c7c796a0b8a9a275a4bc6b27661" category="paragraph">SAP HANA 主机通过使用冗余 10GbE 或速度更快的网络基础架构连接到存储控制器。SAP HANA 主机和存储控制器之间的数据通信基于 NFS 协议。建议使用冗余交换基础架构，以便在交换机或网络接口卡（ Network Interface Card ， NIC ）发生故障时提供容错 SAP HANA 主机到存储连接。这些交换机可能会将各个端口的性能与端口通道进行聚合，以便在主机级别显示为一个逻辑实体。</block>
  <block id="afcaa068bd76451ec818e7c845c867f4" category="paragraph">FAS 系统产品系列的不同型号可以在存储层混用并匹配，以满足增长以及不同的性能和容量需求。可以连接到存储系统的最大 SAP HANA 主机数由 SAP HANA 性能要求和所用 NetApp 控制器型号定义。所需磁盘架的数量仅取决于 SAP HANA 系统的容量和性能要求。下图显示了一个配置示例，其中八个 SAP HANA 主机连接到一个存储高可用性（ HA ）对。</block>
  <block id="341d84aa26cb4521474864e04ea2a63b" category="inline-image-macro">错误：缺少图形映像</block>
  <block id="f4f82b400d2e9f287534fac8765380bd" category="paragraph"><block ref="f4f82b400d2e9f287534fac8765380bd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="015a4116e31d7ff2bdb70f8a95b52a25" category="paragraph">下图显示了使用 VMware vSphere 作为虚拟化层的示例。</block>
  <block id="196b7b387afdabccf0edd5a9e5270533" category="paragraph"><block ref="196b7b387afdabccf0edd5a9e5270533" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1e90382cf8f5501614307f142be99675" category="paragraph">该架构可扩展到两个方面：</block>
  <block id="ab0b299aa5582f36321ac715a26741f5" category="list-text">通过将更多 SAP HANA 主机和 / 或存储容量附加到现有存储，前提是存储控制器提供的性能足以满足当前 SAP 关键性能指标（ KPI ）的要求</block>
  <block id="a8cc6b546c8a58e173b13fdbe03083d7" category="list-text">通过为其他 SAP HANA 主机添加更多具有额外存储容量的存储系统</block>
  <block id="0c8c8eb56a169d6a4275a52f8c66c079" category="paragraph">下图显示了一个配置示例，其中，更多 SAP HANA 主机连接到存储控制器。在此示例中，要满足 16 个 SAP HANA 主机的容量和性能要求，需要更多磁盘架。根据总吞吐量要求，必须添加到存储控制器的额外 10GbE （或更快）连接。</block>
  <block id="d865ac1be3a1177044fd2bc01b13a1e7" category="paragraph"><block ref="d865ac1be3a1177044fd2bc01b13a1e7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="cdb7ac32da38343cc4a6b2f3f23caa92" category="paragraph">无论部署的 FAS 系统如何， SAP HANA 环境也可以通过添加任何经过认证的存储控制器来进行扩展，以满足所需的节点密度（下图）。</block>
  <block id="a19867e6be0cc46f7880a9fc457690c8" category="paragraph"><block ref="a19867e6be0cc46f7880a9fc457690c8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9268ea89b7553eda23a9690606daf736" category="section-title">SAP HANA 备份</block>
  <block id="38dd23c567963490bfc29e59a1f28717" category="paragraph">所有 NetApp 存储控制器上的 ONTAP 软件都提供了一种内置机制，可在运行期间备份 SAP HANA 数据库，而不会影响性能。基于存储的 NetApp Snapshot 备份是一种完全受支持的集成备份解决方案，可用于 SAP HANA 单个容器以及具有单个租户或多个租户的 SAP HANA 多租户数据库容器（ MDG ）系统。</block>
  <block id="9955fcf90f7a4d24fcdd226f2bad9404" category="paragraph">基于存储的 Snapshot 备份可使用适用于 SAP HANA 的 NetApp SnapCenter 插件来实施。这样，用户就可以使用 SAP HANA 数据库本机提供的界面创建一致的基于存储的 Snapshot 备份。SnapCenter 会将每个 Snapshot 备份注册到 SAP HANA 备份目录中。因此， SnapCenter 所做的备份可以在 SAP HANA Studio 和 Cockpit 中查看，您可以在其中直接选择这些备份进行还原和恢复操作。</block>
  <block id="a998ce5555ab7229162baef2b7ee1c9a" category="paragraph">通过 NetApp SnapMirror 技术，可以将在一个存储系统上创建的 Snapshot 副本复制到由 SnapCenter 控制的二级备份存储系统。然后，可以为主存储上的每个备份集以及二级存储系统上的备份集定义不同的备份保留策略。适用于 SAP HANA 的 SnapCenter 插件可自动管理基于 Snapshot 副本的数据备份和日志备份的保留，包括备份目录的管理。适用于 SAP HANA 的 SnapCenter 插件还允许通过执行基于文件的备份对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="020d9d4fc21927a10cbfdf929f1e5d5a" category="paragraph">可以使用 NFS 挂载将数据库日志直接备份到二级存储，如下图所示。</block>
  <block id="ead55e617ee5640d2ef8cde89d9089e4" category="paragraph"><block ref="ead55e617ee5640d2ef8cde89d9089e4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6a8f36af9b25dbdaa27206e8556f144d" category="paragraph">与基于文件的传统备份相比，基于存储的 Snapshot 备份具有显著优势。这些优势包括但不限于：</block>
  <block id="cd3237725900192ea60a708828192eed" category="list-text">备份速度更快（几分钟）</block>
  <block id="dd3af9880bd4d720f57bfb3f08113c40" category="list-text">由于存储层上的恢复时间（几分钟）以及备份频率更高，因此恢复时间目标（ RTO ）缩短</block>
  <block id="f458c876961fbe066dc1f94b4d8f0606" category="list-text">在备份和恢复操作期间， SAP HANA 数据库主机，网络或存储的性能不会下降</block>
  <block id="ca34922c96391967c8028dc44cd98e22" category="list-text">根据块更改，将节省空间和带宽的复制到二级存储</block>
  <block id="c67ddee39e41dfe63b7c798d76514143" category="inline-link">TR-4614 ：《使用 SnapCenter 实现 SAP HANA 备份和恢复》</block>
  <block id="8992a3e8c438bc5d1cfda7ee49ec843f" category="paragraph">有关使用 SnapCenter 的 SAP HANA 备份和恢复解决方案的详细信息，请参见<block ref="f91ad5f72ca89ecac47641fa01cbfa5f" category="inline-link-rx"></block>。</block>
  <block id="dd44a87fdee6157429ed3ab3b6e9ead4" category="section-title">SAP HANA 灾难恢复</block>
  <block id="208d812de76aa602471fe71c37e930c8" category="paragraph">SAP HANA 灾难恢复既可以使用 SAP HANA 系统复制在数据库层执行，也可以使用存储复制技术在存储层执行。下一节概述了基于存储复制的灾难恢复解决方案。</block>
  <block id="1ff29e7b597f9f2f9d2a5edf1b79532b" category="inline-link">TR-4646 ：《使用存储复制实现 SAP HANA 灾难恢复》</block>
  <block id="2ba75f8f28d5b6b2cfee56e1346047f8" category="paragraph">有关 SAP HANA 灾难恢复解决方案的详细信息，请参见<block ref="dfa76f526e34dee57bfae58022907510" category="inline-link-rx"></block>。</block>
  <block id="524130dbe5da3e0bed566e873780d92c" category="section-title">基于 SnapMirror 的存储复制</block>
  <block id="0f905789004d93140f2472f04587e3e9" category="paragraph">下图显示了一个三站点灾难恢复解决方案，该 使用同步 SnapMirror 复制到本地灾难恢复数据中心，并使用异步 SnapMirror 将数据复制到远程灾难恢复数据中心。</block>
  <block id="8f5ac6f44493cd58abff6c1e0220cb5b" category="paragraph">使用同步 SnapMirror 进行数据复制可提供零 RPO 。主灾难恢复数据中心与本地灾难恢复数据中心之间的距离限制为 100 公里左右。</block>
  <block id="4e1cb33198a7d562f17cd0f57cfdb9c6" category="paragraph">通过使用异步 SnapMirror 将数据复制到第三个远程灾难恢复数据中心，可以防止主灾难恢复站点和本地灾难恢复站点发生故障。RPO 取决于复制更新的频率以及传输更新的速度。理论上，距离是无限的，但限制取决于必须传输的数据量以及数据中心之间的可用连接。典型的 RPO 值介于 30 分钟到多小时之间。</block>
  <block id="d9bfc3ce5a49e5308dfdbda6295cc6a3" category="paragraph">这两种复制方法的 RTO 主要取决于在灾难恢复站点启动 HANA 数据库并将数据加载到内存所需的时间。假设数据的读取吞吐量为 1000 Mbps ，则加载 1 TB 数据大约需要 18 分钟。</block>
  <block id="b9052158da7f0b5b55d6e0ec9555e353" category="paragraph">正常运行期间，灾难恢复站点上的服务器可用作开发 / 测试系统。发生灾难时，需要关闭开发 / 测试系统并将其作为灾难恢复生产服务器启动。</block>
  <block id="d32d8a0b4465128d05cbe3a72ff9a229" category="paragraph">这两种复制方法均允许您执行灾难恢复工作流测试，而不会影响 RPO 和 RTO 。FlexClone 卷在存储上创建并连接到灾难恢复测试服务器。</block>
  <block id="7d1e20cc67f328ef47e09b754d887367" category="paragraph"><block ref="7d1e20cc67f328ef47e09b754d887367" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3fd58c2ba10df8da6e80791e2dae3f96" category="paragraph">同步复制提供 StrictSync 模式。如果由于任何原因未完成对二级存储的写入，则应用程序 I/O 将失败，从而确保主存储系统和二级存储系统完全相同。只有在 SnapMirror 关系恢复为 InSync 状态后，主系统的应用程序 I/O 才会恢复。如果主存储发生故障，则可以在故障转移后在二级存储上恢复应用程序 I/O ，而不会丢失数据。在 StrictSync 模式下， RPO 始终为零。</block>
  <block id="2cb03e71b30b5ad997f5080619a60d31" category="section-title">基于 MetroCluster 的存储复制</block>
  <block id="8a29e11272dc9f6e89fdfd8d07e0a808" category="paragraph">下图简要展示了解决方案。每个站点上的存储集群可提供本地高可用性，并用于生产工作负载。每个站点的数据会同步复制到另一个位置，如果发生灾难故障转移，这些数据将可用。</block>
  <block id="60857ee8b00b5db6db2351a243a987d5" category="paragraph"><block ref="60857ee8b00b5db6db2351a243a987d5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9bf36fdcd24fca320fec98a1e621e1ce" category="inline-link-macro">接下来：存储规模估算。</block>
  <block id="36e4b44254feaa24f0c68689709373d0" category="paragraph"><block ref="36e4b44254feaa24f0c68689709373d0" category="inline-link-macro-rx"></block></block>
  <block id="d41d8cd98f00b204e9800998ecf8427e" category="summary"></block>
  <block id="650e7293e887dfe8d6a1e7be568f91f1" category="doc">更新历史记录</block>
  <block id="98c7616ec2b7c09dbf1a2e93da9c710f" category="paragraph">自此解决方案最初发布以来，已对其进行了以下技术更改。</block>
  <block id="34b6cd75171affba6957e308dcbd92be" category="cell">version</block>
  <block id="44749712dbec183e983dcd78a7736c41" category="cell">Date</block>
  <block id="d46591db8118f77057750203ede1b2ca" category="cell">更新摘要</block>
  <block id="3798985ee5e15c84c4263815d5a4d0b7" category="cell">版本 1.0</block>
  <block id="be0c84ff5b19b7be3f3c3bcf63481301" category="cell">2015年10月</block>
  <block id="e9bacaae9e45a23fffabf2e649f09b75" category="cell">初始版本</block>
  <block id="e988e5fd54b0b79f1d8fa9ce06ad58d5" category="cell">版本 1.1</block>
  <block id="bc407ceaf8eb27d5253807a9ebda0414" category="cell">2016年3月</block>
  <block id="54db89e9b4e49265f32e0495cda7d5e4" category="cell">更新了容量规模估算</block>
  <block id="304f30474edd152dc34aef7dbb123607" category="cell">版本 2.0</block>
  <block id="d97683d280d36a8f907f655c8ae74044" category="cell">2017年2月</block>
  <block id="053aaab3b6a6f68ce7ea49ba7b9f8fee" category="cell">新的 NetApp 存储系统和磁盘架 ONTAP 9 新操作系统版本（ SLES12 SP1 和 RHEL 7.2 ）新的 SAP HANA 版本的新增功能</block>
  <block id="f26acbf3c7c6f56c2924d8f11f414022" category="cell">版本 2.1</block>
  <block id="27328ef4198621c47c9eed9d679e106e" category="cell">2017年7月</block>
  <block id="486ac802b593e5c6576c88cd6ce4d040" category="cell">少量更新</block>
  <block id="46b9839969e4bc429da9cc245c756450" category="cell">版本 3.0</block>
  <block id="a0412a4f0a7daea31c561a20fad808b8" category="cell">September 2018</block>
  <block id="4b94bef311266eb7014c7ca918108710" category="cell">新的 NetApp 存储系统新的操作系统版本（ SLES12 SP3 和 RHEL 7.4 ）其他次要更新 SAP HANA 2.0 SPS3</block>
  <block id="1934d1f00863288384225e6e467701f9" category="cell">版本 3.1</block>
  <block id="aafb48343bbcbc586f011c8f87a52d7f" category="cell">2019年11月</block>
  <block id="c7c8844211522f47505bf90db2c5f40e" category="cell">新的 NetApp 存储系统和 NVMe 磁盘架新的操作系统版本（ SLES12 SP4 ， SLES 15 和 RHEL 7.6 ）其他次要更新</block>
  <block id="5258b9f7a7bafc6f48ad56c4cdae8810" category="cell">版本 3.2</block>
  <block id="a00f05a660c5d5d561663fe44e44cdf5" category="cell">2020年4月</block>
  <block id="62b07fbc56cb53e44a6f5cbdadaa6212" category="cell">自 SAP HANA 2.0 SPS4 以来，全新的 AFF ASA 系列存储系统引入了多种数据分区功能</block>
  <block id="e9d6df059c684606e3b274b55bf5e7fe" category="cell">版本 3.3</block>
  <block id="0c32ac23d148fcf8f103092f860ea484" category="cell">2020 年 6 月</block>
  <block id="2a68b73f24c9113c1b9b27be5840d301" category="cell">有关可选功能的追加信息次要更新</block>
  <block id="c6bdef625cb67c9d4ef94200ba60efb0" category="doc">基础架构设置和配置</block>
  <block id="d39f50075dc9ec7266b5156c1d0ce319" category="summary">以下各节提供了 SAP HANA 基础架构设置和配置准则。</block>
  <block id="3b878279a04dc47d60932cb294d96259" category="doc">概述</block>
  <block id="2faa028f31cd6505efeb538b561fa154" category="inline-link-macro">上一步：存储规模估算。</block>
  <block id="c75079fba23ca537a88b1c797bdb8fcb" category="paragraph"><block ref="c75079fba23ca537a88b1c797bdb8fcb" category="inline-link-macro-rx"></block></block>
  <block id="98453eecb7a0821c9f84e894eeb80b6f" category="paragraph">以下各节提供了 SAP HANA 基础架构设置和配置准则。其中包括设置 SAP HANA 所需的所有步骤。此时将创建一个 SVM 来托管数据。在这些部分中，使用了以下示例配置：</block>
  <block id="5f817989cf0f93d4a14f30644d1994e2" category="list-text">使用 SID=SS3 和 ONTAP 9.7 或更早版本的 HANA 系统</block>
  <block id="e7f4f805e4b2edf4e5d40f8db1e51fd5" category="list-text">SAP HANA 单主机和多主机</block>
  <block id="0bad0fb3efdfa0349f059e6510652363" category="list-text">使用 SAP HANA 多个分区的 SAP HANA 单个主机</block>
  <block id="273f733be4b4eee98578fce71ccc7a70" category="list-text">使用 Linux 逻辑卷管理器（ LVM ）且 SID=FC5 和 ONTAP 9.8 的 HANA 系统</block>
  <block id="2af8d2a05817fecc58806624e3ae7e00" category="inline-link-macro">接下来： SAN 网络结构设置。</block>
  <block id="29adaafd4c901d06eaa6a2b9ebd9da49" category="paragraph"><block ref="29adaafd4c901d06eaa6a2b9ebd9da49" category="inline-link-macro-rx"></block></block>
  <block id="b12639fe9d1443bc3f4a0ef40ebb4021" category="paragraph"><block ref="b12639fe9d1443bc3f4a0ef40ebb4021" category="inline-link-macro-rx"></block></block>
  <block id="5eb85e4ee49189c45f87c6f2796e3683" category="inline-link-macro">下一步：网络设置。</block>
  <block id="890a387444b4efc026c95507fde0ab8d" category="paragraph"><block ref="890a387444b4efc026c95507fde0ab8d" category="inline-link-macro-rx"></block></block>
  <block id="5ab9c3d59a0ecc9e30a1f938039d0ecf" category="summary">NFS 版本 4 及更高版本需要用户身份验证。可以使用轻型目录访问协议（ Lightweight Directory Access Protocol ， LDAP ）服务器等中央用户管理工具或使用本地用户帐户来完成此身份验证。</block>
  <block id="e3a77a70624c57f3f0e2fc7075e4f75f" category="doc">NFSv4 的 SAP HANA 安装准备</block>
  <block id="6221178ad17ca6fb70249c2a9013d261" category="inline-link-macro">上一步：主机设置。</block>
  <block id="81fb65f6fb6ca2e8e800d01c4c893a35" category="paragraph"><block ref="81fb65f6fb6ca2e8e800d01c4c893a35" category="inline-link-macro-rx"></block></block>
  <block id="7f5e79baae33aa1aca5c990882a844cb" category="paragraph">NFS 版本 4 及更高版本需要用户身份验证。可以使用轻型目录访问协议（ Lightweight Directory Access Protocol ， LDAP ）服务器等中央用户管理工具或使用本地用户帐户来完成此身份验证。以下各节介绍如何配置本地用户帐户。</block>
  <block id="3e0be3ed453ef480d348366ac9692e0b" category="paragraph">在开始安装 SAP HANA 软件之前，必须在 SAP HANA 主机和存储控制器上手动创建管理用户 ` &lt;sidadm&gt;` 和 `sapsys` 组。</block>
  <block id="cbec60dce8dfbeca522952f14d38d3b1" category="section-title">SAP HANA 主机</block>
  <block id="6f99ed415d7b5330cfe770dc1088f66b" category="paragraph">如果不存在，则必须在 SAP HANA 主机上创建 `sapsys` 组。必须选择一个不与存储控制器上的现有组 ID 冲突的唯一组 ID 。</block>
  <block id="7bafe155f78e1791271552be40c162f4" category="paragraph">已在 SAP HANA 主机上创建用户 ` &lt;sidadm&gt;` 。必须选择一个与存储控制器上的现有用户 ID 不冲突的唯一 ID 。</block>
  <block id="8f35838ad2fe64a0c17ff23449515d26" category="paragraph">对于多主机 SAP HANA 系统，所有 SAP HANA 主机上的用户和组 ID 必须相同。通过将 ` /etc/group` 和 ` /etc/passwd` 中的受影响行从源系统复制到所有其他 SAP HANA 主机，可以在其他 SAP HANA 主机上创建组和用户。</block>
  <block id="2fa0eba92353ea7e1816fcc916b31030" category="admonition">在所有 Linux 服务器（` /etc/idmapd.conf` ）和 SVM 上， NFSv4 域必须设置为相同的值。在文件 ` /etc/idmapd.conf` 中为 Linux 主机设置域参数 "Domain = &lt;domain-name&gt; " 。</block>
  <block id="c16fea4c59b7f6d7ce28e4f656eb58f6" category="paragraph">启用并启动 NFS idmapd 服务。</block>
  <block id="8e70a1707d21dc1444e77d404e6ac2f0" category="admonition">最新的 Linux 内核不需要执行此步骤。可以安全地忽略警告消息。</block>
  <block id="22f78a96796d22d06c6c67652a374ffa" category="section-title">存储控制器</block>
  <block id="33414af712ec9cf5beb615810511c047" category="paragraph">SAP HANA 主机和存储控制器上的用户 ID 和组 ID 必须相同。可通过在存储集群上输入以下命令来创建组和用户：</block>
  <block id="2cb27363dc868bf23cc2ef137b8ee00a" category="paragraph">此外，将 SVM 的 UNIX 用户 root 的组 ID 设置为 0 。</block>
  <block id="ea202f4ea7c881d6ebbfcd1018b9f5fe" category="inline-link-macro">接下来： SAP HANA 的 I/O 堆栈配置。</block>
  <block id="90afaa573725fac2c1e8aeba2bbb1942" category="paragraph"><block ref="90afaa573725fac2c1e8aeba2bbb1942" category="inline-link-macro-rx"></block></block>
  <block id="2ad2e055e24d21da5d30dba91f44d731" category="summary">本节介绍在单主机和多主机系统上安装 SAP HANA 所需的准备工作。</block>
  <block id="919364909c7165636bc8715422a691ec" category="doc">SAP HANA 软件安装</block>
  <block id="87c861a96ef44105e2d89dd5b2f3788a" category="inline-link-macro">先前版本： SAP HANA 的 I/O 堆栈配置。</block>
  <block id="33dfe35e382c841f54e5a8b774db13d2" category="paragraph"><block ref="33dfe35e382c841f54e5a8b774db13d2" category="inline-link-macro-rx"></block></block>
  <block id="3e1a84486a34f2de53acbb9a76a7dacc" category="section-title">在单主机系统上安装</block>
  <block id="9ffcf0639aa6ab06ceced36736b5807d" category="paragraph">SAP HANA 软件安装不需要为单主机系统做任何其他准备。</block>
  <block id="e4fd411b2330f50a5f169247fb9817ac" category="section-title">在多主机系统上安装</block>
  <block id="877357acf24fb0c198118a9551671417" category="paragraph">开始安装之前，请创建一个 `global.ini` 文件，以便在安装过程中使用 SAP 存储连接器。在安装过程中， SAP 存储连接器会在工作主机上挂载所需的文件系统。`global.ini` 文件必须位于可从所有主机访问的文件系统中，例如， ` /ha/shared` 文件系统。</block>
  <block id="dba154e032a79db94e79189eb47b028f" category="paragraph">在多主机系统上安装 SAP HANA 软件之前，必须完成以下步骤：</block>
  <block id="c0c2d256d9ee9ad617ad43119e6ad751" category="list-text">将以下数据 LUN 和日志 LUN 的挂载选项添加到 `global.ini` 文件中：</block>
  <block id="d00f7ccbbb090c63d2eb2e3a5ddbd0db" category="list-text">`relatime` 和 `inode64` 用于数据和日志文件系统</block>
  <block id="3daf48572816497403ca0d7b3ca79c5c" category="list-text">添加数据分区和日志分区的 WWID 。WWID 必须与 ` /etc/multipath.conf` 文件中配置的别名匹配。</block>
  <block id="c5e7e01683b04809035115f6c4c7e4aa" category="paragraph">以下输出显示了 2+1 多主机设置示例，其中系统标识符（ SID ）为 SS3 。</block>
  <block id="f206fb31ca322606be1acbaecf34f9fa" category="paragraph">如果使用的是 Linux LVM ，则所需的配置会有所不同。以下示例显示了一个 2+1 多主机设置，其中 SID 为 FC5 。</block>
  <block id="0eb184ead31411795a6c716a0d38caf4" category="admonition">存储已准备的 `global.ini` 文件的目录包含在 `storage_cfg` CLI 选项（` - storage_cfg=/has/shared` ）中。</block>
  <block id="e698d9fadd050973bab2f9f855248cca" category="admonition">根据所使用的操作系统版本，可能需要先安装 Python 2.7 ，然后再安装 SAP HANA 数据库。</block>
  <block id="9659639598149d1609e9fcde405a759f" category="list-text">验证安装工具是否已在所有工作主机和备用主机上安装所有选定组件。</block>
  <block id="aeb6d46340ff11bae60d5545621a6200" category="inline-link-macro">下一步：为 SAP HANA 单主机系统添加其他数据卷分区。</block>
  <block id="206e7d27fd4df2164ed0c8f4c5eb7bb4" category="paragraph"><block ref="206e7d27fd4df2164ed0c8f4c5eb7bb4" category="inline-link-macro-rx"></block></block>
  <block id="6f9f0e834814d7ad77b7ef8666f24988" category="summary">下一节概述了为 SAP HANA 估算存储系统规模所需的性能和容量注意事项。</block>
  <block id="894445e8ea6df545bfbc4247797a2162" category="doc">存储规模估算</block>
  <block id="5b1c62f1e35074e19185d9341b492c54" category="inline-link-macro">先前版本：架构。</block>
  <block id="eddef42bc593b70ff2e5a7aefcad694e" category="paragraph"><block ref="eddef42bc593b70ff2e5a7aefcad694e" category="inline-link-macro-rx"></block></block>
  <block id="dcf9ba0966947285c275da7a2e4983af" category="admonition">请联系 NetApp 或您的 NetApp 合作伙伴销售代表，帮助您创建大小合适的存储环境。</block>
  <block id="1261ba8eeb83d9d138ff9e9a37214a7e" category="section-title">性能注意事项</block>
  <block id="0133d1c5c524f1c132eeaabe81e24a26" category="paragraph">SAP 定义了一组静态存储 KPI ，这些 KPI 适用于所有生产 SAP HANA 环境，不受数据库主机和使用 SAP HANA 数据库的应用程序的内存大小的限制。这些 KPI 适用于单主机，多主机， HANA 上的 Business Suite ， HANA 上的 Business Warehouse ， S/4HANA 和 BB/4HANA 环境。因此，当前的性能规模估算方法仅取决于连接到存储系统的活动 SAP HANA 主机的数量。</block>
  <block id="66e21be29915de7ccd15e3f2259dfb2d" category="admonition">存储性能 KPI 仅适用于生产 SAP HANA 系统，但您可以在所有 HANA 系统中实施。</block>
  <block id="367a819110d98ed167caa72fba8c3476" category="paragraph">SAP 提供了一个性能测试工具，用于验证连接到存储的活动 SAP HANA 主机的存储系统性能。</block>
  <block id="209deb211357a5417a81e757fa385d98" category="paragraph">NetApp 测试并预定义了可连接到特定存储模型的最大 SAP HANA 主机数，同时仍满足 SAP 为基于生产的 SAP HANA 系统提供的所需存储 KPI 。</block>
  <block id="c7e4c0767ab9722c4f237d635d610c0c" category="admonition">认证的 FAS 产品系列中的存储控制器也可用于采用其他磁盘类型或磁盘后端解决方案的 SAP HANA 。但是，它们必须由 NetApp 提供支持，并满足 SAP HANA TDI 性能 KPI 要求。例如， NetApp 存储加密（ NetApp Storage Encryption ， NSE ）和 NetApp FlexArray 技术。</block>
  <block id="15d11459079dc48f1e85bea1313c9726" category="paragraph">本文档介绍了 SAS HDD 和固态驱动器（ SSD ）的磁盘大小调整。</block>
  <block id="4f99803ea06af8f6d9a1da5b19e96b61" category="section-title">HDD</block>
  <block id="409693e484428f0ddd3c7f9edad94110" category="paragraph">每个 SAP HANA 节点至少需要 10 个数据磁盘（ 10k RPM SAS ），才能满足 SAP 的存储性能 KPI 要求。</block>
  <block id="2b23f51631667ab0603ece64b7f523a3" category="admonition">此计算与使用的存储控制器和磁盘架以及数据库的容量要求无关。添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="9d8806ed6779e6a16f204fad2d0cdfc1" category="section-title">固态驱动器</block>
  <block id="0712272d8957e85acded217a85370070" category="paragraph">对于 SSD ，数据磁盘的数量取决于从存储控制器到 SSD 磁盘架的 SAS 连接吞吐量。</block>
  <block id="d7e101f5680bb6cef55b45b6400c7696" category="paragraph">可在单个磁盘架上运行的最大 SAP HANA 主机数以及每个 SAP HANA 主机所需的最小 SSD 数均通过运行 SAP 性能测试工具来确定。此测试不会考虑主机的实际存储容量要求。此外，您还必须计算容量要求，以确定所需的实际存储配置。</block>
  <block id="17034526fac893b51c72109e731e3150" category="list-text">如果磁盘架连接到 12 Gb ，则具有 24 个 SSD 的 12 Gb SAS 磁盘架（ DS224C ）最多可支持 14 个 SAP HANA 主机。</block>
  <block id="5a3f83272b733d11b72f90c6434634bc" category="list-text">具有 24 个 SSD 的 6 Gb SAS 磁盘架（ DS2246 ）最多支持 4 个 SAP HANA 主机。</block>
  <block id="4218dd2a9cf8d2a4ac0bf4b4418b6a8a" category="paragraph">SSD 和 SAP HANA 主机必须在两个存储控制器之间平均分布。</block>
  <block id="53186c8561352a2df976925dcabf62f0" category="paragraph">下表汇总了每个磁盘架支持的 SAP HANA 主机数。</block>
  <block id="6bb313266cb9beb41de9d6c9e38c1940" category="cell">满载 24 个 SSD 的 6 Gb SAS 磁盘架（ DS2246 ）</block>
  <block id="511314f062f8b637138c0e7691d63b28" category="cell">满载 24 个 SSD 的 12 GB SAS 磁盘架（ DS224C ）</block>
  <block id="aa2d00c9db46d97d9e46eaaf81d65e1d" category="cell">每个磁盘架的最大 SAP HANA 主机数</block>
  <block id="a87ff679a2f3e71d9181a67b7542122c" category="cell">4.</block>
  <block id="aab3238922bcc25a6f606eb525ffdc56" category="cell">14</block>
  <block id="67daefa02c71a745373981700ce5c943" category="admonition">此计算与所使用的存储控制器无关。添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="a341ad540524c27a40ee6f8e4c1de2e4" category="section-title">混合工作负载</block>
  <block id="53fc113bc08b6e6a4382d93d7b1beccf" category="paragraph">支持在同一存储控制器或同一存储聚合上运行的 SAP HANA 和其他应用程序工作负载。但是， NetApp 的最佳实践是将 SAP HANA 工作负载与所有其他应用程序工作负载分开。</block>
  <block id="e96e66eb5ca678b012ed829901a8e778" category="paragraph">您可能会决定在同一存储控制器或同一聚合上部署 SAP HANA 工作负载和其他应用程序工作负载。如果是，您必须确保在混合工作负载环境中为 SAP HANA 提供足够的性能。NetApp 还建议您使用服务质量（ QoS ）参数来控制这些其他应用程序可能产生的影响，并保证 SAP HANA 应用程序的吞吐量。</block>
  <block id="1d8d1934499ced39732f5c5099083c6b" category="paragraph">必须使用 SAP 性能测试工具检查是否可以在已用于其他工作负载的现有存储控制器上运行其他 SAP HANA 主机。SAP 应用程序服务器可以安全地放置在与 SAP HANA 数据库相同的存储控制器和 / 或聚合上。</block>
  <block id="8025837196ec3641307b0ebcb276143c" category="section-title">容量注意事项</block>
  <block id="244d98fed97800c3bc8073163dc1e3b2" category="inline-link">SAP HANA 存储要求</block>
  <block id="30babbb47792d5801024c3a51ce97d61" category="paragraph">有关 SAP HANA 容量要求的详细问题描述，请参见<block ref="ae8b2f435e0615ecc6234e8baafe37d2" category="inline-link-rx"></block> 白皮书。</block>
  <block id="bbce32f30700e8b905762b8cfd022bc5" category="admonition">必须使用 NetApp 的 SAP HANA 存储规模估算工具来确定使用多个 SAP HANA 系统的整体 SAP 环境的容量规模估算。请联系 NetApp 或您的 NetApp 合作伙伴销售代表，以验证适当规模的存储环境的存储规模估算流程。</block>
  <block id="46fcaad64094e886321a215ecd47a4b6" category="section-title">配置性能测试工具</block>
  <block id="e69e9d3f5ed6c444c36582f4128ffd41" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。使用 SAP 性能测试工具测试存储性能时，还必须设置这些参数。</block>
  <block id="9a648a6755f45956100ee3fff99676a5" category="paragraph">NetApp 进行了性能测试以定义最佳值。下表列出了必须在 SAP 性能测试工具的配置文件中设置的参数。</block>
  <block id="83f499a540b1323009c200d6f8cc9396" category="cell">参数</block>
  <block id="689202409e48743b914713f96d93947c" category="cell">价值</block>
  <block id="a26ec55747d14548cbbfb785ba7235ca" category="cell">max_parlated_io_requests.</block>
  <block id="76dc611d6ebaafc66cc0879c71b5db5c" category="cell">128.</block>
  <block id="6ed7c95da7b1657525ed8f429f52b06a" category="cell">异步读取提交</block>
  <block id="ed2b5c0139cec8ad2873829dc1117d50" category="cell">开启</block>
  <block id="67e2efa65376a7aacd40ff40da1bddae" category="cell">异步写入提交活动</block>
  <block id="ac5e272fb590151aef3dd14286c416e0" category="cell">异步写入提交块</block>
  <block id="a181a603769c1f98ad927e7367c7aa51" category="cell">全部</block>
  <block id="149b8cb3de2ef5293654161397dd957b" category="inline-link">SAP 注释 1943937</block>
  <block id="cfc4a41d38a7e9272bd9608bb24765a7" category="inline-link">SAP 注释 2493172</block>
  <block id="21d0c248148c59a01600a5188cec24a7" category="paragraph">有关 SAP 测试工具配置的详细信息，请参见<block ref="ec90a615c6d378fa60ba8e7f2e7592b2" category="inline-link-rx"></block> 适用于 HWCCT （ SAP HANA 1.0 ）和<block ref="2912abb2c0271a2912b6a4a94888e0ec" category="inline-link-rx"></block> 适用于 HCMT/HCOT （ SAP HANA 2.0 ）。</block>
  <block id="f3ff9b33ed05e0cef1b1ae8cf470ea13" category="paragraph">以下示例显示了如何为 HCMT/HCOT 执行计划设置变量。</block>
  <block id="deab23bd3b868c986b7cb29f6fd4acc0" category="paragraph">必须在测试配置中使用这些变量。SAP 使用 HCMT/HCOT 工具提供的预定义执行计划通常会出现这种情况。以下 4K 日志写入测试示例来自执行计划。</block>
  <block id="9d9e7f5a6c25f736c782389b8599b38d" category="section-title">存储规模估算流程概述</block>
  <block id="b1dce9c1c938edf81a622f42fe8fc806" category="paragraph">每个 HANA 主机的磁盘数以及每个存储模型的 SAP HANA 主机密度均通过 SAP 性能测试工具确定。</block>
  <block id="a2a4e680f0b23836f4575f338d8b238e" category="paragraph">规模估算过程需要详细信息，例如生产和非生产 SAP HANA 主机的数量，每个主机的 RAM 大小以及基于存储的 Snapshot 副本的备份保留。SAP HANA 主机的数量决定了存储控制器和所需磁盘的数量。</block>
  <block id="4e22e31bf06b566da1fafaaf1f973f9d" category="paragraph">在容量规模估算期间， RAM 大小，每个 SAP HANA 主机磁盘上的净数据大小以及 Snapshot 副本备份保留期限均用作输入。</block>
  <block id="99be89615802a61d60cb75b091a02b81" category="paragraph">下图总结了规模估算过程。</block>
  <block id="2e7a402421dfc1b152f473c0c97f8a59" category="paragraph"><block ref="2e7a402421dfc1b152f473c0c97f8a59" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f7cbe605dd56f1b17607d52d35afa671" category="inline-link-macro">接下来：基础架构设置和配置。</block>
  <block id="edd62249093de8aefd66e0a83a7096ce" category="paragraph"><block ref="edd62249093de8aefd66e0a83a7096ce" category="inline-link-macro-rx"></block></block>
  <block id="535db3cbff51345ddc48fb6dbd091125" category="summary">在设置主机之前，必须从 NetApp 支持站点下载 NetApp SAN 主机实用程序，并将其安装在 HANA 服务器上。主机实用程序文档提供了有关根据所使用的 FCP HBA 而必须安装的其他软件的信息。</block>
  <block id="94b743cff45da9c23b8a3bc300657f21" category="doc">主机设置</block>
  <block id="62a0988dc2ebf8d31210d402e15edfd1" category="inline-link-macro">先前版本： SAP HANA 存储连接器 API 。</block>
  <block id="83c6ffc50438a454bac899ca1f154203" category="paragraph"><block ref="83c6ffc50438a454bac899ca1f154203" category="inline-link-macro-rx"></block></block>
  <block id="09ea0908fbfc4cde85bf416e35dc55c8" category="inline-link">NetApp 支持</block>
  <block id="aec61b9198189c2192a934e97fa0ba6c" category="paragraph">在设置主机之前，必须从下载 NetApp SAN 主机实用程序<block ref="1a36b59ecae7684863b79a0f690b6840" category="inline-link-rx"></block> 站点和安装在 HANA 服务器上。主机实用程序文档提供了有关根据所使用的 FCP HBA 而必须安装的其他软件的信息。</block>
  <block id="ac2b4035dacf66e6bdd5bede88e20260" category="inline-link">《 Linux Host Utilities 7.1 安装和设置指南》</block>
  <block id="451ad01703fad985ae3358eaf6f2bd14" category="paragraph">文档还包含有关特定于所用 Linux 版本的多路径配置的信息。本文档介绍了 SLES 12 SP1 或更高版本以及 RHEL 7 所需的配置步骤。2 或更高版本，如中所述<block ref="c4b23c8c60f3faad406f8d46d87ba646" category="inline-link-rx"></block>。</block>
  <block id="41df23532b1b2095e93dfed170e3e95a" category="section-title">配置多路径</block>
  <block id="29c8d00954b1d81fd235004ad72cdc15" category="admonition">必须在 SAP HANA 多主机配置中的所有辅助主机和备用主机上执行步骤 1 到 6 。</block>
  <block id="face2730fdfb3061ad0f284515f9695d" category="paragraph">要配置多路径，请完成以下步骤：</block>
  <block id="d49e35527dee3aa4c0935558a3ccd40e" category="list-text">在每个服务器上运行 Linux `rescan-scsi-bus.sh -a` 命令以发现新的 LUN 。</block>
  <block id="75be82f3eaed4a8948bb32c324a96484" category="list-text">运行 `sanlun lun show` 命令并验证所有必需的 LUN 是否可见。以下示例显示了对于具有两个数据 LUN 和两个日志 LUN 的 2+1 多主机 HANA 系统的 `sanlun lun show` 命令输出。输出将显示 LUN 以及相应的设备文件，例如 LUN `SS3_data_mnt00001` 和设备文件 ` /dev/sdag` 每个 LUN 都有八条从主机到存储控制器的 FC 路径。</block>
  <block id="56674facde12d75bf46b49b5d6316f96" category="list-text">运行 `multipath -r` 命令以获取设备文件名的全球通用标识符（ WWID ）。</block>
  <block id="86551857b20d1627afd561e1111dd48c" category="admonition">在此示例中，有四个 LUN 。</block>
  <block id="b0a7dea9169ca74da0133eed343854ee" category="list-text">编辑 ` /etc/multipath.conf` 文件并添加 WWID 和别名。</block>
  <block id="649b8d1047ff4dbb68eac12144e5c1d5" category="admonition">示例输出显示了 ` /etc/multipath.conf` 文件的内容，其中包括 2+1 多主机系统中四个 LUN 的别名。如果没有可用的 multipath.conf 文件，则可以运行以下命令创建一个： `multipath -T &gt; /etc/multipath.conf` 。</block>
  <block id="9dc341408c35ffb21d021f873916b3be" category="list-text">运行 `multipath -r` 命令重新加载设备映射。</block>
  <block id="349df7a76ee939fd3552195d183e56a3" category="list-text">运行 `multipath -ll` 命令列出所有 LUN ，别名以及活动和备用路径，以验证配置。</block>
  <block id="3c440be39ee7b8ee32df76222e620417" category="admonition">以下示例输出显示了具有两个数据和两个日志 LUN 的 2+1 多主机 HANA 系统的输出。</block>
  <block id="f54213342718e90a288d6625eb733968" category="section-title">创建 LVM 卷组和逻辑卷</block>
  <block id="eeeec6c7d6ba3ce79b3e9a26d6ebed05" category="paragraph">只有在使用 LVM 时，才需要执行此步骤。以下示例适用于使用 SID FC5 的 2+1 主机设置。</block>
  <block id="72d8906ce88673b5ddc42cd605b2aaa9" category="admonition">对于基于 LVM 的设置，也必须完成上一节所述的多路径配置。在此示例中，必须为多路径配置八个 LUN 。</block>
  <block id="baf6ddaa837973f5c39837c3746535f5" category="list-text">将所有 LUN 初始化为物理卷。</block>
  <block id="e4eae96188ebd77284f0fc28c5c7413d" category="list-text">为每个数据和日志分区创建卷组。</block>
  <block id="fa0e9e0367bdf43a5c4d9ceba40a46db" category="list-text">为每个数据和日志分区创建一个逻辑卷。使用的条带大小等于每个卷组使用的 LUN 数量（在此示例中为 2 个），数据条带大小为 256k ，日志条带大小为 64k 。SAP 仅支持每个卷组一个逻辑卷。</block>
  <block id="a087a05338313c4f0b57c0d12c8ab31f" category="list-text">扫描所有其他主机上的物理卷，卷组和卷组。</block>
  <block id="58ccaa44e6f56ff65128a0b109099e56" category="admonition">如果这些命令未找到卷，则需要重新启动。</block>
  <block id="2fd29cd445709da647beada7d8568a19" category="paragraph">要挂载逻辑卷，必须激活逻辑卷。要激活卷，请运行以下命令：</block>
  <block id="e496d06cb94c67ede4a84c45f23a2df0" category="section-title">创建文件系统</block>
  <block id="fe1d650ecab92ef6fac725422fa64a17" category="paragraph">要在属于 HANA 系统的每个 LUN 上创建 XFS 文件系统，请执行以下操作之一：</block>
  <block id="21310a39c09dc5a86b6aa8b7ca24abda" category="list-text">对于单主机系统，请在数据，日志和 ` /ha/shared` LUN 上创建 XFS 文件系统。</block>
  <block id="c4802401f24cf9235459d06e324b1822" category="list-text">对于多主机系统，请在所有数据和日志 LUN 上创建 XFS 文件系统。</block>
  <block id="0c55b43772e02b7a7b21494f4ebb786e" category="list-text">如果使用 LVM ，请在所有数据卷和日志逻辑卷上创建 XFS 文件系统。</block>
  <block id="39cf4ec35983fa721c6b420b210c0675" category="admonition">多主机示例命令显示 2+1 多主机 HANA 系统。</block>
  <block id="da177ee5af51709ede3e62f55d81fee9" category="section-title">创建挂载点</block>
  <block id="fd9e946778d15df799e35ae9bfac94dc" category="paragraph">要创建所需的挂载点目录，请执行以下操作之一：</block>
  <block id="85db8406a3844549afcdbb507b8b4a00" category="list-text">对于单主机系统，设置权限并在数据库主机上创建挂载点。</block>
  <block id="88e0b55e191e70b52e4da6547b146c00" category="list-text">对于多主机系统，请在所有辅助主机和备用主机上设置权限并创建挂载点。</block>
  <block id="dc20c000dc7df08f0d52c68147bd32cc" category="admonition">示例命令显示 2+1 多主机 HANA 系统。</block>
  <block id="abf08e214081b9beed93c8754e4c2830" category="admonition">对于使用 Linux LVM 的系统配置，必须执行相同的步骤。</block>
  <block id="89c617c4ed9cac275e572a67b1c52b29" category="section-title">挂载文件系统</block>
  <block id="0cf8a62142dc06e1659f328c1b19b998" category="paragraph">要在系统启动期间使用 ` /etc/fstab` 配置文件挂载文件系统，请完成以下步骤：</block>
  <block id="6ddcbef1e37179143e2e2d6df9bd36e3" category="list-text">对于单主机系统，请将所需的文件系统添加到 ` /etc/fstab` 配置文件中。</block>
  <block id="f698665f2a88873767fbe21e3908ef17" category="admonition">必须使用 `relatime` 和 `inode64` 挂载选项挂载数据和日志 LUN 的 XFS 文件系统。</block>
  <block id="3a5164e3fb3ffa4aa2126eda14219ec2" category="paragraph">如果使用 LVM ，请对数据和日志使用逻辑卷名称。</block>
  <block id="6103fab32715f34b55faefb16a1ee20b" category="list-text">对于多主机系统，请将 ` /ha/shared` 文件系统添加到每个主机的 ` /etc/fstab` 配置文件中。</block>
  <block id="54720e6c9a787dee1a825e4ea3505728" category="admonition">所有数据和日志文件系统均通过 SAP HANA 存储连接器挂载。</block>
  <block id="5a3bf297b3cbbda0eaa792a3fc9aa696" category="paragraph">要挂载文件系统，请在每个主机上运行 `mount – a` 命令。</block>
  <block id="7f0b4f9d457a69000abff967efc2f112" category="inline-link-macro">接下来： SAP HANA 的 I/O 堆栈配置。</block>
  <block id="471f14a809ee8298d2de500feee5421a" category="paragraph"><block ref="471f14a809ee8298d2de500feee5421a" category="inline-link-macro-rx"></block></block>
  <block id="3a8315c9f707101d2111acb24fbc9655" category="summary">下面是 SAP HANA 软件安装的要求。</block>
  <block id="5a2aa3670ec2c725fbc9df08b8acb57a" category="paragraph"><block ref="5a2aa3670ec2c725fbc9df08b8acb57a" category="inline-link-macro-rx"></block></block>
  <block id="0c68d8a40313113ebbe5ac4a1f3d0dba" category="section-title">在单主机系统上安装</block>
  <block id="00cf3f3ec718b396e5e81b9c3fb6cf84" category="section-title">在多主机系统上安装</block>
  <block id="bb69fd52b05309d22618c8df73c8950e" category="admonition">以下安装操作步骤基于 SAP HANA 1.0 SPS12 或更高版本。</block>
  <block id="89a99a898a74d4f2ff80a5aa417e1639" category="paragraph">开始安装之前，请创建一个 `global.ini` 文件，以便在安装过程中使用 SAP 存储连接器。在安装过程中， SAP 存储连接器会在工作主机上挂载所需的文件系统。`global.ini` 文件必须位于可从所有主机访问的文件系统中，例如， ` /ha/shared/SID` 文件系统。</block>
  <block id="0e0c950ebceebc20ac07965f3d63f754" category="paragraph">如果使用 LVM ，则所需的配置会有所不同。以下示例显示了一个 2+1 多主机设置，其中 SID 为 FC5 。</block>
  <block id="617127e0171267994816fcd2ebf41ca9" category="paragraph">使用 SAP `hdblcm` 安装工具，在其中一个工作主机上运行以下命令以启动安装。使用 `addhosts` 选项添加第二个工作主机（ sapcc-han-TST-04 ）和备用主机（ sapcc-han-TST-05 ）。存储已准备好的 `global.ini` 文件的目录包含在 `storage_cfg` CLI 选项（` -storage_cfg=/has/shared` ）中。根据所使用的操作系统版本，可能需要先安装 phyton 2.7 ，然后再安装 SAP HANA 数据库。</block>
  <block id="7240594518adce5aa15ce898f9fedf54" category="paragraph"><block ref="7240594518adce5aa15ce898f9fedf54" category="inline-link-macro-rx"></block></block>
  <block id="ccfecfc3c760234b204defd360b79249" category="paragraph"><block ref="ccfecfc3c760234b204defd360b79249" category="inline-link-macro-rx"></block></block>
  <block id="912023f4eba0bf223e908e20d22ff92f" category="paragraph">以下各节提供了 SAP HANA 基础架构设置和配置准则，并介绍了设置 SAP HANA 系统所需的所有步骤。在这些部分中，使用了以下示例配置：</block>
  <block id="1fe7024fe9791851449cb45fab125c35" category="paragraph"><block ref="1fe7024fe9791851449cb45fab125c35" category="inline-link-macro-rx"></block></block>
  <block id="4bb047f8c530785002e490ef17fa725e" category="doc">从何处查找追加信息</block>
  <block id="b3df4b83a613273f219d7e187779a691" category="inline-link-macro">上一步：添加其他数据卷分区。</block>
  <block id="d23d485ddb6a253c7a66aa36bdc6ce38" category="paragraph"><block ref="d23d485ddb6a253c7a66aa36bdc6ce38" category="inline-link-macro-rx"></block></block>
  <block id="345245c83d2b2c4c2a5eb9f2887da627" category="paragraph">要了解有关本文档中所述信息的更多信息，请参见以下文档和 / 或网站：</block>
  <block id="8fd6557b141d2028a09650e620b8db62" category="inline-link">www.vmware.com/files/pdf/SAP_HANA_on_vmware_vSphere_best_practices_guide.pdf</block>
  <block id="e716d4cf191a23eed050de97f30c7734" category="list-text">在 VMware vSphere 上纵向扩展 SAP HANA 的最佳实践和建议<block ref="156ab83547a69207813015793bfe2332" category="inline-link-rx"></block></block>
  <block id="e5610b49e37e1a9ca8d3ccf645895af2" category="inline-link"><block ref="e5610b49e37e1a9ca8d3ccf645895af2" category="inline-link-rx"></block></block>
  <block id="970dbae95adcaf61c533fc0168c59d92" category="list-text">在 VMware vSphere 上横向扩展 SAP HANA 的最佳实践和建议<block ref="ed1a4cf8e74958e746c53d94aee28736" category="inline-link-rx"></block></block>
  <block id="77187c93e0b43c549228506243592b1f" category="inline-link"><block ref="77187c93e0b43c549228506243592b1f" category="inline-link-rx"></block></block>
  <block id="0a3bd9b406b68c67e9ecedb9de02fb0b" category="list-text">适用于 SAP HANA 的 SAP 认证企业存储硬件<block ref="e40283d3953ee3d843b92518a02ffe78" category="inline-link-rx"></block></block>
  <block id="609ca29747ea8303cd5fa3fb9470668d" category="inline-link"><block ref="609ca29747ea8303cd5fa3fb9470668d" category="inline-link-rx"></block></block>
  <block id="e0a1169f5eb8d266a87ee416bfe69d83" category="list-text">SAP HANA 存储要求<block ref="38657a01715c45b59546cbf0d906ef65" category="inline-link-rx"></block></block>
  <block id="06ad3435fb38e020aa7a36d8924c9f5c" category="inline-link"><block ref="06ad3435fb38e020aa7a36d8924c9f5c" category="inline-link-rx"></block></block>
  <block id="e13abf2b6c9591fe151e9286fa5e75a5" category="list-text">SAP HANA 定制数据中心集成常见问题解答<block ref="3710f13cc62644ea40b0af38f0b1198e" category="inline-link-rx"></block></block>
  <block id="6137d44b5191549a06e7bea8ffd942d3" category="inline-link"><block ref="6137d44b5191549a06e7bea8ffd942d3" category="inline-link-rx"></block></block>
  <block id="6f907eb751f7fabe2c63aee8b3529b14" category="list-text">TR-4646 ：《使用存储复制实现 SAP HANA 灾难恢复》<block ref="62658c7987e92cf3967ab8bdd1e66d18" category="inline-link-rx"></block></block>
  <block id="1ffb329e128f9f021221cb333667e643" category="inline-link"><block ref="1ffb329e128f9f021221cb333667e643" category="inline-link-rx"></block></block>
  <block id="7a28a9c1676d9980d4743396ec41e05e" category="list-text">TR-4614 ：《使用 SnapCenter 实现 SAP HANA 备份和恢复》<block ref="026a8e661ca1c91258a93024c126a529" category="inline-link-rx"></block></block>
  <block id="ed4d2f627a13537ec50cc73b8aab9434" category="inline-link">www.netapp.com/us/media/tr-4338.pdf</block>
  <block id="0aeac98f03977f60da41b25c44ab1d16" category="list-text">TR-4338 ：《基于 VMware vSphere 的 SAP HANA 与 NetApp FAS 和 AFF 系统》<block ref="f3cf3d4bafab3435fc6438043df8d588" category="inline-link-rx"></block></block>
  <block id="144b9f7c2b692720a8d41abdda9b5485" category="inline-link"><block ref="144b9f7c2b692720a8d41abdda9b5485" category="inline-link-rx"></block></block>
  <block id="9437a0c7fd3aa1491ea7e97594e4706e" category="list-text">TR-4667 ：使用 SnapCenter 4.0 SAP HANA 插件自动执行 SAP 系统副本<block ref="cb22cde491c8ae8ab780a6806f412e04" category="inline-link-rx"></block></block>
  <block id="c9617ae303d0bce89d13bebecca2ea1b" category="inline-link"><block ref="c9617ae303d0bce89d13bebecca2ea1b" category="inline-link-rx"></block></block>
  <block id="af970b7f5802a374d53f2c5d39adb076" category="list-text">NetApp 文档中心<block ref="bf78332b32395471af72955679895502" category="inline-link-rx"></block></block>
  <block id="29381d3b46032a1fd6af6512d8c47b4a" category="inline-link"><block ref="29381d3b46032a1fd6af6512d8c47b4a" category="inline-link-rx"></block></block>
  <block id="f089acce3f0d6fcaced91a0696005dff" category="list-text">NetApp FAS 存储系统资源<block ref="65fdf1bbdd083420089318972c99c550" category="inline-link-rx"></block></block>
  <block id="1dccfff04324701476d4ae813651374e" category="inline-link">www.netapp.com/us/solutions/applications/sap/index.aspx#sap-hana</block>
  <block id="1d2d39f411f870989256ab7ea42e9394" category="list-text">SAP HANA 软件解决方案<block ref="71aa61c769ce3c313ee996249b3ba484" category="inline-link-rx"></block></block>
  <block id="2c5ab7ab8a72e469f0ac8b6594f8be1e" category="inline-link-macro">下一步：更新历史记录。</block>
  <block id="1ddeb75915dad792c1523a505f384cbb" category="paragraph"><block ref="1ddeb75915dad792c1523a505f384cbb" category="inline-link-macro-rx"></block></block>
  <block id="3a8abeead42ccd286a7d0cbd4af82313" category="cell">2014年4月</block>
  <block id="862ad23f517c987dec375a134fc0d5c0" category="cell">初始版本</block>
  <block id="4d07a3bdc1f6c260f91eff5a8c4732c0" category="cell">2014年8月</block>
  <block id="4b0b2617da1a441d88f736d71d3ac092" category="cell">更新了磁盘大小调整选择并添加了 SSD 配置添加了 Red Hat Enterprise Linux OS 配置添加了 SAP HANA 存储连接器信息添加了有关 VMware 配置的信息</block>
  <block id="76bc3a375f8e5795348c2e28143619d9" category="cell">2014年11月</block>
  <block id="db4466d6123c2bcdc9153e35eed5d67a" category="cell">更新了存储规模估算部分</block>
  <block id="618bd2c932463ac5cdbf61a8a11129b7" category="cell">版本 2.2</block>
  <block id="bde49e4082500b233767ac0393f52c97" category="cell">2015年1月</block>
  <block id="18b29171bb9db10940df132fe30b02ef" category="cell">更新了存储连接器 API 部分更新了聚合和卷配置</block>
  <block id="71b25740d9a5ec039b5d6a1c55f0bd02" category="cell">版本 2.3</block>
  <block id="e9d3c4f3be58e8eb9a2fe5ef80b5dbcd" category="cell">2015年3月</block>
  <block id="adceb3eeeca6d2e6e13cc707f1047b4d" category="cell">新增了 SAP HANA SPS9 的 STONITH 实施功能，增加了计算节点设置和 HANA 安装部分</block>
  <block id="6c37787225b6b2fa9a3a2d7f9c7b9b1f" category="cell">增加了对 cDOT 的 NFSv4 支持，更新了 sysctl 参数，包括 SAP HANA 的 I/O 参数和 HWVAL &gt; SPS10</block>
  <block id="357a6db4d8952d53bdb6f4eb953edf16" category="cell">更新了容量规模估算更新了 /has/shared 更新了 sysctl 参数的挂载选项</block>
  <block id="5d431191212b0f13c81937d63ee45577" category="cell">版本 4.0</block>
  <block id="3d4f06d9a20e1dd80d32a7be99445018" category="cell">新的 NetApp 存储系统和磁盘架 ONTAP 9 的新增功能支持 40GbE 新操作系统版本（ SUSE Linux Enterprise Server12 SP1 和 Red Hat Enterprise Linux 7.2 ）新的 SAP HANA 版本</block>
  <block id="f61a9f4c3fce94c521ff33cc50c285ab" category="cell">版本 4.1</block>
  <block id="738e4f16a24a9e74c1f67ae2e7c02f3b" category="cell">版本 5.0</block>
  <block id="4880361a9deda058baa93a9609f49c06" category="cell">新的 NetApp 存储系统新的操作系统版本（ SUSE Linux Enterprise Server 12 SP3 和 Red Hat Enterprise Linux 7.4 ） SAP HANA 2.0 SPS3 的其他次要更改</block>
  <block id="62819fc3af1b125ec2e633ccd65a3cba" category="cell">版本 5.1</block>
  <block id="bbfb6d5a145f45ac380d5c56707a3b3f" category="cell">2019 年 9 月</block>
  <block id="b48c54ef40f55cf60865e423133eea27" category="cell">新的操作系统版本（ SUSE Linux Enterprise Server 12 SP4 ， SUSE Linux Enterprise Server 15 和 Red Hat Enterprise Linux 7.6 ） MAX Data 卷大小略有更改</block>
  <block id="0b0eef8f1e851afe6b131cf612887364" category="cell">版本 5.2</block>
  <block id="42aef0714dca75b922449334f8354e29" category="cell">2019年12月</block>
  <block id="be4ee54ca2edc105b3af0d346b4fab97" category="cell">新的 NetApp 存储系统新的操作系统版本 SUSE Linux Enterprise Server 15 SP1</block>
  <block id="f82abf5460f6063b37d14a41a7afceb1" category="cell">版本 5.3</block>
  <block id="342aa26fa2cc7e365c1b819a4e86b6f1" category="cell">2020年3月</block>
  <block id="d41615a4f21c04431fed0afc578baede" category="cell">支持 NFSv3 新操作系统版本 Red Hat Enterprise Linux 8 的 nconnect</block>
  <block id="4e34602dd848f28c88462ee499addd05" category="cell">版本 5.4</block>
  <block id="0fa56213ed5deea97598ccd1f1d3db87" category="cell">2020 年 5 月</block>
  <block id="1ab89c4e611ba31faab0f6bdb2081951" category="cell">自 SAP HANA 2.0 SPS4 以来，引入了多种数据分区功能</block>
  <block id="5ff2ce30f1ed8ad6f7e86aad1d43f427" category="cell">版本 5.5</block>
  <block id="0a8d47ca9f632c416a369fde81c14d1d" category="cell">版本 5.6</block>
  <block id="a5667679a016ee66ef9bc45c1a173b3b" category="cell">2020年12月</block>
  <block id="cdd33367f29c689bcb60e79e248c660e" category="cell">从 ONTAP 9.8 开始支持 NFSv4.1 的 nconnect 新操作系统版本新的 SAP HANA 版本</block>
  <block id="3cc049a85ec03d6c7c7e7cee3943f656" category="cell">版本 5.7</block>
  <block id="8aa90565fb34d8b0aeab74ab74ffdf4a" category="cell">2021年2月</block>
  <block id="6ed1463e8ca682ff7a3d60ed388dcefe" category="cell">更改主机网络设置和其他小更改</block>
  <block id="caedd77305f36805e5e9f71196bad9dc" category="summary">每个 SAP HANA 服务器都必须具有一个冗余 FCP SAN 连接，带宽至少为 8 Gbps 。对于连接到存储控制器的每个 SAP HANA 主机，必须在存储控制器上至少配置 8 Gbps 的带宽。</block>
  <block id="ac20a17ff8274dc0492aecef51b17cc3" category="doc">SAN 网络结构设置</block>
  <block id="e42c6dba9257b7818a2f1dbd8618271c" category="inline-link-macro">先前版本：基础架构设置和配置。</block>
  <block id="df2b2f4d3b2ced71ab2886cd3fa8b7b7" category="paragraph"><block ref="df2b2f4d3b2ced71ab2886cd3fa8b7b7" category="inline-link-macro-rx"></block></block>
  <block id="b180b819c4be4e05edc4c7fb2025b37a" category="paragraph">下图显示了一个示例，其中四个 SAP HANA 主机连接到两个存储控制器。每个 SAP HANA 主机都有两个 FCP 端口连接到冗余网络结构。在存储层，配置了四个 FCP 端口，可为每个 SAP HANA 主机提供所需的吞吐量。</block>
  <block id="da00e65e184de09d67293fad7ce88ffd" category="paragraph"><block ref="da00e65e184de09d67293fad7ce88ffd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3537fc965bfc8258734281e905f0339b" category="paragraph">除了交换机层上的分区之外，您还必须将存储系统上的每个 LUN 映射到连接到此 LUN 的主机。使交换机上的分区保持简单，即定义一个分区集，使所有主机 HBA 都可以查看所有控制器 HBA 。</block>
  <block id="0261b55ae8064a9ab3d6f349e6620bf9" category="inline-link-macro">下一步：时间同步。</block>
  <block id="0c6bb7fd302bb2eafabcba0aba3ea4f2" category="paragraph"><block ref="0c6bb7fd302bb2eafabcba0aba3ea4f2" category="inline-link-macro-rx"></block></block>
  <block id="030c69314a5026a51c56546f16b3d52c" category="cell">2015年2月</block>
  <block id="d236c4295d03153cf4b58756ba35a16b" category="cell">包含 SAP HANA 和 HWVAL SPS 10 及更高版本的 I/O 参数</block>
  <block id="ca67bdac3e5296c9aca14c7757a45a43" category="cell">2016年2月</block>
  <block id="8511699ac8ab74e8202ea00e8605032a" category="cell">新的 NetApp 存储系统和磁盘架 ONTAP 9 新操作系统版本（ SLES12 SP1 和 Red Hat Enterprise Linux 7.2 ）的新功能全新 SAP HANA 版本</block>
  <block id="86c976bd97e98538a78594cffd1f4347" category="cell">新的 NetApp 存储系统新的操作系统版本（ SLES12 SP3 和 Red Hat Enterprise Linux 7.4 ） SAP HANA 2.0 SPS3 的其他次要更新</block>
  <block id="b2741985b04e7a670dd01c660734116f" category="cell">新操作系统会发布次要更新</block>
  <block id="c3687f641cfdd19b41b8fe6f7cb68897" category="cell">版本 4.2</block>
  <block id="e3e03be4a83995541c9aa6cd468adfff" category="cell">自 SAP HANA 2.0 SPS4 以来，全新的 AFF ASA 系列存储系统引入了多种数据分区功能</block>
  <block id="e1b61136672bccd13e6828fe7987e4f6" category="cell">版本 4.3</block>
  <block id="0eb0e7ad4cb166bbccd693c2caa1bacd" category="cell">Linux LVM 支持新的 NetApp 存储系统新的操作系统版本（ SLES15SP2 ， RHEL 8 ）</block>
  <block id="9a4bface9098ff4cd4b35cca641c0042" category="cell">2021年4月</block>
  <block id="f389acb9c3b9da7fd00873307beefaf2" category="cell">添加了 VMware vSphere 专用信息</block>
  <block id="825584759100661fac8be910e01502e6" category="summary">您必须同步存储控制器与 SAP HANA 数据库主机之间的时间。</block>
  <block id="be8226fe0c6443f6cad5815ef0b97b33" category="doc">时间同步</block>
  <block id="09796b22691133f0d1379e7a53a1fc5e" category="inline-link-macro">先前版本： SAN 网络结构设置。</block>
  <block id="ab79161f2cd451ff879c4012d4fa708c" category="paragraph"><block ref="ab79161f2cd451ff879c4012d4fa708c" category="inline-link-macro-rx"></block></block>
  <block id="f63d5e470adeffe7633a6b7dd6a766f0" category="paragraph">您必须同步存储控制器与 SAP HANA 数据库主机之间的时间。必须为所有存储控制器和所有 SAP HANA 主机设置相同的时间服务器。</block>
  <block id="6f54798af3956fe25acf274f8d9aad87" category="inline-link-macro">下一步：存储控制器设置。</block>
  <block id="ad088212a9faffd249d2040d0f53f712" category="paragraph"><block ref="ad088212a9faffd249d2040d0f53f712" category="inline-link-macro-rx"></block></block>
  <block id="2eb788c7ebf9dce439e8e3c303d5a7e0" category="paragraph"><block ref="2eb788c7ebf9dce439e8e3c303d5a7e0" category="inline-link-macro-rx"></block></block>
  <block id="283788d4b8f40899acef933a8b3cb2e7" category="paragraph">下一节概述了为 SAP HANA 估算存储系统规模所需的性能和容量注意事项。</block>
  <block id="d80e2fc4ceca3d26a3277e9ab88fda68" category="admonition">请联系您的 NetApp 或 NetApp 合作伙伴销售代表，为存储规模估算流程提供支持，并帮助您创建大小合适的存储环境。</block>
  <block id="42bd6e1e54cc980bd9322b30521321ca" category="paragraph">SAP 定义了一组静态存储关键性能指标（ KPI ）。无论数据库主机和使用 SAP HANA 数据库的应用程序的内存大小如何，这些 KPI 都适用于所有生产 SAP HANA 环境。这些 KPI 适用于单主机，多主机， HANA 上的 Business Suite ， HANA 上的 Business Warehouse ， S/4HANA 和 BB/4HANA 环境。因此，当前的性能规模估算方法仅取决于连接到存储系统的活动 SAP HANA 主机的数量。</block>
  <block id="c2c1b5b14996ab9aba9a186353eb6741" category="admonition">存储性能 KPI 仅适用于生产 SAP HANA 系统，但您可以在中为所有 HANA 系统实施。</block>
  <block id="8e1e38affc84c007b3fadf2fe3f94c0d" category="paragraph">SAP 提供了一个性能测试工具，必须使用该工具来验证连接到存储的活动 SAP HANA 主机的存储系统性能。</block>
  <block id="6149b256ad8746f06c3f529454afe3e0" category="paragraph">NetApp 测试并预定义了可连接到特定存储模型的最大 SAP HANA 主机数，同时仍满足 SAP 为基于生产的 SAP HANA 系统提供的所需存储 KPI 。</block>
  <block id="64b8a436222beafffe6cdd183786a7e7" category="paragraph">可以在磁盘架上运行的最大 SAP HANA 主机数以及每个 SAP HANA 主机所需的最小 SSD 数均通过运行 SAP 性能测试工具来确定。此测试不会考虑主机的实际存储容量要求。您还必须计算容量要求，以确定所需的实际存储配置。</block>
  <block id="a052dc95cd52f99e2150cc7afb3c9c46" category="section-title">SAS 磁盘架</block>
  <block id="b3ccef22c64fb18c4586c819217d0f8d" category="paragraph">对于 12 Gb SAS 磁盘架（ DS224C ），可使用固定磁盘架配置来执行性能规模估算：</block>
  <block id="627d56f1e06c43902409b38517d071d8" category="list-text">半负载磁盘架，带 12 个 SSD</block>
  <block id="caf4121cd1e84773f66f61f25a118b4f" category="list-text">满载磁盘架，含 24 个 SSD</block>
  <block id="f5bae058eb14b2365a397455cac09daa" category="paragraph">这两种配置都使用高级驱动器分区（ ADPv2 ）。半负载磁盘架最多可支持 9 个 SAP HANA 主机；一个全负载磁盘架最多可在一个磁盘架中支持 14 个主机。SAP HANA 主机必须在两个存储控制器之间平均分布。</block>
  <block id="801801c4a151eb328734c55f97c13ff3" category="admonition">必须使用 12 Gb SAS 连接 DS224C 磁盘架，以支持 SAP HANA 主机的数量。</block>
  <block id="5115380b0209eebdde0a83a569c67ac9" category="paragraph">6 Gb SAS 磁盘架（ DS2246 ）最多支持 4 个 SAP HANA 主机。SSD 和 SAP HANA 主机必须在两个存储控制器之间平均分布。下图总结了每个磁盘架支持的 SAP HANA 主机数。</block>
  <block id="043c223ee43975d6131cc23521e57f4d" category="cell">满载 24 个 SSD 的 6 Gb SAS 磁盘架（ DS2246 ）</block>
  <block id="2b0c391c7894ff251721538dc649534b" category="cell">12 GB SAS 磁盘架（ DS224C ），半负载，具有 12 个 SSD 和 ADPv2</block>
  <block id="7565d12fd6dd164a9dc8caa5e983cd6d" category="cell">12 GB SAS 磁盘架（ DS224C ），满载 24 个 SSD 和 ADPv2</block>
  <block id="45c48cce2e2d7fbdea1afc51c7c6ad26" category="cell">9</block>
  <block id="2b496b69f4c7aea7a8d59474a9bf6c8a" category="admonition">此计算与所使用的存储控制器无关。添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="58913e61815b0d5b4ebf09a2dbba07e5" category="section-title">NS224 NVMe 磁盘架</block>
  <block id="fb7b6fa1858a95ebd1dfe3c33b7d43fa" category="paragraph">第一个磁盘架至少需要 12 个 NVMe SSD ，最多支持 16 个 SAP HANA 主机。一个完全填充的磁盘架最多可支持 34 个 SAP HANA 主机。</block>
  <block id="8bcf6b78575503f1caaf3d70970f3855" category="admonition">添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="e2725d07d4b4cbeaff651e403b9ed0c2" category="paragraph">您可能会决定在同一存储控制器或同一聚合上部署 SAP HANA 工作负载和其他应用程序工作负载。如果是，您必须确保在混合工作负载环境中为 SAP HANA 提供足够的性能。NetApp 还建议您使用服务质量（ QoS ）参数来控制这些其他应用程序对 SAP HANA 应用程序可能产生的影响，并保证 SAP HANA 应用程序的吞吐量。</block>
  <block id="39d8b74e0095310309063c02410f6a20" category="paragraph">必须使用 SAP HCMT 测试工具检查是否可以在已用于其他工作负载的现有存储控制器上运行其他 SAP HANA 主机。SAP 应用程序服务器可以安全地放置在与 SAP HANA 数据库相同的存储控制器和 / 或聚合上。</block>
  <block id="fe49f707e4996a28b6c7f34609ee9475" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。使用 SAP 测试工具测试存储性能时，还必须为 SAP 的性能测试工具设置这些参数。</block>
  <block id="b86abe7931a3894ff977168fbdb8b7b6" category="paragraph">NetApp 进行了性能测试以定义最佳值。下表列出了必须在 SAP 测试工具的配置文件中设置的参数。</block>
  <block id="0e614553d2a8cc9424587a1d3acd9d09" category="paragraph">有关 SAP 测试工具配置的详细信息，请参见<block ref="ec90a615c6d378fa60ba8e7f2e7592b2" category="inline-link-rx"></block> 适用于 HWCCT （ SAP HANA 1.0 ）和<block ref="2912abb2c0271a2912b6a4a94888e0ec" category="inline-link-rx"></block> 适用于 HCMT/HCOT （ SAP HANA 2.0 ）。</block>
  <block id="410dd60427299621482167417a192d6f" category="paragraph">每个 HANA 主机的磁盘数以及每个存储模型的 SAP HANA 主机密度均通过 SAP HANA 测试工具确定。</block>
  <block id="5354fb46e0a3c5b507fe8fd5e4a8d6e8" category="paragraph"><block ref="5354fb46e0a3c5b507fe8fd5e4a8d6e8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ed09cf28c789300cc1749d434c9e2dab" category="paragraph"><block ref="ed09cf28c789300cc1749d434c9e2dab" category="inline-link-macro-rx"></block></block>
  <block id="365912103e9bce0d6c05c8ee64c9b43f" category="summary">从 SAP HANA 2.0 SPS4 开始，您可以配置其他数据卷分区，从而可以为 SAP HANA 租户数据库的数据卷配置两个或更多卷。</block>
  <block id="69a593c87ff666bb67c1207a32a24a79" category="doc">添加其他数据卷分区</block>
  <block id="3faf58bf7cc4bf76db58d3afb5f626de" category="inline-link-macro">先前版本： SAP HANA 软件安装。</block>
  <block id="1506c99c61ab69728c5ca23580c36e02" category="paragraph"><block ref="c465d53a60a0eb9e1a090706ecaed117" category="inline-link-macro-rx"></block>从 SAP HANA 2.0 SPS4 开始，您可以配置其他数据卷分区，从而可以为 SAP HANA 租户数据库的数据卷配置两个或更多卷。您还可以扩展到超出单个卷的大小和性能限制的范围。</block>
  <block id="35697e7b3429f60c725ef9d7b697ea1e" category="admonition">对于 SAP HANA 单主机和多主机系统，可以为数据卷使用两个或更多个单独的卷。您可以随时添加其他数据卷分区，但这样做可能需要重新启动 SAP HANA 数据库。</block>
  <block id="19ddc7e98eb6fa40c4ac62a77090bff2" category="section-title">启用其他数据卷分区</block>
  <block id="b4dbae4c26b3a936fe51ac6f503e18f7" category="list-text">要启用其他数据卷分区，请使用 SAP HANA Studio 或 SYSTEMDB 配置中的 Cockpit 在 `global.ini` 中添加以下条目。</block>
  <block id="6646190eb7b9d6c7a29ea115116c1c5e" category="admonition">手动将参数添加到 `global.ini` 文件需要重新启动数据库。</block>
  <block id="7935ac3c59536eb9c8a1b5f13e7f5716" category="section-title">单主机 SAP HANA 系统的卷配置</block>
  <block id="2583a9b74a1a2d8e89634e09b78f590d" category="paragraph">具有多个分区的单主机 SAP HANA 系统的卷布局与具有一个数据卷分区的系统的布局类似，但另一个数据卷存储在与日志卷和另一个数据卷不同的聚合上。下表显示了具有两个数据卷分区的 SAP HANA 单主机系统的示例配置。</block>
  <block id="94ef64dabfa4b51295dd875fa15a44de" category="cell">控制器 A 上的聚合 1</block>
  <block id="0da1566401e5a0582b6d811560cc8438" category="cell">控制器 A 上的聚合 2</block>
  <block id="747929c967a801a630de61c08e522b6b" category="cell">控制器 B 上的聚合 1</block>
  <block id="1d2c38f49539ebccd4cc3327d455942e" category="cell">控制器 b 上的聚合 2</block>
  <block id="a983282d84f231230a21d6e897fa5096" category="cell">数据卷： sid_data_mnt00001</block>
  <block id="3458d911e12a02c2c22c30c147e60dc7" category="cell">共享卷： sid_shared</block>
  <block id="d1ce9ffb9c761d5074baf3a5457e1bed" category="cell">数据卷： sid_data2_mnt00001</block>
  <block id="2849faa7f343c897c5059440d947d834" category="cell">日志卷： sid_log_mnt00001</block>
  <block id="1a7f6076f09280d452350c186d20b52c" category="paragraph">下表显示了具有两个数据卷分区的单主机系统的挂载点配置示例。</block>
  <block id="a75d0e69bd02dcf9fa585e045bc16d84" category="cell">Junction path</block>
  <block id="e73cda510e8bb947f7e61089e5581494" category="cell">目录</block>
  <block id="bf64a2d18066494ae65ae74fb4aae57d" category="cell">HANA 主机上的挂载点</block>
  <block id="bd8e6b40602529d6e57fdd885a48d151" category="cell">sid_data_mnt00001</block>
  <block id="37ce74088416f28dc9bb04355c2e5a28" category="cell">–</block>
  <block id="28645b4c3119792ae6fa1d7c40f5f3a8" category="cell">/ha/data/sid/mnt00001</block>
  <block id="25df05fd17104ffc9b29c882613281c6" category="cell">sid_data2_mnt00001</block>
  <block id="bb3dd4d1045ea603128872d169f40096" category="cell">/ha/data2/sid/mnt00001</block>
  <block id="b0344f7eade7f841bc1eb24d9175cad3" category="cell">sid_log_mnt00001</block>
  <block id="6adac4774bcd36fdc536601e6bdf18f5" category="cell">/ha/log/sid/mnt00001</block>
  <block id="07fe7fc9aa3cd33458708758a4a5854e" category="cell">sid_shared</block>
  <block id="c1ce059dbe7a4bf70cbd08a0fede6581" category="cell">use-sap 共享</block>
  <block id="96a082d267455fedce449479e429850b" category="cell">/usr/sap/SID /has/shared</block>
  <block id="afd44e74cb54a923d1cd4fe5065b370a" category="paragraph">创建新数据卷并使用 ONTAP 系统管理器或 ONTAP 集群命令行界面将其挂载到命名空间。</block>
  <block id="b7244e6e0957d367c131dd41458b8619" category="section-title">多主机 SAP HANA 系统的卷配置</block>
  <block id="0d93df55c1f3029fd5c21ba9e75aa25e" category="paragraph">具有多个分区的多主机 SAP HANA 系统的卷布局与具有一个数据卷分区的系统的布局类似，但另一个数据卷存储在与日志卷和另一个数据卷不同的聚合上。下表显示了具有两个数据卷分区的 SAP HANA 多主机系统的示例配置。</block>
  <block id="261addf78c7b2c961032b3dd08ba0b1f" category="cell">目的</block>
  <block id="15572572230ee081e530fd30f1a16139" category="cell">控制器 B 上的聚合 2</block>
  <block id="c50bebb751ab31a7b0e508e4dfdba06e" category="cell">节点 1 的数据卷和日志卷</block>
  <block id="d6b8eb7e3d6ddf4af2ac24f74f1ddee8" category="cell">Data2 卷： sid_data2_mnt00001</block>
  <block id="5585cc8b94529d9c0f345077289daeb3" category="cell">节点 2 的数据卷和日志卷</block>
  <block id="7efb64be9f62e8f3406e303538204110" category="cell">日志卷： sid_log_mnt00002</block>
  <block id="79c44c08a641df91246f70b5f4721b31" category="cell">Data2 卷： sid_data2_mnt00002</block>
  <block id="f26af5ab0fdf7a3063e0701448193969" category="cell">数据卷： sid_data_mnt00002</block>
  <block id="b62802686db75d9aaba27ff8baea5457" category="cell">节点 3 的数据卷和日志卷</block>
  <block id="93b4e1912193293e4191e8d10ca4086e" category="cell">数据卷： sid_data_mnt00003</block>
  <block id="8d4ffa81992169c71fc47a58aa110819" category="cell">Data2 卷： sid_data2_mnt00003</block>
  <block id="3051e617efdca60e945d64ca6067b3a2" category="cell">日志卷： sid_log_mnt00003</block>
  <block id="66bb8e08981a9eb2e93115ca07d2d372" category="cell">节点 4 的数据卷和日志卷</block>
  <block id="e841538cca9e2cf1fae81ffe21df7466" category="cell">Data2 卷： sid_data2_mnt00004</block>
  <block id="3ed5556fee96de062d644851208dd660" category="cell">日志卷： sid_log_mnt00004</block>
  <block id="03a60a69cee7408b407e8ed18de961e5" category="cell">数据卷： sid_data_mnt00004</block>
  <block id="7ad8ef5e9493431c100fe1929275d46f" category="cell">所有主机的共享卷</block>
  <block id="693ff1bb9789154e19ce882511f832d6" category="cell">SAP HANA 主机上的挂载点</block>
  <block id="3b0649c72650c313a357338dcdfb64ec" category="cell">注意</block>
  <block id="3834b3356eaa1553006c5471596d35c1" category="cell">已挂载到所有主机上</block>
  <block id="aed47d1036974391b87115f518c5ad9d" category="cell">sid_data_mnt00002</block>
  <block id="014e151088a15dadd29fbd3ddd2eece8" category="cell">/ha/data/sid/mnt00002</block>
  <block id="33536390a7276b2c74b95566e3d0d297" category="cell">sid_data2_mnt00002</block>
  <block id="ab22798507bc37ab18a91947cfbe50e6" category="cell">/ha/data2/sid/mnt00002</block>
  <block id="8eaf7e9b1604430bac4e6dfd5939d3b3" category="cell">sid_log_mnt00002</block>
  <block id="36fb6deade219e3cfdee0d1e5382afa8" category="cell">/ha/log/sid/mnt00002</block>
  <block id="2289ec88b37b878c492747449a18a549" category="cell">sid_data_mnt00003</block>
  <block id="fef79e4721fe570e8a193320c7d270ce" category="cell">/ha/data/sid/mnt00003</block>
  <block id="bbff3274b9791230c96c20a7db005976" category="cell">sid_data2_mnt00003</block>
  <block id="ca0cf1c880cd5ab76a6c51562746eb04" category="cell">/ha/data2/sid/mnt00003</block>
  <block id="4439e6ea1822110931ae0b346803a4ac" category="cell">sid_log_mnt00003</block>
  <block id="380d4f0ad324c2dfd6c1ca68fd7bafbf" category="cell">/ha/log/sid/mnt00003</block>
  <block id="e8305dfe00f0309c92a6206d66e79543" category="cell">sid_data_mnt00004</block>
  <block id="a4f33e779d1944af098aa7eb8e8b7af4" category="cell">/ha/data/sid/mnt00004</block>
  <block id="218ad8a689f58dc4e5ba92853698500b" category="cell">sid_data2_mnt00004</block>
  <block id="08dc2448980b987da62e9d1e4ca018c9" category="cell">/ha/data2/sid/mnt00004</block>
  <block id="772d9b9673f172efa79c1a7882b6d979" category="cell">sid_log_mnt00004</block>
  <block id="69c78d157fba71e316ca5acf4eb8cb75" category="cell">/ha/log/sid/mnt00004</block>
  <block id="9e81e7b963c71363e2fb3eefcfecfc0e" category="cell">共享</block>
  <block id="9c7f13d493df94d57a532cd79c0ffa64" category="cell">/ha/shared/SID</block>
  <block id="f4c8435e4cbde93f00e4d1d5f25bedb2" category="cell">usr-sap-host1</block>
  <block id="e049803e41fabe0f53c4ead4b0f14350" category="cell">/usr/sap/SID</block>
  <block id="8d653d19a4cbb5862c5b1fc62193bed3" category="cell">挂载在主机 1 上</block>
  <block id="2c1dcadb291b7285e8a1001552fcc6d1" category="cell">usr-sap-host2.</block>
  <block id="33a6785666ac3aaa1c087db254ded2cb" category="cell">挂载在主机 2 上</block>
  <block id="340e8bd3e6491f3fe8bd43fca2c60e95" category="cell">usr-sap-host3.</block>
  <block id="2a7bf7921d279ab9a00111b11d3ae899" category="cell">挂载在主机 3 上</block>
  <block id="123a9fde0665e6f3dee96c9c40722de3" category="cell">usr-sap-host4.</block>
  <block id="6e3dcff90b7ca24cdf923aff68ce5b00" category="cell">挂载在主机 4 上</block>
  <block id="907d47ee5162569b082834e89adfec7c" category="cell">usr-sap-host5</block>
  <block id="fc0236f60f516ce4f48a70a9736de333" category="cell">挂载在主机 5 上</block>
  <block id="13d80777c8fd43e555c1f5b1b72d7ef0" category="section-title">主机配置</block>
  <block id="b688483cd0a2e330c81c99abb3e612b1" category="inline-link-macro">" 主机设置 " ，</block>
  <block id="835c0d8e2099421bae5671f87d4583ab" category="paragraph">除了一节中所述的任务之外 <block ref="b752442e7fb5d355acb77dfb5e05753a" category="inline-link-macro-rx"></block> 您必须为新的附加数据卷创建其他挂载点和 fstab 条目，并且必须挂载新卷。</block>
  <block id="560dda3ab3afa61eb803bc19cb5acc84" category="list-text">创建其他挂载点：</block>
  <block id="ae184ec9bdba806be5988da85e799c3a" category="list-text">对于单主机系统，创建挂载点并在数据库主机上设置权限。</block>
  <block id="3a4afc3d4465684d9924e5bca29c53fe" category="list-text">对于多主机系统，创建挂载点并在所有工作主机和备用主机上设置权限。以下示例命令适用于 2+1 多主机 HANA 系统。</block>
  <block id="fc99a71532d5fc19420f3089b094e40c" category="list-text">第一员工主机：</block>
  <block id="74ce80ef80982f26e052c73c94a02637" category="list-text">第二工作主机：</block>
  <block id="411d2b952bb67be5147ad7888b44819f" category="list-text">备用主机：</block>
  <block id="fffa779fc8dbbf30d23e4f7dba0bce07" category="list-text">将其他文件系统添加到所有主机上的 ` /etc/fstab` 配置文件中。以下是使用 NFSv4.1 的单主机系统的示例：</block>
  <block id="38f49054cf8e175dd49c721b8e9b5584" category="admonition">使用不同的存储虚拟接口连接到每个数据卷，以确保每个卷使用不同的 TCP 会话。如果 nconnect 挂载选项可用于您的操作系统，您也可以使用它。</block>
  <block id="1aa3240e835a1ccee1c1455ab8240cfa" category="list-text">要挂载文件系统，请运行 `mount – a` 命令。</block>
  <block id="f24c14c86fe4885372ee7537f12b5831" category="section-title">添加其他数据卷分区</block>
  <block id="140aa7f2a42d2786e74cffaa9b3cae98" category="paragraph">对租户数据库执行以下 SQL 语句，以便向租户数据库添加额外的数据卷分区。使用指向其他卷的路径：</block>
  <block id="46ad194113137aaa1e08246e5fa99530" category="paragraph"><block ref="46ad194113137aaa1e08246e5fa99530" category="inline-image-macro-rx" type="image"></block></block>
  <block id="40a15e6807b47955e7b7a9b1bd330b01" category="inline-link-macro">下一步：从何处查找追加信息。</block>
  <block id="5e7f139b932bbd679ffe8a834590de40" category="paragraph"><block ref="5e7f139b932bbd679ffe8a834590de40" category="inline-link-macro-rx"></block></block>
  <block id="8517d48ff677af656392e116dabd2ac9" category="summary">每个 SAP HANA 服务器都必须具有一个冗余 FCP SAN 连接，带宽至少为 8 Gbps 。对于连接到存储控制器的每个 SAP HANA 主机，必须在存储控制器上至少配置 8 Gbps 的带宽。</block>
  <block id="a65b7d2801e805c9afa7617259daff95" category="paragraph"><block ref="a65b7d2801e805c9afa7617259daff95" category="inline-link-macro-rx"></block></block>
  <block id="5da9c4793f212c1e833eebd1c243ca3d" category="paragraph"><block ref="5da9c4793f212c1e833eebd1c243ca3d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="adc5ba94f8a61c91b0f0e0d06f1f4d70" category="paragraph"><block ref="adc5ba94f8a61c91b0f0e0d06f1f4d70" category="inline-link-macro-rx"></block></block>
  <block id="e368e008d79a3b2079d973871fd38c35" category="summary">本节介绍 NetApp 存储系统的配置。您必须根据相应的 ONTAP 设置和配置指南完成主安装和设置。</block>
  <block id="331f03787d9544cd97e5b3a31e2b31bc" category="doc">存储控制器设置</block>
  <block id="ae414ad84caa821e402350e04857e2ad" category="inline-link-macro">Previous ：时间同步。</block>
  <block id="894de544f0eac1207fa7838f54544a87" category="paragraph"><block ref="894de544f0eac1207fa7838f54544a87" category="inline-link-macro-rx"></block></block>
  <block id="fd18465573ec21a6218982055981f6b1" category="section-title">存储效率</block>
  <block id="cc9ff39c9f631978557ae00fd8f5865d" category="paragraph">在 SSD 配置中， SAP HANA 支持实时重复数据删除，跨卷实时重复数据删除，实时数据压缩和实时数据缩减。</block>
  <block id="ed6036f9cee51fdd7e2a091bbae50c50" category="paragraph">不支持在基于 HDD 的配置中启用存储效率功能。</block>
  <block id="f884253d5c2cf3e0fbcf27b5bd7fc515" category="section-title">NetApp 卷加密</block>
  <block id="473b0453336bcd8bf5591681f8f2d0a1" category="paragraph">SAP HANA 支持使用 NetApp 卷加密（ NVE ）。</block>
  <block id="a662d487b875a4e232a16649f36fb399" category="section-title">Quality of service</block>
  <block id="7686322155849443f06959615c011bf4" category="paragraph">QoS 可用于限制共享使用控制器上特定 SAP HANA 系统或其他应用程序的存储吞吐量。其中一个使用情形是，限制开发和测试系统的吞吐量，使其不会影响混合环境中的生产系统。</block>
  <block id="6c86cfdf44739a850a7a1248b66cb537" category="paragraph">在规模估算过程中，您应确定非生产系统的性能要求。开发和测试系统的规模可以采用较低的性能值进行调整，通常在 SAP 定义的生产系统 KPI 的 20% 到 50% 范围内。</block>
  <block id="6ab5df7290e481b70e28b2b6f494b241" category="paragraph">从 ONTAP 9 开始， QoS 会在存储卷级别进行配置，并使用最大吞吐量值（ MBps ）和 I/O 量（ IOPS ）。</block>
  <block id="652c99b312d2d799385f153fd324ef46" category="paragraph">大型写入 I/O 对存储系统的性能影响最大。因此，应将 QoS 吞吐量限制设置为数据卷和日志卷中相应写入 SAP HANA 存储性能 KPI 值的百分比。</block>
  <block id="2e985af49c448d15c7b99987586e6b15" category="section-title">NetApp FabricPool</block>
  <block id="06ef1046368829b825e8266554a89dcb" category="paragraph">SAP HANA 系统中的活动主文件系统不能使用 NetApp FabricPool 技术。这包括数据和日志区域的文件系统以及 ` /hana 或共享` 文件系统。这样做会导致性能不可预测，尤其是在启动 SAP HANA 系统期间。</block>
  <block id="7bb98c896519df010b68c8bdb336edc7" category="paragraph">可以使用 " 仅快照 " 分层策略，也可以在 FabricPool 或 SnapMirror 目标等备份目标上使用 SnapVault 。</block>
  <block id="b76091ebd2ebee3eceba1434b0e25665" category="admonition">使用 FabricPool 在主存储上分层 Snapshot 副本或在备份目标上使用 FabricPool 会更改还原和恢复数据库或执行其他任务（例如创建系统克隆或修复系统）所需的时间。在规划整个生命周期管理策略时，请考虑这一点，并检查以确保在使用此功能时仍符合 SLA 要求。</block>
  <block id="46727fb1b4c25171c126d53a75e860d4" category="paragraph">FabricPool 是将日志备份移动到另一存储层的理想选择。移动备份会影响恢复 SAP HANA 数据库所需的时间。因此，应将选项 " 分层最小冷却天数 " 设置为一个值，以便在本地快速存储层上放置恢复所需的日志备份。</block>
  <block id="6e8775bd755a8835ce86806d669677ea" category="section-title">存储配置</block>
  <block id="6e2e713144257635582dbbf70df45c90" category="paragraph">以下概述总结了所需的存储配置步骤。后续章节将详细介绍每个步骤。在本节中，我们假定已设置存储硬件，并且已安装 ONTAP 软件。此外，存储端口（ 10GbE 或更快）与网络之间的连接必须已建立。</block>
  <block id="1a6713a2ed51f26877113c77d1ed10d7" category="inline-link-macro">磁盘架连接。</block>
  <block id="8a256fca82b713e79a5c2eb58989ed1c" category="list-text">按照中所述检查正确的 SAS 堆栈配置 <block ref="43af2724f5082b46987a75d8ab006aa5" category="inline-link-macro-rx"></block></block>
  <block id="9b58b6eeca17fb4fe9e5352e926cdcfa" category="inline-link-macro">聚合配置</block>
  <block id="b36aec9930308e0171ace274b1435446" category="list-text">创建并配置所需的聚合，如中所述 <block ref="148e1b9e1ae72918ac5182a6a0ab42d1" category="inline-link-macro-rx"></block></block>
  <block id="b198e02504c91a496ce6aa963575c839" category="inline-link-macro">Storage Virtual Machine 配置</block>
  <block id="a4c777849af1dc862ca5ddb9889e2147" category="list-text">创建 Storage Virtual Machine （ SVM ），如中所述 <block ref="74536016401b3037fbe7880f8456140d" category="inline-link-macro-rx"></block></block>
  <block id="345bb6af01988bbf21faec0cf43efa4c" category="inline-link-macro">逻辑接口配置。</block>
  <block id="777b1870d452642485ec2e8132ec404c" category="list-text">按照中所述创建 LIF <block ref="45280be6ff9e6c2edb75908a8c6b0fe9" category="inline-link-macro-rx"></block></block>
  <block id="6e12a7f11b9c2161720afb5f8de85d45" category="inline-link-macro">SAP HANA 单主机系统的卷配置</block>
  <block id="2d96346a98280eefa1ce52a6dc646347" category="inline-link-macro">SAP HANA 多主机系统的卷配置。</block>
  <block id="46ea27c06cfac2a7e50a216fe2b74d19" category="list-text">在聚合中创建卷，如中所述 <block ref="4a942275534568641e8ed37ef94c8909" category="inline-link-macro-rx"></block> 和 <block ref="b26ec3c7473556fe12ca09dc77e0d3a7" category="inline-link-macro-rx"></block></block>
  <block id="5f8947cce1567cd7d0eddcfc20683ac3" category="inline-link-macro">卷选项</block>
  <block id="ff5cec781d4485d5ace27e41224dab40" category="list-text">按照中所述设置所需的卷选项 <block ref="f565a9290b750486a8840d8d88264b3a" category="inline-link-macro-rx"></block></block>
  <block id="8011b09d28d54ea23274d28560d4fd1e" category="inline-link-macro">NFSv3 的 NFS 配置</block>
  <block id="a0212bd1cf31c1a185f0f29d94897927" category="inline-link-macro">NFSv4 的 NFS 配置。</block>
  <block id="01bd8be115ec4094d2f4c35689305ec5" category="list-text">为 NFSv3 设置所需的选项，如中所述 <block ref="8c64733e7fb76bbd4650c0bf29ed950b" category="inline-link-macro-rx"></block> 或 NFSv4 ，如中所述 <block ref="ab5c20669050c73ba24d89c4b271e9e7" category="inline-link-macro-rx"></block></block>
  <block id="00e211cc0d199a4dc3e5894015258add" category="inline-link-macro">将卷挂载到命名空间并设置导出策略。</block>
  <block id="cf0e53f3e79fba7d9a1e67ec1a7f6efd" category="list-text">将卷挂载到命名空间并设置导出策略，如中所述 <block ref="b8bd45dc69d8895b4fc3769108729cc4" category="inline-link-macro-rx"></block></block>
  <block id="a2c22f5fc8f18d8d87dd5a34087a8c8e" category="section-title">磁盘架连接</block>
  <block id="d999c97b7b1008a316e18c6626bbd3f9" category="paragraph">对于 HDD ，最多可以将两个 DS2246 磁盘架或四个 DS224C 磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。</block>
  <block id="3676f5995b256670006f039ebb3d7e19" category="paragraph"><block ref="3676f5995b256670006f039ebb3d7e19" category="inline-image-macro-rx" type="image"></block></block>
  <block id="be1f49d12074a6591e9316baeac9bd63" category="paragraph">使用 SSD 时，最多可以将一个磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。对于 DS224C 磁盘架，也可以使用四路径 SAS 布线，但这不是必需的。</block>
  <block id="43eac0561a56cbb6d5a4809c534c67bb" category="paragraph"><block ref="43eac0561a56cbb6d5a4809c534c67bb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="10ae1f9130fbbe975a644b0f325c6b31" category="section-title">聚合配置</block>
  <block id="6d83330b28ca1a77d72839b80db66f91" category="paragraph">通常，您必须为每个控制器配置两个聚合，而不受所使用的磁盘架或驱动器技术（ SSD 或 HDD ）的影响。对于 FAS2000 系列系统，一个数据聚合就足够了。</block>
  <block id="1033ef32c4f49ab33d841963d284959e" category="section-title">使用 HDD 的聚合配置</block>
  <block id="f86ec3e0c9a63d44ac0e2e4b954909f2" category="paragraph">下图显示了八个 SAP HANA 主机的配置。每个存储控制器连接四个 SAP HANA 主机。配置了两个单独的聚合，每个存储控制器一个。每个聚合都配置有 4 × 10 = 40 个数据磁盘（ HDD ）。</block>
  <block id="f609e212a9d2663a08599ec67567082d" category="paragraph"><block ref="f609e212a9d2663a08599ec67567082d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d6cced120b68f4aa019b47531e1ca2a2" category="section-title">使用纯 SDD 系统进行聚合配置</block>
  <block id="6133edaaabe85a9df71198b718da08cd" category="paragraph">通常，您必须为每个控制器配置两个聚合，而与使用的磁盘架或磁盘技术（ SSD 或 HDD ）无关。对于 FAS2000 系列系统，一个数据聚合就足够了。</block>
  <block id="db04b8526d641576c657ab1ab39cc830" category="paragraph">下图显示了在配置了 ADPv2 的 12 Gb SAS 磁盘架上运行的 12 个 SAP HANA 主机的配置。每个存储控制器连接六个 SAP HANA 主机。配置了四个单独的聚合，每个存储控制器两个。每个聚合都配置有 11 个磁盘，其中包含九个数据分区和两个奇偶校验磁盘分区。每个控制器都有两个备用分区。</block>
  <block id="8acbb29394ff9658464b0db64d193aad" category="paragraph"><block ref="8acbb29394ff9658464b0db64d193aad" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4e777d3b2a8b458c7f1f8e99e8ee985b" category="section-title">Storage Virtual Machine 配置</block>
  <block id="f138253c8e7297962c645362420d9aa2" category="paragraph">使用 SAP HANA 数据库的多个 SAP 环境可以使用一个 SVM 。如果需要，还可以为每个 SAP 环境分配一个 SVM ，以防这些 SVM 由公司内的不同团队管理。</block>
  <block id="ea2e61216b6ebab627ba8bbb11a9ed06" category="paragraph">如果在创建新 SVM 期间自动创建和分配了 QoS 配置文件，请从 SVM 中删除自动创建的配置文件，以提供 SAP HANA 所需的性能：</block>
  <block id="d1a14b5b7465c90ccf63dce24060e194" category="section-title">逻辑接口配置</block>
  <block id="a7546acf86ebe6ec3fca7a6d1722c1c3" category="paragraph">对于 SAP HANA 生产系统，您必须使用不同的 LIF 从 SAP HANA 主机挂载数据卷和日志卷。因此，至少需要两个 LIF 。</block>
  <block id="11b3a97ddf63560e6780cfe906220e5c" category="paragraph">不同 SAP HANA 主机的数据和日志卷挂载可以通过使用相同的 LIF 或为每个挂载使用单独的 LIF 来共享物理存储网络端口。</block>
  <block id="9c5c8b7c01b0aefdbe9a08c959df1a52" category="paragraph">下表显示了每个物理接口的最大数据和日志卷挂载数。</block>
  <block id="bb065ebf8bee13d3c6ea634c4584fc80" category="cell">以太网端口速度</block>
  <block id="0cc5c79089d6ca0752529568758efc4c" category="cell">10GbE</block>
  <block id="dec94f7ee4a8bd795f860764b38b4bfe" category="cell">25GbE</block>
  <block id="d577a779ffdacd409ec756e191be8c6b" category="cell">40GbE</block>
  <block id="797c6d8f4bdab58ccf0409871daa900d" category="cell">100 个地理位置</block>
  <block id="29350e56cf985cc1c3055886a585be16" category="cell">每个物理端口的最大日志或数据卷挂载数</block>
  <block id="c81e728d9d4c2f636f067f89cc14862c" category="cell">2.</block>
  <block id="1679091c5a880faf6fb5e6087eb1b2dc" category="cell">6.</block>
  <block id="c20ad4d76fe97759aa27a0c99bff6710" category="cell">12</block>
  <block id="1ff1de774005f8da13f42943881c655f" category="cell">24</block>
  <block id="4f405e1a75e4b7b8ec6f50946f0734fc" category="admonition">在不同 SAP HANA 主机之间共享一个 LIF 可能需要将数据或日志卷重新挂载到其他 LIF 。如果将卷移动到其他存储控制器，此更改可避免性能降低。</block>
  <block id="ea4399c89609128e15e361a718a71f5a" category="paragraph">开发和测试系统可以在物理网络接口上使用更多的数据和卷挂载或 LIF 。</block>
  <block id="93dc7819b20008ad7611ec3405b515ef" category="paragraph">对于生产，开发和测试系统， ` /ha/shared` 文件系统可以使用与数据或日志卷相同的 LIF 。</block>
  <block id="6fb40a9890e4f86fa48bd658ab16833b" category="paragraph">下图显示了四个单主机 SAP HANA 系统的卷配置。每个 SAP HANA 系统的数据卷和日志卷会分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID1_data_mnt00001` ，在控制器 B 上配置了卷 `SID1_log_mnt00001`</block>
  <block id="7ba23b870b3412fc76e2335500441f60" category="admonition">如果 SAP HANA 系统仅使用 HA 对中的一个存储控制器，则数据和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="39d162ac72e2fe9f7198155ac712dbc1" category="admonition">如果数据卷和日志卷存储在同一控制器上，则必须使用两个不同的 LIF 从服务器访问存储：一个 LIF 用于访问数据卷，一个 LIF 用于访问日志卷。</block>
  <block id="be6cf28afbd1f9ba8b4ee0b7df8962ef" category="paragraph"><block ref="be6cf28afbd1f9ba8b4ee0b7df8962ef" category="inline-image-macro-rx" type="image"></block></block>
  <block id="073ab5784fc6b184fe0dffe3c4a47dd9" category="paragraph">对于每个 SAP HANA DB 主机，都会为 ` 或 HANA 或 Shared` 配置一个数据卷，一个日志卷和一个卷。下表显示了单主机 SAP HANA 系统的配置示例。</block>
  <block id="bec4d7ba62d8818495dd8047fe16febc" category="cell">系统 SID1 的数据，日志和共享卷</block>
  <block id="3ff612b88bbeb6483579591b4b16a8c2" category="cell">数据卷： SID1_data_mnt00001</block>
  <block id="f32db5be1eba03edf6b74cb2c307a926" category="cell">共享卷： sid1_shared</block>
  <block id="e27dc2a68e5af6cb931b3784bf308897" category="cell">日志卷： SID1_LOG_mnt00001</block>
  <block id="bbe315bb9712be033b109b8cc20809c7" category="cell">系统 SID2 的数据，日志和共享卷</block>
  <block id="3b8347a425c00d6aaef68430847885d8" category="cell">日志卷： SID2_LOG_mnt00001</block>
  <block id="d655f9e8f5e3c0ab2d138ad9ceb5b0a4" category="cell">数据卷： SID2_data_mnt00001</block>
  <block id="383766abb3257650122592338d6ddfe8" category="cell">共享卷： sid2_shared</block>
  <block id="a8c9456b945dda42b7cb811cdeeeb569" category="cell">系统 SID3 的数据，日志和共享卷</block>
  <block id="7f2a7203636ecb8154977fbc4165ad52" category="cell">共享卷： sID3_shared</block>
  <block id="75bc4903743cacb7ec299172f9a7a923" category="cell">数据卷： SID3_data_mnt00001</block>
  <block id="ac9f0ccc380a2cf30aca6416dca9dc26" category="cell">日志卷： SID3_LOG_mnt00001</block>
  <block id="e415aa3c6982d40c43978fa59557a7af" category="cell">系统 SID4 的数据，日志和共享卷</block>
  <block id="5572f58fe3ff25e3eb168eea2fc37e6b" category="cell">日志卷： SID4_LOG_mnt00001</block>
  <block id="5e45398818752a3a8c885762ddfc9916" category="cell">共享卷： SID4_shared</block>
  <block id="5541ec8e99b4baa58cb2afaed5fc63bf" category="cell">数据卷： SID4_data_mnt00001</block>
  <block id="57d26add59c4bcc2f219b2d2e8666bd7" category="paragraph">下表显示了单主机系统的挂载点配置示例。要将 `sidadm` 用户的主目录放在中央存储上，应从 `SID_shared` 卷挂载 ` us/sap/SID` 文件系统。</block>
  <block id="2b20636173a684fa0d66246f2351348f" category="cell">Junction path</block>
  <block id="139518e6703ff17871be2e881429d302" category="section-title">SAP HANA 多主机系统的卷配置</block>
  <block id="f7122248eb9bb754dcbae085218e1595" category="paragraph">下图显示了 4+1 SAP HANA 系统的卷配置。每个 SAP HANA 主机的数据卷和日志卷分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID1_data1_mnt00001` ，在控制器 B 上配置了卷 `SID1_log1_mnt00001`</block>
  <block id="85c5636d02be1f0b907841ad58213447" category="admonition">如果 SAP HANA 系统仅使用 HA 对的一个存储控制器，则数据和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="d75f982c7fa083a511e12080e3a4cfd5" category="admonition">如果数据卷和日志卷存储在同一控制器上，则必须使用两个不同的 LIF 从服务器访问存储：一个用于访问数据卷，一个用于访问日志卷。</block>
  <block id="9d34c02a947bd142e38c1b0131e59a75" category="paragraph"><block ref="9d34c02a947bd142e38c1b0131e59a75" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3aaed26996523c93d5f3f1362bf3a698" category="paragraph">对于每个 SAP HANA 主机，系统会创建一个数据卷和一个日志卷。` HANA 系统的所有主机都使用` /hana / 共享 卷。下表显示了具有四个活动主机的多主机 SAP HANA 系统的配置示例。</block>
  <block id="e1b0e513c8bb3fb181664dfb11823d82" category="paragraph">下表显示了具有四个活动 SAP HANA 主机的多主机系统的配置和挂载点。要将每个主机的 `sidadm` 用户的主目录放置在中央存储上，会从 `SID_shared` 卷挂载 ` us/sap/SID` 文件系统。</block>
  <block id="8afc05cfcca59bdc514fcb80e6c0d949" category="cell">/ha/shared/</block>
  <block id="66cbf41a87a685e6ad37ed18e6f61f06" category="section-title">卷选项</block>
  <block id="6e52e9b5049ecde797509957559efadd" category="paragraph">您必须在所有 SVM 上验证并设置下表中列出的卷选项。对于某些命令，您必须在 ONTAP 中切换到高级权限模式。</block>
  <block id="004bf6c9a40003140292e97330236c53" category="cell">Action</block>
  <block id="ee97be03cb04119af45014d815621ce1" category="cell">命令</block>
  <block id="59dafe6ffe356573f4a59e43b8c2a12d" category="cell">禁用 Snapshot 目录可见性</block>
  <block id="bfcee32efb1a622a6e587e6e46aabb35" category="cell">vol modify -vserver &lt;vserver-name&gt; -volume &lt;volname&gt; -snapdir-access false</block>
  <block id="d9802677b2dd550f4d0177de99399b0d" category="cell">禁用自动 Snapshot 副本</block>
  <block id="bba4f772e426d2e1201535827315e250" category="cell">vol modify – vserver &lt;vserver-name&gt; -volume &lt;volname&gt; -snapshot-policy none</block>
  <block id="85314edd158f5145de1023ea7992a73d" category="cell">禁用除 SID_shared 卷以外的访问时间更新</block>
  <block id="d06aa9b498f490322d6b75ab763868c4" category="paragraph">设置高级 vol modify -vserver &lt;vserver-name&gt; -volume &lt;volname&gt; -atime-update false set admin</block>
  <block id="69b5be9d0ad62cad1fe29832746d89fc" category="paragraph">下表中列出的 NFS 选项必须在所有存储控制器上进行验证和设置。</block>
  <block id="7b0c54ca1e88f6ef7461709ba20843e4" category="paragraph">对于所示的某些命令，您必须在 ONTAP 中切换到高级权限模式。</block>
  <block id="d696a6a2b32bd5b7e510d3c088fce207" category="cell">启用 NFSv3 ：</block>
  <block id="d9a7640ac46e3f8cf9816a8ab8caaabb" category="cell">NFS modify -vserver &lt;vserver-name&gt; v3.0 已启用</block>
  <block id="c59b6b6ccda30b7d9580c4a3fb9a1be4" category="cell">ONTAP 9 ：将 NFS TCP 最大传输大小设置为 1 MB</block>
  <block id="88a84b59bbf7c31014bc6e5332d54d69" category="paragraph">设置 advanced nfs modify -vserver &lt;vserver_name&gt; -tcp-max-xfer-size 1048576 set admin</block>
  <block id="387cbcbc68932c744bec8dc8c31a465c" category="cell">ONTAP 8 ：将 NFS 读取和写入大小设置为 64 KB</block>
  <block id="07532d41432e61e5d8242e7babd2070c" category="paragraph">设置 advanced nfs modify -vserver &lt;vserver-name&gt; -v3-tcp-max-read-size 65536 nfs modify -vserver &lt;vserver-name&gt; -v3-tcp-max-write-size 65536 set admin</block>
  <block id="4b3b3fba259d5ac2ca622fa9160b1fb5" category="section-title">NFSv4 的 NFS 配置</block>
  <block id="c8542833574cfec9920af77661a766e0" category="paragraph">下表中列出的 NFS 选项必须在所有 SVM 上进行验证和设置。</block>
  <block id="214d7b06b7a82576ad3cc8dda3a23b58" category="paragraph">对于某些命令，您必须在 ONTAP 中切换到高级权限模式。</block>
  <block id="70f982c83fe296db3a8fc01d6800eeb5" category="cell">启用 NFSv4 ：</block>
  <block id="b4a26338e6b2855edb75ec84606be72f" category="cell">NFS modify -vserver &lt;vserver-name&gt; -v4.1 已启用</block>
  <block id="d1e1ffed5786862bbb79671233692063" category="cell">设置 advanced nfs modify -vserver &lt;vserver_name&gt; -tcp-max-xfer-size 65536 set admin</block>
  <block id="ddf50f4def54fc42e1e3c48d60dc6360" category="cell">禁用 NFSv4 访问控制列表（ ACL ）</block>
  <block id="77fd2d8c2c348207e3e8aa8833c161c4" category="cell">nfs modify -vserver &lt;vserver_name&gt; -v4.1-acl 已禁用</block>
  <block id="75a14711dc56291ed980640b0097eeda" category="cell">设置 NFSv4 域 ID</block>
  <block id="33f975af5bcb6d72979c2b52e31d0a40" category="cell">nfs modify -vserver &lt;vserver_name&gt; -v4-id-domain &lt;domain-name&gt;</block>
  <block id="098bb5f97d963ff34a01a7b3ceb37e49" category="cell">禁用 NFSv4 读取委派</block>
  <block id="a7a4297edce035892ff20e78720f0828" category="cell">nfs modify -vserver &lt;vserver_name&gt; -v4.1-read-delegation disabled</block>
  <block id="67b5b0ca237f222e8fc13c6b113fed2f" category="cell">禁用 NFSv4 写入委派</block>
  <block id="7654c857db3169792d3c5833ad28cd37" category="cell">NFS modify -vserver &lt;vserver_name&gt; -v4.1-write-delegation 已禁用</block>
  <block id="b536e6889ef55581986e4e8b1c67319b" category="cell">设置 NFSv4 租用时间</block>
  <block id="a1577ab4439c333a27d3a1daf67efe55" category="cell">设置高级 NFS 修改 -vserver &lt;vserver_name&gt; -v4-lease-seconds 10 set admin</block>
  <block id="ffea0284d7bfb3aad7e0d7a07765b424" category="cell">禁用 NFSv4 数字 ID</block>
  <block id="96adb5308418a0e6a16e78f391a5725d" category="cell">nfs modify -vserver &lt;vserver_name&gt; -v4-numeric-id 已禁用</block>
  <block id="c153016d304829102496ce3ee4c66867" category="admonition">对于 NFS 版本 4 。0 ，替换 `4 。1` 和 `4.0` 。虽然支持 NFSv4.0 ，但最好使用 NFSv4.1 。</block>
  <block id="4a762e476d9eda379d2de2de4266fb64" category="inline-link-macro">NFSv4 的 SAP HANA 安装准备。</block>
  <block id="ad357b093f7cd3e6d382bfe20cd1f2bd" category="admonition">在所有 Linux 服务器（ /`etc/idmapd.conf` ）和 SVM 上，必须将 NFSv4 域 ID 设置为相同的值，如中所述 <block ref="7cbf1992917906c8f8c329ad679d4886" category="inline-link-macro-rx"></block></block>
  <block id="7fe6e3db98dfe3477134c69fb6a1a8e6" category="admonition">如果使用的是 NFSv4.1 ，则默认情况下会启用并使用 pNFS （建议）。</block>
  <block id="8a497c5d71c93d9fb0f969b97af6bf05" category="paragraph">如果使用 SAP HANA 多主机系统，请按下表所示设置 SVM 的 NFSv4 租赁时间。</block>
  <block id="3228e5563c749aee2e3aacd329eadf42" category="cell">设置 NFSv4 租用时间。</block>
  <block id="0a1cdfe3de7f309f6c0b04a185658b15" category="paragraph">从 HANA 2.0 SPS4 开始， HANA 提供了用于控制故障转移行为的参数。NetApp 建议使用这些 HANA 参数，而不是在 SVM 级别设置租用时间。这些参数位于 `nameserver.ini` 中，如下表所示。请在这些部分中保留默认重试间隔 10 秒。</block>
  <block id="58c8eee50f8f52237271f796e3c1123f" category="cell">部分 nameserver.ini</block>
  <block id="3ad6e9988864aeae2ef386345946dc6d" category="cell">故障转移</block>
  <block id="af175fe1a76f8f5124de60f5d01ca78b" category="cell">normal 重试</block>
  <block id="19d4f3d1b35d2e82f1cec6bde8a752c8" category="cell">Distributed watchdog</block>
  <block id="2a81c8748d4d99f78d015104c26e9e58" category="cell">deactivation_retries</block>
  <block id="6512bd43d9caa6e02c990b0a82652dca" category="cell">11.</block>
  <block id="e83d9d66a13e5beb6fcd73e9458bd812" category="cell">takeover_retries</block>
  <block id="8b59115254ff7312d8a47a3558d2ef5a" category="section-title">将卷挂载到命名空间并设置导出策略</block>
  <block id="118d2a12d0ab217e6a53a464692c141a" category="paragraph">创建卷时，必须将卷挂载到命名空间。在本文档中，我们假定接合路径名称与卷名称相同。默认情况下，使用默认策略导出卷。如果需要，可以调整导出策略。</block>
  <block id="42c292e4ad4cfecb54e8cfd70a463681" category="inline-link-macro">下一步：主机设置。</block>
  <block id="2888108a4ca4efe1522f5f2c1f4dca5a" category="paragraph"><block ref="2888108a4ca4efe1522f5f2c1f4dca5a" category="inline-link-macro-rx"></block></block>
  <block id="5a8b82a0bfb2e7625d351720d4376bdf" category="summary">只有具有故障转移功能的多主机环境才需要存储连接器。在多主机设置中， SAP HANA 可提供高可用性功能，以便 SAP HANA 数据库主机可以故障转移到备用主机。在这种情况下，备用主机将访问并使用故障主机的 LUN 。</block>
  <block id="cfb64066e9063f57ad27ccf9e4e06e87" category="doc">SAP HANA 存储连接器 API</block>
  <block id="c44aa4c783c18bfadb1ffa8a269236bf" category="inline-link-macro">先前：存储控制器设置。</block>
  <block id="3e2e264956b7ff79eacd26e2e294ae71" category="paragraph"><block ref="3e2e264956b7ff79eacd26e2e294ae71" category="inline-link-macro-rx"></block></block>
  <block id="143f136fe7528a58d8f5256ccaa89109" category="paragraph">只有具有故障转移功能的多主机环境才需要存储连接器。在多主机设置中， SAP HANA 可提供高可用性功能，以便 SAP HANA 数据库主机可以故障转移到备用主机。在这种情况下，备用主机将访问并使用故障主机的 LUN 。存储连接器用于确保一次只能由一个数据库主机主动访问存储分区。</block>
  <block id="89814b29e88510280af62ae60925b251" category="inline-link">SAP 注释 1900823</block>
  <block id="e078b828a6bb770866173121ebdf49eb" category="paragraph">在采用 NetApp 存储的 SAP HANA 多主机配置中，使用 SAP 提供的标准存储连接器。《 SAP HANA 光纤通道存储连接器管理指南》可作为的附件找到<block ref="fb03c315acf5bdf850546480c01e7306" category="inline-link-rx"></block>。</block>
  <block id="2ffc3b6dcb7334bca51a0056e10f9483" category="paragraph"><block ref="2ffc3b6dcb7334bca51a0056e10f9483" category="inline-link-macro-rx"></block></block>
  <block id="7fd01fa95033c040ddfe882c5258bda9" category="paragraph">= ： hardbress ：：： nod页 脚：：： icons ：字体： linkattrs ：：： imagesdir ： ./../media/</block>
  <block id="a451568e0ed1add94bbb9f1791377329" category="inline-link-macro">上一步：网络设置。</block>
  <block id="71ca7936cfbd9508d381fe82ce80bef2" category="paragraph"><block ref="71ca7936cfbd9508d381fe82ce80bef2" category="inline-link-macro-rx"></block></block>
  <block id="42adc1bfcd3235fac4ff951f70ecd835" category="paragraph">您必须同步存储控制器与 SAP HANA 数据库主机之间的时间。为此，请为所有存储控制器和所有 SAP HANA 主机设置相同的时间服务器。</block>
  <block id="0058261b3f5b76fac384a2a9658e0232" category="paragraph"><block ref="0058261b3f5b76fac384a2a9658e0232" category="inline-link-macro-rx"></block></block>
  <block id="e91f856fa9e93a1406d354f1fb9df553" category="summary">本节所述的所有步骤对物理服务器上的 SAP HANA 环境和在 VMware vSphere 上运行的 SAP HANA 均有效。</block>
  <block id="41ae8edf907c93bdcf2743340a4e627d" category="paragraph"><block ref="41ae8edf907c93bdcf2743340a4e627d" category="inline-link-macro-rx"></block></block>
  <block id="ec222a30e1c5681ed56787b00bda2116" category="section-title">SUSE Linux Enterprise Server 的配置参数</block>
  <block id="8740018c375cf2d0f4d463d0bbd4d8d4" category="paragraph">必须根据 SAP HANA 生成的工作负载调整每个 SAP HANA 主机上的其他内核和配置参数。</block>
  <block id="efcd9df071a570f7c5ed3559b172bce3" category="section-title">SUSE Linux Enterprise Server 12 和 15</block>
  <block id="ebb8355d8accfb697b6808ce518c8666" category="paragraph">从 SUSE Linux Enterprise Server （ SLES ） 12 SP1 开始，必须在 ` /etc/sysctl.d` 目录的配置文件中设置内核参数。例如，必须创建一个名为 `91-netapp-hana` 的配置文件。</block>
  <block id="68d9ac2d7e973e347e878b223355bf31" category="inline-link">SAP 注释 3024346</block>
  <block id="5a7935c69e3983bd16f2022048011c44" category="admonition">可以使用适用于 SAP 操作系统的 SLES 版本中的 Saptune 设置这些值。请参见<block ref="d34bfa3c287edf039e3a5c4e365c2a83" category="inline-link-rx"></block> （需要 SAP 登录）。</block>
  <block id="fe039cc1acff15ac3ebdef50867dad8e" category="paragraph">如果使用 NFSv3 连接存储，则必须在 ` /etc/modprobe.d/sunrpc.conf` 中设置 `sunrpc.tcp_max_slot_table_entries` 参数。如果此文件不存在，则必须先通过添加以下行来创建它：</block>
  <block id="82740b25df395d68a79118ebc5c4da80" category="section-title">适用于 Red Hat Enterprise Linux 7.2 或更高版本的配置参数</block>
  <block id="ba0e722235d43672bc79f8b3d5e18c9f" category="paragraph">您必须在每个 SAP HANA 主机上为 SAP HANA 生成的工作负载调整额外的内核和配置参数。</block>
  <block id="384d34c5cb85a44702029243289c3645" category="paragraph">如果使用 NFSv3 连接存储，则必须在 ` /etc/modprobe.d/sunrpc.conf` 中设置参数 `sunrpc.tcp_max_slot_table_entries` 。如果此文件不存在，则必须先通过添加以下行来创建它：</block>
  <block id="c2e770dd6d768668395e4b8d3b9291d1" category="paragraph">从 Red Hat Enterprise Linux 7.2 开始，您必须在 ` /etc/sysctl.d` 目录的配置文件中设置内核参数。例如，必须创建一个名为 `91-netapp-hana` 的配置文件。</block>
  <block id="4142bd640477d1c4292c7fcbb3bb1f57" category="section-title">在 /has/ 共享卷中创建子目录</block>
  <block id="67435e0588f5cb039a7fb0f4578e90a7" category="admonition">这些示例显示了一个 SID=NF2 的 SAP HANA 数据库。</block>
  <block id="73534bc746cc8b23b1e96428d64fb98d" category="paragraph">要创建所需的子目录，请执行以下操作之一：</block>
  <block id="a3dd76ccd42ef45432fcdf4bcd06d1d6" category="list-text">对于单主机系统，请挂载 ` /ha/shared` 卷并创建 `shared` 和 `usr-sp` 子目录。</block>
  <block id="4dedcda7bf51022c092ff39d3a6d5686" category="list-text">对于多主机系统，请挂载 ` /ha/shared` 卷，然后为每个主机创建 `shared` 和 `usr-sap` 子目录。</block>
  <block id="d434026f127f46b1327fb139872c6f31" category="list-text">对于多主机系统，创建挂载点并在所有工作主机和备用主机上设置权限。</block>
  <block id="456f14e4dccd61c74e863ee833a9ca13" category="paragraph">以下示例命令适用于 2+1 多主机 HANA 系统。</block>
  <block id="436b2f88b88434a5965be45b319737cd" category="paragraph">根据 NFS 版本和 ONTAP 版本，必须使用不同的挂载选项。必须将以下文件系统挂载到主机：</block>
  <block id="2f44a4485ee99d4db07e6c780160d663" category="list-text">` /ha/data/SID/mnt0000*`</block>
  <block id="cbc27a44a01f5f9f44192601795600d7" category="list-text">` /ha/log/SID/mnt0000*`</block>
  <block id="e7152fc8e9f9294e574fc844aa9126ef" category="list-text">` /hana / 共享`</block>
  <block id="8b82ac8f276252de930b321606714ed5" category="list-text">` usr/sap/SID`</block>
  <block id="a73f318e7c68296dbc2c1fc7dc495dc8" category="paragraph">下表显示了单主机和多主机 SAP HANA 数据库的不同文件系统必须使用的 NFS 版本。</block>
  <block id="3b18b13f059019d19211f8a9f36f7e4e" category="cell">文件系统</block>
  <block id="c5a3e92c7aeb0572333d41454f2c2695" category="cell">SAP HANA 单台主机</block>
  <block id="6cfacba9e34e52124b1a2bcc7c4645a3" category="cell">SAP HANA 多台主机</block>
  <block id="9fdd313c432a6ee693f5c8f5cc8fdf3c" category="cell">/ha/data/sid/mnt0000*</block>
  <block id="a3fc88f53929bc60dc3ca6c7a4b19b35" category="cell">NFSv3 或 NFSv4</block>
  <block id="08e90903fe145a9dcc2fb967259a1755" category="cell">NFSv4</block>
  <block id="8f6fb4f6458a23be27986bb84613b874" category="cell">/ha/log/sid/mnt0000*</block>
  <block id="b61595b5b7b716bd6b8bd21e4fa4a3bf" category="cell">/has/ 共享</block>
  <block id="1f34f4f6ae42ad0e5ccc8d8a4399150c" category="paragraph">下表显示了各种 NFS 版本和 ONTAP 版本的挂载选项。通用参数与 NFS 和 ONTAP 版本无关。</block>
  <block id="b79b53eefbb492c96c4e5c552596db5a" category="admonition">SAP Lama 要求 /usr/sap/SID 目录为本地目录。因此，如果使用的是 SAP Lama ，请勿挂载 /usr/sap/SID 的 NFS 卷。</block>
  <block id="cd5a202e71fd003517be23ed41f89f8d" category="paragraph">对于 NFSv3 ，您必须关闭 NFS 锁定，以避免在软件或服务器出现故障时执行 NFS 锁定清理操作。</block>
  <block id="93827363c57822e58dfbd5f05b9beac8" category="paragraph">使用 ONTAP 9 ， NFS 传输大小最多可配置为 1 MB 。具体而言，如果与存储系统建立 40GbE 或更快的连接，则必须将传输大小设置为 1 MB ，才能达到预期吞吐量值。</block>
  <block id="6f5e55da455474f8c585cb463a2d639e" category="cell">通用参数</block>
  <block id="5b12ee0369243579651edca43ff65c85" category="cell">NFSv3</block>
  <block id="de841868c2911da76b8ae2da9fa3166d" category="cell">NFSv4.1</block>
  <block id="0614a261ce2e53d5987e97a60496a434" category="cell">ONTAP 9 中的 NFS 传输大小</block>
  <block id="54b941646e65c3622af659cd9d965169" category="cell">使用 ONTAP 8 时的 NFS 传输大小</block>
  <block id="1017e4c4798ba77b88c85f3b8c6fdf03" category="cell">rw ， bg ， hard ， timeo=600 ， noatime ，</block>
  <block id="7f4fbd9239422e6cbff6a5c40524adb3" category="cell">vers=3 ， nolock ，</block>
  <block id="16523b39871af16af52009bc15a2673c" category="cell">vers=4 ， minorVersion=0 ，锁定</block>
  <block id="5ce2764cf9f6ed7aadfe7ba01b6b29a4" category="cell">vers=4 ， minorVersion=1 ， lock</block>
  <block id="4d883abf7f72dbd8b8458ae706f6b358" category="cell">rsize=1048576 ， wsize=1048576 ，</block>
  <block id="7d7894f31c9b83146d2bc22185ed5db0" category="cell">rsize=65536 ， wsize=65536 ，</block>
  <block id="15ae6c88c5781cc59702ffce23dbc9c4" category="admonition">要提高 NFSv3 的读取性能，建议使用 `nconnect=n` mount 选项，该选项可用于 SUSE Linux Enterprise Server 12 SP4 或更高版本以及 RedHat Enterprise Linux （ RHEL ） 8.3 或更高版本。</block>
  <block id="5af44f409fcf1d822ee94e4abf92a132" category="admonition">性能测试表明， `nconnect=8` 可提供良好的读取结果。日志写入可能会因会话数较少而受益，例如 `nconnect=2.` 请注意，从 NFS 服务器进行的首次挂载（ IP 地址）会定义所使用的会话量。即使 `nconnect` 使用不同的值，后续挂载也不会更改此设置。</block>
  <block id="be650784c43282affe1d47ff0ef4386a" category="admonition">从 ONTAP 9.8 和 SUSE SLES15SP2 或 RedHat RHEL 8.3 或更高版本开始， NetApp 支持 NFSv4.1 的 nconnect 选项。对于追加信息，请查看 Linux 供应商文档。</block>
  <block id="ae2c578e6abfee06e6c468fd4e7cb392" category="paragraph">要在系统启动期间使用 ` /etc/fstab` 配置文件挂载文件系统，请完成以下步骤：</block>
  <block id="c86f68d88b3987101672c79c058d3f8f" category="paragraph">以下示例显示了使用 NFSv3 且 NFS 传输大小为 1 MB 的单个主机 SAP HANA 数据库，其中 SID=NF2 。</block>
  <block id="f731bd3074578aba0a3c1b5ab0ca78ee" category="list-text">将所需的文件系统添加到 ` /etc/fstab` 配置文件中。</block>
  <block id="aff8bbab4f16423ec5907aed644aead6" category="list-text">运行 `mount – a` 在所有主机上挂载文件系统。</block>
  <block id="8ffd511efff2f95144ac621432b751cd" category="paragraph">下一个示例显示了一个多主机 SAP HANA 数据库，其中 SID=NF2 对数据和日志文件系统使用 NFSv4.1 ，而对 ` ， HA/Shared` 和 ` ， USR/SAP/NF2` 文件系统使用 NFSv3 。使用的 NFS 传输大小为 1 MB 。</block>
  <block id="2555851d01cabd281a371497bed0a9a9" category="list-text">将所需的文件系统添加到所有主机上的 ` /etc/fstab` 配置文件中。</block>
  <block id="4292e3e460b31d735c080ccc8524778e" category="admonition">每个数据库主机的 ` /usr/sap/nF2` 文件系统都不同。以下示例显示了 ` /NF2_Shared/usr- sap- host1` 。</block>
  <block id="05fcfc623e22f168e6b8f88a05afe537" category="inline-link-macro">接下来：为 NFSv4 准备 SAP HANA 安装。</block>
  <block id="c0153fd855ce5fc4d351344c800a4d34" category="paragraph"><block ref="c0153fd855ce5fc4d351344c800a4d34" category="inline-link-macro-rx"></block></block>
  <block id="365b0fa5af0fe53c3e68f0efc2868744" category="paragraph"><block ref="365b0fa5af0fe53c3e68f0efc2868744" category="inline-link-macro-rx"></block></block>
  <block id="b355fd9084447d300f74c92778d0f953" category="paragraph"><block ref="b355fd9084447d300f74c92778d0f953" category="inline-link-macro-rx"></block></block>
  <block id="019dc6de8e76037cb2c701eebcc7885a" category="summary">要了解有关本文档中所述信息的更多信息，请参见以下文档和 / 或网站。</block>
  <block id="7ac956c99583618bc18b8baac542cc88" category="paragraph"><block ref="7ac956c99583618bc18b8baac542cc88" category="inline-link-macro-rx"></block></block>
  <block id="9e9bd8073039e8b9017ce3890a88b07f" category="list-text">在 VMware vSphere 上纵向扩展 SAP HANA 的最佳实践和建议<block ref="c53e7d8b68aab8589d1fe2ae632d97f1" category="inline-link-rx"></block></block>
  <block id="69d8738d5b71d896a0dc1609b971b14d" category="inline-link">www.vmware.com/files/pdf/sap-hana-scale-out-deployments-on-vsphere.pdf</block>
  <block id="74b1b173720e87b0062e2526ef199eeb" category="list-text">在 VMware vSphere 上横向扩展 SAP HANA 的最佳实践和建议<block ref="325bd10ade5d3352b63a0d91230eab8c" category="inline-link-rx"></block></block>
  <block id="5436be3b15621c53306ed17c9721265a" category="inline-link"><block ref="5436be3b15621c53306ed17c9721265a" category="inline-link-rx"></block></block>
  <block id="f223211a9eb0e2e3ef2fdf31819a1c08" category="list-text">适用于 SAP HANA 的 SAP 认证企业存储硬件<block ref="b2901b5fadd797c41e96b0d0d1767b47" category="inline-link-rx"></block></block>
  <block id="f14e467c65ef4ff721da90c5b9cbf5ea" category="list-text">SAP HANA 存储要求<block ref="c08aa13f8ebb327df5fe69e0ae014187" category="inline-link-rx"></block></block>
  <block id="b85044843e3efc484beb8f17420d8426" category="inline-link">www.sap.com/documents/2016/05/e8705aae-717c-0010-82c7-eda71af511fa.html</block>
  <block id="ca31417d8418184dd2ad737980499409" category="list-text">SAP HANA 定制数据中心集成常见问题解答<block ref="d0f0386672baea12e027b5a778b51eba" category="inline-link-rx"></block></block>
  <block id="a8da6448607bf45f80e5204b8be68e27" category="inline-link">www.netapp.com/us/media/tr-4646.pdf</block>
  <block id="24e1d80ffab5b1fa2978d571e09f1a25" category="list-text">TR-4646 ：《使用存储复制实现 SAP HANA 灾难恢复》<block ref="5535bb7ff97847d56c64f89c0a96ede0" category="inline-link-rx"></block></block>
  <block id="ab7f9021522a52600fca371af06629f2" category="inline-link">www.netapp.com/us/media/tr-4614.pdf</block>
  <block id="c5c650b56fbb9fa65cf9e47fde05f179" category="list-text">TR-4614 ：《使用 SnapCenter 实现 SAP HANA 备份和恢复》<block ref="a50e21e630f35731790436c759fca5b7" category="inline-link-rx"></block></block>
  <block id="0a96172d42ff3da65b0f1c7bc827f84e" category="list-text">TR-4338 ：《基于 VMware vSphere 的 SAP HANA 与 NetApp FAS 和 AFF 系统》<block ref="98a7d509ee148a118d5943b98dac0880" category="inline-link-rx"></block></block>
  <block id="f15eda444a7f3c1908338e1801c55307" category="inline-link">www.netapp.com/us/media/tr-4667.pdf</block>
  <block id="25432379081387b0127fa08bb638c061" category="list-text">TR-4667 ：使用 SnapCenter 4.0 SAP HANA 插件自动执行 SAP 系统副本<block ref="123ec0a6c1b7ebb478c5566cdc547f86" category="inline-link-rx"></block></block>
  <block id="69e9c5891ea0d7c109eca9d776a28922" category="list-text">NetApp 文档中心<block ref="25f769ea9202a023ba9c99acedadbda6" category="inline-link-rx"></block></block>
  <block id="e9de988fb4a8df63ad9aa891e14b766c" category="list-text">NetApp FAS 存储系统资源<block ref="b8ffe4c4013882c10001270e8b487ee3" category="inline-link-rx"></block></block>
  <block id="06c9004a0f2fcfcfd8f0e4998e26ceea" category="list-text">SAP HANA 软件解决方案<block ref="f8e283f33fb9df1008b8f59ee91b76be" category="inline-link-rx"></block></block>
  <block id="de9510cb4c0063cb04d3ef6260e87070" category="paragraph"><block ref="de9510cb4c0063cb04d3ef6260e87070" category="inline-link-macro-rx"></block></block>
  <block id="e34a4f0f85c6affc800c8d9647e17923" category="summary">本节介绍如何配置系统，以便在单主机和多主机系统上安装 SAP HANA 软件。</block>
  <block id="ba68dd6c01e84e673baab8824fd76cfa" category="inline-link-macro">先前版本： SAP HANA 数据卷大小。</block>
  <block id="c6233a2ee1e1f9186b8ee6a3aa53d53e" category="paragraph"><block ref="c6233a2ee1e1f9186b8ee6a3aa53d53e" category="inline-link-macro-rx"></block></block>
  <block id="22b91f6553e0cbb7685f9eb877cf188d" category="section-title">在单主机系统上安装</block>
  <block id="8e74883ab7ca2d81b61cfaad2ddf19d2" category="section-title">在多主机系统上安装</block>
  <block id="2c5a7a5ceaf9ad774a81a7201b4dd250" category="paragraph">要在多主机系统上安装 SAP HANA ，请完成以下步骤：</block>
  <block id="5a5457353a8426b7deea1f3ab1b9725a" category="list-text">使用 SAP `hdbclm` 安装工具，在其中一个工作主机上运行以下命令以启动安装。使用 `addhosts` 选项添加第二个工作主机（ `sAPCP-HANA TST-07` ）和备用主机（ `sAPCP-HANA TST-08` ）。</block>
  <block id="66037027466b6a49c7351cd2e886e167" category="inline-link-macro">下一步：添加其他数据卷分区。</block>
  <block id="184f0a41e0fe0de2f876dcda12ea0a8e" category="paragraph"><block ref="184f0a41e0fe0de2f876dcda12ea0a8e" category="inline-link-macro-rx"></block></block>
  <block id="ae2868fd55605b6107ba93c6890a3b53" category="summary">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 IO 行为并针对所使用的文件和存储系统优化数据库。</block>
  <block id="1bd81531313378d0d4283de4cbbc35d1" category="doc">SAP HANA 的 I/O 堆栈配置</block>
  <block id="7e5054a128510c891f44115cba007e74" category="inline-link-macro">先前版本： NFSv4 的 SAP HANA 安装准备。</block>
  <block id="7810ae24b6a335d6aa3284b3f84a0bce" category="paragraph"><block ref="7810ae24b6a335d6aa3284b3f84a0bce" category="inline-link-macro-rx"></block></block>
  <block id="67844e82ab322c50575db48293bd0359" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所使用的文件和存储系统优化数据库。</block>
  <block id="26ab8f65129b11e214b8281e8c3aaa83" category="paragraph">NetApp 进行了性能测试以定义理想值。下表列出了从性能测试中推断的最佳值。</block>
  <block id="1274865f8edcaa13006383f553d00582" category="inline-link">2267798 ：使用 hdbparam 在安装期间配置 SAP HANA 数据库</block>
  <block id="8fc6942b9d902fde53ed01fa7625aae8" category="paragraph">对于 SPS12 之前的 SAP HANA 1.0 版本，可以在安装 SAP HANA 数据库期间设置这些参数，如 SAP 注释所述<block ref="2b0fd22ead842cf1665d70f8909d17e2" category="inline-link-rx"></block>。</block>
  <block id="4e0f8b3ee102e5b52cc383fd8b0d90f9" category="paragraph">或者，也可以在安装 SAP HANA 数据库后使用 `hdbparam` framework 设置这些参数。</block>
  <block id="ec8a4b40a7d633a3cf77ecd95d9d5df1" category="inline-link">2399079 ：在 HANA 2 中消除了 hdbparam</block>
  <block id="834a8b3050b2226b4812fb49026571b3" category="paragraph">从 SAP HANA 2.0 开始， `hdbparam` 已弃用，并且参数已移至 `global.ini` 。可以使用 SQL 命令或 SAP HANA Studio 设置这些参数。有关详细信息，请参见 SAP 注释<block ref="6af86c07e5a30516e9705c5fc7252793" category="inline-link-rx"></block>。您还可以在 global.ini 中设置参数，如以下文本所示：</block>
  <block id="31835039a339b5b0f4d95c207e26b5e3" category="paragraph">自 `sHANA 2.0 SPS5 以来，可以使用 v í` etParameter.py 脚本设置正确的参数：</block>
  <block id="e4ffba0e312d6337b30e07be252b701d" category="inline-link-macro">接下来： SAP HANA 数据卷大小。</block>
  <block id="27050e2c290e878d422bc1e9c060c6b4" category="paragraph"><block ref="27050e2c290e878d422bc1e9c060c6b4" category="inline-link-macro-rx"></block></block>
  <block id="482a7b20dc0168fcd798c01f92ff4f90" category="summary">文档还包含有关特定于所用 Linux 版本的多路径配置的信息。</block>
  <block id="cf02bd9e6ef314ca4ad97baa7e001887" category="paragraph"><block ref="cf02bd9e6ef314ca4ad97baa7e001887" category="inline-link-macro-rx"></block></block>
  <block id="f1b2831b8f22303f2f43d48d0f147f3a" category="paragraph">在设置主机之前，必须从下载 NetApp SAN Host Utilities<block ref="1a36b59ecae7684863b79a0f690b6840" category="inline-link-rx"></block> 站点和安装在 HANA 服务器上。Host Utility 文档提供了有关根据使用的 FCP HBA 而必须安装的其他软件的信息。</block>
  <block id="e077bd74583341fa1e17ee8fc0b5c0b4" category="paragraph">文档还包含有关特定于所用 Linux 版本的多路径配置的信息。本文档介绍了 SLES 15 和 Red Hat Enterprise Linux 7.6 或更高版本所需的配置步骤，如中所述<block ref="c4b23c8c60f3faad406f8d46d87ba646" category="inline-link-rx"></block>。</block>
  <block id="4d8b576322bf7d5677701855a54e6977" category="admonition">必须对 SAP HANA 多主机配置中的所有辅助主机和备用主机执行步骤 1 到 6 。</block>
  <block id="f0e0bdbc42c37dae577b18eb8dbd1386" category="list-text">运行 `sanlun lun show` 命令并验证所有必需的 LUN 是否可见。以下示例显示了对于具有两个数据 LUN 和两个日志 LUN 的 2+1 多主机 HANA 系统的 `sanlun lun show` 命令输出。输出将显示 LUN 和相应的设备文件，例如 LUN `SS3_data_mnt00001` 和设备文件 ` /dev/sdag` 。每个 LUN 都有八条从主机到存储控制器的 FC 路径。</block>
  <block id="26414ff85e6b93c3631085373a3c9e8c" category="list-text">运行 `multipath -r` 命令以获取设备文件名的全球通用标识符（ WWID ）：</block>
  <block id="22ab51ff386eeec071034ae781990962" category="admonition">示例输出显示了 ` /etc/multipath.conf` 文件的内容，其中包括 2+1 多主机系统中四个 LUN 的别名。如果没有可用的 `multipath.conf` 文件，则可以运行以下命令创建一个： `multipath -T &gt; /etc/multipath.conf` 。</block>
  <block id="1b95bd550160c56e99e04b6458dfcf6a" category="paragraph">只有在使用 LVM 时才需要执行此步骤。以下示例适用于使用 SID FC5 的 2+1 主机设置。</block>
  <block id="ad08495729cc8eaf90d420ef1e6f12b4" category="list-text">为每个数据和日志分区创建一个逻辑卷。使用的条带大小等于每个卷组使用的 LUN 数量（示例 2 ），数据条带大小为 256k ，日志条带大小为 64k 。SAP 仅支持每个卷组一个逻辑卷。</block>
  <block id="5c5bd50a3cfa405915bc6892659042ce" category="admonition">如果上述命令未找到卷，则需要重新启动。</block>
  <block id="4d65ef8cf84d37cbb99560183afc8431" category="list-text">执行以下操作之一：</block>
  <block id="c9b9bdcff428106a20521627c72baa32" category="admonition">必须使用 `relatime` 和 `inode64` 挂载选项挂载数据和日志 LUN 的 XFS 文件系统。</block>
  <block id="3c08f1e0ce4bad0271e675a198b90eeb" category="paragraph"><block ref="3c08f1e0ce4bad0271e675a198b90eeb" category="inline-link-macro-rx"></block></block>
  <block id="ff3f1e894014f4c26eac8cab49b8a0f4" category="doc">使用 VMware vSphere 的 SAP HANA</block>
  <block id="9364ba5b71474eab1ac61395344525e0" category="inline-link-macro">先前版本： TR-4436 ：《基于采用光纤通道协议的 NetApp AFF 系统的 SAP HANA 》。</block>
  <block id="4f2d3f3763f28ae3e098a7ca955dfdd9" category="paragraph"><block ref="4f2d3f3763f28ae3e098a7ca955dfdd9" category="inline-link-macro-rx"></block></block>
  <block id="e6bbcb3e4d889de6d1cf73dee0f9eac9" category="inline-link-macro">基于采用 NFS 的 NetApp AFF 系统的 SAP HANA</block>
  <block id="bb5be01c74f4ed3f756e4d4ee67ca6c6" category="paragraph">可以通过多种方法将存储连接到虚拟机（ VM ）。首选方法是，将具有 NFS 的存储卷直接从子操作系统中连接起来。中介绍了此选项 <block ref="a9babd54e73efbc4c3e12890384d0165" category="inline-link-macro-rx"></block>。</block>
  <block id="c96bf665650aa48ececa7a9b878579a4" category="paragraph">此外，还支持原始设备映射（ RDM ）， FCP 数据存储库或具有 FCP 的 VVol 数据存储库。对于这两个数据存储库选项，数据存储库中只能存储一个 SAP HANA 数据或日志卷，以便在高效使用情形下使用。此外，无法实施由 SnapCenter 和基于此的解决方案协调的基于 Snapshot 的备份和恢复，例如 SAP 系统克隆。</block>
  <block id="5363a1e8e1763bb11c4b91b2868d5584" category="paragraph">有关将 vSphere 与 SAP HANA 结合使用的详细信息，请参见以下链接：</block>
  <block id="f02780ddcfc1bddf0683bf8de02155d5" category="inline-link">基于 VMware vSphere 的 SAP HANA —虚拟化—社区 Wiki</block>
  <block id="a98079dcafc3bc09ff53c1843096b51d" category="paragraph"><block ref="a98079dcafc3bc09ff53c1843096b51d" category="inline-link-rx"></block></block>
  <block id="685faeffbf3c0039314a5071b5798f2c" category="inline-link">在 VMware vSphere 上纵向扩展 SAP HANA 的最佳实践和建议</block>
  <block id="2f9b2abd933de82f868c9111de78674c" category="list-text"><block ref="2f9b2abd933de82f868c9111de78674c" category="inline-link-rx"></block></block>
  <block id="6a3ba410820602029c0289b87ca24a63" category="inline-link">在 VMware vSphere 上横向扩展 SAP HANA 的最佳实践和建议</block>
  <block id="976acfa42022d691038e2ff7dc503713" category="list-text"><block ref="976acfa42022d691038e2ff7dc503713" category="inline-link-rx"></block></block>
  <block id="ab1b1647c4e88f4d70b589d5781012ca" category="inline-link">2161991 — VMware vSphere 配置准则— SAP One Support Launchpad （需要登录）</block>
  <block id="77735103527f028107b29d19df178798" category="list-text"><block ref="77735103527f028107b29d19df178798" category="inline-link-rx"></block></block>
  <block id="d463f48696e58e286e9c0d594169b395" category="inline-link-macro">接下来：架构。</block>
  <block id="c781bca40d4095ed6929c620803dfb13" category="paragraph"><block ref="c781bca40d4095ed6929c620803dfb13" category="inline-link-macro-rx"></block></block>
  <block id="17b509f26d5de9fb91caac1351c661de" category="paragraph"><block ref="17b509f26d5de9fb91caac1351c661de" category="inline-link-macro-rx"></block></block>
  <block id="37139cc09cc8bc80e9ca73af4d3c785b" category="paragraph">或者，也可以在安装 SAP HANA 数据库后使用 `hdbparam` framework 设置这些参数。</block>
  <block id="ae8838acb9cb389ab57ac7e29427fe50" category="paragraph">从 SAP HANA 2.0 开始， `hdbparam` 已弃用，并且参数已移至 `global.ini` 。可以使用 SQL 命令或 SAP HANA Studio 设置这些参数。有关详细信息，请参见 SAP 注释<block ref="6af86c07e5a30516e9705c5fc7252793" category="inline-link-rx"></block>。这些参数也可以在 global.ini 中进行设置，如下所示：</block>
  <block id="57011fe1859f006c6ec7d602edb7a5a4" category="paragraph">从 SAP HANA 2.0 SPS5 开始，您可以使用 `setParameter.py` 脚本设置正确的参数：</block>
  <block id="52f0703c63884d2286e98f0a3488601f" category="paragraph"><block ref="52f0703c63884d2286e98f0a3488601f" category="inline-link-macro-rx"></block></block>
  <block id="7c2539ff7a7121e5f40217630b2b7413" category="paragraph"><block ref="7c2539ff7a7121e5f40217630b2b7413" category="inline-link-macro-rx"></block></block>
  <block id="fef2c24f71a084e813005b395f827515" category="paragraph">在 SSD 配置中， SAP HANA 支持实时重复数据删除，跨卷实时重复数据删除，实时压缩和实时数据缩减。</block>
  <block id="c4b8c29f448328e82ce27062b5fd9c28" category="section-title">NetApp 卷加密</block>
  <block id="8bc14f0cb78851f59e85c1d447c2c99f" category="section-title">Quality of service</block>
  <block id="37464f39e18200cea48c4d9c6761a91b" category="paragraph">在规模估算过程中，您应确定非生产系统的性能要求。开发和测试系统的规模可以采用较低的性能值进行调整，通常在 SAP 定义的生产系统 KPI 的 20% 到 50% 范围内。</block>
  <block id="67a6bbb8d3e29659ce53d34fa70d088f" category="paragraph">可以使用 " 仅快照 " 分层策略，也可以在 NetApp SnapVault 或 SnapMirror 目标等备份目标上使用 FabricPool 。</block>
  <block id="cbafb452655573815d095edb344c9594" category="admonition">使用 FabricPool 在主存储上分层 Snapshot 副本或在备份目标上使用 FabricPool 会更改还原和恢复数据库或执行其他任务（例如创建系统克隆或修复系统）所需的时间。在规划整体生命周期管理策略时，请考虑此因素，并检查以确保在使用此功能时仍符合 SLA 。</block>
  <block id="390af04511c942a81559a2b17fca6eb5" category="list-text">按照中所述检查正确的磁盘架配置 "<block ref="039cb3f1d3f19b24b2d3e1a57595e88d" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="e138f99dc0c2e735649f097e067d3c91" category="list-text">按照中所述创建和配置所需的聚合 "<block ref="19f0aba2b822910f53ba3966ee7c8d59" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="71f431043ca74922b294e83922284844" category="list-text">创建 Storage Virtual Machine （ SVM ），如 "<block ref="9943aaa2798622d6311d148886b936da" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="6daaa42b583f68f6a1719fe98bb43ec6" category="list-text">按照中所述创建 LIF"<block ref="023ebc077eb941ef66f2a9b14dc7710e" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="d4fdb595d47ecb1300395ba5a1a59e46" category="list-text">在聚合中创建卷，如 "<block ref="c1e870dd22594c8e4692679ba535d7a2" category="inline-xref-macro-rx"></block>，和<block ref="0383723b8ff0e319ee4606bce16f31bf" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="4871e71c94c222ec35408f3579ea5aef" category="list-text">按照中所述设置所需的卷选项 "<block ref="8045d57af453a5d82abf825155790be5" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="50382f37b1d5817b19a1416d66a869ab" category="list-text">按照中所述为 NFSv3 设置所需的选项 "<block ref="12f4a1429ee236ba2b69187511d66e29" category="inline-xref-macro-rx"></block>" 或 NFSv4 ，如 "<block ref="446c862a0c96e5df798af38fe615a410" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="77e8c1a1e836e9cc2d6f7071ed8ff48b" category="list-text">将卷挂载到命名空间并设置导出策略，如 "<block ref="11ce1c973ef514d254ac6cb22131e75f" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="625393be624ef9b6c1788fc2acdc4a1f" category="section-title">SAS 磁盘架</block>
  <block id="9b62b24b8d9ba375e94ccacca94fc52d" category="paragraph">最多可以将一个磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。ADPv2 可用于 ONTAP 9 和 DS224C 磁盘架。</block>
  <block id="03ec21b0d762028e928e8b7603d1b5a0" category="admonition">对于 DS224C 磁盘架，也可以使用四路径 SAS 布线，但这并不是必需的。</block>
  <block id="e79b084bc75002c7a80cdabcdef777cf" category="paragraph"><block ref="e79b084bc75002c7a80cdabcdef777cf" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bdf2df4b25ef7731104da665fef6a0bc" category="section-title">NVMe （ 100GbE ）磁盘架</block>
  <block id="c95631e026846b434e73e4f8b624c435" category="paragraph">每个 NS224 NVMe 磁盘架使用每个控制器的两个 100GbE 端口进行连接。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。聚合配置一章中所述的 ADPv2 也用于 NS224 磁盘架。下图显示了磁盘架与 NVMe 驱动器的连接。</block>
  <block id="311f51c9bd6357610dafad2954087904" category="paragraph"><block ref="311f51c9bd6357610dafad2954087904" category="inline-image-macro-rx" type="image"></block></block>
  <block id="03513f35519e245e0d372c52a62dc871" category="paragraph">通常，您必须为每个控制器配置两个聚合，而不受所使用的磁盘架或驱动器技术（ SAS SSD 或 NVMe SSD ）的影响。要使用所有可用的控制器资源，必须执行此步骤。对于 AFF A200 系列系统，一个数据聚合就足够了。</block>
  <block id="f1c8039bfd9034e917c3ee25c37b6e80" category="paragraph">下图显示了在配置了 ADPv2 的 12 Gb SAS 磁盘架上运行的 12 个 SAP HANA 主机的配置。每个存储控制器连接六个 SAP HANA 主机。配置了四个单独的聚合，每个存储控制器两个。每个聚合都配置有 11 个磁盘，其中包含九个数据分区和两个奇偶校验磁盘分区。每个控制器都有两个备用分区。</block>
  <block id="8b5ff3078857cca3f190e4be50e6e21c" category="paragraph"><block ref="8b5ff3078857cca3f190e4be50e6e21c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="99897c39b8224cf5a25fe9c6f599b3a7" category="section-title">SVM 配置</block>
  <block id="b37f183111116179ae8b8190b10de385" category="paragraph">使用 SAP HANA 数据库的多个 SAP 环境可以使用一个 SVM 。如果需要，还可以为每个 SAP 环境分配一个 SVM ，以防这些 SVM 由公司内的不同团队管理。</block>
  <block id="8740ae6e0d37fe62c3e22cc10d6808f0" category="paragraph">如果在创建新的 SVM 时自动创建和分配了 QoS 配置文件，请从 SVM 中删除此自动创建的配置文件，以便为 SAP HANA 启用所需的性能：</block>
  <block id="cb001cd493365720d42ec425b1721062" category="section-title">LIF 配置</block>
  <block id="0b2bb5856cc4dea0b040a3b21fd8dd64" category="paragraph">对于 SAP HANA 生产系统，您必须使用不同的 LIF 从 SAP HANA 主机挂载数据卷和日志卷。因此，至少需要两个 LIF 。</block>
  <block id="960aa85c03f033763848fa3aa9fe340a" category="paragraph">不同 SAP HANA 主机的数据和日志卷挂载可以通过使用相同的 LIF 或为每个挂载使用单独的 LIF 来共享物理存储网络端口。</block>
  <block id="5722c99f4a5680ae1ee34f95cc81e80c" category="paragraph">下表显示了每个物理接口的最大数据和日志卷装载量。</block>
  <block id="36913193033e347ca8ec536cf018744d" category="admonition">如果数据卷和日志卷存储在同一控制器上，则必须使用两个不同的 LIF 从服务器访问存储：一个 LIF 用于访问数据卷，另一个 LIF 用于访问日志卷。</block>
  <block id="f18264165c70d6613dd7e3ee9ebc771e" category="paragraph"><block ref="f18264165c70d6613dd7e3ee9ebc771e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="34a9cf7a71d5de61eb0516df58caeb4d" category="paragraph">对于每个 SAP HANA 主机，都会为 ` 或 HANA 或 Shared` 配置一个数据卷，一个日志卷和一个卷。下表显示了单主机 SAP HANA 系统的配置示例。</block>
  <block id="7a2dcccea93b2a3993b37840c369bf46" category="cell">/usr/sap/SID /has/shared/</block>
  <block id="9ee074032c91b18bf376be73c034505a" category="paragraph"><block ref="9ee074032c91b18bf376be73c034505a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="08ddf4f39e81c4a0e663d6db2274b8d0" category="cell">控制器 A 上的聚合 1</block>
  <block id="4991d6ed5c177c09528f1b08e62e870b" category="cell">控制器 A 上的聚合 2</block>
  <block id="70ea877d22047c4d7b3160f2dfbb602e" category="cell">控制器 B 上的聚合 1</block>
  <block id="b01794ad3843a1780c443788733b44ac" category="cell">控制器 B 上的聚合 2</block>
  <block id="edf427eb9e76414a3f84589e9f2ecf37" category="paragraph">下表显示了具有四个活动 SAP HANA 主机的多主机系统的配置和挂载点。要将每个主机的 `sidadm` 用户的主目录放置在中央存储上，会从 `SID_shared` 卷挂载 ` us/sap/SID` 文件系统。</block>
  <block id="6c973aa519b6f8499c2dc9a71251b4f7" category="cell">禁用访问时间更新， SID_shared 卷除外</block>
  <block id="8ec2236fd6ed4715167a8899b66d149b" category="paragraph">下表中列出的 NFS 选项必须在所有存储控制器上进行验证和设置。对于此表中显示的某些命令，您必须切换到高级权限模式。</block>
  <block id="5c87e78153c1f2e2e2b534049bdc60f9" category="paragraph">对于此表中的某些命令，您必须切换到高级权限模式。</block>
  <block id="b78ad1fd79e9fc7773f87edda4742199" category="cell">NFS modify -vserver &lt;vserver-name&gt; -v4.1 已启用</block>
  <block id="4e11d437a84608405c1cba53cb335989" category="cell">设置 advanced nfs modify -vserver &lt;vserver_name&gt; -tcp-max-xfer-size 1048576 set admin</block>
  <block id="9d4c39bb98c40111c9c2cda962a5051a" category="cell">设置 advanced nfs modify -vserver &lt;vserver_name&gt; -tcp-max-xfer-size 65536 set admin</block>
  <block id="d36a06d4ce7ff3f416af683fa8c69c48" category="admonition">对于 NFS 版本 4 。0 ，在前面的命令中将 `4.1` 替换为 `4.0` 。虽然支持 NFSv4.0 ，但首选 NFSv4.1 。</block>
  <block id="c480c17814d28d6a9b00fd06a87dee2a" category="inline-link-macro">《 NFSv4 的 SAP HANA 安装准备工作》。</block>
  <block id="9fa840f16cd7cf7f80145507faa2a523" category="admonition">在所有 Linux 服务器（` /etc/idmapd.conf` ）和 SVM 上，必须将 NFSv4 域 ID 设置为相同的值，如一节所述 <block ref="19618adae76246007b68ca646cc14e2b" category="inline-link-macro-rx"></block></block>
  <block id="cd2bd9dcb9cd374f1c6be216bae1bdf6" category="paragraph">如果使用 SAP HANA 多主机系统，请在 SVM 上设置 NFSv4 租赁时间（如下表所示）。</block>
  <block id="7ffdb0b76d7e00eb6b452c2e74026dc6" category="paragraph">从 HANA 2.0 SPS4 开始， HANA 提供了用于控制故障转移行为的参数。NetApp 建议使用这些 HANA 参数，而不是在 SVM 级别设置租用时间。</block>
  <block id="6db9549748203188275a99dbe3f37e35" category="paragraph">这些参数位于 `nameserver.ini` 中，如下表所示。请在这些部分中保留默认重试间隔 10 秒。</block>
  <block id="ea45b1c1ea68b79495fa9e10bf790b3b" category="paragraph"><block ref="ea45b1c1ea68b79495fa9e10bf790b3b" category="inline-link-macro-rx"></block></block>
  <block id="f337a835d86e0c289439e035a0e76f48" category="cell">更新了容量规模估算更新了 ` /ha/shared` 更新了 sysctl 参数的挂载选项</block>
  <block id="bc879b28cd3f4053f1a4fb6a09b4059b" category="cell">新的 NetApp 存储系统和磁盘架 ONTAP 9 的新增功能支持 40GbE 新操作系统版本（ SUSE Linux Enterprise Server 12 SP1 和 Red Hat Enterprise Linux 7.2 ）新的 SAP HANA 版本</block>
  <block id="fec3e19d5453902e6d2d2f07b445096e" category="cell">新 NetApp 存储系统支持 100GbE 新操作系统版本（ SUSE Linux Enterprise Server 12 SP3 和 Red Hat Enterprise Linux 7.4 ） SAP HANA 2.0 SPS3 的其他小更改</block>
  <block id="e10986a4d8d7c27e4a9031d551cb15f3" category="cell">2019年10月</block>
  <block id="42cb7cd8194fc37a66ecbcf38853bc47" category="cell">新的 NetApp 存储系统和 NVMe 磁盘架新的操作系统版本（ SUSE Linux Enterprise Server 12 SP4 ， SUSE Linux Enterprise Server 15 和 Red Hat Enterprise Linux 7.6 ） MAX Data 卷大小略有更改</block>
  <block id="4a93378c0090bfbf8b8bc50a06815950" category="cell">支持 NFSv3 新操作系统版本 Red Hat Enterprise Linux 8 的 nconnect</block>
  <block id="10ac19f67b5c625d18963e0639db41ec" category="cell">版本 3.4</block>
  <block id="1f8f179d086bf23bb88de92da36a278f" category="cell">支持 SAP HANA 2.0 SPS4 提供多个数据卷分区</block>
  <block id="27cf29d3ba2e543cc0a860ffea48422c" category="cell">版本 3.5</block>
  <block id="26287cafb4ea7add00d9de270496dd80" category="paragraph">SAP HANA 主机使用冗余 FCP 基础架构和多路径软件连接到存储控制器。如果交换机或主机总线适配器（ HBA ）发生故障，则需要一个冗余 FCP 交换机基础架构来提供容错 SAP HANA 主机到存储连接。必须在交换机上配置适当的分区，以使所有 HANA 主机能够访问存储控制器上所需的 LUN 。</block>
  <block id="017a3133a467238fee42563e68a614f9" category="paragraph">AFF 系统产品系列的不同型号可以在存储层混用并匹配，以满足增长以及不同的性能和容量需求。可以连接到存储系统的最大 SAP HANA 主机数由 SAP HANA 性能要求和所用 NetApp 控制器型号定义。所需磁盘架的数量仅取决于 SAP HANA 系统的容量和性能要求。</block>
  <block id="06cf62788076915ae55f580212c2bf1e" category="paragraph">下图显示了一个配置示例，其中八个 SAP HANA 主机连接到一个存储 HA 对。</block>
  <block id="e72a3bb79de828b6cb73cfa54cdef5e3" category="paragraph"><block ref="e72a3bb79de828b6cb73cfa54cdef5e3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2900e6adf5856ac968de15d89cb194b9" category="paragraph">此架构可扩展到两个方面：</block>
  <block id="d4a057bb51f816211a65deedffe4b054" category="list-text">如果存储控制器提供的性能足以满足当前的 SAP HANA KPI 要求，请将更多的 SAP HANA 主机和存储容量附加到现有存储</block>
  <block id="8ca9a95d490a682ea8d4488876c744a4" category="paragraph">下图显示了一个配置示例，其中，更多 SAP HANA 主机连接到存储控制器。在此示例中，需要更多磁盘架来满足 16 个 SAP HANA 主机的容量和性能要求。根据总吞吐量要求，您必须为存储控制器添加额外的 FC 连接。</block>
  <block id="cf4cd73d6d8437d4455657ab57e2456d" category="paragraph"><block ref="cf4cd73d6d8437d4455657ab57e2456d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7ebb858993c6febaa60f7bc7602d20dc" category="paragraph">除了已部署的 AFF 系统之外，还可以通过添加任何经过认证的存储控制器来扩展 SAP HANA 环境，以满足所需的节点密度，如下图所示。</block>
  <block id="c3c5d55eb3731532580fbb6b5b691e62" category="paragraph"><block ref="c3c5d55eb3731532580fbb6b5b691e62" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3ad7f7aed9ec06eff738c0dcda85c37c" category="summary">从 SAP HANA 2.0 SPS4 开始，可以配置其他数据卷分区。这样，您就可以为 SAP HANA 租户数据库的数据卷配置两个或更多卷，并可扩展到超出单个卷的大小和性能限制。</block>
  <block id="f55ba4ae3718b6c573c3a1d2b1fb7f02" category="paragraph"><block ref="f55ba4ae3718b6c573c3a1d2b1fb7f02" category="inline-link-macro-rx"></block></block>
  <block id="0b3d2dc69d0ecef48ed4d97711abe783" category="admonition">对于 SAP HANA 单主机和 SAP HANA 多主机系统，可以为数据卷使用两个或更多个单独的卷。您可以随时添加其他数据卷分区。</block>
  <block id="13a679c566e6214fe896e24a695761e4" category="paragraph">要启用其他数据卷分区，请使用 SYSTEMDB 配置中的 SAP HANA Studio 或 Cockpit 在 `global.ini` 中添加以下条目。</block>
  <block id="9d32fa1f9d8d59813a1ef11682a4f5bf" category="section-title">单主机 SAP HANA 系统的卷配置</block>
  <block id="517b7c43e6e06ed83a71808ad5423407" category="paragraph">具有多个分区的单主机 SAP HANA 系统的卷布局与具有一个数据卷分区，但另有一个数据卷存储在与日志卷和另一个数据卷不同的聚合上的系统的布局类似。下表显示了具有两个数据卷分区的 SAP HANA 单主机系统的示例配置。</block>
  <block id="6cc4be8865a78ca53ed1eaf173bd28a3" category="cell">控制器 b 上的聚合 2</block>
  <block id="4facf56b8e32b968748dc3f301c82b59" category="paragraph">您可以使用 NetApp ONTAP 系统管理器或 ONTAP 命令行界面创建新数据卷并将其挂载到命名空间。</block>
  <block id="1d63ad99e78bdad7469de07c7f318451" category="section-title">多主机 SAP HANA 系统的卷配置</block>
  <block id="2f9bf27ae27db05dcf966a759ab139d7" category="paragraph">卷的布局类似于多主机 SAP HANA 系统的布局，该系统具有一个数据卷分区，但另一个数据卷作为日志卷存储在另一个聚合上，而另一个数据卷则存储在另一个聚合上。下表显示了具有两个数据卷分区的 SAP HANA 多主机系统的示例配置。</block>
  <block id="2b59fb89728efdb7c494694c3a85a129" category="paragraph">您可以使用 ONTAP 系统管理器或 ONTAP 命令行界面创建新数据卷并将其挂载到命名空间。</block>
  <block id="baeebc68f3b64a7c3291f0ca7f4df4f4" category="inline-link-macro">主机设置，</block>
  <block id="5638843af2d8de8b12e567f3b97df4dd" category="paragraph">除了一节中所述的任务之外 <block ref="39826558a7f1485d436120c70d356cd5" category="inline-link-macro-rx"></block> 必须为新的附加数据卷创建附加挂载点和 `fstab` 条目，并且必须挂载新卷。</block>
  <block id="5b44880dacc6b2708bb197731958315d" category="list-text">创建其他挂载点。</block>
  <block id="b6a2046ad9f2856608b23df9628204f9" category="list-text">对于单主机系统，创建挂载点并在数据库主机上设置权限：</block>
  <block id="16761c2a0fb024c597b40911ae9db317" category="paragraph">以下示例命令适用于 2 加 1 多主机 HANA 系统。</block>
  <block id="83ae0722b3e48679da7a55d190be5e44" category="list-text">将其他文件系统添加到所有主机上的 ` /etc/fstab` 配置文件中。</block>
  <block id="474fcd58a82b43abb0995925c1918bb9" category="paragraph">对于使用 NFSv4.1 的单主机系统，请参见以下示例：</block>
  <block id="f1a09f6792682f701db17bcfb7a8d318" category="admonition">使用不同的存储虚拟接口连接每个数据卷，以确保每个卷使用不同的 TCP 会话</block>
  <block id="d3bc1dd8c6c3cc7ddb77b7e695a19878" category="list-text">运行 `mount – a` 命令挂载文件系统。</block>
  <block id="356dd722b5b14363393c40db43145fba" category="paragraph">对租户数据库执行以下 SQL 语句，以便向租户数据库添加额外的数据卷分区。使用指向其他卷的路径：</block>
  <block id="7618130faa3e9d9686fa90b4bd797ac0" category="paragraph"><block ref="7618130faa3e9d9686fa90b4bd797ac0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d578585fd0be7fac636b880e81e23076" category="paragraph"><block ref="d578585fd0be7fac636b880e81e23076" category="inline-link-macro-rx"></block></block>
  <block id="1caaec94c48cce019804705be39c0788" category="paragraph"><block ref="1caaec94c48cce019804705be39c0788" category="inline-link-macro-rx"></block></block>
  <block id="523ed46a1b80ff97206086ca1cf66c74" category="paragraph">SAP 已定义一组静态存储 KPI 。无论数据库主机和使用 SAP HANA 数据库的应用程序的内存大小如何，这些 KPI 都适用于所有生产 SAP HANA 环境。这些 KPI 适用于单主机，多主机， HANA 上的 Business Suite ， HANA 上的 Business Warehouse ， S/4HANA 和 BB/4HANA 环境。因此，当前的性能规模估算方法仅取决于连接到存储系统的活动 SAP HANA 主机的数量。</block>
  <block id="9f9af9fdd084ad8eda305ac55f4cfd99" category="paragraph">SAP 提供了一个性能测试工具，必须使用该工具来验证连接到存储的活动 SAP HANA 主机的存储系统性能。</block>
  <block id="3f54db3fa7dd353cd2bf6e94f663b8ea" category="paragraph">NetApp 测试并预定义了可附加到特定存储模型的最大 SAP HANA 主机数，同时仍满足 SAP 为基于生产的 SAP HANA 系统提供的所需存储 KPI 。</block>
  <block id="372b4c73d2b83a38a4fb94c562f53c6d" category="paragraph">对于 12 Gb 串行连接 SCSI （ SAS ）磁盘架（ DS224C ），可使用以下固定磁盘架配置来执行性能规模估算：</block>
  <block id="27cd945eb6d2a58787f658282dc8c114" category="admonition">这两种配置都使用高级磁盘分区（ Advanced Disk Partitioning ， ADPv2 ）。半负载磁盘架最多可支持九个 SAP HANA 主机，而满载磁盘架最多可在一个磁盘架中支持 14 个主机。SAP HANA 主机必须在两个存储控制器之间平均分布。相同的适用场景 AFF A700s 系统的内部磁盘。必须使用 12 Gb SAS 连接 DS224C 磁盘架，以支持 SAP HANA 主机的数量。</block>
  <block id="7168b6fab3d1fdb1f905b5d9064d3a24" category="paragraph">6 Gb SAS 磁盘架（ DS2246 ）最多支持四个 SAP HANA 主机。SSD 和 SAP HANA 主机必须在两个存储控制器之间平均分布。</block>
  <block id="f1ae15f6fd143c9e1276af68c06658c7" category="cell">12 GB SAS 磁盘架（ DS224C ），半个装有 12 个 SSD 和 ADPv2</block>
  <block id="de1ff9288ed7f638a8b7369cd4297ed8" category="paragraph">第一个磁盘架至少需要 12 个 NVMe SSD ，最多支持 16 个 SAP HANA 主机。一个完全填充的磁盘架（ 24 个 SSD ）最多支持 34 个 SAP HANA 主机。相同的适用场景 AFF A800 系统的内部磁盘。</block>
  <block id="336d2fc2904f8210c02f37eb24f92eca" category="admonition">添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="fac3c55a3cdc98c6d08b96c048885f29" category="section-title">配置性能测试工具</block>
  <block id="918724fe4fec0578cd9e798f8152194e" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。使用 SAP 性能测试工具测试存储性能时，还必须为 SAP 的性能测试工具设置这些参数。</block>
  <block id="c2cbcc154a82de8081d9414e0f5a0e72" category="paragraph">有关配置不同 SAP 测试工具的详细信息，请参见<block ref="ec90a615c6d378fa60ba8e7f2e7592b2" category="inline-link-rx"></block> 适用于 HWCCT （ SAP HANA 1.0 ）和<block ref="2912abb2c0271a2912b6a4a94888e0ec" category="inline-link-rx"></block> 适用于 HCMT/HCOT （ SAP HANA 2.0 ）。</block>
  <block id="819c1f9958e8bb33d727e63084453a6d" category="paragraph">每个 HANA 主机的磁盘数以及每个存储模型的 SAP HANA 主机密度均通过性能测试工具确定。</block>
  <block id="f0c841de9af65f567936371d382c94ec" category="paragraph">规模估算过程需要详细信息，例如生产和非生产 SAP HANA 主机的数量，每个主机的 RAM 大小以及基于存储的 Snapshot 副本的备份保留。SAP HANA 主机的数量决定了存储控制器和所需磁盘的数量。</block>
  <block id="50555071af908138ac56ce172b19cc5d" category="paragraph"><block ref="50555071af908138ac56ce172b19cc5d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c74ff3a04dfaf8295d9c6f7254506ba9" category="paragraph"><block ref="c74ff3a04dfaf8295d9c6f7254506ba9" category="inline-link-macro-rx"></block></block>
  <block id="e41020e64935329a6db54f4c483b9113" category="summary">本节所述的所有主机设置步骤对物理服务器上的 SAP HANA 环境和在 VMware vSphere 上运行的 SAP HANA 均有效。</block>
  <block id="970af0317b4da152f387070d466a966a" category="paragraph"><block ref="970af0317b4da152f387070d466a966a" category="inline-link-macro-rx"></block></block>
  <block id="95df6f6c376792473a459235195a79dd" category="paragraph">从 SUSE Linux Enterprise Server 12 SP1 开始，必须在 ` /etc/sysctl.d` 目录的配置文件中设置内核参数。例如，您必须创建一个名为 `91-netapp-hana` 的配置文件。</block>
  <block id="ec0668f7ae6dba074f0862485b7b15f8" category="admonition">可以使用适用于 SAP 操作系统的 SLES 版本中的 Saptune 设置这些值。有关详细信息，请参见<block ref="d34bfa3c287edf039e3a5c4e365c2a83" category="inline-link-rx"></block> （需要 SAP 登录）。</block>
  <block id="c60051ea586d490f1e69166ac39409e5" category="paragraph">如果使用 NFSv3 连接存储，则必须在 ` /etc/modprobe.d/sunrpc.conf` 中设置 `sunrpc.tcp_max_slot_table_entries` 。如果此文件不存在，则必须先通过添加以下行来创建它：</block>
  <block id="f0ded98122b7aeb2413673f23e0cf2d9" category="paragraph">如果使用 nconnect 挂载选项，则此值可以从 256 增加到 512 。</block>
  <block id="179a425489e8da15ef704b42e37645c8" category="section-title">适用于 Red Hat Enterprise Linux 7.2 或更高版本的配置参数</block>
  <block id="e19cf298e039e5acff1dbe7e98090d84" category="paragraph">您必须在每个 SAP HANA 主机上为 SAP HANA 生成的工作负载调整其他内核和配置参数。</block>
  <block id="7a093f47a350c0e9b97c0070054a7d01" category="paragraph">如果使用 NFSv3 连接存储，则必须在 ` /etc/modprobe.d/sunrpc.conf` 中设置参数 `sunrpc.tcp_max_slot_table_entries 参数` 。如果此文件不存在，则必须先通过添加以下行来创建它：</block>
  <block id="5491b828c5fede318e582fdb0621d64f" category="paragraph">从 Red Hat Enterprise Linux 7.2 开始，您必须在 ` /etc/sysctl.d` 目录的配置文件中设置内核参数。例如，您必须创建一个名为 `91-netapp-hana` 的配置文件。</block>
  <block id="b57aa9745ef1f47f50b9a81013b110fc" category="admonition">以下示例显示了 SID=NF2 的 SAP HANA 数据库。</block>
  <block id="efa2100424814ed736c66e231fca168e" category="paragraph">下表显示了单主机和多主机 SAP HANA 数据库的不同文件系统必须使用的 NFS 版本。</block>
  <block id="2f47d7fd74fc1974289ac9986bf3aadc" category="admonition">SAP Lama 要求 /usr/sap/SID 目录为本地目录。因此，如果使用的是 SAP Lama ，请勿挂载 /usr/sap/SID 的 NFS 卷。</block>
  <block id="2d10c7ea8ceb7d4d67cf331de62acb84" category="paragraph">对于 NFSv3 ，您必须关闭 NFS 锁定，以避免在软件或服务器出现故障时执行 NFS 锁定清理操作。</block>
  <block id="d8ad267f2c46ff97a15a2d97678f0e5d" category="cell">rw ， bg ， hard ， timeo=600 ， noatime</block>
  <block id="d52686ae129e1d4bbe8cb75712e98f22" category="cell">vers=3 ， nolock</block>
  <block id="5c2fca07471576b78522310793904392" category="cell">rsize=1048576 ， wsize=1048576</block>
  <block id="9fdcbaccc733453d8e7687d8e14a4e06" category="cell">rsize=65536 ， wsize=65536</block>
  <block id="a6b3bab4792cb8cb5eda6f38e11a69e7" category="admonition">要提高 NFSv3 的读取性能， NetApp 建议您使用 `nconnect=n` mount 选项，该选项可在 SUSE Linux Enterprise Server 12 SP4 或更高版本以及 RedHat Enterprise Linux （ RHEL ） 8.3 或更高版本中使用。</block>
  <block id="c252bc09fef14c3fb2a8d711bae9e7ed" category="admonition">性能测试表明， `nconnect=8` 可提供良好的读取结果。日志写入可能会因会话数较少而受益，例如 `nconnect=2` 。请注意，从 NFS 服务器进行的首次挂载（ IP 地址）会定义所使用的会话量。即使 nconnect 使用不同的值，后续挂载也不会更改此设置。</block>
  <block id="dacabe1f6964cddac20654972bf735ae" category="admonition">对于 NFSv4 ，从 ONTAP 9.8 开始， NetApp 支持 NFSv4.1 的 nconnect 选项。SLES15SP2 和 RHEL 8.3 提供了第一个支持 NFSv4.1 nconnect 的 NFS 客户端。有关追加信息，请查看 Linux 供应商文档。</block>
  <block id="d3413923f038d5ccbb48c2ba31d26f55" category="paragraph">以下示例显示了使用 NFSv3 且 NFS 传输大小为 1 MB 的单个主机 SAP HANA 数据库，其中 SID=NF2 。要在系统启动期间使用 ` /etc/fstab` 配置文件挂载文件系统，请完成以下步骤：</block>
  <block id="03c18c34eb30051a996a6e6304e449da" category="paragraph"><block ref="03c18c34eb30051a996a6e6304e449da" category="inline-link-macro-rx"></block></block>
  <block id="af4ba9ef9ab9bd07d7c649c6d51dfa19" category="summary">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。</block>
  <block id="044185db5eecc41b1eff832a2449939e" category="doc">适用于 SAP HANA 的 I/O 堆栈配置</block>
  <block id="edd4b0a785aee12ec105e54c3b3e0875" category="paragraph"><block ref="edd4b0a785aee12ec105e54c3b3e0875" category="inline-link-macro-rx"></block></block>
  <block id="9b9a22cabf9c193636cd9f07c91af320" category="paragraph">NetApp 进行了性能测试以定义理想值。下表列出了从性能测试中推断的最佳值。</block>
  <block id="5a47372463f3478c00e62fe8d0fab323" category="inline-link">2267798 —使用 hdbparam 在安装期间配置 SAP HANA 数据库</block>
  <block id="c310dbb2184ad240ae5b0efe2fa7161c" category="paragraph">对于 SAP HANA 1.0 - SPS12 ，可以在安装 SAP HANA 数据库期间设置这些参数，如 SAP 注释中所述<block ref="c391dcebb4d33a6a0f840983455654bf" category="inline-link-rx"></block>。</block>
  <block id="cae4446a780e78b5b18c423d76e75bb3" category="paragraph">从 SAP HANA 2.0 开始， `hdbparam` 已弃用，并且参数将移至 `global.ini` 文件。可以使用 SQL 命令或 SAP HANA Studio 设置这些参数。有关详细信息，请参见 SAP 注释<block ref="6af86c07e5a30516e9705c5fc7252793" category="inline-link-rx"></block>。也可以在 `global.ini` 文件中设置这些参数。</block>
  <block id="35e29c7133f7345ff12b812a10716c82" category="paragraph">对于 SAP HANA 2.0 SPS5 及更高版本，请使用 `setParameter.py` 脚本设置正确的参数。</block>
  <block id="903f97a90a3e3dde308a3446021799f5" category="inline-link-macro">接下来： SAP HANA 软件安装。</block>
  <block id="3cdfc8a41029c02db2f75000bec7b96d" category="paragraph"><block ref="3cdfc8a41029c02db2f75000bec7b96d" category="inline-link-macro-rx"></block></block>
  <block id="b040a1563eb002a288bc32bd9d35964c" category="inline-link-macro">先前版本： TR-4436 —基于采用光纤通道协议的 NetApp AFF 系统的 SAP HANA 。</block>
  <block id="adfd1902a33a023c2f96ffacdc9062e3" category="paragraph"><block ref="adfd1902a33a023c2f96ffacdc9062e3" category="inline-link-macro-rx"></block></block>
  <block id="c7d5014cd251a0d4b223b8a8c9d0d690" category="paragraph">SAP HANA 主机使用冗余 FCP 基础架构和多路径软件连接到存储控制器。如果交换机或主机总线适配器（ HBA ）发生故障，则需要一个冗余 FCP 交换机基础架构来提供容错 SAP HANA 主机到存储连接。必须在交换机上配置适当的分区，以使所有 HANA 主机能够访问存储控制器上所需的 LUN 。</block>
  <block id="10de0f7913b47a7c113fc4c77c57b582" category="paragraph">与部署的 AFF 系统无关， SAP HANA 环境也可以通过添加任何经过认证的存储控制器来进行扩展，以满足所需的节点密度，如下图所示。</block>
  <block id="6e885a25dfabc924cf867ada3aeb785e" category="paragraph">所有 NetApp 存储控制器上的 ONTAP 软件都提供了一种内置机制，可在运行期间备份 SAP HANA 数据库，而不会影响性能。基于存储的 NetApp Snapshot 备份是一种完全受支持的集成备份解决方案，可用于 SAP HANA 单个容器以及具有单个租户或多个租户的 SAP HANA MDC 系统。</block>
  <block id="c2934ecf3d665eb48045a5c0a76aaa32" category="paragraph">基于存储的 Snapshot 备份可使用适用于 SAP HANA 的 NetApp SnapCenter 插件来实施。这样，用户就可以使用 SAP HANA 数据库本机提供的界面创建一致的基于存储的 Snapshot 备份。SnapCenter 会将每个 Snapshot 备份注册到 SAP HANA 备份目录中。因此， SnapCenter 所做的备份可以在 SAP HANA Studio 或 Cockpit 中查看，您可以直接选择这些备份来执行还原和恢复操作。</block>
  <block id="c821c77589b970937599a027069b75fa" category="paragraph">通过 NetApp SnapMirror 技术，可以将在一个存储系统上创建的 Snapshot 副本复制到由 SnapCenter 控制的二级备份存储系统。然后，可以为主存储上的每个备份集以及二级存储系统上的备份集定义不同的备份保留策略。适用于 SAP HANA 的 SnapCenter 插件可自动管理基于 Snapshot 副本的数据备份和日志备份的保留，包括备份目录的管理。适用于 SAP HANA 的 SnapCenter 插件还允许通过执行基于文件的备份对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="5d0796fc364eb9339f2a48b34dbdae91" category="paragraph"><block ref="5d0796fc364eb9339f2a48b34dbdae91" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e2f0b48a9d9947c9b7911e4ac2346676" category="paragraph">与基于文件的传统备份相比，基于存储的 Snapshot 备份具有显著优势。这些优势包括但不限于：</block>
  <block id="d953c3b1d4ebbca797ea1cbd2db09e48" category="list-text">由于存储层上的恢复时间（几分钟）更快，备份频率更高，因此 RTO 减少</block>
  <block id="34a61102005a53f987add91d18ab2a11" category="paragraph">有关 SAP HANA 备份和恢复解决方案的详细信息，请参见<block ref="f91ad5f72ca89ecac47641fa01cbfa5f" category="inline-link-rx"></block>。</block>
  <block id="1901dda5acbabe5dc59a8bf332104608" category="paragraph">SAP HANA 灾难恢复既可以在数据库层使用 SAP HANA 系统复制，也可以在存储层使用存储复制技术。下一节概述了基于存储复制的灾难恢复解决方案。</block>
  <block id="4d7265e8ab9e98481c57ad3467a13264" category="paragraph">下图显示了一个三站点灾难恢复解决方案，它使用同步 SnapMirror 复制到本地灾难恢复数据中心，并使用异步 SnapMirror 将数据复制到远程灾难恢复数据中心。</block>
  <block id="ccb93370e2c5ea05681c87d10716cb76" category="paragraph">使用同步 SnapMirror 进行数据复制可提供零 RPO 。主灾难恢复数据中心与本地灾难恢复数据中心之间的距离限制为 100 公里左右。</block>
  <block id="fb05024902b454ea7eaf93ee5c249633" category="paragraph">通过使用异步 SnapMirror 将数据复制到第三个远程灾难恢复数据中心，可以防止主灾难恢复站点和本地灾难恢复站点发生故障。RPO 取决于复制更新的频率以及传输更新的速度。理论上，距离是无限的，但限制取决于必须传输的数据量以及数据中心之间的可用连接。典型的 RPO 值介于 30 分钟到多小时之间。</block>
  <block id="38a27392aa0b0ea2c83916c20bd81d8f" category="paragraph">这两种复制方法的 RTO 主要取决于在灾难恢复站点启动 HANA 数据库并将数据加载到内存所需的时间。假设数据的读取吞吐量为 1000 Mbps ，则加载 1 TB 数据大约需要 18 分钟。</block>
  <block id="d58470687869446fe4f35300048a7a2a" category="paragraph">正常运行期间，灾难恢复站点上的服务器可用作开发 / 测试系统。发生灾难时，需要关闭开发 / 测试系统并将其作为灾难恢复生产服务器启动。</block>
  <block id="494407c34ad1fbd6885e474888931b49" category="paragraph">这两种复制方法均允许您执行灾难恢复工作流测试，而不会影响 RPO 和 RTO 。FlexClone 卷在存储上创建并连接到灾难恢复测试服务器。</block>
  <block id="301d1888036e60c156e78c1c10fe52c6" category="paragraph"><block ref="301d1888036e60c156e78c1c10fe52c6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="66ea2532c88937e1b2fec44c9c66cdc2" category="paragraph">同步复制提供 StrictSync 模式。如果由于任何原因未完成对二级存储的写入，则应用程序 I/O 将失败，从而确保主存储系统和二级存储系统完全相同。只有在 SnapMirror 关系恢复为 InSync 状态后，主系统的应用程序 I/O 才会恢复。如果主存储发生故障，则在故障转移后可以在二级存储上恢复应用程序 I/O ，而不会丢失数据。在 StrictSync 模式下， RPO 始终为零。</block>
  <block id="4812f5d5dcef7b57ffc92a05d9b87dab" category="section-title">基于 NetApp MetroCluster 的存储复制</block>
  <block id="f831142d32986e69abb23ade52461f9f" category="paragraph">下图简要展示了解决方案。每个站点上的存储集群可提供本地高可用性，并用于生产工作负载。每个站点的数据会同步复制到另一位置，并可在发生灾难故障转移时使用。</block>
  <block id="a553ad9863be7367f2e8a90d3781c5da" category="paragraph"><block ref="a553ad9863be7367f2e8a90d3781c5da" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6947ce71df0ada36f65d3ed13c9a90da" category="paragraph"><block ref="6947ce71df0ada36f65d3ed13c9a90da" category="inline-link-macro-rx"></block></block>
  <block id="c51b24aaab462fd7294e78e8c4e9e241" category="summary">本节介绍 SAP HANA 主机的专用存储网络设置。</block>
  <block id="4d9de89d8dc9bb9db25b8c5a5aa836cc" category="doc">网络设置</block>
  <block id="6d7715a4313dcd3894c3ebe7ee700ef7" category="paragraph"><block ref="6d7715a4313dcd3894c3ebe7ee700ef7" category="inline-link-macro-rx"></block></block>
  <block id="7853be0a719416aa35b3da38940c0ce2" category="paragraph">配置网络时，请遵循以下准则：</block>
  <block id="5aa2ed1209919c655eae0cb94df9bae3" category="list-text">必须使用专用存储网络将 SAP HANA 主机连接到具有 10GbE 或更快网络的存储控制器。</block>
  <block id="4404b42b626eaf177ab6e6e9125dfe97" category="list-text">对存储控制器和 SAP HANA 主机使用相同的连接速度。如果无法做到这一点，请确保存储控制器和 SAP HANA 主机之间的网络组件能够处理不同的速度。例如，您必须提供足够的缓冲区空间，以便在存储和主机之间的 NFS 级别进行速度协商。网络组件通常是交换机，但也必须考虑刀片式服务器机箱中的其他组件，例如背板。</block>
  <block id="a32bac621f038e27eb9c7bba7b82a094" category="list-text">在存储网络交换机和主机层上用于存储流量的所有物理端口上禁用流量控制。</block>
  <block id="9f9c9a0f31b06a64351ba948107beb87" category="list-text">每个 SAP HANA 主机都必须具有一个冗余网络连接，带宽至少为 10 Gb 。</block>
  <block id="83b25287cb23c57a7801df3c84079ee0" category="list-text">必须在 SAP HANA 主机和存储控制器之间的所有网络组件上启用最大传输单元（ MTU ）大小为 9 ， 000 的巨型帧。</block>
  <block id="8e07acfd1437feec339a101261f3d33e" category="list-text">在 VMware 设置中，必须为每个正在运行的虚拟机分配专用 VMXNET3 网络适配器。有关更多要求，请查看 " 简介 " 中提及的相关文章。</block>
  <block id="ba1e4c91d87d340db9164d860b5fae70" category="list-text">为避免彼此干扰，请在日志和数据区域使用单独的网络 /IO 路径。</block>
  <block id="faee62bb79701f4ef71263923314ff62" category="paragraph">下图显示了一个示例，其中四个 SAP HANA 主机使用 10GbE 网络连接到一个存储控制器 HA 对。每个 SAP HANA 主机都与冗余网络结构建立主动 - 被动连接。</block>
  <block id="44597b05bc198603e6227f2548462391" category="paragraph">在存储层，配置了四个活动连接，可为每个 SAP HANA 主机提供 10 Gb 吞吐量。此外，还会在每个存储控制器上配置一个备用接口。</block>
  <block id="1efc1e7690d351bfed1ced8c36c4ee03" category="paragraph">在存储层，将配置 MTU 大小为 9000 的广播域，并将所有必需的物理接口添加到此广播域。此方法会自动将这些物理接口分配给同一故障转移组。分配给这些物理接口的所有逻辑接口（ LIF ）都会添加到此故障转移组中。</block>
  <block id="d1e0f5616249a49a84ab878af7f79663" category="paragraph"><block ref="d1e0f5616249a49a84ab878af7f79663" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3054a5405dd4f286779b953b08fbeacf" category="paragraph">通常，也可以在服务器（绑定）和存储系统（例如链路聚合控制协议（ Link Aggregation Control Protocol ， LACP ）和 ifgroups ）上使用 HA 接口组。使用 HA 接口组，验证负载是否在组内的所有接口之间平均分布。负载分布取决于网络交换机基础架构的功能。</block>
  <block id="0e9b7a6bc69692a6125fb9b457a42e62" category="admonition">根据 SAP HANA 主机的数量和使用的连接速度，需要不同数量的活动物理端口。有关详细信息，请参见一节 <block ref="53f775602a3eaa10214452e4a87da1ea" category="inline-link-macro-rx"></block>。</block>
  <block id="283bdd66e3d6ab214e33d303e668536e" category="section-title">VMware 专用网络设置</block>
  <block id="970db5841ccfee51a6e5d4efea5c84f3" category="paragraph">正确的网络设计和配置至关重要，因为 SAP HANA 实例的所有数据，包括数据库的性能关键型数据和日志卷，均通过此解决方案中的 NFS 提供。专用存储网络用于将 NFS 流量与 SAP HANA 节点之间的通信和用户访问流量分开。每个 SAP HANA 节点都需要一个冗余专用网络连接，带宽至少为 10 Gb 。此外，还支持更高的带宽。此网络必须通过网络交换和计算从存储层端扩展到端，直到 VMware vSphere 上托管的子操作系统为止。除了物理交换基础架构之外，还可以使用 VMware 分布式交换机（ VDS ）在虚拟机管理程序层为网络流量提供足够的性能和易管理性。</block>
  <block id="d611c9ea89baceab23239b20e82c12f3" category="paragraph"><block ref="d611c9ea89baceab23239b20e82c12f3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="60777d420c292249b3947e8807f44971" category="paragraph">如上图所示，每个 SAP HANA 节点都会在 VMware 分布式交换机上使用一个专用端口组。通过此端口组，可以在 ESX 主机上增强服务质量（ QoS ）并专用分配物理网络接口卡（ NIC ）。要在发生 NIC 故障时使用专用物理 NIC 并保留 HA 功能，专用物理 NIC 将配置为活动上行链路。其他 NIC 会在 SAP HANA 端口组的绑定和故障转移设置中配置为备用上行链路。此外，物理和虚拟交换机上必须端到端启用巨型帧（ MTU 9 ， 000 ）。此外，关闭服务器，交换机和存储系统上用于存储流量的所有以太网端口上的流量控制。下图显示了此类配置的一个示例。</block>
  <block id="0e4dfad25f5529b5f21a75404c509772" category="admonition">对于用于 NFS 流量的接口，必须关闭 LRO （大型接收卸载）。有关所有其他网络配置准则，请参见相应的适用于 SAP HANA 的 VMware 最佳实践指南。</block>
  <block id="03ca0c6ee1676cb097a4bab5309a21c0" category="paragraph"><block ref="03ca0c6ee1676cb097a4bab5309a21c0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="71054bcefaa80a2c1f4cbd58be22a9d9" category="paragraph"><block ref="71054bcefaa80a2c1f4cbd58be22a9d9" category="inline-link-macro-rx"></block></block>
  <block id="2989b01f158291341d56d0e6fe15bd6a" category="paragraph"><block ref="2989b01f158291341d56d0e6fe15bd6a" category="inline-link-macro-rx"></block></block>
  <block id="3d549724a6f011375a270e91b5a0db1c" category="paragraph"><block ref="3d549724a6f011375a270e91b5a0db1c" category="inline-link-macro-rx"></block></block>
  <block id="7db55fece99cd60241eaadd5b0b310da" category="summary">下一节概述了为 SAP HANA 估算存储系统规模时的性能和容量注意事项。</block>
  <block id="21ab51874a1ce38185b730c85021adcd" category="paragraph"><block ref="21ab51874a1ce38185b730c85021adcd" category="inline-link-macro-rx"></block></block>
  <block id="83814b9c4a7b826717cc464aa8fb78ac" category="admonition">请联系您的 NetApp 或 NetApp 合作伙伴销售代表，为存储规模估算流程提供支持，并创建适当规模的存储环境。</block>
  <block id="9b5082bba6ed43c3e4659d132b4df7f3" category="paragraph">SAP 已定义一组静态存储 KPI 。无论数据库主机和使用 SAP HANA 数据库的应用程序的内存大小如何，这些 KPI 都适用于所有生产 SAP HANA 环境。这些 KPI 适用于单主机，多主机， HANA 上的 Business Suite ， HANA 上的 Business Warehouse ， S/4HANA 和 BB/4HANA 环境。因此，当前的性能规模估算方法仅取决于连接到存储系统的活动 SAP HANA 主机的数量。</block>
  <block id="f2de3e3b437bebbf070dca38090a29ca" category="admonition">只有生产 SAP HANA 系统才需要存储性能 KPI 。</block>
  <block id="e4dda14ad0a8b54fc49903f1eeb3764e" category="paragraph">SAP 提供了一个性能测试工具，必须使用该工具来验证连接到存储的活动 SAP HANA 主机的存储性能。</block>
  <block id="5e2e10cba29f5251b72e245ca5e627be" category="admonition">认证 FAS 产品系列中的存储控制器也可用于采用其他磁盘类型或磁盘后端解决方案的 SAP HANA ，但前提是它们受 NetApp 支持并满足 SAP HANA TDI 性能 KPI 要求。例如， NetApp 存储加密（ NetApp Storage Encryption ， NSE ）和 NetApp FlexArray 技术。</block>
  <block id="99724050fbff82fec44c60c3ee4f7aee" category="paragraph">本文档介绍了 SAS 硬盘驱动器和固态驱动器的磁盘大小调整。</block>
  <block id="4506c934d7af90d5123a60cf609a388b" category="section-title">硬盘驱动器</block>
  <block id="c89d32b6013ce9723a96c107be1c4d48" category="admonition">此计算与使用的存储控制器和磁盘架无关。</block>
  <block id="e21e8a6bac2619ab0247181c81f6fd10" category="paragraph">对于固态驱动器（ SSD ），数据磁盘的数量取决于从存储控制器到 SSD 磁盘架的 SAS 连接吞吐量。</block>
  <block id="b3e9f6494455275ea6b6edb7295ebd0e" category="paragraph">可以在磁盘架上运行的最大 SAP HANA 主机数以及每个 SAP HANA 主机所需的最小 SSD 数均通过运行 SAP 性能测试工具来确定。</block>
  <block id="2befc3957b70e50f23dacfb3bcf86c2c" category="list-text">如果磁盘架连接到 12 Gb ，则具有 24 个 SSD 的 12 Gb SAS 磁盘架（ DS224C ）最多可支持 14 个 SAP HANA 主机。</block>
  <block id="03de450915ad58bd89ba02bcc1724c69" category="cell">满载 24 个 SSD 的 6 Gb SAS 磁盘架（ DS2246 ）</block>
  <block id="c1fe2a19a34d1ba0d03c9b34ed6d6dc0" category="cell">满载 24 个 SSD 的 12 GB SAS 磁盘架（ DS224C ）</block>
  <block id="f703381fdb02047b96e8a08ccd787c3d" category="paragraph">您可能会决定在同一存储控制器或同一聚合上部署 SAP HANA 工作负载和其他应用程序工作负载。如果是，您必须确保混合工作负载环境中的 SAP HANA 始终具有足够的性能。NetApp 还建议您使用服务质量（ QoS ）参数来控制这些其他应用程序可能对 SAP HANA 应用程序产生的影响。</block>
  <block id="4af2232eb1cbb56b9ad9f27dd1436328" category="paragraph">必须使用 SAP HCMT 测试工具检查是否可以在已用于其他工作负载的存储控制器上运行其他 SAP HANA 主机。但是， SAP 应用程序服务器可以安全地放置在与 SAP HANA 数据库相同的存储控制器和聚合上。</block>
  <block id="b0f9650ddfbaa04c69d0afbc401f6dce" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。使用 SAP 测试工具测试存储性能时，还必须为 SAP （ fsperf ）的性能测试工具设置这些参数。</block>
  <block id="3555c6a1af2c71b84c5e56f0d1e1bf9a" category="paragraph">NetApp 进行了性能测试，以定义最佳值。下表列出了必须在 SAP 测试工具的配置文件中设置的参数。</block>
  <block id="4ee612e0e9020cc8630b9f3c2a731f47" category="paragraph">每个 HANA 主机的磁盘数以及每个存储模型的 SAP HANA 主机密度均通过 SAP HANA 测试工具确定。</block>
  <block id="c047f42ac7558995af3a7e8b7e1c8c65" category="paragraph">规模估算过程需要详细信息，例如生产和非生产 SAP HANA 主机的数量，每个主机的 RAM 大小以及基于存储的 Snapshot 副本的备份保留期限。SAP HANA 主机的数量决定了存储控制器和所需磁盘的数量。</block>
  <block id="72512f57a9671c8fd7e4e6c720f19f86" category="paragraph">在容量规模估算期间， RAM 大小，每个 SAP HANA 主机磁盘上的净数据大小以及 Snapshot 副本备份保留期限均用作输入。</block>
  <block id="51be19458384c68e3b7da48098b0fb3f" category="paragraph"><block ref="51be19458384c68e3b7da48098b0fb3f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="53da9a0c7fb2a33dd40ed0fe607bafc4" category="paragraph"><block ref="53da9a0c7fb2a33dd40ed0fe607bafc4" category="inline-link-macro-rx"></block></block>
  <block id="888a97817eb269434426d56de56528fa" category="summary">默认情况下， SAP HANA 在每个 SAP HANA 服务中仅使用一个数据卷。由于文件系统的最大文件大小限制，我们建议限制最大数据卷大小。</block>
  <block id="c7c8b48fd23d939958d032aa4f897d35" category="doc">SAP HANA 数据卷大小</block>
  <block id="bd411fd9dcc1be4e9633a309099ef775" category="paragraph"><block ref="bd411fd9dcc1be4e9633a309099ef775" category="inline-link-macro-rx"></block></block>
  <block id="2313d7e75b1293ec19e67b10399a5b36" category="paragraph">要自动执行此操作，请在 `global.ini` 中的 ` [ 持久性 ]` 部分设置以下参数：</block>
  <block id="bcd4783f16a6a90aaaeb9703e35b2183" category="inline-link">SAP 注释 240005 问题 15</block>
  <block id="02fb0663b2b25ed3058835e1a2db5762" category="paragraph">这将在达到 8 ， 000 GB 限制后创建一个新的数据卷。<block ref="0d7b59f229b453865b91c5e952a7b217" category="inline-link-rx"></block> 提供了更多信息。</block>
  <block id="215d37a3af4a86848d9b73685d09313a" category="paragraph"><block ref="215d37a3af4a86848d9b73685d09313a" category="inline-link-macro-rx"></block></block>
  <block id="0f41d05d80faf4e3a75a6b4e2292f1c0" category="summary">NetApp AFF 产品系列已通过认证，可在 TDI 项目中与 SAP HANA 结合使用。经过认证的企业级存储平台采用 NetApp ONTAP 软件。</block>
  <block id="0db6b81db5bd35e1eef1e83e154c3cb5" category="doc">TR-4436 ：《基于采用光纤通道协议的 NetApp AFF 系统的 SAP HANA 》</block>
  <block id="3582e9217fbd3de24b2e5ecfb0fc97b4" category="paragraph">NetApp 公司 Nil Bauser 和 Marco Schoen</block>
  <block id="0b79795d3efc95b9976c7c5b933afce2" category="section-title">简介</block>
  <block id="e4509a748ae3ce7cb528662f2f9f7e10" category="paragraph">此认证适用于以下型号：</block>
  <block id="47230a2a4e3598c31d12840cfd054ac9" category="list-text">AFF A220 ， AFF A250 ， AFF A300 ， AFF A320 ， AFF A400 ， AFF A700s ， AFF A700 ， AFF A800</block>
  <block id="130c9ce9d2909449cb229a98c66f9d29" category="inline-link">经过认证并受支持的 SAP HANA 硬件目录</block>
  <block id="47a36a94edc53cd5187c3a1d7d414368" category="list-text">ASA AFF A220 ， ASA AFF A250 ， ASA AFF A400 ， ASA AFF A700 ， ASA AFF A800 有关适用于 SAP HANA 的 NetApp 认证存储解决方案的完整列表，请参见<block ref="4863cb1d1ac806ba02e335dda429f580" category="inline-link-rx"></block>。</block>
  <block id="171ad4663cdfb492651e0357292fbe82" category="paragraph">本文档介绍了使用光纤通道协议（ FCP ）的 AFF 配置。</block>
  <block id="a08e3f55ac1bf243274ee454a477749b" category="admonition">要为 SAP HANA 实现所需的 SAP HANA KPI 和最佳性能，必须采用本文所述的配置。更改此处未列出的任何设置或使用的功能可能会导致发生原因性能下降或出现意外行为，只有在 NetApp 支持人员建议的情况下，才应执行此操作。</block>
  <block id="9ba59bf1b64e9d129b41dbb49f3c385f" category="paragraph">有关使用 NFS 和 NetApp FAS 系统的 AFF 系统的配置指南，请访问以下链接：</block>
  <block id="6e309be8793679276c5f6a7bdd2bfdfa" category="inline-link">基于采用 FCP 的 NetApp FAS 系统的 SAP HANA</block>
  <block id="794aa68d1e6abb7bdd6b9ecf4a1125fd" category="inline-link">基于采用 NFS 的 NetApp FAS 系统的 SAP HANA</block>
  <block id="4300aba024439d53329726e8ecb7f77b" category="list-text"><block ref="4300aba024439d53329726e8ecb7f77b" category="inline-link-rx"></block></block>
  <block id="5f6e041a9634120ceb1ee084f6acde8a" category="inline-link">SAP 注释 2235581 — SAP HANA 支持的操作系统</block>
  <block id="10fba2fd8d2b0860517a92eefbfce26b" category="paragraph">在 SAP HANA 多主机环境中，标准 SAP HANA 存储连接器用于在发生 SAP HANA 主机故障转移时提供隔离。有关操作系统配置准则和 HANA 专用 Linux 内核依赖关系，请始终参考相关 SAP 注释。有关详细信息，请参见<block ref="362348e4aadbc3b1dc4fa3ddcce8fb65" category="inline-link-rx"></block>。</block>
  <block id="c28f239d8c4b11cfe19d1dcf078100b9" category="section-title">SAP HANA 量身定制的数据中心集成</block>
  <block id="e13ebe7bf91deecb41098f3561e752bf" category="paragraph">NetApp AFF 存储系统已通过 SAP HANA TDI 计划的认证，该计划同时使用 NFS （ NAS ）和 FC （ SAN ）协议。它们可以部署在任何当前 SAP HANA 方案中，例如采用单主机或多主机配置的基于 HANA 的 SAP Business Suite ， S/4HANA ， BB/4HANA 或基于 HANA 的 SAP Business Warehouse 。任何经认证可与 SAP HANA 结合使用的服务器均可与 NetApp 认证的存储解决方案结合使用。下图显示了一个架构概述。</block>
  <block id="92587b11e86da44eb218f2b17846d58e" category="paragraph"><block ref="92587b11e86da44eb218f2b17846d58e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ea6847e11cffe9d9606d920fe126bfdc" category="paragraph">有关高效 SAP HANA 系统的前提条件和建议的详细信息，请参见以下资源：</block>
  <block id="14a31d6554fa48b10cc86d1aaf656a07" category="inline-link">SAP HANA 定制数据中心集成常见问题解答</block>
  <block id="9282f2106e2ecc166cf241e78c58163e" category="list-text"><block ref="9282f2106e2ecc166cf241e78c58163e" category="inline-link-rx"></block></block>
  <block id="44cbaf598c2b8895a3d3a875dd63203f" category="list-text"><block ref="44cbaf598c2b8895a3d3a875dd63203f" category="inline-link-rx"></block></block>
  <block id="677ab22de36ea7a11313727ef07c5d64" category="inline-link-macro">先前版本：为 SAP HANA 单主机系统添加其他数据卷分区。</block>
  <block id="8743d46cf40e9841fd4d7a036d38956c" category="paragraph"><block ref="8743d46cf40e9841fd4d7a036d38956c" category="inline-link-macro-rx"></block></block>
  <block id="156ab83547a69207813015793bfe2332" category="paragraph"><block ref="156ab83547a69207813015793bfe2332" category="inline-link-rx"></block></block>
  <block id="ed1a4cf8e74958e746c53d94aee28736" category="paragraph"><block ref="ed1a4cf8e74958e746c53d94aee28736" category="inline-link-rx"></block></block>
  <block id="0efd230d120bc177f0918dac852f2cf2" category="list-text">适用于 SAP HANA 的 SAP 认证企业存储硬件</block>
  <block id="a33fe1a52fed6bf7e934c86f0fa54fcb" category="paragraph"><block ref="a33fe1a52fed6bf7e934c86f0fa54fcb" category="inline-link-rx"></block></block>
  <block id="38657a01715c45b59546cbf0d906ef65" category="paragraph"><block ref="38657a01715c45b59546cbf0d906ef65" category="inline-link-rx"></block></block>
  <block id="3710f13cc62644ea40b0af38f0b1198e" category="paragraph"><block ref="3710f13cc62644ea40b0af38f0b1198e" category="inline-link-rx"></block></block>
  <block id="68be744220cfff40ab15d535a912c8a0" category="list-text">TR-4646 ：《使用 SnapCenter 4.0 SAP HANA 插件通过异步存储复制实现 SAP HANA 灾难恢复》</block>
  <block id="62658c7987e92cf3967ab8bdd1e66d18" category="paragraph"><block ref="62658c7987e92cf3967ab8bdd1e66d18" category="inline-link-rx"></block></block>
  <block id="026a8e661ca1c91258a93024c126a529" category="paragraph"><block ref="026a8e661ca1c91258a93024c126a529" category="inline-link-rx"></block></block>
  <block id="d3f52fc82e5e1c25912db41874144b01" category="list-text">TR-4338 ：《基于 VMware vSphere 的 SAP HANA 与 NetApp FAS 和 AFF 系统》</block>
  <block id="f3cf3d4bafab3435fc6438043df8d588" category="paragraph"><block ref="f3cf3d4bafab3435fc6438043df8d588" category="inline-link-rx"></block></block>
  <block id="2505e1f3dd70f8398b450e6045393d0e" category="list-text">TR-4667 ：使用 SnapCenter 4.0 SAP HANA 插件自动执行 SAP 系统副本</block>
  <block id="cb22cde491c8ae8ab780a6806f412e04" category="paragraph"><block ref="cb22cde491c8ae8ab780a6806f412e04" category="inline-link-rx"></block></block>
  <block id="c54847a2046020d06d345fd8b61fc169" category="list-text">NetApp 文档中心</block>
  <block id="bf78332b32395471af72955679895502" category="paragraph"><block ref="bf78332b32395471af72955679895502" category="inline-link-rx"></block></block>
  <block id="b4142d7007d4ca027509ca5370c0f3e9" category="list-text">NetApp FAS 存储系统资源</block>
  <block id="65fdf1bbdd083420089318972c99c550" category="list-text"><block ref="65fdf1bbdd083420089318972c99c550" category="inline-link-rx"></block></block>
  <block id="1f97b7a68d0268791593f9152a2471f4" category="list-text">SAP HANA 软件解决方案</block>
  <block id="71aa61c769ce3c313ee996249b3ba484" category="paragraph"><block ref="71aa61c769ce3c313ee996249b3ba484" category="inline-link-rx"></block></block>
  <block id="93edd73a174ce62b468c111e85659a4e" category="paragraph"><block ref="93edd73a174ce62b468c111e85659a4e" category="inline-link-macro-rx"></block></block>
  <block id="02e9c064fb16f4d7c921173e0ea3e1d4" category="summary">SAP HANA 主机通过使用冗余 10GbE 或速度更快的网络基础架构连接到存储控制器。SAP HANA 主机和存储控制器之间的数据通信基于 NFS 协议。如果交换机或网络接口卡（ Network Interface Card ， NIC ）发生故障，则需要一个冗余交换基础架构来提供容错 SAP HANA 主机到存储连接。</block>
  <block id="55cb2ce80ae821cef5432ebb2091bff2" category="paragraph"><block ref="55cb2ce80ae821cef5432ebb2091bff2" category="inline-link-macro-rx"></block></block>
  <block id="9ebc0606dc606ba3c824288cbcec4b6a" category="paragraph">这些交换机可能会将各个端口的性能与端口通道进行聚合，以便在主机级别显示为一个逻辑实体。</block>
  <block id="ec7778649625767bca80e5172b3215f8" category="paragraph">下图显示了一个配置示例，其中八个 SAP HANA 主机连接到一个存储高可用性（ HA ）对。</block>
  <block id="b29537513701761c57bf9d412289ba1a" category="paragraph"><block ref="b29537513701761c57bf9d412289ba1a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b2ff8e71e9e5aa43773ccdafa2b95737" category="paragraph">下图显示了使用 VMware vSphere 作为虚拟化层的示例。</block>
  <block id="4c44af3d2dea8446272d44b6a23d865f" category="paragraph"><block ref="4c44af3d2dea8446272d44b6a23d865f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f000fef8626763ce732cc75182f80de1" category="list-text">如果存储控制器提供的性能足以满足当前 SAP HANA 主要性能指标（ KPI ）的要求，则可以将更多的 SAP HANA 主机和存储容量附加到现有存储。</block>
  <block id="af0b30d5f97bb5800d0d429f5f501e85" category="paragraph">下图显示了一个配置示例，其中，更多 SAP HANA 主机连接到存储控制器。在此示例中，要满足 16 个 SAP HANA 主机的容量和性能要求，需要更多的磁盘架。根据总吞吐量要求，您必须向存储控制器添加更多 10GbE 或更快的连接。</block>
  <block id="276c9a6f9a2bc0b55d6a461bf80732b6" category="paragraph"><block ref="276c9a6f9a2bc0b55d6a461bf80732b6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="014f96dd954f0cad52c8dd1e4a0f6c0c" category="paragraph">无论部署的 AFF 系统如何， SAP HANA 环境也可以通过添加任何经过认证的存储控制器来进行扩展，以满足所需的节点密度，如下图所示。</block>
  <block id="23afd4f2c1dfda5dd05b75c067e4c3d1" category="paragraph"><block ref="23afd4f2c1dfda5dd05b75c067e4c3d1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="403661a7cc1e3bdbdbb3bc83a0e07b79" category="paragraph">所有 NetApp 存储控制器上的 ONTAP 软件都提供了一种内置机制，可在运行期间备份 SAP HANA 数据库，而不会影响性能。基于存储的 NetApp Snapshot 备份是一种完全受支持的集成备份解决方案，可用于 SAP HANA 单个容器以及具有单个租户或多个租户的 SAP HANA 多租户数据库容器（ MDG ）系统。</block>
  <block id="d27691a65309de7a848f265e2a85db07" category="paragraph">通过 NetApp SnapMirror 技术，可以将在一个存储系统上创建的 Snapshot 副本复制到由 SnapCenter 控制的二级备份存储系统。然后，可以为主存储上的每个备份集以及二级存储系统上的备份集定义不同的备份保留策略。适用于 SAP HANA 的 SnapCenter 插件可自动管理基于 Snapshot 副本的数据备份和日志备份的保留，包括备份目录的管理。适用于 SAP HANA 的 SnapCenter 插件还允许通过执行基于文件的备份对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="e45a55da3ede32b284f50ffc72619006" category="paragraph"><block ref="e45a55da3ede32b284f50ffc72619006" category="inline-image-macro-rx" type="image"></block></block>
  <block id="37a72a4ef96da2b1b4de8dfd6a6578e1" category="paragraph">与基于文件的传统备份相比，基于存储的 Snapshot 备份具有显著优势。这些优势包括但不限于：</block>
  <block id="174308ff465221226aee11e550ae48e1" category="admonition">有关 SAP HANA 备份和恢复解决方案的详细信息，请参见<block ref="f91ad5f72ca89ecac47641fa01cbfa5f" category="inline-link-rx"></block>。</block>
  <block id="a87b95aa164115fe66d032fbca70ca68" category="paragraph">SAP HANA 灾难恢复（ DR ）可以通过 SAP HANA 系统复制在数据库层上完成，也可以通过存储复制技术在存储层完成。下一节概述了基于存储复制的灾难恢复解决方案。</block>
  <block id="bbd9cd279c4821dc8442f0cee747a314" category="paragraph">有关 SAP HANA 灾难恢复解决方案的详细信息，请参见<block ref="dfa76f526e34dee57bfae58022907510" category="inline-link-rx"></block>。</block>
  <block id="d8c167d8f4fbaa19b28b96b8f9830293" category="paragraph">正常运行期间，灾难恢复站点上的服务器可用作开发 / 测试系统。发生灾难时，需要关闭开发 / 测试系统并将其作为灾难恢复生产服务器启动。</block>
  <block id="90049d260fc9ee28e156b798776a344e" category="paragraph"><block ref="90049d260fc9ee28e156b798776a344e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2eae71a1adc3f840dd7f52367b3ca0b2" category="paragraph"><block ref="2eae71a1adc3f840dd7f52367b3ca0b2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5a248e50c9ff026b6f8c2cb21b20533d" category="paragraph"><block ref="5a248e50c9ff026b6f8c2cb21b20533d" category="inline-link-macro-rx"></block></block>
  <block id="5a19cb1f3722bd59393efe7cbc853747" category="summary">NetApp AFF 系统产品系列已通过认证，可在定制数据中心集成（ TDI ）项目中与 SAP HANA 结合使用。经过认证的企业级存储系统采用 NetApp ONTAP 软件的特征。</block>
  <block id="8290e539e87b39f4743f2a941a37d00d" category="doc">TR-4435 ：《采用 NFS 的 NetApp AFF 系统上的 SAP HANA —配置指南》</block>
  <block id="ccc35786789b66e9752e6f8cde933754" category="paragraph">NetApp 公司 Nil Bauser 和 Marco schön</block>
  <block id="af01ac16ca42b9b924b834a3199131e9" category="paragraph">此认证适用于以下型号：</block>
  <block id="79fc4220549a4c2c93c30a0983ee4447" category="paragraph">有关适用于 SAP HANA 的 NetApp 认证存储解决方案的完整列表，请参见<block ref="4863cb1d1ac806ba02e335dda429f580" category="inline-link-rx"></block>。</block>
  <block id="e6f3c771b97ae513ec4c1db0f4a875ce" category="paragraph">本文档介绍了 NFS 协议版本 3 （ NFSv3 ）或 NFS 协议版本 4 （ NFSv4.0 和 NFSv4.1 ）的 ONTAP 配置要求。</block>
  <block id="f40ff8772938c5d60689bb69269c8692" category="paragraph">在本文档的其余部分中， NFSv4 既指 NFSv4.0 ，也指 NFSv4.1 。</block>
  <block id="793f62e70c31f71a93161db091bea2c0" category="paragraph">有关使用 FCP 的 NetApp AFF 系统以及使用 NFS 或 FCP 的 FAS 系统的配置指南，请访问以下链接：</block>
  <block id="fd645c3ffaeed1c3efb140082b037a69" category="inline-link">基于采用光纤通道协议的 NetApp FAS 系统的 SAP HANA</block>
  <block id="8c286ade008f7d794b82d8e4bc981424" category="list-text"><block ref="8c286ade008f7d794b82d8e4bc981424" category="inline-link-rx"></block></block>
  <block id="d3eeeac9b8ca9512c68dfff9f3b301a2" category="inline-link">基于采用光纤通道协议的 NetApp AFF 系统的 SAP HANA</block>
  <block id="c5b75af125f41729ef7bcd709c04f970" category="list-text"><block ref="c5b75af125f41729ef7bcd709c04f970" category="inline-link-rx"></block></block>
  <block id="36fafbaf89be825de435f50a73ce793c" category="paragraph">下表显示了 NFS 版本， NFS 锁定和所需隔离实施的受支持组合，具体取决于 SAP HANA 数据库配置。</block>
  <block id="4a74ba49b2778c7cf6b73600b7dfe758" category="paragraph">对于不使用主机自动故障转移的 SAP HANA 单主机系统或多个主机，支持 NFSv3 和 NFSv4 。</block>
  <block id="8456bce54ecacb824d3f0f3333eec164" category="paragraph">对于采用主机自动故障转移的 SAP HANA 多主机系统， NetApp 仅支持 NFSv4 ，而使用 NFSv4 锁定作为服务器专用 STONITH （ SAP HANA HA/DR 提供程序）实施的替代方案。</block>
  <block id="86083f3ea21c2385b4f013aae3c57858" category="cell">SAP HANA</block>
  <block id="b09bc640e0761651dfc89ddfb932bca4" category="cell">NFS 版本</block>
  <block id="4dc6f2785947994abb17dafc579b385c" category="cell">NFS 锁定</block>
  <block id="112546829b39fc0ca5f6864abb9eb36b" category="cell">SAP HANA HA/DR 提供程序</block>
  <block id="11b07481dbca2b152fe454ec6b2bda1b" category="cell">SAP HANA 单个主机，多个主机，而不具有主机自动故障转移功能</block>
  <block id="d15305d7a4e34e02489c74a5ef542f36" category="cell">关闭</block>
  <block id="274b68192b056e268f128ff63bfcd4a4" category="cell">不适用</block>
  <block id="521c36a31c2762741cf0f8890cbe05e3" category="cell">开启</block>
  <block id="17f561d1407ffe04f736722475cbc0d4" category="cell">使用主机自动故障转移的 SAP HANA 多个主机</block>
  <block id="fbe7f3b8db20ca64d74a09b5069fe001" category="cell">必须实施特定于服务器的 STONITH</block>
  <block id="6fd5e95dc0bce8329da87e1152677b48" category="cell">不需要</block>
  <block id="c522b313eec5744e458e23dab3741128" category="admonition">本指南不包括特定于服务器的 STONITH 实施。请联系您的服务器供应商进行此类实施。</block>
  <block id="8543c5790a0b5260e2446fad651e5ade" category="paragraph">本文档介绍了在物理服务器和使用 VMware vSphere 的虚拟服务器上运行的 SAP HANA 的配置建议。</block>
  <block id="e0f43a4c6e28079f6afdc78865b7782e" category="admonition">有关操作系统配置准则和特定于 HANA 的 Linux 内核依赖关系，请参见相关 SAP 注释。有关详细信息，请参见 SAP 注释 2235581 ： SAP HANA 支持的操作系统。</block>
  <block id="5d75848b6169b06c4cd7d6a8c2ec2337" category="paragraph">NetApp AFF 存储控制器已通过 SAP HANA TDI 计划的认证，并同时使用 NFS （ NAS ）和 FC （ SAN ）协议。它们可以部署在任何当前 SAP HANA 方案中，例如采用单主机或多主机配置的基于 HANA 的 SAP Business Suite ， S/4HANA ， BB/4HANA 或基于 HANA 的 SAP Business Warehouse 。任何经认证可与 SAP HANA 结合使用的服务器均可与 NetApp 认证的存储解决方案结合使用。有关 SAP HANA TDI 的架构概述，请参见下图。</block>
  <block id="b397cda0484ae78f49c994384022879a" category="paragraph"><block ref="b397cda0484ae78f49c994384022879a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0b915d978fec9594c52c6c0d2f128886" category="paragraph">有关 producti SAP HANA 系统的前提条件和建议的详细信息，请参见以下资源：</block>
  <block id="4769b140b92a70ffdab406be16d30122" category="paragraph">可通过多种方法将存储连接到虚拟机（ VM ）。首选选项是直接从子操作系统中连接具有 NFS 的存储卷。使用此选项时，物理主机和 VM 的主机和存储配置不会有所不同。</block>
  <block id="35eb3c62d099b5d5e6334b74d5b2bcff" category="paragraph">此外，还支持 NFS 数据存储库和采用 NFS 的 VVol 数据存储库。对于这两个选项，数据存储库中只能存储一个 SAP HANA 数据或日志卷，以用于生产用例。此外，无法实施由 NetApp SnapCenter 和基于此的解决方案协调的基于 Snapshot 的备份和恢复，例如 SAP 系统克隆。</block>
  <block id="f7fbf8be79b2dbbf7cca7d63ea2aaa3e" category="paragraph">本文档介绍了从子操作系统直接挂载 NFS 的建议设置。</block>
  <block id="181fc43b08ba57214c4bbd2448ec470d" category="list-text"><block ref="181fc43b08ba57214c4bbd2448ec470d" category="inline-link-macro-rx"></block></block>
  <block id="cf67b8f52627ca93f03f86a0a17c027c" category="list-text"><block ref="cf67b8f52627ca93f03f86a0a17c027c" category="inline-link-macro-rx"></block></block>
  <block id="f889a715c2c77a76b725f272585bdf07" category="list-text"><block ref="f889a715c2c77a76b725f272585bdf07" category="inline-link-macro-rx"></block></block>
  <block id="302092b20c647fa4f675ff96913675f9" category="list-text"><block ref="302092b20c647fa4f675ff96913675f9" category="inline-link-macro-rx"></block></block>
  <block id="3d92328d2ece8cce52ff1c29c5d4f7c4" category="paragraph"><block ref="3d92328d2ece8cce52ff1c29c5d4f7c4" category="inline-link-macro-rx"></block></block>
  <block id="a5ebe9916e263957a0c4218cc06bbf5a" category="paragraph"><block ref="a5ebe9916e263957a0c4218cc06bbf5a" category="inline-link-macro-rx"></block></block>
  <block id="36355d63733febc8629c7068b9264aba" category="list-text">TR-4646 ：《使用 SnapCenter 4.0 SAP HANA 插件通过存储复制实现 SAP HANA 灾难恢复》</block>
  <block id="bb41f5e2046d2c100d796ce09315ce5a" category="list-text">TR-4667 ：使用 SnapCenter 4.0 SAP HANA 插件自动执行 SAP 系统副本</block>
  <block id="ca6b4c114aab9ce885b2e3f3375cf6a1" category="list-text">NetApp AFF 存储系统资源</block>
  <block id="df02d530b506eb0d3a627cf87375e921" category="paragraph"><block ref="df02d530b506eb0d3a627cf87375e921" category="inline-link-rx"></block></block>
  <block id="478e40cd9ddf422d368f6b4491dd38c7" category="paragraph"><block ref="478e40cd9ddf422d368f6b4491dd38c7" category="inline-link-macro-rx"></block></block>
  <block id="4f0141ecc04bee7dc293f8992542b4bd" category="summary">NetApp FAS 产品系列已通过认证，可在 TDI 项目中与 SAP HANA 结合使用。经过认证的企业级存储平台采用 NetApp ONTAP 操作系统。</block>
  <block id="088c8c258db90c09658a39d2839f52b0" category="doc">TR-4384 ：《采用光纤通道协议的 NetApp FAS 系统上的 SAP HANA 配置指南》</block>
  <block id="d505ac9d8d6e21d17ef8d33d547be191" category="list-text">FAS2720 ， FAS2750 ， FAS8200 ， FAS8300 ， FAS8700 ， FAS9000</block>
  <block id="42eb56ae1e83db3afce70f056a668205" category="inline-link">经过认证并受支持的 SAP HANA 硬件目录</block>
  <block id="e722e7b3a802520d055b584591aecb34" category="paragraph">有关适用于 SAP HANA 的 NetApp 认证存储解决方案的完整列表，请参见<block ref="4ad366ef77d40c13190de08fae8e4fc8" category="inline-link-rx"></block>。</block>
  <block id="b448d121930edfc4a956027d7533c403" category="paragraph">本文档介绍了使用光纤通道协议（ FCP ）的 FAS 配置。</block>
  <block id="bd06b22fab5b6b92f9bf2b53d26f4805" category="admonition">要为 SAP HANA 实现所需的 SAP HANA KPI 和最佳性能，必须采用本文所述的配置。更改此处未列出的任何设置或使用的功能可能会导致性能下降或出现意外行为，只有在 NetApp 支持人员建议的情况下，才应执行此操作。</block>
  <block id="b33f6954e7bec0569d3be6ef5cea4d1d" category="paragraph">有关使用 NFS 和 NetApp AFF 系统的 FAS 系统的配置指南，请访问以下链接：</block>
  <block id="1800d8919a8de7dbf0bdd4d4ef0a94f4" category="paragraph">在 SAP HANA 多主机环境中，标准 SAP HANA 存储连接器用于在发生 SAP HANA 主机故障转移时提供隔离。有关操作系统配置准则和 HANA 专用 Linux 内核依赖关系的信息，请参见相关 SAP 注释。有关详细信息，请参见<block ref="362348e4aadbc3b1dc4fa3ddcce8fb65" category="inline-link-rx"></block>。</block>
  <block id="324c1541e14a4687bde362da7f340662" category="paragraph">NetApp FAS 存储控制器已通过使用 NFS （ NAS ）和光纤通道（ SAN ）协议的 SAP HANA 定制数据中心集成（ TDI ）计划的认证。它们可以部署在任何 SAP HANA 方案中，例如采用单主机或多主机配置的基于 HANA 的 SAP Business Suite ， S/4HANA ， BB/4HANA 或基于 HANA 的 SAP Business Warehouse 。任何经认证可与 SAP HANA 结合使用的服务器均可与经过认证的存储解决方案结合使用。有关架构概述，请参见下图。</block>
  <block id="edf706df3a1da44f680d9aeb650d6f07" category="paragraph"><block ref="edf706df3a1da44f680d9aeb650d6f07" category="inline-image-macro-rx" type="image"></block></block>
  <block id="77d248262c4913bdbb243f5ab783f804" category="paragraph">可通过多种方法将存储连接到虚拟机（ VM ）。首选方法是，将具有 NFS 的存储卷直接从子操作系统中连接起来。中介绍了此选项<block ref="9ea324ddb9f7511fb783cc61e9aee7e8" category="inline-link-rx"></block>。</block>
  <block id="2119e51f96366de40a69723f79096b89" category="paragraph">此外，还支持原始设备映射（ RDM ）， FCP 数据存储库或具有 FCP 的 VVol 数据存储库。对于这两个数据存储库选项，数据存储库中只能存储一个 SAP HANA 数据或日志卷，以便在高效使用情形下使用。此外，无法实施由 SnapCenter 和基于此的解决方案协调的基于 Snapshot 的备份和恢复，例如 SAP 系统克隆。</block>
  <block id="b8d262c1ae7b810ad38a6e608b89ffa6" category="paragraph"><block ref="b8d262c1ae7b810ad38a6e608b89ffa6" category="inline-link-macro-rx"></block></block>
  <block id="3823dde38e881edb5563cdd3b64099ba" category="summary">以下是 SAP HANA 软件安装的要求。</block>
  <block id="c3da6d29b64aa69d7a0b1e2f75e1200d" category="paragraph"><block ref="c3da6d29b64aa69d7a0b1e2f75e1200d" category="inline-link-macro-rx"></block></block>
  <block id="d62e297e0f46d31deba4b84efdfafc32" category="paragraph">安装 SAP HANA 软件不需要为单主机系统做任何其他准备。</block>
  <block id="4892ecebb50bda68f4f9f3421f981b8a" category="paragraph"><block ref="4892ecebb50bda68f4f9f3421f981b8a" category="inline-link-macro-rx"></block></block>
  <block id="07f50886cb51dc3f90123d42cf009896" category="summary">SAP HANA 主机使用冗余 FCP 基础架构和多路径软件连接到存储控制器。</block>
  <block id="f8702cc34a81df5ca3b64a0d66f52610" category="inline-link-macro">先前版本：《采用 FCP 的 FAS 系统上的 SAP HANA 配置指南》。</block>
  <block id="02721c8e712b93ff751bdb871277e990" category="paragraph"><block ref="02721c8e712b93ff751bdb871277e990" category="inline-link-macro-rx"></block></block>
  <block id="adff62b08f2c542a637f6a31fbda8673" category="paragraph">SAP HANA 主机使用冗余 FCP 基础架构和多路径软件连接到存储控制器。如果交换机或主机总线适配器（ HBA ）发生故障，则需要一个冗余 FCP 交换机基础架构来提供容错 SAP HANA 主机到存储连接。必须在交换机上配置适当的分区，以使所有 HANA 主机能够访问存储控制器上所需的 LUN 。</block>
  <block id="bae63c2771206a25f50da057ce067a9c" category="paragraph">可以在存储层使用不同型号的 FAS 产品系列。连接到存储的最大 SAP HANA 主机数由 SAP HANA 性能要求定义。所需的磁盘架数量取决于 SAP HANA 系统的容量和性能要求。</block>
  <block id="5db3f175b30c1233589dfa69c2f82996" category="paragraph"><block ref="5db3f175b30c1233589dfa69c2f82996" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6afb369a6dbb704834887d425d781975" category="list-text">假设存储控制器可以在新负载下提供足够的性能以满足关键性能指标（ KPI ）要求，则将额外的 SAP HANA 主机和磁盘容量附加到存储</block>
  <block id="03f9c73bd24a38ac275bf81d436e85a9" category="list-text">为其他 SAP HANA 主机添加更多存储系统和磁盘容量</block>
  <block id="2149c7e57da1ba04dc2a0fbf9d7d2048" category="paragraph"><block ref="2149c7e57da1ba04dc2a0fbf9d7d2048" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dd7ae5d97763211b9ba0c4fb173c8ba0" category="paragraph">无论部署的 FAS 系统存储模式如何， SAP HANA 环境也可以通过添加更多存储控制器进行扩展，如下图所示。</block>
  <block id="edfb118fb2523678e1c86125dfe6332a" category="paragraph"><block ref="edfb118fb2523678e1c86125dfe6332a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b29e296e3fc82d9667053e3613da9983" category="paragraph">NetApp ONTAP 软件提供了用于备份 SAP HANA 数据库的内置机制。基于存储的 Snapshot 备份是一种完全受支持的集成备份解决方案，可用于 SAP HANA 单容器系统和 SAP HANA MDC 单租户系统。</block>
  <block id="850e88ceda74d905d2efd5ea7c4b192d" category="paragraph">基于存储的 Snapshot 备份可通过适用于 SAP HANA 的 NetApp SnapCenter 插件来实施，该插件可通过 SAP HANA 数据库提供的接口实现基于存储的一致 Snapshot 备份。SnapCenter 会在 SAP HANA 备份目录中注册 Snapshot 备份，以便备份在 SAP HANA Studio 中可见，并可选择用于还原和恢复操作。</block>
  <block id="bbfb7e54dd17cf679279af8ea2a15ae3" category="paragraph">通过使用 NetApp SnapVault 软件，可以将在主存储上创建的 Snapshot 副本复制到由 SnapCenter 控制的二级备份存储。可以为主存储上的备份和二级存储上的备份定义不同的备份保留策略。适用于 SAP HANA 数据库的 SnapCenter 插件可管理基于 Snapshot 副本的数据备份和日志备份的保留，包括备份目录的管理。此外，适用于 SAP HANA 数据库的 SnapCenter 插件还可以通过执行基于文件的备份来对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="2b3606f8732f8e85cb223421eac6fc6d" category="paragraph"><block ref="2b3606f8732f8e85cb223421eac6fc6d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="467d52bc18a84a9e401464296b95f32a" category="paragraph">与基于文件的备份相比，基于存储的 Snapshot 备份具有显著优势。这些优势包括：</block>
  <block id="7be39960baf9da92a5fd16aff336d896" category="list-text">备份速度更快（几分钟）</block>
  <block id="e48202a443acc7da9527083f2193be67" category="list-text">存储层上的还原速度更快（几分钟）</block>
  <block id="0fc3856f751e6cb653d303821aef3541" category="list-text">备份期间不会影响 SAP HANA 数据库主机，网络或存储的性能</block>
  <block id="3228fe22c23747656168738709bc6bd1" category="paragraph">SAP HANA 灾难恢复可以通过 SAP 系统复制在数据库层执行，也可以通过存储复制技术在存储层执行。下一节概述了基于存储复制的灾难恢复解决方案。</block>
  <block id="a1714349685014d0362e5cbbd09f2c0b" category="paragraph">有关使用 SnapCenter 的 SAP HANA 灾难恢复解决方案的详细信息，请参见<block ref="b44c9af0a29f9fd7a04d2aec65a6c8ef" category="inline-link-rx"></block>。</block>
  <block id="ad3b35bfc8ee4f5dee91390584d5b8cd" category="paragraph">下图显示了一个三站点灾难恢复解决方案，它使用同步 SnapMirror 复制到本地灾难恢复数据中心，并使用异步 SnapMirror 将数据复制到远程灾难恢复数据中心。</block>
  <block id="1dc2152179d0df84f344742891cef88f" category="paragraph"><block ref="1dc2152179d0df84f344742891cef88f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c3a14b2b8a8f3abd4f577b36ff5a89d7" category="paragraph">下图简要展示了解决方案。每个站点上的存储集群均可提供本地高可用性，并用于生产工作负载。每个站点上的数据会同步复制到另一位置，并可在发生灾难故障转移时使用。</block>
  <block id="aca10306bdc23a799b23351ac5549b13" category="paragraph"><block ref="aca10306bdc23a799b23351ac5549b13" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1d4245f48f57ec79c6d5c5ccd3162922" category="paragraph"><block ref="1d4245f48f57ec79c6d5c5ccd3162922" category="inline-link-macro-rx"></block></block>
  <block id="7225f05095f2fe74910dbb5735f28299" category="paragraph"><block ref="7225f05095f2fe74910dbb5735f28299" category="inline-link-macro-rx"></block></block>
  <block id="766c3ec7b91d6121d225b55cf37f9e60" category="paragraph">如果尚未创建，则必须在 SAP HANA 主机上创建 `sapsys` 组。选择一个不与存储控制器上现有组 ID 冲突的唯一组 ID 。</block>
  <block id="96affa74630cd326f32e3a646b2bf9ad" category="admonition">所有 Linux 服务器和 SVM 上的 NFSv4 域必须设置为相同的值。在文件 ` /etc/idmapd.conf` 中为 Linux 主机设置域参数 `Domain = &lt;domain_name&gt;` 。</block>
  <block id="90c5b46276106ab7121fe824091fdfde" category="paragraph">启用并启动 NFS idmapd 服务：</block>
  <block id="82d9f02aa4638adac22e7bc4604d9e25" category="admonition">最新的 Linux 内核不需要执行此步骤。您可以安全地忽略警告消息。</block>
  <block id="f2892195957f717b3f05d41064d2250d" category="paragraph"><block ref="f2892195957f717b3f05d41064d2250d" category="inline-link-macro-rx"></block></block>
  <block id="434daaa9d4475e3659e87a54ca5a6295" category="paragraph"><block ref="434daaa9d4475e3659e87a54ca5a6295" category="inline-link-macro-rx"></block></block>
  <block id="0ac916d37bb0f520ee49c349a1fb6659" category="paragraph"><block ref="0ac916d37bb0f520ee49c349a1fb6659" category="inline-link-macro-rx"></block></block>
  <block id="fe772f1f05ae8cbd39b88886e4d0fcf5" category="summary">配置网络时，请遵循以下准则。</block>
  <block id="9b0a739a576f00afdef6129ac1e3013b" category="paragraph"><block ref="9b0a739a576f00afdef6129ac1e3013b" category="inline-link-macro-rx"></block></block>
  <block id="875a868e535d44216d12214375a99823" category="list-text">在 VMware 设置中，必须为每个正在运行的虚拟机分配专用 VMXNET3 网络适配器。查看中提及的相关文章 <block ref="d760bbf7570648527297b475f5b883a1" category="inline-link-macro-rx"></block> 以满足更多要求。</block>
  <block id="716afef9353a2aa423b9fbffb89b8377" category="paragraph">在存储层，配置了四个活动连接，可为每个 SAP HANA 主机提供 10 Gb 吞吐量。此外，还会在每个存储控制器上配置一个备用接口。</block>
  <block id="5004d67e74d74f4647f005bcd8841c16" category="paragraph"><block ref="5004d67e74d74f4647f005bcd8841c16" category="inline-image-macro-rx" type="image"></block></block>
  <block id="620672771873ad77b081be6daf96e1b2" category="paragraph">通常，也可以在服务器（绑定）和存储系统（例如链路聚合控制协议（ Link Aggregation Control Protocol ， LACP ）和 ifgroups ）上使用 HA 接口组。使用 HA 接口组，验证负载是否在组内的所有接口之间平均分布。负载分布取决于网络交换机基础架构的功能。</block>
  <block id="eabdde73a31467e22fe277441a349672" category="admonition">根据 SAP HANA 主机的数量和使用的连接速度，需要不同数量的活动物理端口。</block>
  <block id="f462972ec98ad35d3b6e515013a43ef9" category="paragraph">由于 SAP HANA 实例的所有数据（包括数据库的性能关键型数据和日志卷）均通过此解决方案中的 NFS 提供，因此正确的网络设计和配置至关重要。专用存储网络用于将 NFS 流量与 SAP HANA 节点之间的通信和用户访问流量分开。每个 SAP HANA 节点都需要一个冗余专用网络连接，带宽至少为 10 Gb 。此外，还支持更高的带宽。此网络必须通过网络交换和计算从存储层端扩展到端，直到 VMware vSphere 上托管的子操作系统为止。除了物理交换基础架构之外，还可以使用 VMware 分布式交换机（ VDS ）在虚拟机管理程序层为网络流量提供足够的性能和易管理性。</block>
  <block id="df3398ff3a0d523a63128a7ec386096f" category="paragraph">下图提供了网络概述。</block>
  <block id="1d20c677ea653cadb11e198f806f1b9f" category="paragraph"><block ref="1d20c677ea653cadb11e198f806f1b9f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="25c6d04f8538068cb7dacb7934148082" category="paragraph">每个 SAP HANA 节点都会在 VMware 分布式交换机上使用一个专用端口组。通过此端口组，可以在 ESX 主机上增强服务质量（ QoS ）并专用分配物理网络接口卡（ NIC ）。要在发生 NIC 故障时使用专用物理 NIC 并保留 HA 功能，专用物理 NIC 将配置为活动上行链路。其他 NIC 会在 SAP HANA 端口组的绑定和故障转移设置中配置为备用上行链路。此外，物理和虚拟交换机上必须端到端启用巨型帧（ MTU 9 ， 000 ）。此外，关闭服务器，交换机和存储系统上用于存储流量的所有以太网端口上的流量控制。下图显示了此类配置的一个示例。</block>
  <block id="360be069cd1171b76a16517180e58f5d" category="paragraph"><block ref="360be069cd1171b76a16517180e58f5d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="19a50fd857161a2e7389320f2ae234f2" category="paragraph"><block ref="19a50fd857161a2e7389320f2ae234f2" category="inline-link-macro-rx"></block></block>
  <block id="fe7a2cce203f9009f4435ee3db743d2f" category="summary">默认情况下， SAP HANA 在每个 SAP HANA 服务中仅使用一个数据卷。由于文件系统的最大文件大小限制， NetApp 建议限制最大数据卷大小。</block>
  <block id="a28520e00868027d025d2aaa3bdcc208" category="paragraph">这将在达到 8 ， 000 GB 限制后创建一个新的数据卷。<block ref="0d7b59f229b453865b91c5e952a7b217" category="inline-link-rx"></block> 提供了更多信息。</block>
  <block id="f54b24d13377be057e438977fe989589" category="paragraph"><block ref="f54b24d13377be057e438977fe989589" category="inline-link-macro-rx"></block></block>
  <block id="ae36d6b58fffa77bdfe0d08c2e56cf30" category="summary">从 SAP HANA 2.0 SPS4 开始，可以配置其他数据卷分区。通过此功能，您可以为 SAP HANA 租户数据库的数据卷配置两个或更多 LUN ，并可扩展到超出单个 LUN 的大小和性能限制。</block>
  <block id="347050b0ee6af8facb503abbf8ce92c2" category="doc">为 SAP HANA 单主机系统添加其他数据卷分区</block>
  <block id="a9d7c70849565bacbfda55d794bb4c7b" category="paragraph"><block ref="a9d7c70849565bacbfda55d794bb4c7b" category="inline-link-macro-rx"></block></block>
  <block id="b843f6375afb3db0cfb7caa278c6cde4" category="admonition">无需使用多个分区来实现 SAP HANA KPI 。具有单个分区的单个 LUN 可满足所需的 KPI 。</block>
  <block id="ac2de546fdfde82672b56ccdf9ca6d81" category="admonition">仅 SAP HANA 单主机系统可以为数据卷使用两个或更多个单独的 LUN 。SAP HANA 多主机系统所需的 SAP 存储连接器仅支持数据卷使用一个设备。</block>
  <block id="58c9cbe15952cf82eac3f861da23b041" category="paragraph">您可以随时添加更多数据卷分区，但可能需要重新启动 SAP HANA 数据库。</block>
  <block id="c18741487d69f1af9206f4577e19dbc1" category="paragraph">要启用其他数据卷分区，请完成以下步骤：</block>
  <block id="b35b93682ba2c90dfcdb9d223fe9a37f" category="list-text">在 `global.ini` 文件中添加以下条目：</block>
  <block id="f6a6e9954258aa0392a80c08caf1ff27" category="list-text">重新启动数据库以启用此功能。使用 SYSTEMDB 配置通过 SAP HANA Studio 将参数添加到 `global.ini` 文件中可阻止重新启动数据库。</block>
  <block id="1696d347b6aa4302eae1d97bae40de76" category="section-title">卷和 LUN 配置</block>
  <block id="5ffce73a813932a4b86f329f6b66a796" category="paragraph">卷和 LUN 的布局与具有一个数据卷分区的单个主机的布局类似，但附加数据卷和 LUN 作为日志卷存储在另一个聚合上，而另一个数据卷则存储在另一个聚合上。下表显示了具有两个数据卷分区的 SAP HANA 单主机系统的配置示例。</block>
  <block id="c9ed70b94b01f7131a326f6bae3eff65" category="paragraph">下表显示了具有两个数据卷分区的单主机系统的挂载点配置示例。</block>
  <block id="b26e74ed6e2892c7e2bb95e414d460c6" category="cell">LUN</block>
  <block id="649c9030e92d8cd4b009650fea137825" category="cell">已使用 /etc/fstab 条目挂载</block>
  <block id="72097bd4370b0b19d48c67e981158544" category="paragraph">使用 ONTAP 系统管理器或 ONTAP 命令行界面创建新的数据 LUN 。</block>
  <block id="8c74ac3f77233a64ddd5171869c51c2a" category="paragraph">要配置主机，请完成以下步骤：</block>
  <block id="d9fec5dcb66d8fefe671f1719e1ee97d" category="list-text">为其他 LUN 配置多路径，如第 0 节所述。</block>
  <block id="a81a698c2f4b08044a08db7d32e1af81" category="list-text">在属于 HANA 系统的每个附加 LUN 上创建 XFS 文件系统。</block>
  <block id="f255815987a5727cdc75e965673dc603" category="list-text">将其他文件系统添加到 ` /etc/fstab` 配置文件中。</block>
  <block id="ab129d4dcc57fb1586e0730518f15ee9" category="admonition">必须使用 `relatime` 和 `inode64` 挂载选项挂载数据 LUN 的 XFS 文件系统。日志 LUN 的 XFS 文件系统必须使用 `relatime` ， `inode64` 和 `nodarrier` 挂载选项进行挂载。</block>
  <block id="88717870e2f46492c2e9147aafeac98f" category="list-text">创建挂载点并在数据库主机上设置权限。</block>
  <block id="beb45bc6e1a41c7a0a9e399cd74843b5" category="section-title">添加额外的数据卷分区</block>
  <block id="07a78873f27afab791279f5d19e3f88c" category="paragraph">要向租户数据库添加额外的数据卷分区，请完成以下步骤：</block>
  <block id="9b76b6c583544a2f5372da2ae89b54d5" category="list-text">对租户数据库执行以下 SQL 语句。每个附加 LUN 可以具有不同的路径。</block>
  <block id="02c3c24b1240e860b5773437fc8e6de8" category="paragraph"><block ref="02c3c24b1240e860b5773437fc8e6de8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e16c7e502dd2e29460ff6cbd37824070" category="paragraph"><block ref="e16c7e502dd2e29460ff6cbd37824070" category="inline-link-macro-rx"></block></block>
  <block id="a1f3bfe21fa4a014b71cdb6f5c22ed48" category="summary">NetApp FAS 产品系列已通过认证，可在定制数据中心集成（ TDI ）项目中与 SAP HANA 结合使用。经过认证的企业级存储系统采用 NetApp ONTAP 软件的特征。</block>
  <block id="ea2a5017e6cdb7eff470cc58152d6c96" category="doc">TR-4290 ：《采用 NFS 配置的 NetApp FAS 系统上的 SAP HANA 》指南</block>
  <block id="3ba2c0f2dd07fd36730e20b6bcba3d0a" category="paragraph">此认证目前仅适用于以下型号：</block>
  <block id="ae9c01e101eba86b0e6ff092df062fae" category="inline-link">经过认证并受支持的 SAP HANA 硬件目录</block>
  <block id="319205843b22e5ac2d3a538e9da3a938" category="list-text">FAS2720 ， FAS2750 ， FAS8300 ， FAS8700 和 FAS9000A 有关适用于 SAP HANA 的 NetApp 认证存储解决方案的完整列表，请参见<block ref="1f1391b4a4e3510e52fedc44ebc619dc" category="inline-link-rx"></block>。</block>
  <block id="b4c89f05de6c3fe24965b0e343289e75" category="paragraph">本文档介绍了 NFS 版本 3 （ NFSv3 ）协议或 NFS 版本 4 （ NFSv4.0 和 NFSv4.1 ）协议的 ONTAP 配置要求。在本文档的其余部分中， NFSv4 既指 NFSv4.0 ，也指 NFSv4.1 。</block>
  <block id="134a6ecca2c7d98e325ad00ee461d25a" category="admonition">要为 SAP HANA 实现所需的 SAP HANA KPI 和最佳性能，必须采用本文所述的配置。更改任何设置或使用本文未列出的功能可能会导致发生原因性能下降或出现意外行为，只有在 NetApp 支持人员建议的情况下，才应执行此操作。</block>
  <block id="c79fca4f33a4c23e62509e315c7a3415" category="paragraph">有关使用 FCP 的 NetApp FAS 系统以及使用 NFS 或 FC 的 AFF 系统的配置指南，请访问以下链接：</block>
  <block id="90a239e164a24bfe58142290491d6a2c" category="paragraph">对于不具有主机自动故障转移功能的 SAP HANA 单主机系统或多个主机，支持 NFSv3 和 NFSv4 。</block>
  <block id="97e382ecf7e6f1064476764cbcc5b429" category="cell">NFS 版本</block>
  <block id="63bed36f11f7ad7653116b5a06c528d7" category="cell">NFS 锁定</block>
  <block id="1aa0b40b5a76a1d683cb73122ad91018" category="cell">SAP HANA HA/DR 提供程序</block>
  <block id="1d753a89bf8a361dbe3f6356d640806b" category="cell">SAP HANA 多个主机，具有主机自动故障转移功能</block>
  <block id="6b576fbe1d4469d95e2d87dc73f75226" category="inline-link">SAP 注释 2235581 ： SAP HANA 支持的操作系统</block>
  <block id="9321b95e47f982056a8fbe2dbfe57bc0" category="admonition">有关操作系统配置准则和特定于 HANA 的 Linux 内核依赖关系，请始终参考相关 SAP 注释。有关详细信息，请参见<block ref="731cf6347f8c9e1ff069ebd907984a5f" category="inline-link-rx"></block>。</block>
  <block id="fdb63fa26dfca812f4f453ca18a829c7" category="section-title">SAP HANA 量身定制的数据中心集成</block>
  <block id="c2798d82f6c464fd30d247919005bc5b" category="paragraph">NetApp FAS 存储控制器已通过 SAP HANA TDI 计划的认证，并同时使用 NFS （ NAS ）和 FC （ SAN ）协议。它们可以部署在任何当前 SAP HANA 方案中，例如采用单主机或多主机配置的基于 HANA 的 SAP Business Suite ， S/4HANA ， BB/4HANA 或基于 HANA 的 SAP Business Warehouse 。任何经认证可与 SAP HANA 结合使用的服务器均可与 NetApp 认证的存储解决方案结合使用。有关架构概述，请参见下图。</block>
  <block id="780627a969a9ecaba83ec1a8ad4e34f6" category="paragraph"><block ref="780627a969a9ecaba83ec1a8ad4e34f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c57f9f1ae5801f0d8675d5d2053fbac7" category="paragraph">有关生产 SAP HANA 系统的前提条件和建议的详细信息，请参见以下 SAP 资源：</block>
  <block id="cd67947f6f1984974a5e507afaa2222d" category="paragraph">可以通过多种方法将存储连接到虚拟机（ VM ）。首选方法是，将具有 NFS 的存储卷直接从子操作系统中连接起来。使用此选项时，物理主机和 VM 之间的主机和存储配置不会有所不同。</block>
  <block id="3e0badc46d16811661a7977c8991b3ea" category="paragraph">此外，还支持 NFS 数据存储库或采用 NFS 的 VVol 数据存储库。对于这两个选项，数据存储库中只能存储一个 SAP HANA 数据或日志卷，以用于生产用例。此外，无法实施由 SnapCenter 协调的基于 Snapshot 副本的备份和恢复，以及基于此操作的解决方案，例如 SAP 系统克隆。</block>
  <block id="41f8d362e2484ed69d1a57c66be636dc" category="paragraph"><block ref="41f8d362e2484ed69d1a57c66be636dc" category="inline-link-macro-rx"></block></block>
  <block id="a3bc23f60d8778684d75db7b4d688fae" category="summary">本节介绍 NetApp 存储系统的配置。您必须根据相应的 Data ONTAP 设置和配置指南完成主安装和设置。</block>
  <block id="1f9b6cb5e6465cc0b4cd03f573daa750" category="paragraph"><block ref="1f9b6cb5e6465cc0b4cd03f573daa750" category="inline-link-macro-rx"></block></block>
  <block id="429f30a2f19f5542c01260900f1268d8" category="paragraph">QoS 可用于限制共享控制器上特定 SAP HANA 系统或非 SAP 应用程序的存储吞吐量。其中一个使用情形是，限制开发和测试系统的吞吐量，使其不会影响混合环境中的生产系统。</block>
  <block id="dc8101343408623d860369896b9691df" category="paragraph">您可以在 FabricPool 或 SnapMirror 目标等备份目标上使用仅 Snapshot 分层策略和 SnapVault 。</block>
  <block id="0b70acc9e842036e1675b7fd08e43ff6" category="admonition">使用 FabricPool 在主存储上分层 Snapshot 副本或在备份目标上使用 FabricPool 会更改还原和恢复数据库或执行其他任务（例如创建系统克隆或修复系统）所需的时间。在规划整个生命周期管理策略时，请考虑此因素，并检查以确保在使用此功能时仍符合 SLA 。</block>
  <block id="2ac3f8b0b798078f242ae9b0249081bc" category="paragraph">FabricPool 是将日志备份移动到另一存储层的理想选择。移动备份会影响恢复 SAP HANA 数据库所需的时间。因此，选项 `tiering-minimum-cooling-days` 应设置为一个值，用于在本地快速存储层上放置恢复所需的日志备份。</block>
  <block id="d25223f4065ca21361aff2e7cdc61203" category="section-title">配置存储</block>
  <block id="c2cd71459709a9b877c06b5e5f772f9d" category="paragraph">以下概述总结了所需的存储配置步骤。后续章节将更详细地介绍每个步骤。在本节中，我们假定已设置存储硬件，并且已安装 ONTAP 软件。此外，必须已将存储 FCP 端口连接到 SAN 网络结构。</block>
  <block id="5130b49486508cbe5c2d0b023d415091" category="list-text">检查磁盘架配置是否正确，如 "<block ref="039cb3f1d3f19b24b2d3e1a57595e88d" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="5ed0e891e8b990c7168739eb02edd6a3" category="list-text">创建并配置所需的聚合，如 "<block ref="19f0aba2b822910f53ba3966ee7c8d59" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="f9a28c46fbd1f4dfd78367e2b160714f" category="list-text">创建 Storage Virtual Machine （ SVM ），如 "<block ref="7c58f6887f41bcea1635c2c18a7a4529" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="9629532b191c2dfd3156fe8e116bbe3b" category="list-text">创建逻辑接口（ LIF ），如 "<block ref="fc903155b67a1626f9032f79a26da71f" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="a8d79b07ead85e8a39ae801f57769490" category="list-text">创建端口集，如 "<block ref="8a161b601c7edc91c1d11775d753aa89" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="e09571c79b9e2d4f7af651ed139e8851" category="list-text">在聚合中创建启动程序组，卷和 LUN ，如创建 "<block ref="7d89099fa8cd9005cadad1d85b39ea01" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="2630ee9d2d6404a0be197b5cefef0514" category="section-title">SAS-based 磁盘架</block>
  <block id="678c0ed398bb044c2e5a9c21044b8bf5" category="paragraph">最多可以将一个磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须在 HA 对的两个控制器之间平均分布。ADPv2 可用于 ONTAP 9 和新的 DS224C 磁盘架。</block>
  <block id="e43c25c02ef0e36b49921f6074b8af67" category="paragraph"><block ref="e43c25c02ef0e36b49921f6074b8af67" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dd253c07b5e479b9a57c4dff19990513" category="section-title">基于 NVMe （ 100GbE ）的磁盘架</block>
  <block id="ffd4979e43c842f7c83880611de780c8" category="paragraph">每个 NS224 NVMe 桌面架都通过每个控制器的两个 100GbE 端口进行连接，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。NS224 磁盘架也使用 ADPv2 。</block>
  <block id="c744675c9c2fab81c22b8e35d23e8ee6" category="paragraph"><block ref="c744675c9c2fab81c22b8e35d23e8ee6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="825e04b1728be563d50e2a0cc23bf6ca" category="paragraph">通常，您必须为每个控制器配置两个聚合，而与使用的磁盘架或磁盘技术（ SSD 或 HDD ）无关。要使用所有可用的控制器资源，必须执行此步骤。对于 AFF A200 系列系统，一个数据聚合就足以满足要求。</block>
  <block id="e4138b69e5e67fa3fd2dd44df6e94489" category="paragraph"><block ref="e4138b69e5e67fa3fd2dd44df6e94489" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9edbcb82e27829dd83ad8ddf87b121c5" category="paragraph">如果在创建新 SVM 时自动创建和分配了 QoS 配置文件，请从 SVM 中删除此自动创建的配置文件，以确保 SAP HANA 具有所需的性能：</block>
  <block id="5d32d4572d40717acaf8b9ef008f4901" category="paragraph">在存储集群配置中，必须创建一个网络接口（ LIF ）并将其分配给一个专用 FCP 端口。例如，如果出于性能原因需要四个 FCP 端口，则必须创建四个 LIF 。下图显示了在 `HANA` SVM 上配置的八个 LIF （名为 `fc_*` ）的屏幕截图。</block>
  <block id="63e3a8e678ddbe12b94ea1a05a98b472" category="paragraph"><block ref="63e3a8e678ddbe12b94ea1a05a98b472" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ad0e46aa05fcef2f37453adf0ef136ec" category="paragraph">在使用 ONTAP 9.8 System Manager 创建 SVM 期间，您可以选择所有所需的物理 FCP 端口，并自动为每个物理端口创建一个 LIF 。</block>
  <block id="dbda75d2303e00e563851e4f527aaeef" category="paragraph"><block ref="dbda75d2303e00e563851e4f527aaeef" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fd32c02d4b7251741240b397ff65496a" category="section-title">FCP 端口集</block>
  <block id="934baa69e76d9725b7833c87e6c67cba" category="paragraph">FCP 端口集用于定义特定启动程序组要使用的 LIF 。通常，为 HANA 系统创建的所有 LIF 都置于同一端口集中。下图显示了一个名为 32g 的端口集的配置，其中包括已创建的四个 LIF 。</block>
  <block id="9c49ea22aed185f972e4e15cfd0fa2e8" category="paragraph"><block ref="9c49ea22aed185f972e4e15cfd0fa2e8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ba21da193047a8b196b8513f3735ad5c" category="admonition">在 ONTAP 9.8 中，不需要端口集，但可以通过命令行创建和使用该端口集。</block>
  <block id="3dc0bb550ffeb410b2cbe908abda2020" category="section-title">SAP HANA 单主机系统的卷和 LUN 配置</block>
  <block id="2cd30dd459c96f8423572cfd0315dd72" category="paragraph">下图显示了四个单主机 SAP HANA 系统的卷配置。每个 SAP HANA 系统的数据卷和日志卷会分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID1_data_mnt00001` ，在控制器 B 上配置了卷 `SID1_log_mnt00001`在每个卷中，会配置一个 LUN 。</block>
  <block id="a2ab47e506561509501f3015dfd353bb" category="admonition">如果 SAP HANA 系统仅使用 HA 对中的一个存储控制器，则数据卷和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="87186ba3f48a6da40eb2c0ef1cf71bff" category="paragraph"><block ref="87186ba3f48a6da40eb2c0ef1cf71bff" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4a6aff734b6925db0b295309b406bb09" category="paragraph">对于每个 SAP HANA 主机，都会为 ` 或 HANA 或 Shared` 配置一个数据卷，一个日志卷和一个卷。下表显示了一个使用四个 SAP HANA 单主机系统的配置示例。</block>
  <block id="bf2694976353bf0fd87866d930f0f42d" category="paragraph">下表显示了单主机系统的挂载点配置示例。</block>
  <block id="aaef8ff6bbc08e9efaddebd078c4777c" category="cell">SID1_data_mnt00001</block>
  <block id="6ae93bb41469fd4a9d5c05c492392242" category="cell">/ha/data/SID1/mnt00001</block>
  <block id="eedd0dd4abbe982364bb7aa4dc29237b" category="cell">SID1_LOG_mnt00001</block>
  <block id="867844c1d35f4b67a56a71e776d4a8ad" category="cell">/ha/log/SID1/mnt00001</block>
  <block id="ab07e4bbf6e507a26a731683320de6e3" category="cell">SID1_shared</block>
  <block id="d8ee68f6803fad6b40fde1bf30891d5c" category="cell">/has/shared/SID1</block>
  <block id="f26f6073b7776e8f86f6bf13d02a97ca" category="admonition">按照所述配置，存储用户 SID1adm 默认主目录的 ` /usr/sap/SID1` 目录位于本地磁盘上。在采用基于磁盘的复制的灾难恢复设置中， NetApp 建议在 `SID1_shared` 卷中为 ` /usr/sap/sid1` 目录创建一个额外的 LUN ，以便所有文件系统都位于中央存储上。</block>
  <block id="8d4e658f528a31efe4237fe11774716f" category="section-title">使用 Linux LVM 为 SAP HANA 单主机系统配置卷和 LUN</block>
  <block id="4f2eb711021dab33e5ff7c3395979045" category="paragraph">Linux LVM 可用于提高性能并解决 LUN 大小限制。LVM 卷组中的不同 LUN 应存储在不同的聚合和不同的控制器中。下表显示了每个卷组两个 LUN 的示例。</block>
  <block id="bf2b73e5a1069f54823f3690829c44f7" category="admonition">无需将 LVM 与多个 LUN 结合使用即可实现 SAP HANA KPI 。单个 LUN 设置可满足所需的 KPI 要求。</block>
  <block id="50c8a736d0d7665eb46c9696d32e54b3" category="cell">基于 LVM 的系统的数据，日志和共享卷</block>
  <block id="e419668a145069bd5df27d1d94e5bf5a" category="cell">共享卷： SID1_shared log2 卷： SID1_log2_mnt00001</block>
  <block id="c5a46bab63449b2e1afaed056128e704" category="cell">Data2 卷： SID1_data2_mnt00001</block>
  <block id="f077106d32b9bc50fe9eeac1cd3d7c18" category="paragraph">在 SAP HANA 主机上，需要创建和挂载卷组和逻辑卷，如下表所示。</block>
  <block id="20c772a627871f53550c990cac40e436" category="cell">逻辑卷 /LUN</block>
  <block id="4dbf191e4ed6b7c6ecc5f37903313222" category="cell">LV ： SID1_data_mnt0000-vol</block>
  <block id="45cf28b4bb0bed9fa061ae20911813ad" category="cell">LV ： SID1_LOG_mnt00001-vol</block>
  <block id="0a0eb6344c43262455dfef7dd783c9a2" category="cell">LUN ： SID1_shared</block>
  <block id="b25b558581b55b9f2fe2ef166b8c7153" category="section-title">SAP HANA 多主机系统的卷和 LUN 配置</block>
  <block id="6b7ff1a28666a16440c8c6ea6637d7a5" category="paragraph">下图显示了 4+1 多主机 SAP HANA 系统的卷配置。每个 SAP HANA 主机的数据卷和日志卷会分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID_data_mnt00001` ，在控制器 B 上配置了卷 `SID_log_mnt00001`每个卷都配置了一个 LUN 。</block>
  <block id="159562ba9c8d36ce5afba352e4de35a9" category="paragraph">所有 HANA 主机都必须能够访问 ` /HANA / 共享` 卷，因此可以使用 NFS 导出此卷。即使对于 ` /ha/shared` 文件系统没有特定的性能 KPI ， NetApp 建议使用 10 Gb 以太网连接。</block>
  <block id="11862afda87479323583a609effa0913" category="admonition">如果 SAP HANA 系统仅使用 HA 对中的一个存储控制器，则数据和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="453b8497395d5bbd79a0c8e798f0c9cc" category="admonition">NetApp ASA AFF 系统不支持 NFS 协议。NetApp 建议为 ` /ha/shared` 文件系统使用额外的 AFF 或 FAS 系统。</block>
  <block id="5e50a0efca4cb187b06b12d337775e73" category="paragraph"><block ref="5e50a0efca4cb187b06b12d337775e73" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f4674e3b297184ff65e01cfe3e66e78c" category="paragraph">对于每个 SAP HANA 主机，系统会创建一个数据卷和一个日志卷。` HANA 系统的所有主机都使用` /hana / 共享 卷。下表显示了 4+1 多主机 SAP HANA 系统的配置示例。</block>
  <block id="8bb34960315f3235a2496b26df78d447" category="paragraph">下表显示了具有四个活动 SAP HANA 主机的多主机系统的配置和挂载点。</block>
  <block id="18eff1c18c750a16e21791332618bb66" category="cell">LUN 或卷</block>
  <block id="0afec29b8027d3f045fedf178d620337" category="cell">LUN ： SID_data_mnt00001</block>
  <block id="0295216fc17b8b84178853eef4b264c9" category="cell">使用存储连接器挂载</block>
  <block id="3598df8aff573874a41c3383272e1be8" category="cell">LUN ： sid_log_mnt00001</block>
  <block id="ffeef75de08f2bf3ae65edc9f2fefdd3" category="cell">LUN ： SID_data_mnt00002</block>
  <block id="5a9c6a41898da03d863b855e51215c74" category="cell">LUN ： sid_log_mnt00002</block>
  <block id="f4ea076d315fa65da2bc595e9aa84d32" category="cell">LUN ： SID_data_mnt00003</block>
  <block id="0a3a86cff137cfa7fef2f6b7347b6a19" category="cell">LUN ： sid_log_mnt00003</block>
  <block id="f946b7889ddc57388b641916a63b4fe2" category="cell">LUN ： SID_data_mnt00004</block>
  <block id="11b774b700c0644e1f4311df2fcb05be" category="cell">LUN ： sid_log_mnt00004</block>
  <block id="b7db253f6e3bac8aad3ab6a0941fb70d" category="cell">卷： sid_shared</block>
  <block id="7e81644459f05c7fe5ef716463a0b0fd" category="cell">使用 NFS 和 /etc/fstab 条目挂载在所有主机上</block>
  <block id="3e7047d2bf94461f14196805112df4f5" category="admonition">在所述配置中，存储用户 SIDadm 默认主目录的 ` /usr/sap/SID` 目录位于每个 HANA 主机的本地磁盘上。在采用基于磁盘的复制的灾难恢复设置中， NetApp 建议在 `SID_shared` 卷中为 ` /usr/sap/SID` 文件系统另外创建四个子目录，以便每个数据库主机的所有文件系统都位于中央存储上。</block>
  <block id="c054b3fc8b39c77b600c774805522378" category="section-title">使用 Linux LVM 为 SAP HANA 多主机系统配置卷和 LUN</block>
  <block id="fb98d6eb62d89d96b064be4fe17f583e" category="paragraph">Linux LVM 可用于提高性能并解决 LUN 大小限制。LVM 卷组中的不同 LUN 应存储在不同的聚合和不同的控制器中。</block>
  <block id="3ba3509b7579ef045ff4c77476c7cf11" category="admonition">无需使用 LVM 组合多个 LUN 即可实现 SAP HANA KPI 。单个 LUN 设置可满足所需的 KPI 要求。</block>
  <block id="f7be036cddf21af55fc52689e1f3055b" category="paragraph">下表显示了 2+1 SAP HANA 多主机系统中每个卷组两个 LUN 的示例。</block>
  <block id="4d9935e6cd83034a64b5ac62866a0738" category="cell">log2 卷： sid_log2_mnt00001</block>
  <block id="ce92b52ec6796984f134f3d663d31dd9" category="cell">log2 卷： sid_log2_mnt00002</block>
  <block id="120bb07a74c62db6e646c3e4c6894343" category="cell">逻辑卷（ LV ）或卷</block>
  <block id="e0aca5a9c63604d53aca20804da97330" category="cell">LV ： sid_data_mnt00001-vol</block>
  <block id="e865dd471095d94a2e4b63c8a0f33860" category="cell">LV ： sid_log_mnt00001-vol</block>
  <block id="711212cf75d514aac51d33222c3265b1" category="cell">LV ： sid_data_mnt00002-vol</block>
  <block id="57d1d1afeed57e5be9d3694589233736" category="cell">LV ： sid_log_mnt00002-vol</block>
  <block id="941ad2feba868268ee283fe1886c4440" category="paragraph">下表中列出的卷选项必须在所有 SVM 上进行验证和设置。</block>
  <block id="b9c48200eb9eba714e3c88803e97b4ce" category="section-title">创建 LUN ，卷并将 LUN 映射到启动程序组</block>
  <block id="c2e3c2f5e5887a87fcfac0e555a07a70" category="paragraph">您可以使用 NetApp ONTAP System Manager 创建存储卷和 LUN 并将其映射到服务器。</block>
  <block id="092e6a6bc4923c6cfc72d214ce390535" category="paragraph">NetApp 在 ONTAP System Manager 9.7 及更早版本中为 SAP HANA 提供了自动化应用程序向导，从而显著简化了卷和 LUN 配置过程。它会根据适用于 SAP HANA 的 NetApp 最佳实践自动创建和配置卷和 LUN 。</block>
  <block id="0c71c668e5ae926e6d75aa8bbbc09dd2" category="paragraph">使用 `sanlun` 工具，运行以下命令以获取每个 SAP HANA 主机的全球通用端口名称（ WWPN ）：</block>
  <block id="a86be254d15f1254d56b97c8755a5b77" category="admonition">`sanlun` 工具是 NetApp Host Utilities 的一部分，必须安装在每个 SAP HANA 主机上。有关详细信息，请参见 "host_setup" 一节。</block>
  <block id="3b02abc3a7dd4095cd8ef946e6bd6dd0" category="paragraph">以下步骤显示了使用 SID SS3 配置 2+1 多主机 HANA 系统的过程：</block>
  <block id="ce30bd2bdaee34467dfdf55ea753e7ba" category="list-text">在 System Manager 中启动适用于 SAP HANA 的应用程序配置向导并提供所需信息。必须添加所有主机中的所有启动程序（ WWPN ）。</block>
  <block id="c0ec03bcc3c02ac27f38d7a9a9006119" category="paragraph"><block ref="c0ec03bcc3c02ac27f38d7a9a9006119" category="inline-image-macro-rx" type="image"></block></block>
  <block id="16307583508372b498160c0e90dba4d0" category="list-text">确认已成功配置存储。</block>
  <block id="4b0625f3aca586969c59b852475f2422" category="paragraph"><block ref="4b0625f3aca586969c59b852475f2422" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8c4751bd2d7d17062a8b536388ba69bc" category="section-title">使用 CLI 创建 LUN ，卷并将 LUN 映射到启动程序组</block>
  <block id="6204c72c80408db453e7fea0b62d2e36" category="paragraph">本节显示了一个使用命令行和 ONTAP 9.8 的示例配置，该配置适用于 2+1 SAP HANA 多主机系统，其中 SID 为 FC5 ，使用 LVM ，每个 LVM 卷组具有两个 LUN ：</block>
  <block id="c48caf1c739d7975abd91d926cd56982" category="list-text">创建所有必要的卷。</block>
  <block id="8e5c1549db5f0e31853b6809f7049388" category="list-text">创建所有 LUN 。</block>
  <block id="d595b9142c1fd0d3ea19c8cd10165661" category="list-text">为属于系统 FC5 的所有服务器创建启动程序组。</block>
  <block id="f987b1e962233a1893b72bf1d65f3a21" category="list-text">将所有 LUN 映射到已创建的启动程序组。</block>
  <block id="205bb1f808e2c005f87dc92e8069a9f9" category="inline-link-macro">接下来： SAP HANA 存储连接器 API 。</block>
  <block id="c06e9c01610fdbe23333da6234682c21" category="paragraph"><block ref="c06e9c01610fdbe23333da6234682c21" category="inline-link-macro-rx"></block></block>
  <block id="47c97f5b5374f82578ea21329859f8cb" category="summary">只有具有故障转移功能的多主机环境才需要存储连接器。</block>
  <block id="4980e2208f9643bc9c7f1d464f4be387" category="paragraph"><block ref="4980e2208f9643bc9c7f1d464f4be387" category="inline-link-macro-rx"></block></block>
  <block id="7a22a81622f7d339ee9037f01614a95e" category="paragraph">在采用 NetApp 存储的 SAP HANA 多主机配置中，使用 SAP 提供的标准存储连接器。《 SAP HANA FC 存储连接器管理指南》可作为的附件找到<block ref="fb03c315acf5bdf850546480c01e7306" category="inline-link-rx"></block>。</block>
  <block id="7a6d6ee33360204901e8acd302ee01b7" category="paragraph"><block ref="7a6d6ee33360204901e8acd302ee01b7" category="inline-link-macro-rx"></block></block>
  <block id="38b9ce28746b740067bec85a2b293e2a" category="paragraph"><block ref="38b9ce28746b740067bec85a2b293e2a" category="inline-link-macro-rx"></block></block>
  <block id="0d3eab0b9e96ff06837e191b39218d16" category="paragraph">不支持在 HDD 配置中启用存储效率功能。</block>
  <block id="908c5fb32cc42e93096371afa23e0dce" category="paragraph">SAP HANA 支持使用 NetApp 卷加密（ NVE ）。</block>
  <block id="e2a82c831a3a4651879482e858053e83" category="paragraph">QoS 可用于限制特定 SAP HANA 系统的存储吞吐量。其中一个使用情形是，限制开发和测试系统的吞吐量，使其不会影响混合环境中的生产系统。</block>
  <block id="6897ebb03b24bb6d57001cdf55ad2d30" category="paragraph">在规模估算过程中，必须确定非生产系统的性能要求。开发和测试系统的规模可以使用较低的性能值进行调整，通常在生产系统的 20% 到 50% 范围内。</block>
  <block id="8469b8e3a88a77acf02664f233b3cb72" category="paragraph">从 ONTAP 9 开始， QoS 会在存储卷级别进行配置，并使用最大吞吐量值（ MBps ）和 I/O 数（ IOPS ）。</block>
  <block id="0df676e828d9cc9486e1b8e0aaf1b692" category="paragraph">可以使用 " 仅快照 " 分层策略，也可以在 SnapVault 或 SnapMirror 目标等备份目标上使用 FabricPool 。</block>
  <block id="5a5237a6a98f8795e5ef541300be3602" category="admonition">使用 FabricPool 在主存储上分层 Snapshot 副本或在备份目标上使用 FabricPool 会更改还原和恢复数据库或执行其他任务（例如创建系统克隆或修复系统）所需的时间。在规划整个生命周期管理策略时，请考虑这一点，并检查以确保在使用此功能时仍符合 SLA 要求。</block>
  <block id="562283819997e7573d7ef1bcd25f02e9" category="paragraph">以下概述总结了所需的存储配置步骤。后续章节将更详细地介绍每个步骤。在启动这些步骤之前，请完成存储硬件设置， ONTAP 软件安装以及存储 FCP 端口与 SAN 网络结构的连接。</block>
  <block id="2cb20ba4c0eb0eb9f98e21ec7aca47f3" category="list-text">检查正确的 SAS 堆栈配置，如一节所述 <block ref="7f61bd8ed95dde5d117ac18e531c2392" category="inline-link-macro-rx"></block></block>
  <block id="3e99cd10c9ef85534f3816fe698acf36" category="list-text">创建和配置所需的聚合，如一节所述 <block ref="1eb0235695db5698c097351f88f0747b" category="inline-link-macro-rx"></block></block>
  <block id="e8bb33c4475cdd668aa10b272a23134c" category="list-text">按照一节中所述创建 Storage Virtual Machine （ SVM ） <block ref="d13b32bfc05b789abfa54d62f28177c3" category="inline-link-macro-rx"></block></block>
  <block id="e8edc3c35ca6d470bb586a19c4ba2a77" category="list-text">按照一节中所述创建逻辑接口（ LIF ） <block ref="304794730509f6f33e41081c9ea9ada6" category="inline-link-macro-rx"></block></block>
  <block id="247671c13d2daa0ebab96556f7a23c0f" category="inline-link-macro">FCP 端口集。</block>
  <block id="0641e7ab6ca260dd1687ed64f731567d" category="list-text">按照一节中所述创建 FCP 端口集 <block ref="80e993b4c7204adfd3e99dcfc8b61878" category="inline-link-macro-rx"></block></block>
  <block id="eb0ef7e6e2bb01610d7af0b64d45f273" category="inline-link-macro">启动程序组。</block>
  <block id="f737bc3e8b1df8cd01c46b1f8bad3991" category="list-text">按照一节中所述，使用 HANA 服务器的全球通用名称（ WWN ）创建启动程序组（ igroup ） <block ref="3616ae8884995c0f6d38b378a7c408ce" category="inline-link-macro-rx"></block></block>
  <block id="5480184205f8be2fc64d333da844de90" category="inline-link-macro">SAP HANA 多主机系统的卷和 LUN 配置。</block>
  <block id="2c6aedb572dccc5a20423edb6df1e593" category="list-text">在聚合中创建卷和 LUN ，如一节所述 <block ref="19ba03664bebb02274f7bd74909fcde5" category="inline-link-macro-rx"></block> 和 <block ref="8ca29b6ed94f0b5f4fd7893d15f21ff7" category="inline-link-macro-rx"></block></block>
  <block id="3ec81a85833bda4fffc5c50530445ae6" category="paragraph"><block ref="3ec81a85833bda4fffc5c50530445ae6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b7483c1a479d4fef5cff97bd81ff277b" category="paragraph">使用 SSD 时，最多可以将一个磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。对于 DS224C 磁盘架，也可以使用四路径 SAS 布线，但这并不是必需的。</block>
  <block id="24666215417a3ffbd3f159e7ba272fce" category="paragraph"><block ref="24666215417a3ffbd3f159e7ba272fce" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fbd0736dc070b8c1ab4ca37b6ff6a1c2" category="paragraph">通常，您必须为每个控制器配置两个聚合，而与使用的磁盘架或磁盘技术（ SSD 或 HDD ）无关。要使用所有可用的控制器资源，必须执行此步骤。对于 FAS 2000 系列系统，一个数据聚合就足够了。</block>
  <block id="4dbfb6fc1fad978fe823c81135c5d729" category="paragraph"><block ref="4dbfb6fc1fad978fe823c81135c5d729" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5739a58e7053e7fb6bd6f313b759b5fd" category="paragraph">通常，每个控制器必须配置两个聚合，而与使用的磁盘架或磁盘技术（ SSD 或 HDD ）无关。对于 FAS2000 系列系统，一个数据聚合就足够了。</block>
  <block id="810f50c02d5c156c295a67dc16b23b09" category="paragraph"><block ref="810f50c02d5c156c295a67dc16b23b09" category="inline-image-macro-rx" type="image"></block></block>
  <block id="15780b309192b18b065fdcb3276b82b6" category="paragraph">采用 SAP HANA 数据库的多主机 SAP 环境可以使用一个 SVM 。如果需要，还可以为每个 SAP 环境分配一个 SVM ，以使其由公司内的不同团队进行管理。本文档中的屏幕截图和命令输出使用名为 `HANA` 的 SVM 。</block>
  <block id="e9fc49c5c730458783a8ccd4b98a94c5" category="paragraph">在存储集群配置中，必须创建一个网络接口（ LIF ）并将其分配给一个专用 FCP 端口。例如，如果出于性能原因需要四个 FCP 端口，则必须创建四个 LIF 。下图显示了在 `HANA` SVM 上配置的四个 LIF （名为 `fc_* ）` 的屏幕截图。</block>
  <block id="cce9ca65b2d2613c9a80ec3d7050ce87" category="paragraph"><block ref="cce9ca65b2d2613c9a80ec3d7050ce87" category="inline-image-macro-rx" type="image"></block></block>
  <block id="34cf3cce20e89b361817cb8171e434a6" category="paragraph">在使用 ONTAP 9.8 System Manager 创建 SVM 期间，可以选择所有必需的物理 FCP 端口，并自动为每个物理端口创建一个 LIF 。</block>
  <block id="d5b418c423bd08ad0961e2eb57962d5a" category="paragraph">下图展示了使用 ONTAP 9.8 System Manager 创建 SVM 和 LIF 的过程。</block>
  <block id="9f1ba6b0e21f9c8c2a0e21ba19f3abc7" category="paragraph"><block ref="9f1ba6b0e21f9c8c2a0e21ba19f3abc7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1031bd6cfd51714668c70d35fdf12489" category="paragraph">FCP 端口集用于定义特定 igroup 要使用的 LIF 。通常，为 HANA 系统创建的所有 LIF 都置于同一端口集中。下图显示了一个名为 32g 的端口集的配置，其中包括已创建的四个 LIF 。</block>
  <block id="7c65c4655216b0bddfc10a67dc3a4659" category="paragraph"><block ref="7c65c4655216b0bddfc10a67dc3a4659" category="inline-image-macro-rx" type="image"></block></block>
  <block id="825d239e42d5cc598eb01f3b672bc521" category="admonition">在 ONTAP 9.8 中，不需要端口集，但可以通过命令行创建和使用该端口集。</block>
  <block id="6651fd2f7a600a31e0103b2ff23752ca" category="section-title">启动程序组</block>
  <block id="517f95ae0c03c21432632bd009cdff0d" category="paragraph">可以为每个服务器或需要访问 LUN 的一组服务器配置 igroup 。igroup 配置需要服务器的全球通用端口名称（ Worldwide Port Name ， WWPN ）。</block>
  <block id="3f87e8b9731d5a43155ef27ca0b567af" category="paragraph">使用 `sanlun` 工具，运行以下命令以获取每个 SAP HANA 主机的 WWPN ：</block>
  <block id="bc7b122f8c7d1a7a700fe37744267ae2" category="inline-link-macro">主机设置。</block>
  <block id="64a7d37bc5bbadc99e0094b3d4046ae2" category="admonition">`sanlun` 工具是 NetApp Host Utilities 的一部分，必须安装在每个 SAP HANA 主机上。有关更多详细信息，请参见第节 <block ref="0b358a640d1236c691cca4bd6fb10205" category="inline-link-macro-rx"></block></block>
  <block id="0cac098cb7f23089be44b592277de000" category="paragraph">下图显示了 SS3_HANA 的启动程序列表。igroup 包含服务器的所有 WWPN ，并分配给存储控制器的端口集。</block>
  <block id="8f99aef5dc3eedd26959fcabff5551b8" category="paragraph"><block ref="8f99aef5dc3eedd26959fcabff5551b8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4ca4e2a0d4e5c589a8ad70a95925a37a" category="paragraph">下图显示了四个单主机 SAP HANA 系统的卷配置。每个 SAP HANA 系统的数据卷和日志卷会分布到不同的存储控制器。例如 `d，在 `m 控制器 A 上配置了卷 `SID1` _tata` _nt00001 `，在 `m 控制器 B 上配置了卷 `SID1` _`log` _nt00001`在每个卷中，会配置一个 LUN 。</block>
  <block id="2c8d2683acd00fc6b7bdbecbc4077a74" category="admonition">如果 SAP HANA 系统仅使用高可用性（ HA ）对中的一个存储控制器，则数据卷和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="1def0ad1433902dcb9b80403c8277a19" category="paragraph"><block ref="1def0ad1433902dcb9b80403c8277a19" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7a1a0bd259dd739b7d810124fe9f4440" category="paragraph">下表显示了单主机系统的挂载点配置示例。</block>
  <block id="05ba29e62de470cece1f33d7d960bebc" category="admonition">按照所述配置，存储用户 SID1adm 默认主目录的 ` /usr/sap/SID1` 目录位于本地磁盘上。在采用基于磁盘的复制的灾难恢复设置 `s中， NetApp 建议在 `SID1` _sbr hared `卷中为 ` /usr/sap/sid1` 目录创建一个额外的 LUN ，以便所有文件系统都位于中央存储上。</block>
  <block id="414644d9944d8acf448d00964757d116" category="admonition">无需将 LVM 与多个 LUN 结合使用即可实现 SAP HANA KPI 。单个 LUN 设置可满足所需的 KPI 要求。</block>
  <block id="6ca08fbeb2f69e5ac6d7d31de1c0d50e" category="paragraph">必须在 SAP HANA 主机上创建和挂载卷组和逻辑卷。下表列出了使用 LVM 的单主机系统的挂载点。</block>
  <block id="b63455a0893e3fe36b2f2d95447d0b75" category="paragraph">下图显示了 4+1 多主机 SAP HANA 系统的卷配置。每个 SAP HANA 主机的数据卷和日志卷会分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID` `d` ata `m _nt00001` ，在 `m 控制器 B 上配置了卷 `SID` _`log` _nt00001`每个卷都配置了一个 LUN 。</block>
  <block id="0e3fa17938ce2ad92597cc3cf2777462" category="paragraph"><block ref="0e3fa17938ce2ad92597cc3cf2777462" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ebcead3815b9e992a87a9c31a4be99fe" category="paragraph">对于每个 SAP HANA 主机，系统会创建一个数据卷和一个日志卷。` HANA 系统的所有主机都使用` /hana / 共享 卷。下图显示了 4+1 多主机 SAP HANA 系统的配置示例。</block>
  <block id="47efb02d47f9965ca8839f52ecc182bc" category="paragraph">下表显示了具有四个活动 SAP HANA 主机的多主机系统的配置和挂载点。</block>
  <block id="415dc524f4e8d720ce545c8d6263459c" category="cell">LUN 或卷</block>
  <block id="db7586f46a08d4a865d9fcc187eccdc6" category="admonition">在所述配置中，存储用户 SIDadm 默认主目录的 ` /usr/sap/SID` 目录位于每个 HANA 主机的本地磁盘上。在采用基于磁盘的复制的灾难恢复设置 `s中， NetApp 建议在 `SID` _sap hared` 卷中为 ` /usr/sap/SID` 文件系统另外创建四个子目录，以便每个数据库主机的所有文件系统都位于中央存储上。</block>
  <block id="ea15b968cdc22cb1b865eba6daa0eae0" category="paragraph">Linux LVM 可用于提高性能并解决 LUN 大小限制。LVM 卷组中的不同 LUN 应存储在不同的聚合和不同的控制器中。下表显示了 2+1 SAP HANA 多主机系统中每个卷组两个 LUN 的示例。</block>
  <block id="7e819a8bd73b862fc9b80deb044fa7da" category="admonition">无需使用 LVM 组合多个 LUN 即可实现 SAP HANA KPI 。单个 LUN 设置可满足所需的 KPI 要求。</block>
  <block id="70993f32e0c2ae5000f9a5a9cbf641e4" category="paragraph">在 SAP HANA 主机上，需要创建和挂载卷组和逻辑卷：</block>
  <block id="df6802a99a754c5978954aef9c7f4784" category="admonition">在所述配置中，存储用户 SIDadm 默认主目录的 ` /usr/sap/SID` 目录位于每个 HANA 主机的本地磁盘上。在采用基于磁盘的复制的灾难恢复设置 `s中， NetApp 建议在 `SID` _sap hared` 卷中为 ` /usr/sap/SID` 文件系统另外创建四个子目录，以便每个数据库主机的所有文件系统都位于中央存储上。</block>
  <block id="203165a49e3a391bdbc44e3a05d54279" category="cell">ONTAP 9.</block>
  <block id="f0f3c94fb860d8ed677a7fd92098c982" category="paragraph">您可以使用 NetApp OnCommand 系统管理器创建存储卷和 LUN 并将其映射到服务器的 igroup 。</block>
  <block id="628f62b19dac88e4e877b52b00325d1c" category="paragraph">以下步骤显示了使用 SID SS3 配置 2+1 多主机 HANA 系统的情况。</block>
  <block id="99576f0b50cbef6a3dc3e755211ba4df" category="list-text">在 NetApp ONTAP 系统管理器中启动创建 LUN 向导。</block>
  <block id="b1fdf92b21352cb26604b1d9e6e508f3" category="paragraph"><block ref="b1fdf92b21352cb26604b1d9e6e508f3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="cc3bbd3870b19b5988056892345656f8" category="list-text">输入 LUN 名称，选择 LUN 类型，然后输入 LUN 的大小。</block>
  <block id="e8fb2f807904bec3e5b951dbcc96359c" category="paragraph"><block ref="e8fb2f807904bec3e5b951dbcc96359c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="19cca4c2caf04d464b286b57631c5cf3" category="list-text">输入卷名称和托管聚合。</block>
  <block id="d28d35be14c66319dc4eb09611aaa7c6" category="paragraph"><block ref="d28d35be14c66319dc4eb09611aaa7c6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3e7bbfdb3982e2648add19277beb4be0" category="list-text">选择 LUN 应映射到的 igroup 。</block>
  <block id="a9329e5c76837347b2146b02496c0b92" category="paragraph"><block ref="a9329e5c76837347b2146b02496c0b92" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f78e3cdb43aaa763020ac7b127b79352" category="list-text">提供 QoS 设置。</block>
  <block id="6c93cddf9ee6d351d390dc68e4e6c95d" category="paragraph"><block ref="6c93cddf9ee6d351d390dc68e4e6c95d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="59cd39f269f7e809ddc94cf9eb25d4fc" category="list-text">单击摘要页面上的下一步。</block>
  <block id="1aad85204a05b042999a46d961bc941a" category="paragraph"><block ref="1aad85204a05b042999a46d961bc941a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="de93591f8d085ca64b0997731f1a32d8" category="list-text">单击完成页面上的完成。</block>
  <block id="f4563ea8f9bd60259f65f3f458d17456" category="paragraph"><block ref="f4563ea8f9bd60259f65f3f458d17456" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1f0d5a0003e2a9d29d9bdbdb42528453" category="list-text">对每个 LUN 重复步骤 2 到 7 。</block>
  <block id="a0e202053c694786bc442dd83a386ff7" category="paragraph">下图显示了 2+1 多主机设置需要创建的所有 LUN 的摘要。</block>
  <block id="8385eb15d4c1051f6b08b533f7c66087" category="paragraph"><block ref="8385eb15d4c1051f6b08b533f7c66087" category="inline-image-macro-rx" type="image"></block></block>
  <block id="77656454768235b0e1954805bd92d9c9" category="section-title">使用 CLI 创建 LUN ，卷并将 LUN 映射到 igroup</block>
  <block id="90242878213f2eef96eb3fcc1d8e3ad6" category="paragraph">本节显示了一个使用命令行和 ONTAP 9.8 的示例配置，该配置适用于 2+1 SAP HANA 多主机系统，其中 SID 为 FC5 ，使用 LVM ，每个 LVM 卷组具有两个 LUN 。</block>
  <block id="d21a66a2fd717a4acd6dd449ecac4839" category="list-text">为属于系统 FC5 的所有服务器创建 igroup 。</block>
  <block id="3a630997b07207edb38c5c79a4f7d867" category="list-text">将所有 LUN 映射到创建的 igroup 。</block>
  <block id="3a4f303d7a92e7f9eee41a5c46fe00db" category="paragraph"><block ref="3a4f303d7a92e7f9eee41a5c46fe00db" category="inline-link-macro-rx"></block></block>
  <block id="f4d1f454c28a750f94ddf6c721651c94" category="paragraph"><block ref="f4d1f454c28a750f94ddf6c721651c94" category="inline-link-macro-rx"></block></block>
  <block id="60a5608aa352e15e7648da1d39cb299b" category="paragraph">对于 SAP HANA 1.0 - SPS12 ，可以在安装 SAP HANA 数据库期间设置这些参数，如 SAP 注释中所述<block ref="c391dcebb4d33a6a0f840983455654bf" category="inline-link-rx"></block>。</block>
  <block id="8192071b4f7b02996ec3cdeddd07d1d8" category="paragraph">或者，也可以在安装 SAP HANA 数据库后使用 `hdbparam` framework 设置这些参数。</block>
  <block id="c0b08fa9f53bd588cf26dd04b2bf1c29" category="inline-link">2399079 —在 HANA 2 中消除了 hdbparam</block>
  <block id="25acda0af7df7e8f6aaedc308080d2f2" category="paragraph">从 SAP HANA 2.0 开始， `hdbparam` 已弃用，并且参数已移至 `global.ini` 文件。可以使用 SQL 命令或 SAP HANA Studio 设置这些参数。有关详细信息，请参见 SAP 注释<block ref="936e80e83aa8101d48722d387f096a5f" category="inline-link-rx"></block>。也可以在 `global.ini` 文件中设置这些参数。</block>
  <block id="a1dc0f5c23c4490d01718a8d6b05872e" category="paragraph">对于 SAP HANA 2.0 SPS5 及更高版本，您可以使用 `setParameter.py `s脚本设置上述参数。</block>
  <block id="d5640ac08fb9e6938af431151ff9c53c" category="paragraph"><block ref="d5640ac08fb9e6938af431151ff9c53c" category="inline-link-macro-rx"></block></block>
  <block id="b1721da66df66a6c5a926d5a38d3e33b" category="paragraph"><block ref="b1721da66df66a6c5a926d5a38d3e33b" category="inline-link-macro-rx"></block></block>
  <block id="2a986cf5abe7b7785ffcdece33cfc433" category="admonition">无需使用多个分区来实现 SAP HANA KPI 。具有单个分区的单个 LUN 可满足所需的 KPI 。</block>
  <block id="e7e3db35c66fbc08aba59377e767d66f" category="paragraph">可以随时添加其他数据卷分区，但可能需要重新启动 SAP HANA 数据库。</block>
  <block id="0da243913a454541b5b0036cfd8f8135" category="list-text">在 `global.ini` 文件中添加以下条目。</block>
  <block id="2b304fd148da024e97f54db599c2f521" category="paragraph">卷和 LUN 的布局与单个主机的布局类似，该主机具有一个数据卷分区，但另有一个数据卷和 LUN 存储在与日志卷和另一个数据卷不同的聚合上。下表显示了具有两个数据卷分区的 SAP HANA 单主机系统的配置示例。</block>
  <block id="d7021f52f260e11c8c2dd980991f38ae" category="paragraph">使用 ONTAP 系统管理器或 ONTAP 命令行界面创建新的数据 LUN 。</block>
  <block id="5bcb0bf87ac10e193de11e3c3c8eb488" category="list-text">为其他 LUN 配置多路径，如第 0 章所述。</block>
  <block id="572b2316d0cecf8ccd134b71ee2fce66" category="list-text">在属于 HANA 系统的每个附加 LUN 上创建 XFS 文件系统：</block>
  <block id="23c80196123eb12634dbeb70874872fe" category="list-text">在数据库主机上创建挂载点并设置权限。</block>
  <block id="ab876b2fc77b49d4799c8317c49e7fdc" category="list-text">挂载文件系统，运行 `mount – a` 命令。</block>
  <block id="cccc40b2b949eb5631f1a7625e3bbb28" category="paragraph">要向租户数据库添加额外的数据卷分区，请对租户数据库执行以下 SQL 语句。每个附加 LUN 可以具有不同的路径：</block>
  <block id="3a1d443dcdaf18be456d1a2637c962b5" category="paragraph"><block ref="3a1d443dcdaf18be456d1a2637c962b5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="955a257cbf8b76e1828960fc589fed6b" category="paragraph"><block ref="955a257cbf8b76e1828960fc589fed6b" category="inline-link-macro-rx"></block></block>
  <block id="5b560dd2e4abafa3e772dfb63bd1ba9b" category="summary">SAP 业务应用程序和 SAP HANA 数据库解决方案的集合</block>
  <block id="269e48a148be46c6e5fb065e74629d57" category="doc">SAP 业务应用程序和 SAP HANA 数据库解决方案</block>
  <block id="6d6307546d597b4bc32ed8c66226614a" category="paragraph">NetApp 提供了大量适用于 SAP 和 SAP HANA 的技术报告，经验证的设计和解决方案简介。它们分为以下 4 个类别，可从左侧边栏展开以了解更多信息。</block>
  <block id="cbdae17ea62bd72610afa1da8bf0068c" category="list-text">基于 NetApp 的 SAP 配置最佳实践</block>
  <block id="93d41f083069da0461d2140c21de9822" category="list-text">备份和恢复以及灾难恢复</block>
  <block id="4abaf4df325f5c42e7a904aecb84a0d6" category="list-text">SAP 生命周期管理</block>
  <block id="f01120deea316d303519ad5ab689a57f" category="list-text">解决方案简介</block>
  <block id="2f5f480c2cb54884152c412765dd0565" category="summary">要实施有效的灾难恢复策略，您必须测试所需的工作流。测试可证明该策略是否有效以及内部文档是否充足，同时还允许管理员对所需的程序进行培训。</block>
  <block id="1135ff8da5df72747612faee39237919" category="doc">灾难恢复测试</block>
  <block id="6eb9c659b486f33411b66a167b5f2f19" category="inline-link-macro">先前版本：监控 ANF 跨区域复制。</block>
  <block id="6ef66586e2ed5b206403c01adcaf278b" category="paragraph"><block ref="6ef66586e2ed5b206403c01adcaf278b" category="inline-link-macro-rx"></block></block>
  <block id="78c7aecd30426566c46ffded8977d5e8" category="paragraph">ANF 跨区域复制支持灾难恢复测试，而不会使 RTO 和 RPO 面临风险。可以在不中断数据复制的情况下执行灾难恢复测试。</block>
  <block id="937c6624e4ad8af35fa4c42dd6d29b86" category="inline-link">Azure NetApp Files 快照的工作原理 | Microsoft 文档</block>
  <block id="2596187dfded21d3da704d17cb465012" category="paragraph">灾难恢复测试工作流利用 ANF 功能集，根据灾难恢复目标上的现有 Snapshot 备份创建新卷。请参见<block ref="db53ffad00e09cba73a4fdfc74cb3775" category="inline-link-rx"></block>。</block>
  <block id="5cc40200131ad81d8bcd56e79458f4e9" category="paragraph">根据日志备份复制是否属于灾难恢复设置的一部分，灾难恢复的步骤略有不同。本节介绍了针对纯数据备份复制以及结合日志备份卷复制的数据卷复制进行的灾难恢复测试。</block>
  <block id="287204f88222f0f0fc17fea019460c2e" category="paragraph">要执行灾难恢复测试，请完成以下步骤：</block>
  <block id="5d15c22569bad82e3c259149418a5567" category="list-text">准备目标主机。</block>
  <block id="c47b80a6b3e3eeb1c46a9097541a0186" category="list-text">在灾难恢复站点基于 Snapshot 备份创建新卷。</block>
  <block id="3a35566accf9e51bcdeef178bd7f83e7" category="list-text">在目标主机上挂载新卷。</block>
  <block id="69a3fff9d66404b6c7c43fe548a89488" category="list-text">恢复 HANA 数据库。</block>
  <block id="63fe05915e48317fa2d299c9aa6b20e9" category="list-text">仅限数据卷恢复。</block>
  <block id="69a5087055235e78cdb882da9f585b30" category="list-text">使用复制的日志备份进行正向恢复。</block>
  <block id="c4ac05b35ef0c84121e3311d4bfceacc" category="paragraph">以下各小节详细介绍了这些步骤。</block>
  <block id="ab61477121868691df21b1c5c7bcb901" category="paragraph"><block ref="ab61477121868691df21b1c5c7bcb901" category="inline-image-macro-rx" type="image"></block></block>
  <block id="43b53c693a7228067a44849c51980ac2" category="inline-link-macro">下一步：准备目标主机。</block>
  <block id="f456d3afcd280db226476e704a3b8639" category="paragraph"><block ref="f456d3afcd280db226476e704a3b8639" category="inline-link-macro-rx"></block></block>
  <block id="0bd9242ade1764d7b05344c462c5945f" category="summary">现在，可以根据之前创建的 /etc/fstab 文件在目标主机上挂载新卷。</block>
  <block id="0b31021246b10bf3eae6d1d87ea727ab" category="doc">在目标主机上挂载新卷</block>
  <block id="817756d1b24ff3d256a30ad5815cd135" category="inline-link-macro">先前：在灾难恢复站点基于 Snapshot 备份创建新卷。</block>
  <block id="bc73a2003c99d647943cd46c72219c38" category="paragraph"><block ref="bc73a2003c99d647943cd46c72219c38" category="inline-link-macro-rx"></block></block>
  <block id="37b6bf2117a49bac550ea7fbde01cbe6" category="paragraph">现在，可以根据之前创建的 ` /etc/fstab` 文件在目标主机上挂载新卷。</block>
  <block id="a8c746bca5da7073413ffa2079797496" category="paragraph">以下输出显示了所需的文件系统。</block>
  <block id="1c3b9b3db71c0dc9e78c9bcabd089d11" category="inline-link-macro">接下来： HANA 数据库恢复。</block>
  <block id="e7cb6c06fe9aed072f505876c336a81f" category="paragraph"><block ref="e7cb6c06fe9aed072f505876c336a81f" category="inline-link-macro-rx"></block></block>
  <block id="a4d54b1dcfdae0e1a0573e950b1d490a" category="summary">在配置卷复制之前，必须在灾难恢复站点上执行几个准备步骤。</block>
  <block id="86ba0d39a4ca51b69c6fa7d6c445e674" category="doc">ANF 跨区域复制的配置步骤</block>
  <block id="f3b3f5c2a62f948e26137f47b54e673c" category="inline-link-macro">上一步：实验室设置。</block>
  <block id="8309f81eb10cdbb1740b5edc6fb0caaa" category="paragraph"><block ref="8309f81eb10cdbb1740b5edc6fb0caaa" category="inline-link-macro-rx"></block></block>
  <block id="b42a1bf66a549b8645aa369e72b6892a" category="list-text">NetApp 帐户必须可用，并且必须与源帐户配置相同的 Azure 订阅。</block>
  <block id="e3b7f7acd631c2ed58d549c927044283" category="list-text">必须使用上述 NetApp 帐户配置可用的容量池。</block>
  <block id="ab41f73f5c2b7b260e66bd7135be55df" category="list-text">虚拟网络必须可用并已配置。</block>
  <block id="625218459fa15c0fb1b7d5528cb91ccb" category="list-text">在虚拟网络中，必须有一个委派子网可用，并将其配置为可用于 ANF 。</block>
  <block id="458d95f9ec4fff8dd9312e51b3c2a7fb" category="paragraph">现在，可以为 HANA 数据， HANA 共享卷和 HANA 日志备份卷创建保护卷。下表显示了我们实验室设置中配置的目标卷。</block>
  <block id="d6b016ece56ccaef1fd3fcd56391468c" category="admonition">为了实现最佳延迟，在发生灾难故障转移时，必须将卷放置在靠近运行 SAP HANA 的 VM 的位置。因此， DR 卷需要与任何其他 SAP HANA 生产系统相同的固定过程。</block>
  <block id="449a0fc6c7996b28a64846e892cd6926" category="cell">HANA 卷</block>
  <block id="f31bbdd1b3e85bccd652680e16935819" category="cell">源</block>
  <block id="12007e1d59f4d09c87dbe2c438256244" category="cell">目标</block>
  <block id="c17d95dc84bb02bde4b5e15d2626b9ca" category="cell">复制计划</block>
  <block id="79d64f73cfdf4a123fdce2f6c75d002b" category="cell">HANA 数据卷</block>
  <block id="26468341ce2b86a76711548bf32d5374" category="cell">PR1-data-mnt00001</block>
  <block id="dc2ff9902e7813acfb09f85544bb029e" category="cell">PR1-data-mnt00001-sm-dest</block>
  <block id="c512b685438f41daa7386329a3b8f8d3" category="cell">每天</block>
  <block id="1d57310cd0156e7d3039997b3c4fcf49" category="cell">HANA 共享卷</block>
  <block id="79b9df781b053a904e15f901469d5b15" category="cell">PR1-shared</block>
  <block id="48a9062e4add008eae1409d0f6180ff5" category="cell">PR1-shared-sm-dest</block>
  <block id="769cb50c95fd3a43c659aa73aba99e5b" category="cell">每小时</block>
  <block id="175080ca3e495fc5f25b31acc5ea2565" category="cell">HANA 日志 / 目录备份卷</block>
  <block id="043b690b7fa6b658a34cfe4eddef0f66" category="cell">哈纳巴克 up</block>
  <block id="f607dbc7c9b584df2af13aa1e3effa0a" category="cell">hanabackup-sm-dest</block>
  <block id="c2bd6dc7b8af91e4e8d66ba495a405e1" category="paragraph">对于每个卷，必须执行以下步骤：</block>
  <block id="825b53aa3215a8ff5af004871350973b" category="list-text">在灾难恢复站点创建新的保护卷：</block>
  <block id="e84a39f7b4c4e2ad94dca482db6fbc12" category="list-text">提供卷名称，容量池，配额和网络信息。</block>
  <block id="cae87a876f3a8abb3eb23f4af3e93517" category="list-text">提供协议和卷访问信息。</block>
  <block id="27c07ed9c69be3dccb35efafedd4eba8" category="list-text">提供源卷 ID 和复制计划。</block>
  <block id="e8cef5b7d1f6a0653baaed122e42e586" category="list-text">创建目标卷。</block>
  <block id="b686ca8bbff390a495e7e60451ecb210" category="list-text">在源卷上授权复制。</block>
  <block id="f81db0f887d96ce44293b99102b352a6" category="list-text">提供目标卷 ID 。</block>
  <block id="5ae1ee782233392892b749a4f5d850ce" category="paragraph">以下屏幕截图详细显示了配置步骤。</block>
  <block id="e2be47b4fb660d20573336e8663f54db" category="paragraph">在灾难恢复站点上，通过选择卷并单击添加数据复制来创建新的保护卷。在基础选项卡中，您必须提供卷名称，容量池和网络信息。</block>
  <block id="e99589f2cbac6c085c73aea3c0c28855" category="admonition">可以根据容量要求设置卷的配额，因为卷性能不会影响复制过程。如果发生灾难恢复故障转移，则必须调整配额以满足实际的性能要求。</block>
  <block id="54eafc6acb43f4d58b79a36ccfbff752" category="admonition">如果已为容量池配置手动 QoS ，则除了容量要求之外，您还可以配置吞吐量。与上述相同，您可以在正常操作期间将吞吐量配置为低值，并在发生灾难恢复故障转移时增加吞吐量。</block>
  <block id="93c0aa921c3bc0de0d96bc4b0165693c" category="paragraph"><block ref="93c0aa921c3bc0de0d96bc4b0165693c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="09cc677ff6f2db7b9e0c9f462c378118" category="paragraph">在协议选项卡中，您必须提供网络协议，网络路径和导出策略。</block>
  <block id="964f72274255c85554e9bc4d2c7d3507" category="admonition">此协议必须与源卷使用的协议相同。</block>
  <block id="06655c2f005b5520ee4b7424961d6d2c" category="paragraph"><block ref="06655c2f005b5520ee4b7424961d6d2c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="aff73926e77c6491902270e665038623" category="paragraph">在复制选项卡中，您必须配置源卷 ID 和复制计划。对于数据卷复制，我们为实验室设置配置了每日复制计划。</block>
  <block id="716f8c04301b81d7636c064e03f9e95a" category="admonition">可以从源卷的属性屏幕复制源卷 ID 。</block>
  <block id="ae4884783ebef9a2ee0fa804339c2cad" category="paragraph"><block ref="ae4884783ebef9a2ee0fa804339c2cad" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f9ce4d292d3839d7942d11754c497e99" category="paragraph">最后一步是，您必须提供目标卷的 ID 来在源卷上授权复制。</block>
  <block id="588edd807dcaffd38e6d9dc085f71430" category="admonition">您可以从目标卷的属性屏幕复制目标卷 ID 。</block>
  <block id="aab7d98c5ad056de78e5e1dcf6d1990b" category="paragraph"><block ref="aab7d98c5ad056de78e5e1dcf6d1990b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e2a531679c8b0e87dfd7ecbf1e367682" category="paragraph">必须对 HANA 共享卷和日志备份卷执行相同的步骤。</block>
  <block id="3fcab0b0bcfbbffe3c64c089429f3f4a" category="inline-link-macro">下一步：监控 ANF 跨区域复制。</block>
  <block id="8bed3460c10e74668910072eb938a0f2" category="paragraph"><block ref="8bed3460c10e74668910072eb938a0f2" category="inline-link-macro-rx"></block></block>
  <block id="57a1cc592fec58eb1405f0d119665eda" category="summary">本节介绍服务器上所需的准备步骤，这些步骤用于灾难恢复故障转移测试。</block>
  <block id="1805b1ce31eaa33fbab9adfcf5046164" category="doc">准备目标主机</block>
  <block id="b7050df4a04b4de3ce6a97c9bc11b765" category="inline-link-macro">先前版本：灾难恢复测试。</block>
  <block id="6dd31893a7ae53c0661525679f0dc62f" category="paragraph"><block ref="6dd31893a7ae53c0661525679f0dc62f" category="inline-link-macro-rx"></block></block>
  <block id="7a4ba7d447a3ae928cd0b4b1338a8785" category="paragraph">本节介绍用于灾难恢复故障转移测试的服务器所需的准备步骤。</block>
  <block id="29349c3a78cce5cc29808cecf45b06e7" category="paragraph">在正常操作期间，目标主机通常用于其他目的，例如 HANA QA 或测试系统。因此，在执行灾难故障转移测试时，必须运行大多数这些步骤。另一方面，只需复制配置文件，即可准备相关配置文件，例如 ` /etc/fstab` 和 ` usr/sapservices` ，然后将其投入生产。灾难恢复测试操作步骤可确保正确配置准备好的相关配置文件。</block>
  <block id="48170b1147f65f7e4f0ee89771e5ff12" category="paragraph">目标主机准备工作还包括关闭 HANA QA 或测试系统，以及使用 `systemctl stop sapinit` 停止所有服务。</block>
  <block id="e90afee4e0255e92692e4dbb455fab0b" category="section-title">目标服务器主机名和 IP 地址</block>
  <block id="bb4741b9acd629bc36e0a0afe5a882b0" category="paragraph">目标服务器的主机名必须与源系统的主机名相同。IP 地址可以不同。</block>
  <block id="930aaee5905613c0fde11375bafb6008" category="admonition">必须正确隔离目标服务器，使其无法与其他系统通信。如果未设置适当的隔离，则克隆的生产系统可能会与其他生产系统交换数据，从而导致数据在逻辑上损坏。</block>
  <block id="c5d62e4cd93b13ecc40d972d26905aae" category="section-title">安装所需的软件</block>
  <block id="e6d9f482b1a3219db22a8c75173e86bf" category="inline-link">SAP 主机代理</block>
  <block id="0f64c6a225bf532d108a3a45af534297" category="paragraph">SAP 主机代理软件必须安装在目标服务器上。有关详细信息，请参见<block ref="dfb99acb3a5bfb8e56c9630a62e67a77" category="inline-link-rx"></block> 在 SAP 帮助门户上。</block>
  <block id="8c606d54e77d50b5b8be96eba8964fd9" category="admonition">如果主机用作 HANA QA 或测试系统，则已安装 SAP 主机代理软件。</block>
  <block id="7499cb244ac7c7d171d96246d84cfff2" category="section-title">配置用户，端口和 SAP 服务</block>
  <block id="f7188f776339935568f9082e226a74bf" category="paragraph">SAP HANA 数据库所需的用户和组必须在目标服务器上可用。通常使用中央用户管理；因此，不需要在目标服务器上执行任何配置步骤。必须在目标主机上配置 HANA 数据库所需的端口。可以通过将 ` /etc/services` 文件复制到目标服务器来从源系统复制配置。</block>
  <block id="e7ab0414c80c78c499518651c496b99b" category="paragraph">所需的 SAP 服务条目必须在目标主机上可用。可通过将 ` /usr/sapservices` 文件复制到目标服务器来从源系统复制配置。以下输出显示了在实验室设置中使用的 SAP HANA 数据库所需的条目。</block>
  <block id="c6f4d12bfe279cd224db1ab7d3bafeee" category="section-title">准备 HANA 日志卷</block>
  <block id="8ab1ea416a553309f101937f88feadd0" category="paragraph">由于 HANA 日志卷不是复制的一部分，因此目标主机上必须存在一个空的日志卷。日志卷必须包含与源 HANA 系统相同的子目录。</block>
  <block id="ebe6e77fe278b0c44da179596e20dc10" category="section-title">准备日志备份卷</block>
  <block id="d8c860bb68ca61783d80f8661d53179d" category="paragraph">由于源系统为 HANA 日志备份配置了一个单独的卷，因此，目标主机上也必须具有一个日志备份卷。必须在目标主机上配置并挂载用于日志备份的卷。</block>
  <block id="d38e15ac7cf20e8efaf731e3439051e7" category="paragraph">如果日志备份卷复制是灾难恢复设置的一部分，则会在目标主机上挂载基于快照的新卷，而无需准备其他日志备份卷。</block>
  <block id="991bc387262467ee7383a884e1ae528c" category="section-title">准备文件系统挂载</block>
  <block id="e760b9f68755a85c0afb655724f76716" category="paragraph">下表显示了实验室设置中使用的命名约定。灾难恢复站点上新卷的卷名称包含在 ` /etc/fstab` 中。这些卷名称将在下一节的卷创建步骤中使用。</block>
  <block id="c62201a5e4ec1f272c1c685c418cae86" category="cell">HANA PR1 卷</block>
  <block id="43e10a0fc1c9f32ec01b5567dcb26478" category="cell">灾难恢复站点上的新卷和子目录</block>
  <block id="93b8bd1267fc89b2ca2efe06e289f955" category="cell">目标主机上的挂载点</block>
  <block id="a4d45ebfbb892aaa3c0aba5e7211fea0" category="cell">数据卷</block>
  <block id="bf35244369ab029517ff319ae89cbc62" category="cell">pr1-data-mnt00001-sm-dest-clone</block>
  <block id="09e9cb8a4e8275fd4a5db4146ca1609d" category="cell">/ha/data/PR1/mnt00001</block>
  <block id="46e458e62cbb1b2e6d36191ae52d7467" category="cell">共享卷</block>
  <block id="21fe8dccc7ab9a5d0a38ed0c84bb5132" category="cell">PR1-shared-sm-dest-clone/shared PR1-shared-sm-dest-clone/user-sap-pr1</block>
  <block id="3c6826d6950803e805a42a4d006c4a77" category="cell">/has/shared /usr/sap/pr1</block>
  <block id="a38c36c25709867c8eb52bece271a213" category="cell">记录备份卷</block>
  <block id="170f75e41745b7414599fc04eb427e58" category="cell">hanabackup-sm-dest-clone</block>
  <block id="ac32f37d2501e6d25aef85bf49a3a09d" category="cell">/hanabackup</block>
  <block id="4c6241952cf0bebf817c8004f43c828f" category="admonition">必须在目标主机上创建此表中列出的挂载点。</block>
  <block id="5aa4fa30550ad8c9254246ba03f89777" category="paragraph">以下是所需的 ` /etc/fstab` 条目。</block>
  <block id="c76d10d738893745f03437e8a441bfbe" category="inline-link-macro">接下来：在灾难恢复站点基于 Snapshot 备份创建新卷。</block>
  <block id="370c8463b4d21131bf47f94c5294b585" category="paragraph"><block ref="370c8463b4d21131bf47f94c5294b585" category="inline-link-macro-rx"></block></block>
  <block id="0715cc7b6d956cc1bcb7ae80046f1cda" category="summary">以下是 HANA 数据库恢复的步骤。</block>
  <block id="91511a18af650a7ce055d8ec78c57f99" category="doc">HANA 数据库恢复</block>
  <block id="80db771a81b12540cadb0a6b66839670" category="inline-link-macro">上一步：在目标主机上挂载卷。</block>
  <block id="3ec9a75255f023229020b944021c97b3" category="paragraph"><block ref="3ec9a75255f023229020b944021c97b3" category="inline-link-macro-rx"></block></block>
  <block id="7988012007cbc71947d6a647a8c8e726" category="paragraph">启动所需的 SAP 服务。</block>
  <block id="cd963b480c3cb24fbb41cb17a8d85134" category="paragraph">以下输出显示了所需的进程。</block>
  <block id="41f34e0a65027292639585b25be966d8" category="paragraph">以下各小节介绍了使用复制的日志备份进行正向恢复的恢复过程。可以使用系统数据库的 HANA 恢复脚本和租户数据库的 hdbsql. 命令执行恢复。</block>
  <block id="d6c45a48e2dacb7d6bfbf425e93935ed" category="inline-link-macro">恢复到最新的 HANA 数据卷备份 Savepoint</block>
  <block id="99974cb8c998a4d922f9111a6a600bba" category="paragraph">第章介绍了用于恢复到最新数据保存点的命令 <block ref="0be310dc1ba7e1c7766b9cbfdeb6e0df" category="inline-link-macro-rx"></block>。</block>
  <block id="5025c24ec3e0df190e43cbbe151b2633" category="section-title">使用日志备份进行正向恢复</block>
  <block id="09ee90eaa98c13b5a23451eb4bd876bc" category="paragraph">使用所有可用日志备份执行恢复时，使用以下命令作为用户 pr1adm 执行：</block>
  <block id="557c60d90ae6fa286bf7c2d4c8e08cf2" category="list-text">系统数据库</block>
  <block id="47dbd31d59cd136040f750cf889b52fd" category="list-text">租户数据库</block>
  <block id="b7d3f82143b80eb5e90acd916d55348d" category="admonition">要使用所有可用日志进行恢复，您可以在恢复语句中随时使用作为时间戳。</block>
  <block id="a4d94df5aaf94ce5a337f9770dd73652" category="paragraph">您还可以使用 HANA Studio 或 Cockpit 执行系统和租户数据库的恢复。</block>
  <block id="3b67a0f0dbbe2252de94c9cb25faa5bd" category="paragraph">以下命令输出显示了恢复执行情况。</block>
  <block id="5204ae5afd7ee53686a6f99190f93e37" category="section-title">系统数据库恢复</block>
  <block id="3973b179e7f3c7f23b37daa55f8b718c" category="section-title">租户数据库恢复</block>
  <block id="410b822ca485235d4570285ab55bd4fc" category="paragraph">如果尚未在源系统上为 pr1adm 用户创建用户存储密钥，则必须在目标系统上创建密钥。在密钥中配置的数据库用户必须具有执行租户恢复操作的权限。</block>
  <block id="b88213d578dadf0b58255002cdc3235f" category="section-title">检查最新日志备份的一致性</block>
  <block id="b855006be612f8de44edd56b1cbe599e" category="paragraph">由于日志备份卷复制是独立于 SAP HANA 数据库执行的日志备份过程执行的，因此灾难恢复站点上可能存在不一致的开放日志备份文件。只有最新的日志备份文件可能不一致，在使用 `hdbbackupcheck` 工具在灾难恢复站点执行正向恢复之前，应先检查这些文件。</block>
  <block id="2a473356118b695e14aecea6717f8038" category="paragraph">必须对系统和租户数据库的最新日志备份文件执行检查。</block>
  <block id="668fadc42f8855257306656060627f86" category="paragraph">如果 `hdbbackupcheck` 工具报告最新日志备份出错，则必须删除或删除最新的日志备份集。</block>
  <block id="9079f4d1b5099e78a1126b9b2b34bdfd" category="paragraph"><block ref="9079f4d1b5099e78a1126b9b2b34bdfd" category="inline-link-macro-rx"></block></block>
  <block id="81dbd9083542b5058eeff2a69b9df0f1" category="summary">有关跨区域复制的应用程序无关信息，请访问以下位置。</block>
  <block id="1cc8efad9ef8bc01d2445bfc8d04e15c" category="doc">利用 SAP HANA 实现跨区域复制</block>
  <block id="5961c524ae34712821d4ff5aaa9a7841" category="inline-link-macro">先前版本：灾难恢复解决方案比较。</block>
  <block id="66620e8dd57e36e3d0f1a14a502eaa14" category="paragraph"><block ref="66620e8dd57e36e3d0f1a14a502eaa14" category="inline-link-macro-rx"></block></block>
  <block id="a9f4d9aafbea086205494239b45e7d8a" category="inline-link">Azure NetApp Files 文档 | Microsoft 文档</block>
  <block id="489356dbf86ad9e11119e8887ea4b6c8" category="paragraph">有关跨区域复制的应用程序无关信息，请参见<block ref="22a775b2a4aa67305d9e36a10d295cc1" category="inline-link-rx"></block> 在概念和操作指南部分。</block>
  <block id="9a227c038344eaae67971a65da2e07c0" category="inline-link-macro">接下来：使用 SAP HANA 进行跨区域复制的配置选项。</block>
  <block id="013553151cdd6e800e56b07e88539c55" category="paragraph"><block ref="013553151cdd6e800e56b07e88539c55" category="inline-link-macro-rx"></block></block>
  <block id="4a822cebdc9c9ffddab9b72668b15b82" category="summary">已对 SAP HANA 单主机系统执行解决方案验证。适用于 ANF 的 Microsoft AzAcSnap Snapshot 备份工具已用于配置 HANA 应用程序一致的 Snapshot 备份。</block>
  <block id="2ed67d7b0221292a52e0dad8b778413a" category="doc">实验室设置</block>
  <block id="0092b12d3ebb64bde8af7282afa98249" category="inline-link-macro">先前版本：要求和最佳实践。</block>
  <block id="bf57c1ae2832a82da27b392e89ed9b5f" category="paragraph"><block ref="bf57c1ae2832a82da27b392e89ed9b5f" category="inline-link-macro-rx"></block></block>
  <block id="c377a17bdb4b49ee81ed4b850d7aa82f" category="paragraph">已对 SAP HANA 单主机系统执行解决方案验证。适用于 ANF 的 Microsoft AzAcSnap Snapshot 备份工具已用于配置 HANA 应用程序一致的 Snapshot 备份。每天配置数据卷，每小时日志备份和共享卷复制。灾难恢复测试和故障转移已通过保存点以及正向恢复操作进行验证。</block>
  <block id="ee0a08337c36a2e1dc94c66920bc1c53" category="paragraph">实验室设置中使用了以下软件版本：</block>
  <block id="49821fb7d46ce72a906d5558cc7fb49c" category="list-text">一个主机 SAP HANA 2.0 SPS5 系统，一个租户</block>
  <block id="338f7cb0bac9744a3d8f0e058609d27c" category="list-text">适用于 SAP 15 SP1 的 SUSE SLES</block>
  <block id="f169231424331b8331517b539b422205" category="list-text">AzAcSnap 5.0</block>
  <block id="2f756956567b07d5ae865a7961038f49" category="paragraph">灾难恢复站点上配置了一个具有手动 QoS 的容量池。</block>
  <block id="8aa3c19ab9d67a7c99258a236498a316" category="paragraph">下图显示了实验室设置。</block>
  <block id="d81dba6effc0da123e468c030a8f07a1" category="paragraph"><block ref="d81dba6effc0da123e468c030a8f07a1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2ebc3727a62e108be8ad065c82185b2a" category="section-title">使用 AzAcSnap 的 Snapshot 备份配置</block>
  <block id="dea36c580776ee186f7bd3a729fdadae" category="paragraph">在主站点上， AzAcSnap 配置为为为 HANA 系统 PR1 创建应用程序一致的 Snapshot 备份。这些 Snapshot 备份可从 PR1 HANA 系统的 ANF 数据卷获得，它们也会注册到 SAP HANA 备份目录中，如以下两个图所示。计划每 4 小时执行一次 Snapshot 备份。</block>
  <block id="db9218292bb42bb03cca44310ac971c4" category="paragraph">通过使用 ANF 跨区域复制复制数据卷，这些 Snapshot 备份将复制到灾难恢复站点，并可用于恢复 HANA 数据库。</block>
  <block id="6aeab84a5441035790ad6afb0f70ebbd" category="paragraph">下图显示了 HANA 数据卷的 Snapshot 备份。</block>
  <block id="53a79c7de9a2f18349948a24f314d1eb" category="paragraph"><block ref="53a79c7de9a2f18349948a24f314d1eb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e5d963ae30a5059019279dfe93dc08fd" category="paragraph">下图显示了 SAP HANA 备份目录。</block>
  <block id="d0a771a64ed9ad539e908b12374c3264" category="paragraph"><block ref="d0a771a64ed9ad539e908b12374c3264" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9b9906cc301f62ba50b8607fd8ae5b52" category="inline-link-macro">下一步： ANF 跨区域复制的配置步骤。</block>
  <block id="32732e2263114285d7482b8009df015b" category="paragraph"><block ref="32732e2263114285d7482b8009df015b" category="inline-link-macro-rx"></block></block>
  <block id="6ea9fa207b22b88f7a1b71067c28b27c" category="summary">全面的灾难恢复解决方案必须能够使客户从主站点的完全故障中恢复。</block>
  <block id="e83bab5b97dcd6d1ab9fd10e243e00a2" category="doc">灾难恢复解决方案比较</block>
  <block id="7faea0e98710b30b6861d052cca59643" category="inline-link-macro">先前版本：《使用 Azure NetApp Files 进行 SAP HANA 灾难恢复概述》。</block>
  <block id="439d4ecc95101f6f58cd669e57236212" category="paragraph"><block ref="439d4ecc95101f6f58cd669e57236212" category="inline-link-macro-rx"></block></block>
  <block id="c8b28dac8aa9627eba845b258700d143" category="paragraph">全面的灾难恢复解决方案必须能够使客户从主站点的完全故障中恢复。因此，必须将数据传输到二级站点，并且在站点发生故障时，要运行所需的生产 SAP HANA 系统，需要一个完整的基础架构。根据应用程序的可用性要求以及要保护的灾难类型，必须考虑双站点或三站点灾难恢复解决方案。</block>
  <block id="efdfd61135978b48927ebefc9a85bac0" category="paragraph">下图显示了一种典型配置，其中数据会在同一 Azure 区域内同步复制到另一个可用性区域。短距离允许您同步复制数据，以实现零 RPO （通常用于提供 HA ）。</block>
  <block id="6b38154114f7c1d2f1f851414e66cdb5" category="paragraph">此外，当主区域受到影响时，还会将数据异步复制到二级区域，以防止发生灾难。可实现的最小 RPO 取决于数据复制频率，该频率受主区域和二级区域之间可用带宽的限制。典型的最小 RPO 介于 20 分钟到多小时之间。</block>
  <block id="08c05e932772c12e2978ada46a1f6fde" category="paragraph">本文档讨论了双区域灾难恢复解决方案的不同实施选项。</block>
  <block id="a4936a8eb54bc60527eb7e837201d5d2" category="paragraph"><block ref="a4936a8eb54bc60527eb7e837201d5d2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="66ae478deb0faaf5c7e1c6c30e561515" category="section-title">SAP HANA 系统复制</block>
  <block id="aeea0de8341a54a856110ddcce703647" category="paragraph">SAP HANA 系统复制在数据库层运行。解决方案基于灾难恢复站点上的另一个 SAP HANA 系统，该系统可从主系统接收更改。此二级系统必须与主系统相同。</block>
  <block id="ef484be15551dd90fef91c2c2e1282f1" category="paragraph">SAP HANA 系统复制可在以下两种模式之一下运行：</block>
  <block id="d6c8e17e761081d42a482d42d4f77766" category="list-text">将数据预加载到内存中，并在灾难恢复站点上配置一个专用服务器：</block>
  <block id="f5c7666e551b7dcd0fb7f6bf74abeccb" category="list-text">此服务器专用于 SAP HANA 系统复制二级主机。</block>
  <block id="ffc1f03746fb6cf99cdec6f3abc213eb" category="list-text">可以实现极低的 RTO 值，因为数据已加载到内存中，在发生故障转移时不需要启动数据库。</block>
  <block id="a3ebd8ee4ae26bbbfa2ea01be47e0a0d" category="list-text">在灾难恢复站点的内存和共享服务器中未预加载数据的情况下：</block>
  <block id="477f056d84ccdedcc2b8da7c0fe2f21e" category="list-text">此服务器作为 SAP HANA System Replication 二级系统和开发 / 测试系统共享。</block>
  <block id="1f15430c22b1c4d0b83cbf3df1b2e9f4" category="list-text">RTO 主要取决于启动数据库并将数据加载到内存所需的时间。</block>
  <block id="0dbe2efb71acfabc184da717728493bc" category="inline-link">《 SAP HANA 管理指南》</block>
  <block id="24fc91edc6ddc9820730d1097931adb5" category="paragraph">有关所有配置选项和复制场景的完整问题描述，请参见<block ref="9cdea1030de1a49498ea242aace833a6" category="inline-link-rx"></block>。</block>
  <block id="61fd3b86c424b68c3025dfa4d7435573" category="paragraph">下图显示了使用 SAP HANA 系统复制的双区域灾难恢复解决方案的设置。在同一 Azure 区域，但在不同的可用性区域，本地 HA 会使用预加载到内存中的数据进行同步复制。为远程灾难恢复区域配置了不预加载数据的异步复制。</block>
  <block id="de6b408d617cacbaebc5613e7bae767a" category="paragraph">下图显示了 SAP HANA 系统复制。</block>
  <block id="7033c68b4a3970f45586136c4214490a" category="paragraph"><block ref="7033c68b4a3970f45586136c4214490a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5ad9de507b94a9e35c82779c07b66112" category="section-title">将数据预加载到内存中的 SAP HANA 系统复制</block>
  <block id="ad09da2a8b21e5c941bff9931f0257fc" category="paragraph">只有在将数据预加载到内存中的 SAP HANA 系统复制功能下， SAP HANA 才能实现极低的 RTO 值。在灾难恢复站点使用专用二级服务器运行 SAP HANA 系统复制时， RTO 值大约可以为 1 分钟或更短。复制的数据会在二级系统上接收并预加载到内存中。由于故障转移时间较短， SAP HANA 系统复制也经常用于近乎零停机的维护操作，例如 HANA 软件升级。</block>
  <block id="2f8b151742608c981dfe2a7be31eb254" category="paragraph">通常， SAP HANA 系统复制配置为在选择数据预加载时同步复制。同步复制支持的最大距离在 100 公里范围内。</block>
  <block id="3f9cb7e4fa20fef95aea32cdc69e8460" category="section-title">SAP 系统复制，而不将数据预加载到内存中</block>
  <block id="694c53f0877cbba373135629373bd319" category="paragraph">对于不太严格的 RTO 要求，您可以在不预加载数据的情况下使用 SAP HANA 系统复制。在此操作模式下，灾难恢复区域的数据不会加载到内存中。灾难恢复区域的服务器仍用于处理运行所有所需 SAP HANA 进程的 SAP HANA 系统复制。但是，服务器的大部分内存可用于运行其他服务，例如 SAP HANA 开发 / 测试系统。</block>
  <block id="2b44d8f81b2975c63242c95c59996df6" category="paragraph">发生灾难时，必须关闭开发 / 测试系统，启动故障转移，并将数据加载到内存中。这种冷备用方法的 RTO 取决于数据库大小以及加载行和列存储期间的读取吞吐量。假设数据的读取吞吐量为 1000 Mbps ，则加载 1 TB 数据大约需要 18 分钟。</block>
  <block id="9bcfdabaf14710772f17b0493d653584" category="section-title">使用 ANF 跨区域复制实现 SAP HANA 灾难恢复</block>
  <block id="b2c9700ba0816986783177a06a90716d" category="paragraph">ANF 跨区域复制内置在 ANF 中，作为使用异步数据复制的灾难恢复解决方案。anf 跨区域复制通过主 Azure 区域和二级 Azure 区域上的两个 ANF 卷之间的数据保护关系进行配置。如果跨区域复制使用高效的块增量复制来更新二级卷。可以在复制配置期间定义更新计划。</block>
  <block id="35df9d5566869e97350fa1c3c40102d9" category="paragraph">下图显示了一个使用 ANF 跨区域复制的双区域灾难恢复解决方案示例。在本示例中， HANA 系统通过主区域中的 HANA 系统复制进行保护，如上一章所述。使用 ANF 跨区域复制功能复制到二级区域。RPO 由复制计划和复制选项定义。</block>
  <block id="7e70869a8c06362cbdb278f6d317ceec" category="paragraph">RTO 主要取决于在灾难恢复站点启动 HANA 数据库以及将数据加载到内存所需的时间。假设数据的读取吞吐量为 1000 MB/ 秒，则加载 1 TB 数据大约需要 18 分钟。根据复制配置的不同，还需要进行正向恢复，并会增加总 RTO 值。</block>
  <block id="333d88bd70b0ad524022e4b15f89a870" category="inline-link-macro">使用 SAP HANA 跨区域复制的配置选项</block>
  <block id="0786a6f261ed6ec3ab2b81dc0b39a93b" category="paragraph">有关不同配置选项的更多详细信息，请参见第节 <block ref="61afd4207f77a3bdeba925744e9e65c0" category="inline-link-macro-rx"></block>。</block>
  <block id="47fee6f62b40967ce289036f382d6aa0" category="paragraph">正常运行期间，灾难恢复站点上的服务器可用作开发 / 测试系统。发生灾难时，必须关闭开发 / 测试系统并将其作为灾难恢复生产服务器启动。</block>
  <block id="56f51c8398e16c6c97472e682d0549cd" category="paragraph">通过 ANF 跨区域复制，您可以在不影响 RPO 和 RTO 的情况下测试灾难恢复工作流。这是通过创建卷克隆并将其附加到灾难恢复测试服务器来实现的。</block>
  <block id="52738c67ddfc79d0f20d5269ad771b8a" category="paragraph"><block ref="52738c67ddfc79d0f20d5269ad771b8a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1300b1f384765a2d6f6642aa7d71b546" category="section-title">灾难恢复解决方案摘要</block>
  <block id="c3cb469f59db6d8e60f13c8b3e5fad50" category="paragraph">下表对本节中讨论的灾难恢复解决方案进行了比较，并重点介绍了最重要的指标。</block>
  <block id="f484ed4f391844d7fadc29244749f39c" category="paragraph">主要调查结果如下：</block>
  <block id="6622cfdf1e725d8b4135a456e357be05" category="list-text">如果需要极低的 RTO ，则只能选择预加载到内存中的 SAP HANA 系统复制。</block>
  <block id="b116f45c5b2c42d1e8138d258d2f5fe8" category="list-text">灾难恢复站点需要一台专用服务器来接收复制的数据并将数据加载到内存中。</block>
  <block id="2d8a377fde672fd724220780b842a83d" category="list-text">此外，还需要对数据库外部的数据（例如共享文件，接口等）进行存储复制。</block>
  <block id="ecb2ed817ee95fa396911576436c27ba" category="list-text">如果 RTO 或 RPO 要求不太严格，则也可以使用 ANF 跨区域复制来：</block>
  <block id="e8c0f0174ad6150d9635ee7aa99e4228" category="list-text">将数据库和非数据库数据复制结合使用。</block>
  <block id="6266f60d19983a11b58c24924930b95e" category="list-text">涵盖其他使用情形，例如灾难恢复测试和开发 / 测试更新。</block>
  <block id="68f3fced0a17e5de6db735bd1ca45890" category="list-text">通过存储复制，可以在正常操作期间将灾难恢复站点上的服务器用作 QA 或测试系统。</block>
  <block id="f2d77916dea94337c3b46fd53e9685c7" category="list-text">将 SAP HANA 系统复制作为高可用性解决方案与 RPO=0 以及远程存储复制相结合，对于满足不同的要求是有意义的。</block>
  <block id="0a636bae693e759b89cfb2c0eb9cc58d" category="paragraph">下表对灾难恢复解决方案进行了比较。</block>
  <block id="6b0f1320c0ca34e38fda2a62b7d85f42" category="cell">存储复制</block>
  <block id="061f2f8944130376248327444c4e04f3" category="cell">SAP HANA 系统复制</block>
  <block id="b34347ddf6e48f7eb5aee09d6f7b92a6" category="cell">* 跨区域复制 *</block>
  <block id="a590feeee99c4eece8151edeebf0f29f" category="cell">* 具有数据预加载 *</block>
  <block id="7a6d071835a5d748a307424938d7828f" category="cell">* 无数据预加载 *</block>
  <block id="81acff625024c4f103c5facbd0fd49ea" category="cell">RTO</block>
  <block id="765e065e77ae2adb36770b0a057e2e5b" category="cell">低到中，具体取决于数据库启动时间和正向恢复</block>
  <block id="23011c5407fa1798961babe5803602f3" category="cell">非常低</block>
  <block id="89d26991942cf55ebbc2208a4c545bf9" category="cell">低到中，具体取决于数据库启动时间</block>
  <block id="7617de228058c641a638d21a9e3fbd7c" category="cell">RPO</block>
  <block id="161da3361681a0410ce6d369a9f4e50c" category="cell">RPO &gt; 20 分钟异步复制</block>
  <block id="f13811b02fa6f16283beed9446f9fc82" category="cell">RPO &gt; 20 分钟异步复制 RPO=0 同步复制</block>
  <block id="fcf1ef373c2215be6974c8f48b7e76e1" category="cell">灾难恢复站点的服务器可用于开发 / 测试</block>
  <block id="93cba07454f06a4a960172bbd6e2a435" category="cell">是的。</block>
  <block id="bafd7322c6e97d25b6299b5d6fe8920b" category="cell">否</block>
  <block id="e9a0c7e28ba3eab1bc6af3c80e34b8a2" category="cell">复制非数据库数据</block>
  <block id="31dbf042d36f2d2466e8c84d4eb1d5f2" category="cell">灾难恢复数据可用于刷新开发 / 测试系统</block>
  <block id="978cc4a302a1b7555072ef943e882f05" category="cell">在不影响 RTO 和 RPO 的情况下执行灾难恢复测试</block>
  <block id="d922ce21806bdfa807ebed599a760cdf" category="inline-link-macro">接下来：使用 SAP HANA 进行跨区域复制。</block>
  <block id="879ebcb26a568975064742642a159602" category="paragraph"><block ref="879ebcb26a568975064742642a159602" category="inline-link-macro-rx"></block></block>
  <block id="4715bf8add38a289ec23829f68ca6ab1" category="summary">研究表明，业务应用程序停机对企业业务产生了重大负面影响。</block>
  <block id="48d5e63e9107995e8ea0ce708339c7bd" category="doc">TR-4891 ：《使用 Azure NetApp Files 实现 SAP HANA 灾难恢复》</block>
  <block id="0f3dc633a4d453e6870a20626efbd6ae" category="paragraph">NetApp Ralf Klahr Nil Baucer ， Microsoft</block>
  <block id="6dd1b3bcc69afff2942ce57c2b203500" category="paragraph">研究表明，业务应用程序停机对企业业务产生了重大负面影响。除了财务影响之外，停机还会损害公司的声誉，员工士气和客户忠诚度。令人惊讶的是，并非所有公司都制定了全面的灾难恢复策略。</block>
  <block id="ffca3d9db8dc584e54dd8dc3551eabb9" category="paragraph">通过在 Azure NetApp Files 上运行 SAP HANA （ ANF ），客户可以访问其他功能，这些功能可以扩展和改进 SAP HANA 的内置数据保护和灾难恢复功能。本概述部分介绍了这些选项，以帮助客户选择支持其业务需求的选项。</block>
  <block id="8a675f2a23ea4c44524efb908ae11cc8" category="paragraph">要制定全面的灾难恢复策略，客户必须了解数据保护和灾难恢复所需的业务应用程序要求和技术功能。下图概述了数据保护。</block>
  <block id="a6509afa56b2e5f2b15905b34caaf1f0" category="paragraph"><block ref="a6509afa56b2e5f2b15905b34caaf1f0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0bfad55781cf801dfc13ccd9a530fc19" category="section-title">业务应用程序要求</block>
  <block id="0703f72eebc09724abffe00a84eccd17" category="paragraph">业务应用程序有两个关键指标：</block>
  <block id="f5075c8d0b3fde0d177163438d4169b9" category="list-text">恢复点目标（ RPO ）或最大容许数据丢失</block>
  <block id="86c0854362b4108af9e516077a22dcc1" category="list-text">恢复时间目标（ RTO ）或允许的最大业务应用程序停机时间</block>
  <block id="34a5165e4ff0cd4794a05c9d055ec269" category="paragraph">这些要求是根据所使用的应用程序类型和业务数据的性质来定义的。如果您要在一个 Azure 区域防止出现故障，则 RPO 和 RTO 可能会有所不同。如果您正在准备应对灾难，例如丢失完整的 Azure 区域，则它们可能也会有所不同。评估用于定义 RPO 和 RTO 的业务要求非常重要，因为这些要求会对可用的技术选项产生重大影响。</block>
  <block id="05807e454c19f244770adae059b3c330" category="section-title">高可用性</block>
  <block id="02894d06d27b56212ed6fbfccbf5b46d" category="paragraph">SAP HANA 基础架构（例如虚拟机，网络和存储）必须具有冗余组件，以确保不会出现单点故障。MS Azure 可为不同的基础架构组件提供冗余。</block>
  <block id="2056be3e7fe4aad29d8cf504dbe6cad9" category="paragraph">为了在计算和应用程序端提供高可用性，可以使用 SAP HANA 多主机系统配置备用 SAP HANA 主机以实现内置的高可用性。如果服务器或 SAP HANA 服务发生故障， SAP HANA 服务将故障转移到备用主机，从而导致应用程序停机。</block>
  <block id="4acc4b54b5bc31fe21ee19d247c247ba" category="paragraph">如果在服务器或应用程序发生故障时无法接受应用程序停机，您也可以使用 SAP HANA 系统复制作为高可用性解决方案，以便在极短的时间内实现故障转移。SAP 客户使用 HANA 系统复制不仅可以解决计划外故障的高可用性问题，还可以最大限度地减少计划内操作（例如 HANA 软件升级）的停机时间。</block>
  <block id="4cf7b593d5e437dfa0b7b2a5ee3efa97" category="section-title">逻辑损坏</block>
  <block id="5d107f9aa3c669862cfdd15f14788e11" category="paragraph">逻辑损坏可能是由软件错误，人为错误或破坏引起的。遗憾的是，使用标准高可用性和灾难恢复解决方案往往无法解决逻辑损坏问题。因此，根据发生逻辑损坏的层，应用程序，文件系统或存储，有时无法满足 RTO 和 RPO 要求。</block>
  <block id="443448e75fe6177a59a73cd194626ddb" category="paragraph">最糟糕的情况是 SAP 应用程序中的逻辑损坏。SAP 应用程序通常在不同应用程序相互通信并交换数据的环境中运行。因此，不建议使用还原和恢复发生逻辑损坏的 SAP 系统。将系统还原到损坏发生前的某个时间点会导致数据丢失，因此 RPO 会大于零。此外， SAP 环境将不再同步，需要额外的后处理。</block>
  <block id="04262f34451f36f688f3d8e90f5e8c3c" category="paragraph">更好的方法是尝试通过在单独的修复系统中分析问题来修复系统中的逻辑错误，而不是还原 SAP 系统。根发生原因分析需要业务流程和应用程序所有者的参与。在这种情况下，您可以根据发生逻辑损坏之前存储的数据创建修复系统（生产系统的克隆）。在修复系统中，可以将所需数据导出并导入到生产系统中。通过这种方法，无需停止生产系统，在最佳情况下，不会丢失任何数据，也不会丢失一小部分数据。</block>
  <block id="59ccab7de24ca9bc19407633e26a3cf6" category="admonition">设置修复系统所需的步骤与本文档所述的灾难恢复测试场景相同。因此，可以轻松扩展所述的灾难恢复解决方案，以解决逻辑损坏问题。</block>
  <block id="1414cdc093d39dd56d0b0d20049e17fc" category="section-title">备份</block>
  <block id="0cfa2764bd4e71a51de20746e90e6611" category="paragraph">创建备份，以便从不同的时间点数据集进行还原和恢复。通常，这些备份会保留几天到几周。</block>
  <block id="df76538ee7be2473592123c0402f7491" category="paragraph">根据损坏的类型，无论是否丢失数据，都可以执行还原和恢复。如果 RPO 必须为零，即使主存储和备份存储丢失，备份也必须与同步数据复制结合使用。</block>
  <block id="742cd7a760d5086ea1510d8d642c6ba0" category="paragraph">用于还原和恢复的 RTO 由所需还原时间，恢复时间（包括数据库启动）以及将数据加载到内存中来定义。对于大型数据库和传统备份方法， RTO 可能很容易需要几个小时，这可能是不可接受的。要使 RTO 值非常低，必须将备份与热备用解决方案结合使用，其中包括将数据预加载到内存中。</block>
  <block id="9fa6087af3062ad3648dc5977dfb040b" category="paragraph">相反，备份解决方案必须解决逻辑损坏问题，因为数据复制解决方案无法涵盖所有类型的逻辑损坏。</block>
  <block id="5e9d83ea8e8a00e0f5cb9f9049b4ee80" category="section-title">同步或异步数据复制</block>
  <block id="549dd6ad7c9bb8e1ffa4e26090ad44b9" category="paragraph">RPO 主要确定您应使用的数据复制方法。如果 RPO 必须为零，即使主存储和备份存储丢失，也必须同步复制数据。但是，同步复制存在技术限制，例如两个 Azure 区域之间的距离。在大多数情况下，由于延迟，同步复制不适用于 100 公里以上的距离，因此，这不是 Azure 区域之间数据复制的选项。</block>
  <block id="5515876e48f77fbadc732d2d0b61fb6e" category="paragraph">如果可以接受更大的 RPO ，则可以在远距离使用异步复制。在这种情况下， RPO 由复制频率定义。</block>
  <block id="50a4caaa98ec68a105f1a2f046046b49" category="section-title">无论是否预加载数据，均可执行 HANA 系统复制</block>
  <block id="19fe37735fc2d812bd3ae9b350c9042b" category="paragraph">SAP HANA 数据库的启动时间比传统数据库的启动时间长得多，因为在数据库提供预期性能之前，必须将大量数据加载到内存中。因此， RTO 的很大一部分是启动数据库所需的时间。对于任何基于存储的复制以及不预加载数据的 HANA 系统复制，在故障转移到灾难恢复站点时，必须启动 SAP HANA 数据库。</block>
  <block id="e2fc131564c468ee9b36f0286ca4ca75" category="paragraph">SAP HANA 系统复制提供了一种操作模式，在该模式下，数据会在二级主机上进行预加载并持续更新。此模式启用的 RTO 值非常低，但它还需要一个专用服务器，该服务器仅用于从源系统接收复制数据。</block>
  <block id="4612fb4bb7d689e691304c681b2f2b6d" category="inline-link-macro">接下来：灾难恢复解决方案比较。</block>
  <block id="4e4c47aa0a61c57bf1fdfa75a1cceb7a" category="paragraph"><block ref="4e4c47aa0a61c57bf1fdfa75a1cceb7a" category="inline-link-macro-rx"></block></block>
  <block id="4854d6f0814f33fab723d723df86a202" category="summary">下面显示了 HANA 数据库恢复的步骤</block>
  <block id="7bda2d80ff35cc44a2e131e0160f8093" category="paragraph">以下各小节介绍了使用复制的日志备份进行正向恢复和不转发恢复的恢复过程。可以使用系统数据库的 HANA 恢复脚本和租户数据库的 hdbsql. 命令执行恢复。</block>
  <block id="59c7c30c56560af87e5171c311185571" category="section-title">恢复到最新的 HANA 数据卷备份保存点</block>
  <block id="99deca0459bb05c2895cfaffbd802eef" category="paragraph">使用以下命令以用户 pr1adm 的身份执行到最新备份 savepoint 的恢复：</block>
  <block id="0795408f76a4c59ab10d4b68b30e2b26" category="paragraph">租户恢复现在使用 hdbsql.</block>
  <block id="fbff45b2905a411c1ec2710a73ba047f" category="paragraph">HANA 数据库现在已启动并正在运行，并且 HANA 数据库的灾难恢复工作流已进行测试。</block>
  <block id="180f6a3cc920cbfac7b9138f31af3be1" category="section-title">使用日志 / 目录备份进行正向恢复</block>
  <block id="46fdca8f1816e8f0fba1ae53b20a312a" category="paragraph">正在从源系统复制日志备份和 HANA 备份目录。</block>
  <block id="7713e703c3de9d49c8be8c5a144941ec" category="admonition">要使用所有可用日志进行恢复，您可以在恢复语句中随时使用作为时间戳。</block>
  <block id="9aa362cc10f78dc9c324638e14784e6d" category="paragraph">必须对系统和租户数据库的最新日志备份文件执行检查。</block>
  <block id="6c60b403a3bd7528181604bbb3b59acf" category="inline-link-macro">接下来：灾难恢复故障转移。</block>
  <block id="5c9678dc520e897150e85a9eab342820" category="paragraph"><block ref="5c9678dc520e897150e85a9eab342820" category="inline-link-macro-rx"></block></block>
  <block id="89c00df8ab7faebd2081b13849c02f6d" category="summary">现在，可以根据之前创建的 ` /etc/fstab` 文件将卷挂载到目标主机上。</block>
  <block id="13b6058df71d238dde34faeb0f23ca53" category="doc">在目标主机上挂载卷</block>
  <block id="58166a2431dc0a51ec1f5a311f200c40" category="inline-link-macro">先前：中断并删除复制对等关系。</block>
  <block id="d69655ebe435ae84de72454a9533655f" category="paragraph"><block ref="d69655ebe435ae84de72454a9533655f" category="inline-link-macro-rx"></block></block>
  <block id="1da449d2e957dd78330521b9016a8443" category="paragraph"><block ref="1da449d2e957dd78330521b9016a8443" category="inline-link-macro-rx"></block></block>
  <block id="8781b56e6525bf79ec3510bf11e251db" category="doc">灾难恢复测试</block>
  <block id="87dee89423a5f714e7dec138750cc5e4" category="summary">根据灾难恢复设置（包括或不包括日志备份复制），必须根据 Snapshot 备份创建两个或三个新卷。</block>
  <block id="3599970764d2d96426abf88cbe76d48f" category="doc">在灾难恢复站点基于 Snapshot 备份创建新卷</block>
  <block id="239d7c1ce03173e0058b9099857f1d21" category="inline-link-macro">上一步：准备目标主机。</block>
  <block id="cc158024b9d9c74b1ddd4df0ae24e74a" category="paragraph"><block ref="cc158024b9d9c74b1ddd4df0ae24e74a" category="inline-link-macro-rx"></block></block>
  <block id="88376d0d25aeb33976aa7430202e2f7d" category="paragraph">根据灾难恢复设置（包括或不包括日志备份复制），必须根据 Snapshot 备份创建两个或三个新卷。在这两种情况下，都必须为数据创建一个新卷，并为 HANA 共享卷创建一个新卷。如果同时复制日志备份数据，则必须为日志备份卷创建一个新卷。在我们的示例中，数据和日志备份卷已复制到灾难恢复站点。以下步骤使用 Azure 门户。</block>
  <block id="6d1f3c07ad25da0bbbcd07ddc688135f" category="list-text">系统会选择一个应用程序一致的快照备份作为 HANA 数据卷的新卷的源。选择还原到新卷以根据快照备份创建新卷。</block>
  <block id="0fcc7316784f7984b884e1cbc041e958" category="paragraph"><block ref="0fcc7316784f7984b884e1cbc041e958" category="inline-image-macro-rx" type="image"></block></block>
  <block id="479340e25e53263cccbe4d400974554e" category="list-text">必须在用户界面中提供新的卷名称和配额。</block>
  <block id="242b2aeffde13973050a8e1eab32064d" category="paragraph"><block ref="242b2aeffde13973050a8e1eab32064d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="60949ae1e8e73bbec42287a8cd6f8ed0" category="list-text">在协议选项卡中，配置文件路径和导出策略。</block>
  <block id="b7fefe46a6d234b9f97bb7d6ac27c43e" category="paragraph"><block ref="b7fefe46a6d234b9f97bb7d6ac27c43e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8759ff9c6ca36d554091c45e68dc83bd" category="list-text">创建和查看屏幕总结了配置。</block>
  <block id="e8b43847eedf298af9b38a3eca314a02" category="paragraph"><block ref="e8b43847eedf298af9b38a3eca314a02" category="inline-image-macro-rx" type="image"></block></block>
  <block id="55114f27f28823ee3356c20ed9fef0ef" category="list-text">现在，已根据 HANA 快照备份创建了一个新卷。</block>
  <block id="085af1006747e6304cb2e0274116be70" category="paragraph"><block ref="085af1006747e6304cb2e0274116be70" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fa6abbf0782170b61d3fdc6372a0efe0" category="paragraph">现在，必须对 HANA 共享卷和日志备份卷执行相同的步骤，如以下两个屏幕截图所示。由于尚未为 HANA 共享和日志备份卷创建其他快照，因此必须选择最新的 SnapMirror Snapshot 副本作为新卷的源。这是非结构化数据， SnapMirror Snapshot 副本可用于此用例。</block>
  <block id="794f3b206b0c1ad41943efd4f4f27c84" category="paragraph"><block ref="794f3b206b0c1ad41943efd4f4f27c84" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b1c029a960afc679b7835cedb8343cc0" category="paragraph">以下屏幕截图显示了已还原到新卷的 HANA 共享卷。</block>
  <block id="1ffb3226d384c646ba47879707628255" category="paragraph"><block ref="1ffb3226d384c646ba47879707628255" category="inline-image-macro-rx" type="image"></block></block>
  <block id="620ba589298c0daf613aef8a49ec1187" category="admonition">如果已使用性能层较低的容量池，则现在必须将卷移至可提供所需性能的容量池。</block>
  <block id="2fd2064e7ce5a3879663f0a4fe612413" category="paragraph">所有这三个新卷现在都可用，并且可以挂载到目标主机上。</block>
  <block id="b920fd371a20c194ed2d56e81b8254bc" category="inline-link-macro">下一步：在目标主机上挂载新卷。</block>
  <block id="ff0b25dd7292e4c154188a7a5f33eca4" category="paragraph"><block ref="ff0b25dd7292e4c154188a7a5f33eca4" category="inline-link-macro-rx"></block></block>
  <block id="483be6f3dd37511b4c6b3e752d378767" category="summary">发生灾难故障转移时，必须断开目标卷，以便目标主机可以挂载这些卷以执行读写操作。</block>
  <block id="5facbc8db35e3716949290f0b40e7de4" category="doc">中断并删除复制对等关系</block>
  <block id="2499e9fcf1646bef2535cb24fc94c962" category="paragraph"><block ref="2499e9fcf1646bef2535cb24fc94c962" category="inline-link-macro-rx"></block></block>
  <block id="9266018f113912af184108e98c050efd" category="admonition">对于 HANA 数据卷，您必须将该卷还原到使用 AzAcSnap 创建的最新 HANA 快照备份。如果由于复制对等关系而将最新复制快照标记为繁忙，则无法执行此卷还原操作。因此，您还必须删除复制对等关系。</block>
  <block id="cb41ee3647c83dda0f32ae3d0c0bbdeb" category="paragraph">接下来的两个屏幕截图显示了 HANA 数据卷的中断和删除对等操作。此外，还必须对日志备份和 HANA 共享卷执行相同的操作。</block>
  <block id="11189a65e17581535a27299bae2ac0e6" category="paragraph"><block ref="11189a65e17581535a27299bae2ac0e6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="88c79e8d4c8720a8689ccccd558f3f69" category="paragraph"><block ref="88c79e8d4c8720a8689ccccd558f3f69" category="inline-image-macro-rx" type="image"></block></block>
  <block id="46b67b68e6f57344571ed5e6deb96640" category="paragraph">由于复制对等关系已删除，因此可以将卷还原到最新的 HANA 快照备份。如果未删除对等关系，则对还原卷的选择将灰显且不可选。以下两个屏幕截图显示了卷还原操作。</block>
  <block id="8d340ed14b64fdd68b553c43f46a87f1" category="paragraph"><block ref="8d340ed14b64fdd68b553c43f46a87f1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4a9f6bf31833ee2ac14dbaff360dd630" category="paragraph"><block ref="4a9f6bf31833ee2ac14dbaff360dd630" category="inline-image-macro-rx" type="image"></block></block>
  <block id="44bc131dcbc031dad5c60665d0e777cb" category="paragraph">执行卷还原操作后，数据卷将基于一致的 HANA 快照备份，现在可用于执行正向恢复操作。</block>
  <block id="26a7c251db745e0e6e323b2d2a1f06f7" category="admonition">如果已使用性能层较低的容量池，则现在必须将卷移至可提供所需性能的容量池。</block>
  <block id="977c0b846b42e4f38ffde358fe83b871" category="inline-link-macro">下一步：在目标主机上挂载卷。</block>
  <block id="5d3c24a21f2cb6e1cb0c12b1be75023b" category="paragraph"><block ref="5d3c24a21f2cb6e1cb0c12b1be75023b" category="inline-link-macro-rx"></block></block>
  <block id="611474da8104a1c517f6d3e00b794bad" category="summary">本节介绍用于灾难恢复故障转移的服务器所需的准备步骤。</block>
  <block id="3722e335044c30ca5330402a2fe7de4d" category="inline-link-macro">先前：灾难恢复故障转移。</block>
  <block id="8c00f0533910595b011acd0c4f9eff54" category="paragraph"><block ref="8c00f0533910595b011acd0c4f9eff54" category="inline-link-macro-rx"></block></block>
  <block id="fd0f9a84ad1162accae744eb4e8720bc" category="paragraph">在正常运行期间，目标主机通常用于其他目的，例如 HANA QA 或测试系统。因此，在执行灾难故障转移测试时，必须执行所述的大部分步骤。另一方面，只需复制配置文件，即可准备相关配置文件，例如 ` /etc/fstab` 和 ` usr/sapservices` ，然后将其投入生产。灾难恢复故障转移操作步骤可确保正确配置准备好的相关配置文件。</block>
  <block id="68414e630c2410427f8528f7531641e3" category="paragraph">目标主机准备工作还包括关闭 HANA QA 或测试系统，以及使用 `systemctl stop sapinit` 停止所有服务。</block>
  <block id="8660a2116ae3634df0fd5dc665458840" category="paragraph">SAP 主机代理软件必须安装在目标服务器上。有关完整信息，请参见<block ref="dfb99acb3a5bfb8e56c9630a62e67a77" category="inline-link-rx"></block> 在 SAP 帮助门户上。</block>
  <block id="42b048440c50c198439a3f5cf6b2f8fc" category="paragraph">如果日志备份卷复制是灾难恢复设置的一部分，则复制的日志备份卷将挂载到目标主机上，而无需准备额外的日志备份卷。</block>
  <block id="cb03fc2ba6f5264a1d18ec731940b865" category="paragraph">下表显示了实验室设置中使用的命名约定。灾难恢复站点上的卷名称包含在 ` /etc/fstab` 中。</block>
  <block id="3371b95f5c42f5eee8e2e58a6f48fa14" category="cell">灾难恢复站点上的卷和子目录</block>
  <block id="1dc43cfb2d7ee9173ee71963196e6560" category="cell">PR1-shared-sm-dest/shared PR1-shared-sm-dest/usr-sap-pr1</block>
  <block id="b22da6ced8752b012e3da78c79177c72" category="admonition">必须在目标主机上创建此表中的挂载点。</block>
  <block id="061a5576a02769454cefd26ff8f8a9e5" category="inline-link-macro">下一步：中断并删除复制对等关系。</block>
  <block id="dd4401b918762c4290e25aca9a3821cc" category="paragraph"><block ref="dd4401b918762c4290e25aca9a3821cc" category="inline-link-macro-rx"></block></block>
  <block id="d6592b2b5e0e3f570578edc3ab023e7a" category="summary">根据日志备份复制是否属于灾难恢复设置的一部分，灾难恢复的步骤略有不同。</block>
  <block id="baaf26c3cc1634b64f550cbbc10d58ed" category="doc">灾难恢复故障转移</block>
  <block id="dc6b37a8d0f9881e114866c92f31728d" category="inline-link-macro">先前版本： HANA 数据库恢复。</block>
  <block id="f059411c2c29c1b9e86f9e95d88a0f69" category="paragraph"><block ref="f059411c2c29c1b9e86f9e95d88a0f69" category="inline-link-macro-rx"></block></block>
  <block id="e8bee4c9f7418a9fa7423012c3115980" category="paragraph">根据日志备份复制是否属于灾难恢复设置的一部分，灾难恢复的步骤略有不同。本节介绍了适用于纯数据备份复制以及与日志备份卷复制结合使用的数据卷复制的灾难恢复故障转移。</block>
  <block id="1db54f8e2a972ae70747d37496118790" category="paragraph">要执行灾难恢复故障转移，请完成以下步骤：</block>
  <block id="1f61cc07babe71682a84ca95fe1c7d13" category="list-text">中断并删除复制关系。</block>
  <block id="c14c2fe0d30d26aa71b42b15a55b4ac8" category="list-text">将数据卷还原为最新的应用程序一致的 Snapshot 备份。</block>
  <block id="4eee8932f478fb4d431ea7945a48e97a" category="list-text">在目标主机上挂载卷。</block>
  <block id="7f40610e983d6f727ad40881c5a306b8" category="paragraph">以下各小节详细介绍了这些步骤，下图介绍了灾难故障转移测试。</block>
  <block id="c9d197d7b4f75f29f2e390dae49b2082" category="paragraph"><block ref="c9d197d7b4f75f29f2e390dae49b2082" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d5c8c5ee498c72674a9c51260344fe3e" category="paragraph"><block ref="d5c8c5ee498c72674a9c51260344fe3e" category="inline-link-macro-rx"></block></block>
  <block id="89b5eb16af03c7090de707cc37ac1f09" category="summary">下图显示了使用 ANF 跨区域复制的 SAP HANA 系统的卷复制关系。</block>
  <block id="7d224183d244c3eb1b578f3d5d711cfb" category="doc">使用 SAP HANA 进行跨区域复制的配置选项</block>
  <block id="c98b7ee11f048eb89a2e0d3944610ef1" category="inline-link-macro">先前版本：使用 SAP HANA 进行跨区域复制。</block>
  <block id="0751fceb33e02b6258a3202acb573906" category="paragraph"><block ref="0751fceb33e02b6258a3202acb573906" category="inline-link-macro-rx"></block></block>
  <block id="3743669162e4cca4ba5fb8da0d3aa70a" category="paragraph">下图显示了使用 ANF 跨区域复制的 SAP HANA 系统的卷复制关系。使用 ANF 跨区域复制时，必须复制 HANA 数据和 HANA 共享卷。如果仅复制 HANA 数据卷，则典型 RPO 值的范围为一天。如果需要较低的 RPO 值，则还必须复制 HANA 日志备份以进行正向恢复。</block>
  <block id="a5fce1269f63c611b20450b2bb542581" category="admonition">本文档中使用的术语 " 日志备份 " 包括日志备份和 HANA 备份目录备份。执行正向恢复操作需要 HANA 备份目录。</block>
  <block id="114e1274446139d76dc9144e2b14ccc1" category="admonition">以下问题描述和实验室设置侧重于 HANA 数据库。其他共享文件（例如 SAP 传输目录）将采用与 HANA 共享卷相同的方式进行保护和复制。</block>
  <block id="edeecb7503e77b90ed51e96e450bce5f" category="inline-link">什么是适用于 Azure NetApp Files 的 Azure 应用程序一致性 Snapshot 工具 | Microsoft 文档</block>
  <block id="3a325ee10c0e0cbba17bbb780ab5ee2c" category="paragraph">要使用日志备份启用 HANA 保存点恢复或正向恢复，必须在主站点为 HANA 数据卷创建应用程序一致的数据 Snapshot 备份。例如，可以使用 ANF 备份工具 AzAcSnap 执行此操作（另请参见<block ref="ad4a6e6049ad4c7fd5609e852333bc9f" category="inline-link-rx"></block>）。然后，在主站点创建的 Snapshot 备份将复制到灾难恢复站点。</block>
  <block id="23a57e4f9acbbc326b84af2c9f4d23c7" category="paragraph">在发生灾难故障转移时，必须中断复制关系，将卷挂载到灾难恢复生产服务器，并且必须将 HANA 数据库恢复到最后一个 HANA 保存点，或者使用复制的日志备份进行正向恢复。章节 <block ref="baf54569999503bd576caeb99186c047" category="inline-link-macro-rx"></block>，介绍了所需的步骤。</block>
  <block id="713aae56a240e325bb34a0d833729e8f" category="paragraph">下图展示了跨区域复制的 HANA 配置选项。</block>
  <block id="e8d5db08ddf9a2c8bcee15a77c9ea06d" category="paragraph"><block ref="e8d5db08ddf9a2c8bcee15a77c9ea06d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="600ce73f728ef876696aea07da944d48" category="paragraph">对于当前版本的跨区域复制，只能选择固定计划，用户无法定义实际复制更新时间。可用计划包括每日，每小时和每 10 分钟。使用这些计划选项，根据 RPO 要求，有两种不同的配置是有意义的：不执行日志备份复制的数据卷复制以及按不同计划执行的日志备份复制，每小时或每 10 分钟执行一次。可实现的最低 RPO 约为 20 分钟。下表总结了配置选项以及生成的 RPO 和 RTO 值。</block>
  <block id="fcd256654a3c5292023efa55d739bc80" category="cell">数据卷复制</block>
  <block id="1a77af3d4771bcb235680750736a7963" category="cell">数据和日志备份卷复制</block>
  <block id="ecd2e667aef672cef20ccf5d1999bae6" category="cell">CRR 计划数据卷</block>
  <block id="766c1532a762dac9ff24af748740e26b" category="cell">CRR 计划日志备份卷</block>
  <block id="7dd6a6ab32fdea4f29883abb60388da7" category="cell">10 分钟</block>
  <block id="2b1f07f9d71545257dcca60137caef28" category="cell">最大 RPO</block>
  <block id="ca17d9638aadac1ac94c382ca423aa5f" category="cell">24 小时 + Snapshot 计划（例如 6 小时） +</block>
  <block id="72ab9d0304d3e84c6aa2dd15eda282f2" category="cell">1 小时</block>
  <block id="5bc5ed69f9c54b9d85a1cce3e6d1e921" category="cell">2 x 10 分钟</block>
  <block id="55786705935c6a97b4d23698d008516f" category="cell">最大 RTO</block>
  <block id="d7d2ff11a56a872692dbbb3d19ff76cd" category="cell">主要由 HANA 启动时间定义</block>
  <block id="c13edbe874bb6cf35b0de53cd31a1b74" category="cell">HANA 启动时间 + 恢复时间 +</block>
  <block id="842dc6b7f9e3a2c7e84f044e11faeed2" category="cell">正向恢复</block>
  <block id="d4cd0dabcf4caa22ad92fab40844c786" category="cell">不适用</block>
  <block id="49daf1624ce66f46e9b73f92beaa8bdd" category="cell">过去 24 小时的日志 + Snapshot 计划（例如 6 小时） +</block>
  <block id="9a6baa3f49fc771f1df884033bcca713" category="inline-link-macro">接下来：要求和最佳实践。</block>
  <block id="d5e80168e4da3407d13ce91a4f8170e2" category="paragraph"><block ref="d5e80168e4da3407d13ce91a4f8170e2" category="inline-link-macro-rx"></block></block>
  <block id="4486fa7cd414376cc3abe9834a582117" category="summary">Microsoft Azure 不保证特定虚拟机（ VM ）类型在创建时或启动已取消分配的 VM 时可用。</block>
  <block id="9671268467391e7f925a038c0f83e411" category="doc">要求和最佳实践</block>
  <block id="43fe42f9dcacfa50fbb870c2981ddb0c" category="inline-link-macro">先前版本：使用 SAP HANA 进行跨区域复制的配置选项。</block>
  <block id="419ca8e05940d1390bc511bdcfd8222a" category="paragraph"><block ref="419ca8e05940d1390bc511bdcfd8222a" category="inline-link-macro-rx"></block></block>
  <block id="0041be80697e591a22095c3fa9c2bad7" category="paragraph">Microsoft Azure 不保证特定虚拟机（ VM ）类型在创建时或启动已取消分配的 VM 时可用。具体而言，如果某个区域发生故障，许多客户端可能需要在灾难恢复区域添加更多 VM 。因此，建议主动使用具有灾难故障转移所需大小的虚拟机作为灾难恢复区域的测试或 QA 系统，以便分配所需的虚拟机类型。</block>
  <block id="7e0f2788f79e7e6dac3c7a1763ea03ce" category="paragraph">为了优化成本，在正常运行期间使用性能层较低的 ANF 容量池是有意义的。数据复制不需要高性能，因此可以使用具有标准性能层的容量池。对于灾难恢复测试，或者如果需要进行灾难故障转移，则必须将卷移至具有高性能层的容量池。</block>
  <block id="d94877e8e507baf3981ecd776b02880f" category="paragraph">如果不能选择第二个容量池，则应根据容量要求而不是正常操作期间的性能要求来配置复制目标卷。然后，可以调整配额或吞吐量（对于手动 QoS ），以便在发生灾难故障转移时进行灾难恢复测试。</block>
  <block id="4884cf9b8aa0c3a663b5ef3d5ca2e108" category="inline-link">使用 Azure NetApp Files 卷跨区域复制的要求和注意事项 | Microsoft 文档</block>
  <block id="d51d9722e039d6d29e55b83f4505f1e2" category="paragraph">有关详细信息，请参见<block ref="2b5439903546a140450c472c2abf9f4b" category="inline-link-rx"></block>。</block>
  <block id="cf12c21feb995808968bcc931406f37c" category="inline-link-macro">下一步：实验室设置。</block>
  <block id="18f4261cfcaeb319e6b1301c7c4360f8" category="paragraph"><block ref="18f4261cfcaeb319e6b1301c7c4360f8" category="inline-link-macro-rx"></block></block>
  <block id="55d9365909b3a315103ca1908bd396c7" category="summary">以下三个屏幕截图显示了数据，日志备份和共享卷的复制状态。</block>
  <block id="7cc288aea34413093faffad51bc084c1" category="doc">监控 ANF 跨区域复制</block>
  <block id="f5523c3e14e8ebc80906f110d99b0f28" category="inline-link-macro">上一步： ANF 跨区域复制的配置步骤。</block>
  <block id="65515337866ade0fbce728301486d6e0" category="paragraph"><block ref="65515337866ade0fbce728301486d6e0" category="inline-link-macro-rx"></block></block>
  <block id="ca518fa5f8c462a6afa66467a2198108" category="section-title">复制状态</block>
  <block id="134c4bbaf0ae858e55b84b72f15d414a" category="paragraph">卷复制滞后时间是了解 RPO 预期的有用值。例如，日志备份卷复制显示最长滞后时间为 58 分钟，这意味着最大 RPO 具有相同的值。</block>
  <block id="ba11fe397b6f7c72532ba24515066c28" category="paragraph">传输持续时间和传输大小可提供有关带宽要求以及更改复制卷的速率的宝贵信息。</block>
  <block id="b7ecf615e3ff0c312f16190ab1ee41c8" category="paragraph">以下屏幕截图显示了 HANA 数据卷的复制状态。</block>
  <block id="4ab5af8d7599447beab7c8b3ef385207" category="paragraph"><block ref="4ab5af8d7599447beab7c8b3ef385207" category="inline-image-macro-rx" type="image"></block></block>
  <block id="22846a31a2d2e3242432376dc19b200a" category="paragraph">以下屏幕截图显示了 HANA 日志备份卷的复制状态。</block>
  <block id="a3ccede93dc90176fe8c23f0e3177a68" category="paragraph"><block ref="a3ccede93dc90176fe8c23f0e3177a68" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6d58b85d280817df770609a622725eb4" category="paragraph">以下屏幕截图显示了 HANA 共享卷的复制状态。</block>
  <block id="0196c85fbe38e4387309e269b4a6ac9e" category="paragraph"><block ref="0196c85fbe38e4387309e269b4a6ac9e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5bb8b8dab26f014e5b3079efa0dd3754" category="section-title">复制的 Snapshot 备份</block>
  <block id="cfb95d4ab5955fc882056df6c5353ec9" category="paragraph">每次从源卷到目标卷的复制更新都会将上次更新到当前更新之间发生的所有块更改复制到目标卷。这还包括在源卷上创建的快照。以下屏幕截图显示了目标卷上可用的快照。如前文所述， AzAcSnap 工具创建的每个快照都是 HANA 数据库中应用程序一致的映像，可用于执行保存点或正向恢复。</block>
  <block id="e8f1ac642d75f5f86a7154d6dd39a32e" category="admonition">在源卷和目标卷中，还会创建 SnapMirror Snapshot 副本，用于重新同步和复制更新操作。从 HANA 数据库角度来看，这些 Snapshot 副本的应用程序不一致；只有通过 AzaCSnap 创建的应用程序一致的快照才能用于 HANA 恢复操作。</block>
  <block id="b0f3c84f81be17dd0e847c8f72bb7354" category="paragraph"><block ref="b0f3c84f81be17dd0e847c8f72bb7354" category="inline-image-macro-rx" type="image"></block></block>
  <block id="be3088771e5e71dd49af0e7181dda30b" category="inline-link-macro">接下来：灾难恢复测试。</block>
  <block id="8c144403312997e4a0e96908fbf4856a" category="paragraph"><block ref="8c144403312997e4a0e96908fbf4856a" category="inline-link-macro-rx"></block></block>
  <block id="39827364402eb7a6398af8c1194aa72d" category="doc">数据保护概述</block>
  <block id="677f2e7e550075f7bbbdac91e0918f2f" category="sidebar">SAP 解决方案</block>
  <block id="fcf140abed196b8eba71c45f21312bce" category="sidebar">NetApp 解决方案</block>
  <block id="cd47dd01745339787e4c7300389401f2" category="sidebar">最佳实践</block>
  <block id="e5704579323eb4f2edeee34d84f8ebd5" category="sidebar">使用 Azure NetApp Files 在 Microsoft Azure 上运行 SAP 应用程序</block>
  <block id="e1f56e42e145c79ff6fde2314ed0e9db" category="sidebar">使用 Cloud Volumes ONTAP 在 Microsoft Azure 上运行 SAP 应用程序</block>
  <block id="88aa48beec8729be73be99084cd76b79" category="sidebar">《采用 FCP 的 NetApp AFF 系统上的 SAP HANA 配置指南》</block>
  <block id="87aea504b228b108e5161db60e63e422" category="sidebar">基础架构设置和配置概述</block>
  <block id="a1893b920bc48a028abc56e282719481" category="sidebar">《采用 NFS 的 NetApp AFF 系统上的 SAP HANA 配置指南》</block>
  <block id="566e71293623024943bf4c66fa54d2c8" category="sidebar">《采用 NFS 的 NetApp FAS 系统上的 SAP HANA 配置指南》</block>
  <block id="c8ff9dc5c718603eec8564e06ee7b058" category="sidebar">《采用 FCP 的 FAS 系统上的 SAP HANA 配置指南》</block>
  <block id="f2d541ac92b4dd83f2be5b932a057952" category="sidebar">基于 VMware vSphere 和 NetApp FAS 以及全闪存 FAS 系统的 SAP HANA</block>
  <block id="00495563450af6bcde40cb96d650076e" category="sidebar">基于 IBM Power Systems 的 SAP HANA 和采用 NFS 的 NetApp AFF 系统</block>
  <block id="d5d6ed7727f0e542e6846a58af1d02ba" category="sidebar">SAP HANA 生命周期管理</block>
  <block id="68cc439f4e585883d2aaa26a4e3bcef2" category="sidebar">SAP HANA 灾难恢复</block>
  <block id="fa532045e834ec2fac1200964a189516" category="sidebar">生命周期管理</block>
  <block id="1e83c49aed775d711f6d1a9a0a6a7060" category="sidebar">使用 SnapCenter SAP HANA 插件自动化 SAP 系统副本</block>
  <block id="91a1838980cefe2d841b83794fd6d4a1" category="sidebar">将 NetApp 存储与 SAP Landscape Management 集成</block>
  <block id="992418be64e705531aba529adefec66f" category="sidebar">备份，还原和灾难恢复</block>
  <block id="972d8dadb82724623a226062c52b514d" category="sidebar">使用 Azure NetApp Files 实现 SAP HANA 灾难恢复</block>
  <block id="0435a2de9b6c71fb28e3ba4071b531de" category="sidebar">《使用 SAP HANA 进行跨区域复制》概述</block>
  <block id="6c45d41e933130a1d4e3729dad7439f3" category="sidebar">灾难恢复测试概述</block>
  <block id="6db8771af1e20f8b4493135fb9b2465f" category="sidebar">灾难恢复故障转移概述</block>
  <block id="f41a551d63cd5cff04cf3c09ee2c3dea" category="sidebar">使用 SnapCenter 实现 SAP HANA 备份和恢复</block>
  <block id="dd0dec62b557e33c38d24dc3cbaed4bc" category="sidebar">使用存储复制实现 SAP HANA 灾难恢复</block>
  <block id="fceb9e9a7a8e75da09a45b74960f3ce3" category="sidebar">使用 Snap Creator 备份和恢复 SAP HANA</block>
  <block id="0f1df2d5d1f6e9db4283f9e9814fa12a" category="sidebar">使用 NetApp 存储和 Commvault 软件进行 SAP HANA 备份和恢复</block>
  <block id="3993b517d983222c5b766976180367f0" category="inline-link-macro">上一步：从何处查找追加信息。</block>
  <block id="e20ed0e735d698ee86acdf1151e6e451" category="paragraph"><block ref="e20ed0e735d698ee86acdf1151e6e451" category="inline-link-macro-rx"></block></block>
  <block id="53b99ad408aca79aba1e0bcc607cde85" category="paragraph"><block ref="53b99ad408aca79aba1e0bcc607cde85" category="inline-link-macro-rx"></block></block>
  <block id="c1fd2d028e3fff9cae781db6954eb52b" category="summary">本文档为客户和合作伙伴提供了部署 NetApp ONTAP 以支持在 Windows 环境中的 Microsoft SQL Server 中运行 SAP 业务套件解决方案的最佳实践。</block>
  <block id="c5dacd8b175c8c2367525c37eea1dc59" category="doc">TR-4467 ： SAP 与 Windows 上的 Microsoft SQL Server —使用 NetApp ONTAP 和 SnapCenter 的最佳实践</block>
  <block id="611a4a6b98272a717f8e1f6bf5ba787b" category="paragraph">NetApp 公司 Marco Schoen</block>
  <block id="3be0224caa6f122d821c38b09efdbac7" category="inline-link-macro"><block ref="3be0224caa6f122d821c38b09efdbac7" category="inline-link-rx"></block></block>
  <block id="386b4fc148c87ad6a824fb6645fff9ca" category="paragraph"><block ref="386b4fc148c87ad6a824fb6645fff9ca" category="inline-link-macro-rx"></block></block>
  <block id="3b85cb8f62d84ee8a4e0891315a3af26" category="paragraph"><block ref="3b85cb8f62d84ee8a4e0891315a3af26" category="inline-link-macro-rx"></block></block>
  <block id="77856469e4786d81c487dfc174833e29" category="summary">TR-4757 提供了使用适用于 SAP 应用程序的 Azure NetApp Files 和 SAP HANA 部署的最佳实践。此外，本文档还详细介绍了 SAP 共享文件系统的不同使用情形。本文档介绍了利用 NetApp Cloud Volumes ONTAP for SAP Applications 和 SAP HANA 部署的最佳实践。它包括与 SAP 共享文件系统不同的使用情形，以及基于 Cloud Volumes ONTAP 的 SAP HANA 的特定性能注意事项。</block>
  <block id="0e03d1132f9763756b2e5e8f46c33610" category="doc">TR-4757 ：《 Microsoft Azure 上的 SAP 应用程序—使用 NetApp Cloud Volumes ONTAP 》</block>
  <block id="b6dd7e76887eb00cfd6d1dfadf3e9af4" category="paragraph">Bernd Herth ， Tobias Brandl ， Nil Bauser ， NetApp Will Bratton ， Geert Van Teylingen ， Microsoft</block>
  <block id="bc2f77b802672aed5e74bfb91aa5eee4" category="inline-link-macro"><block ref="bc2f77b802672aed5e74bfb91aa5eee4" category="inline-link-rx"></block></block>
  <block id="8e3940acd5b42b2156bc15a3fdf1827d" category="paragraph"><block ref="8e3940acd5b42b2156bc15a3fdf1827d" category="inline-link-macro-rx"></block></block>
  <block id="05b3eeeac64d4f0f9123deacdf9c3fcf" category="paragraph"><block ref="05b3eeeac64d4f0f9123deacdf9c3fcf" category="inline-link-macro-rx"></block></block>
  <block id="5176c066b53609fe56eb537ca7fcac89" category="summary">IBM Power Systems 专为 SAP HANA 等数据密集型和任务关键型工作负载而设计。IBM Power Systems 通过提供四项关键功能来简化和加速 SAP HANA 部署—卓越的虚拟化和灵活性，更快的配置速度，经济实惠的可扩展性以及最大限度地延长正常运行时间。NetApp AFF 产品系列已通过认证，可在定制数据中心集成（ TDI ）项目中与 SAP HANA 结合使用，并与 IBM Power Systems 完美地相辅相成。本文档介绍将 NetApp ONTAP 与 AFF 产品系列和 IBM Power Systems 结合使用的 NAS （ NFS ）存储设置的最佳实践。</block>
  <block id="f20a40b88879c634d62a1183049bd409" category="doc">TR-4821 ：基于 IBM Power Systems 和采用 NFS 的 NetApp AFF 系统的 SAP HANA</block>
  <block id="1645b6f0a7adb1dc7df46dc7fec9625a" category="paragraph">IBM 公司 NetApp Carsten Dieterle 的托比亚斯 · 布兰特</block>
  <block id="68708a2f0db2622048ef976e3d1ceb61" category="paragraph">IBM Power Systems 专为 SAP HANA 等数据密集型和任务关键型工作负载而设计。IBM Power Systems 通过提供四项关键功能来简化和加速 SAP HANA 部署：卓越的虚拟化和灵活性，更快的配置速度，经济实惠的可扩展性以及最大限度地延长正常运行时间。NetApp AFF 产品系列已通过认证，可在定制数据中心集成（ TDI ）项目中与 SAP HANA 结合使用，并与 IBM Power Systems 完美地相辅相成。本文档介绍将 NetApp ONTAP 与 AFF 产品系列和 IBM Power Systems 结合使用的 NAS （ NFS ）存储设置的最佳实践。</block>
  <block id="25c8459cf1533ecc02d4453baf422ef2" category="inline-link-macro"><block ref="25c8459cf1533ecc02d4453baf422ef2" category="inline-link-rx"></block></block>
  <block id="5223a61d48ab537c433cb2cd2b7238ff" category="paragraph"><block ref="5223a61d48ab537c433cb2cd2b7238ff" category="inline-link-macro-rx"></block></block>
  <block id="6382b55c5f4c721a7046327b2675c2a6" category="summary">本文档介绍了在设计存储解决方案以使用 Oracle 数据库支持 SAP 业务套件产品时所面临的挑战。本文档的主要重点是使用最新一代 SAP 解决方案的业务和 IT 主管面临的常见存储基础架构设计，部署，操作和管理挑战。本文档中的建议是通用的；它们并不特定于 SAP 应用程序或 SAP 实施的规模和范围。</block>
  <block id="205c68d6779218d7af7da356dc6a9da2" category="doc">TR-4250 ： SAP 与基于 UNIX 的 Oracle 和 NFS 以及适用于 SAP 3.4 的 NetApp ONTAP 和 SnapManager</block>
  <block id="bb8cd3f7aec777de29cee988f4ade068" category="paragraph">NetApp 公司 Nil Bauser</block>
  <block id="4a889ac1eab815e3cc9e7d0066d4360d" category="paragraph">本文档介绍了在设计存储解决方案以使用 Oracle 数据库支持 SAP 业务套件产品时所面临的挑战。本文档的主要重点是使用最新一代 SAP 解决方案的业务和 IT 主管面临的常见存储基础架构设计，部署，操作和管理挑战。本文档中的建议是通用的；它们并不特定于 SAP 应用程序或 SAP 实施的规模和范围。本文档假定读者已基本了解 NetApp 和 SAP 产品的技术和操作。本文档是在 NetApp ， SAP ， Oracle 和我们的客户技术人员的互动基础上编写的。</block>
  <block id="72b1d38d81a57d1482ce5708d98653f1" category="inline-link-macro"><block ref="72b1d38d81a57d1482ce5708d98653f1" category="inline-link-rx"></block></block>
  <block id="d30f42b2a88310780291191529d76b18" category="paragraph"><block ref="d30f42b2a88310780291191529d76b18" category="inline-link-macro-rx"></block></block>
  <block id="c9d1db03ff9188655c6df6826c9cec88" category="list-text"><block ref="c9d1db03ff9188655c6df6826c9cec88" category="inline-link-rx"></block></block>
  <block id="172a4f6be2e5258ba785f0fbe99140f7" category="list-text"><block ref="172a4f6be2e5258ba785f0fbe99140f7" category="inline-link-rx"></block></block>
  <block id="d76e7542f28a5b74ef246f360a1518d6" category="list-text"><block ref="d76e7542f28a5b74ef246f360a1518d6" category="inline-link-rx"></block></block>
  <block id="1c00cdc071680932dbe093eee9f348e7" category="paragraph">可以通过多种方法将存储连接到虚拟机（ VM ）。首选方法是，将具有 NFS 的存储卷直接从子操作系统中连接起来。中介绍了此选项 <block ref="0f1147a043e687692dc16c07b278ec3b" category="inline-link-macro-rx"></block>。</block>
  <block id="6578ba8f8050606717eb26d6e9c36396" category="list-text"><block ref="6578ba8f8050606717eb26d6e9c36396" category="inline-link-rx"></block></block>
  <block id="9e2f7b0947eed9e36a3d84200631ce7d" category="list-text"><block ref="9e2f7b0947eed9e36a3d84200631ce7d" category="inline-link-rx"></block></block>
  <block id="34e60068300e9e3f871d48a33ffba1f1" category="summary">TR-4746 提供了使用适用于 SAP 应用程序的 Azure NetApp Files 和 SAP HANA 部署的最佳实践。此外，还详细介绍了从 SAP 共享文件系统到完整 SAP HANA 部署的不同使用情形，以及基于 Azure NetApp Files 的 SAP HANA 的特定性能，数据保护和迁移注意事项。</block>
  <block id="6c6f4f0cd3ae1860ad7019d5cd6b2796" category="doc">TR-4746 ：《 Microsoft Azure 上的 SAP 应用程序》</block>
  <block id="56f60b697a28b5549f7fe646776153ad" category="paragraph">Nils Bauser ， Tobias Brandl ， Bernd Herth ， Kevin Morris ， Geert Van Teylingen NetApp 将于 Bratton ， Ralf Klahrh ， Amish Patel ， Jugeren Thomas Microsoft 等人担任此类人员</block>
  <block id="30e3a0469c18bb800da3893853205ac6" category="inline-link-macro"><block ref="30e3a0469c18bb800da3893853205ac6" category="inline-link-rx"></block></block>
  <block id="23d3d60e0f75128aa4f637d0049d0f60" category="paragraph"><block ref="23d3d60e0f75128aa4f637d0049d0f60" category="inline-link-macro-rx"></block></block>
  <block id="81c2f60fe1cd3484018d62f2addc343a" category="summary">本参考架构文档可帮助客户在 VMware vSphere 虚拟机（ VM ）以及 NetApp FAS 和全闪存 FAS （ AFF ）存储系统上设计和部署 SAP HANA 单主机和多主机解决方案。</block>
  <block id="fc21beda63f542908cf6ffb86e8a9b91" category="doc">TR-4338 ：《采用 NetApp 技术的 VMware vSphere 上的 SAP HANA — FAS 和全闪存 FAS 系统》</block>
  <block id="b3ed4b37e21fee2e164f97668ea1afae" category="paragraph">NetApp Erik Rieger ， Bhumik Patel ， VMware</block>
  <block id="492dbdbda06cf15ce343cbe404369a3d" category="paragraph">本参考架构文档可帮助客户在 VMware vSphere 虚拟机（ VM ）以及 NetApp FAS 和全闪存 FAS （ AFF ）存储系统上设计和部署 SAP HANA 单主机和多主机解决方案。此参考架构是根据现有 VMware 和 NetApp 客户的经验，真实模拟以及 NetApp 工程实验室验证而部署并记录的解决方案。本文档可帮助客户完成整个项目生命周期，包括需求评估，解决方案设计，安装和管理。</block>
  <block id="07d3b62fe245f06a68daa5268016da79" category="inline-link-macro"><block ref="07d3b62fe245f06a68daa5268016da79" category="inline-link-rx"></block></block>
  <block id="234856f07739c90d237a9a99b3d9e24c" category="paragraph"><block ref="234856f07739c90d237a9a99b3d9e24c" category="inline-link-macro-rx"></block></block>
  <block id="1b957531101399d0f744aec724e69fa1" category="summary">NetApp 通过提供一个生命周期管理解决方案来应对功能实施缓慢，缺乏自动化以及工作效率下降带来的挑战，该 已完全集成到 SAP 管理员用于日常运营的工具中，例如 SAP Landscape Management （ SAP LaMa ）。目标是简化从预处理到后处理的配置工作流，包括创建生产系统副本所需的所有软件和存储层任务。借助此解决方案，管理员只需单击几下鼠标即可创建开发和测试环境，从而改善生命周期管理。</block>
  <block id="643fa590028dacc026f165afdf4fb795" category="doc">SB-3978 ：《 SAP HANA 生命周期管理》</block>
  <block id="2302484597c5b4089c4a24a850b7f489" category="inline-link-macro"><block ref="2302484597c5b4089c4a24a850b7f489" category="inline-link-rx"></block></block>
  <block id="33876e03541db5898b573e9322b655e7" category="paragraph"><block ref="33876e03541db5898b573e9322b655e7" category="inline-link-macro-rx"></block></block>
  <block id="3616b54049026f3c3013256a38ff9c91" category="summary">本文档介绍了适用于 SAP HANA 的 NetApp 备份和恢复解决方案的安装和配置。解决方案基于 NetApp Snap Creator 框架和适用于 SAP HANA 的 Snap Creator 插件。经认证的 Cisco SAP HANA 多节点设备与 NetApp 存储相结合，可支持此解决方案。在定制数据中心集成（ TDI ）项目中，单节点和多节点 SAP HANA 系统也支持此解决方案。</block>
  <block id="b20847dfaf8bda0f5d26c73527a7a402" category="doc">TR-4313 ：《使用 Snap Creator 备份和恢复 SAP HANA 》</block>
  <block id="a696566e7ab3f2276919a2f7c509c31b" category="paragraph">TR-4313 介绍了适用于 SAP HANA 的 NetApp 备份和恢复解决方案的安装和配置。解决方案基于 NetApp Snap Creator 框架和适用于 SAP HANA 的 Snap Creator 插件。经认证的 Cisco SAP HANA 多节点设备与 NetApp 存储相结合，可支持此解决方案。在定制数据中心集成（ TDI ）项目中，单节点和多节点 SAP HANA 系统也支持此解决方案。</block>
  <block id="2447c9d3e154873d9458d9f21f9d9e82" category="inline-link-macro"><block ref="2447c9d3e154873d9458d9f21f9d9e82" category="inline-link-rx"></block></block>
  <block id="c48a0c69bdeb4ba64f1a756390dd148d" category="paragraph"><block ref="c48a0c69bdeb4ba64f1a756390dd148d" category="inline-link-macro-rx"></block></block>
  <block id="7b84e8d1abd1ca9b58ab3e77d620c832" category="summary">TR-4711 介绍了适用于 SAP HANA 的 NetApp 和 Commvault 解决方案的设计，其中包括 Commvault IntelliSnap 快照管理技术和 NetApp Snapshot 技术。解决方案基于 NetApp 存储和 Commvault 数据保护套件。</block>
  <block id="8fb21969b8486293a6e9aad64bfdce52" category="doc">TR-4711 ：《使用 NetApp 存储系统和 Commvault 软件的 SAP HANA 备份和恢复》</block>
  <block id="f3d4ee1709d5425d89d8314836e60519" category="paragraph">NetApp 公司 Marco Schoen 博士Tristan Daude ， Commvault Systems</block>
  <block id="6b6da8403e50e999c81fff1b93ddd075" category="inline-link-macro"><block ref="6b6da8403e50e999c81fff1b93ddd075" category="inline-link-rx"></block></block>
  <block id="974fc1d6f48a5236cf23f9d95df8992c" category="paragraph"><block ref="974fc1d6f48a5236cf23f9d95df8992c" category="inline-link-macro-rx"></block></block>
  <block id="39655610b54fc1717a4bc2a8dc4ca1ac" category="paragraph"><block ref="39655610b54fc1717a4bc2a8dc4ca1ac" category="inline-link-macro-rx"></block></block>
  <block id="1991f9bd90d7f79579e13fb5b25da162" category="summary">这一经过 NetApp 验证的架构涵盖了在采用 Brocade FC SAN Fabric 的 NetApp 全 SAN 阵列（ ASA ）存储系统上为 SAP HANA 打造现代化 SAP 系统和运营。它包括备份和恢复，灾难恢复和数据保护。</block>
  <block id="6f0f948f8224ca6abd264e8990372af6" category="doc">NVA-1147-design ：基于 NetApp 全 SAN 阵列的 SAP HANA —现代 SAN ，数据保护和灾难恢复</block>
  <block id="cc396fc030ef4980e68d8d063e3bcd5a" category="paragraph">Nil Bauser ， Roland Wartenberg ， Darryl Clinkscales ， Daniel Hohman ， Marco Schöen Steve Botkin ， Michael Peppers ， Vidula Ayer ， Steve Collins ， Pavan JHamnani ， Lee Dorrier ， NetApp Jim Zucchero ， Naem Saafein 博士， Broadcom Brocade</block>
  <block id="bd3a2bd89a649bf3f808ac6c8cc752ef" category="paragraph">这一经过 NetApp 验证的架构涵盖了在采用 Brocade FC SAN Fabric 的 NetApp 全 SAN 阵列（ ASA ）存储系统上为 SAP HANA 打造现代化 SAP 系统和运营。它包括备份和恢复，灾难恢复和数据保护。解决方案利用 NetApp SnapCenter 自动执行 SAP HANA 备份，还原和恢复以及克隆工作流。本节将使用同步 NetApp SnapMirror 数据复制软件介绍灾难恢复配置，测试和故障转移场景。此外，还概述了使用 Commvault 进行 SAP 数据保护。</block>
  <block id="731764091ffe7cacd12c33c9048bfd8f" category="inline-link-macro"><block ref="731764091ffe7cacd12c33c9048bfd8f" category="inline-link-rx"></block></block>
  <block id="a064ef72c49c2eebe828ed0cd3a38305" category="paragraph"><block ref="a064ef72c49c2eebe828ed0cd3a38305" category="inline-link-macro-rx"></block></block>
  <block id="1d5e541dc8524e30bb2781003f0d8400" category="paragraph"><block ref="1d5e541dc8524e30bb2781003f0d8400" category="inline-link-macro-rx"></block></block>
  <block id="cf609e4fa30936be5f8dfd92fb076afe" category="summary">技术报告 TR-4614 提供了使用 NetApp SnapCenter 保护 SAP HANA 数据的最佳实践。本文档介绍 SnapCenter 概念，配置建议和操作工作流，包括配置，备份操作， 以及还原和恢复操作。</block>
  <block id="47f5c5f7b80224cb7832ed3973296f38" category="doc">TR-4614 ：《使用 SnapCenter 实现 SAP HANA 备份和恢复》</block>
  <block id="fcd16ddc69c35eca3711f2163e64ac8c" category="paragraph">TR-4616 概述了 SAP HANA 灾难恢复保护的选项。其中包括基于同步和异步 NetApp SnapMirror 存储复制的三站点灾难恢复解决方案的详细设置信息和用例问题描述。所述的解决方案将 NetApp SnapCenter 与 SAP HANA 插件结合使用来管理数据库一致性。</block>
  <block id="432caa999eec7b9c7ddcabb7fe098139" category="inline-link-macro"><block ref="432caa999eec7b9c7ddcabb7fe098139" category="inline-link-rx"></block></block>
  <block id="f122cfeb37e2d3200cb4806af587b661" category="paragraph"><block ref="f122cfeb37e2d3200cb4806af587b661" category="inline-link-macro-rx"></block></block>
  <block id="8132c1d54d27cf7a67ac0e563e82c329" category="summary">TR-4646 概述了 SAP HANA 灾难恢复保护的选项。其中包括基于同步和异步 NetApp SnapMirror 存储复制的三站点灾难恢复解决方案的详细设置信息和用例问题描述。所述的解决方案将 NetApp SnapCenter 与 SAP HANA 插件结合使用来管理数据库一致性。</block>
  <block id="c79cdf002876c8be8a196f93f344a33f" category="inline-link-macro"><block ref="c79cdf002876c8be8a196f93f344a33f" category="inline-link-rx"></block></block>
  <block id="d925ae253e076ec94fce589bf0750a31" category="paragraph"><block ref="d925ae253e076ec94fce589bf0750a31" category="inline-link-macro-rx"></block></block>
  <block id="e12451ca8917b29faae9e966a7ef40f6" category="summary">TR-4719 介绍了如何在 SAP HANA 系统复制环境中使用 NetApp SnapCenter 技术和 SAP HANA 插件进行备份和恢复。</block>
  <block id="ef5cc7c8780ee87a124c0fd66dd44867" category="doc">TR-4719 ： SAP HANA 系统复制—使用 SnapCenter 进行备份和恢复</block>
  <block id="1a7acb5247a596ecf14f6381a5824bd7" category="inline-link-macro"><block ref="1a7acb5247a596ecf14f6381a5824bd7" category="inline-link-rx"></block></block>
  <block id="d5dfc6464276a185ca9edd33cbc78835" category="paragraph"><block ref="d5dfc6464276a185ca9edd33cbc78835" category="inline-link-macro-rx"></block></block>
  <block id="aabf604423d1b54f70e80a6e69d7cc9b" category="sidebar">SAP 与基于 UNIX 的 Oracle 以及 NFS 与 NetApp ONTAP</block>
  <block id="41af34746c13d49348031a1fca6a2938" category="sidebar">SAP 与使用 ONTAP 的 Windows 上的 Microsoft SQL Server</block>
  <block id="9feb66d55a80dea870deeb88fab704c9" category="sidebar">SAP HANA 备份和恢复</block>
  <block id="556e7469391c18d85f90a695dc28f80e" category="sidebar">使用 SnapCenter 进行 SAP HANA 系统复制，备份和恢复</block>
  <block id="eeb338bfcd3ad35ad6983ecfa31efba2" category="sidebar">基于 NetApp 全 SAN 阵列的 SAP HANA —现代 SAN ，数据保护和灾难恢复</block>
</blocks>