<?xml version="1.0" encoding="UTF-8"?>
<blocks>
  <block id="b89b4b47543b3482418589214b77fa25" category="summary">SAP HANA 主机通过使用冗余 10GbE 或速度更快的网络基础架构连接到存储控制器。</block>
  <block id="2d242bb36ec91b32005f9296ff03a912" category="doc">架构</block>
  <block id="afcaa068bd76451ec818e7c845c867f4" category="paragraph">FAS 系统产品系列的不同型号可以在存储层混用并匹配，以满足增长以及不同的性能和容量需求。可以连接到存储系统的最大 SAP HANA 主机数由 SAP HANA 性能要求和所用 NetApp 控制器型号定义。所需磁盘架的数量仅取决于 SAP HANA 系统的容量和性能要求。下图显示了一个配置示例，其中八个 SAP HANA 主机连接到一个存储高可用性（ HA ）对。</block>
  <block id="015a4116e31d7ff2bdb70f8a95b52a25" category="paragraph">下图显示了使用 VMware vSphere 作为虚拟化层的示例。</block>
  <block id="1e90382cf8f5501614307f142be99675" category="paragraph">该架构可扩展到两个方面：</block>
  <block id="ab0b299aa5582f36321ac715a26741f5" category="list-text">通过将更多 SAP HANA 主机和 / 或存储容量附加到现有存储，前提是存储控制器提供的性能足以满足当前 SAP 关键性能指标（ KPI ）的要求</block>
  <block id="a8cc6b546c8a58e173b13fdbe03083d7" category="list-text">通过为其他 SAP HANA 主机添加更多具有额外存储容量的存储系统</block>
  <block id="0c8c8eb56a169d6a4275a52f8c66c079" category="paragraph">下图显示了一个配置示例，其中，更多 SAP HANA 主机连接到存储控制器。在此示例中，要满足 16 个 SAP HANA 主机的容量和性能要求，需要更多磁盘架。根据总吞吐量要求，必须添加到存储控制器的额外 10GbE （或更快）连接。</block>
  <block id="cdb7ac32da38343cc4a6b2f3f23caa92" category="paragraph">无论部署的 FAS 系统如何， SAP HANA 环境也可以通过添加任何经过认证的存储控制器来进行扩展，以满足所需的节点密度（下图）。</block>
  <block id="9268ea89b7553eda23a9690606daf736" category="section-title">SAP HANA 备份</block>
  <block id="38dd23c567963490bfc29e59a1f28717" category="paragraph">所有 NetApp 存储控制器上的 ONTAP 软件都提供了一种内置机制，可在运行期间备份 SAP HANA 数据库，而不会影响性能。基于存储的 NetApp Snapshot 备份是一种完全受支持的集成备份解决方案，可用于 SAP HANA 单个容器以及具有单个租户或多个租户的 SAP HANA 多租户数据库容器（ MDG ）系统。</block>
  <block id="9955fcf90f7a4d24fcdd226f2bad9404" category="paragraph">基于存储的 Snapshot 备份可使用适用于 SAP HANA 的 NetApp SnapCenter 插件来实施。这样，用户就可以使用 SAP HANA 数据库本机提供的界面创建一致的基于存储的 Snapshot 备份。SnapCenter 会将每个 Snapshot 备份注册到 SAP HANA 备份目录中。因此， SnapCenter 所做的备份可以在 SAP HANA Studio 和 Cockpit 中查看，您可以在其中直接选择这些备份进行还原和恢复操作。</block>
  <block id="a998ce5555ab7229162baef2b7ee1c9a" category="paragraph">通过 NetApp SnapMirror 技术，可以将在一个存储系统上创建的 Snapshot 副本复制到由 SnapCenter 控制的二级备份存储系统。然后，可以为主存储上的每个备份集以及二级存储系统上的备份集定义不同的备份保留策略。适用于 SAP HANA 的 SnapCenter 插件可自动管理基于 Snapshot 副本的数据备份和日志备份的保留，包括备份目录的管理。适用于 SAP HANA 的 SnapCenter 插件还允许通过执行基于文件的备份对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="020d9d4fc21927a10cbfdf929f1e5d5a" category="paragraph">可以使用 NFS 挂载将数据库日志直接备份到二级存储，如下图所示。</block>
  <block id="6a8f36af9b25dbdaa27206e8556f144d" category="paragraph">与基于文件的传统备份相比，基于存储的 Snapshot 备份具有显著优势。这些优势包括但不限于：</block>
  <block id="cd3237725900192ea60a708828192eed" category="list-text">备份速度更快（几分钟）</block>
  <block id="dd3af9880bd4d720f57bfb3f08113c40" category="list-text">由于存储层上的恢复时间（几分钟）以及备份频率更高，因此恢复时间目标（ RTO ）缩短</block>
  <block id="f458c876961fbe066dc1f94b4d8f0606" category="list-text">在备份和恢复操作期间， SAP HANA 数据库主机，网络或存储的性能不会下降</block>
  <block id="ca34922c96391967c8028dc44cd98e22" category="list-text">根据块更改，将节省空间和带宽的复制到二级存储</block>
  <block id="c67ddee39e41dfe63b7c798d76514143" category="inline-link">TR-4614 ：《使用 SnapCenter 实现 SAP HANA 备份和恢复》</block>
  <block id="dd44a87fdee6157429ed3ab3b6e9ead4" category="section-title">SAP HANA 灾难恢复</block>
  <block id="208d812de76aa602471fe71c37e930c8" category="paragraph">SAP HANA 灾难恢复既可以使用 SAP HANA 系统复制在数据库层执行，也可以使用存储复制技术在存储层执行。下一节概述了基于存储复制的灾难恢复解决方案。</block>
  <block id="1ff29e7b597f9f2f9d2a5edf1b79532b" category="inline-link">TR-4646 ：《使用存储复制实现 SAP HANA 灾难恢复》</block>
  <block id="524130dbe5da3e0bed566e873780d92c" category="section-title">基于 SnapMirror 的存储复制</block>
  <block id="0f905789004d93140f2472f04587e3e9" category="paragraph">下图显示了一个三站点灾难恢复解决方案，该 使用同步 SnapMirror 复制到本地灾难恢复数据中心，并使用异步 SnapMirror 将数据复制到远程灾难恢复数据中心。</block>
  <block id="8f5ac6f44493cd58abff6c1e0220cb5b" category="paragraph">使用同步 SnapMirror 进行数据复制可提供零 RPO 。主灾难恢复数据中心与本地灾难恢复数据中心之间的距离限制为 100 公里左右。</block>
  <block id="4e1cb33198a7d562f17cd0f57cfdb9c6" category="paragraph">通过使用异步 SnapMirror 将数据复制到第三个远程灾难恢复数据中心，可以防止主灾难恢复站点和本地灾难恢复站点发生故障。RPO 取决于复制更新的频率以及传输更新的速度。理论上，距离是无限的，但限制取决于必须传输的数据量以及数据中心之间的可用连接。典型的 RPO 值介于 30 分钟到多小时之间。</block>
  <block id="d9bfc3ce5a49e5308dfdbda6295cc6a3" category="paragraph">这两种复制方法的 RTO 主要取决于在灾难恢复站点启动 HANA 数据库并将数据加载到内存所需的时间。假设数据的读取吞吐量为 1000 Mbps ，则加载 1 TB 数据大约需要 18 分钟。</block>
  <block id="b9052158da7f0b5b55d6e0ec9555e353" category="paragraph">正常运行期间，灾难恢复站点上的服务器可用作开发 / 测试系统。发生灾难时，需要关闭开发 / 测试系统并将其作为灾难恢复生产服务器启动。</block>
  <block id="d32d8a0b4465128d05cbe3a72ff9a229" category="paragraph">这两种复制方法均允许您执行灾难恢复工作流测试，而不会影响 RPO 和 RTO 。FlexClone 卷在存储上创建并连接到灾难恢复测试服务器。</block>
  <block id="3fd58c2ba10df8da6e80791e2dae3f96" category="paragraph">同步复制提供 StrictSync 模式。如果由于任何原因未完成对二级存储的写入，则应用程序 I/O 将失败，从而确保主存储系统和二级存储系统完全相同。只有在 SnapMirror 关系恢复为 InSync 状态后，主系统的应用程序 I/O 才会恢复。如果主存储发生故障，则可以在故障转移后在二级存储上恢复应用程序 I/O ，而不会丢失数据。在 StrictSync 模式下， RPO 始终为零。</block>
  <block id="2cb03e71b30b5ad997f5080619a60d31" category="section-title">基于 MetroCluster 的存储复制</block>
  <block id="8a29e11272dc9f6e89fdfd8d07e0a808" category="paragraph">下图简要展示了解决方案。每个站点上的存储集群可提供本地高可用性，并用于生产工作负载。每个站点的数据会同步复制到另一个位置，如果发生灾难故障转移，这些数据将可用。</block>
  <block id="d41d8cd98f00b204e9800998ecf8427e" category="summary"></block>
  <block id="650e7293e887dfe8d6a1e7be568f91f1" category="doc">更新历史记录</block>
  <block id="98c7616ec2b7c09dbf1a2e93da9c710f" category="paragraph">自此解决方案最初发布以来，已对其进行了以下技术更改。</block>
  <block id="34b6cd75171affba6957e308dcbd92be" category="cell">version</block>
  <block id="44749712dbec183e983dcd78a7736c41" category="cell">Date</block>
  <block id="d46591db8118f77057750203ede1b2ca" category="cell">更新摘要</block>
  <block id="3798985ee5e15c84c4263815d5a4d0b7" category="cell">版本 1.0</block>
  <block id="be0c84ff5b19b7be3f3c3bcf63481301" category="cell">2015年10月</block>
  <block id="e9bacaae9e45a23fffabf2e649f09b75" category="cell">初始版本</block>
  <block id="e988e5fd54b0b79f1d8fa9ce06ad58d5" category="cell">版本 1.1</block>
  <block id="bc407ceaf8eb27d5253807a9ebda0414" category="cell">2016年3月</block>
  <block id="54db89e9b4e49265f32e0495cda7d5e4" category="cell">更新了容量规模估算</block>
  <block id="304f30474edd152dc34aef7dbb123607" category="cell">版本 2.0</block>
  <block id="d97683d280d36a8f907f655c8ae74044" category="cell">2017年2月</block>
  <block id="053aaab3b6a6f68ce7ea49ba7b9f8fee" category="cell">新的 NetApp 存储系统和磁盘架 ONTAP 9 新操作系统版本（ SLES12 SP1 和 RHEL 7.2 ）新的 SAP HANA 版本的新增功能</block>
  <block id="27328ef4198621c47c9eed9d679e106e" category="cell">2017年7月</block>
  <block id="486ac802b593e5c6576c88cd6ce4d040" category="cell">少量更新</block>
  <block id="46b9839969e4bc429da9cc245c756450" category="cell">版本 3.0</block>
  <block id="a0412a4f0a7daea31c561a20fad808b8" category="cell">September 2018</block>
  <block id="4b94bef311266eb7014c7ca918108710" category="cell">新的 NetApp 存储系统新的操作系统版本（ SLES12 SP3 和 RHEL 7.4 ）其他次要更新 SAP HANA 2.0 SPS3</block>
  <block id="1934d1f00863288384225e6e467701f9" category="cell">版本 3.1</block>
  <block id="aafb48343bbcbc586f011c8f87a52d7f" category="cell">2019年11月</block>
  <block id="c7c8844211522f47505bf90db2c5f40e" category="cell">新的 NetApp 存储系统和 NVMe 磁盘架新的操作系统版本（ SLES12 SP4 ， SLES 15 和 RHEL 7.6 ）其他次要更新</block>
  <block id="5258b9f7a7bafc6f48ad56c4cdae8810" category="cell">版本 3.2</block>
  <block id="a00f05a660c5d5d561663fe44e44cdf5" category="cell">2020年4月</block>
  <block id="62b07fbc56cb53e44a6f5cbdadaa6212" category="cell">自 SAP HANA 2.0 SPS4 以来，全新的 AFF ASA 系列存储系统引入了多种数据分区功能</block>
  <block id="e9d6df059c684606e3b274b55bf5e7fe" category="cell">版本 3.3</block>
  <block id="0c32ac23d148fcf8f103092f860ea484" category="cell">2020 年 6 月</block>
  <block id="2a68b73f24c9113c1b9b27be5840d301" category="cell">有关可选功能的追加信息次要更新</block>
  <block id="c6bdef625cb67c9d4ef94200ba60efb0" category="doc">基础架构设置和配置</block>
  <block id="d39f50075dc9ec7266b5156c1d0ce319" category="summary">以下各节提供了 SAP HANA 基础架构设置和配置准则。</block>
  <block id="3b878279a04dc47d60932cb294d96259" category="doc">概述</block>
  <block id="98453eecb7a0821c9f84e894eeb80b6f" category="paragraph">以下各节提供了 SAP HANA 基础架构设置和配置准则。其中包括设置 SAP HANA 所需的所有步骤。此时将创建一个 SVM 来托管数据。在这些部分中，使用了以下示例配置：</block>
  <block id="5f817989cf0f93d4a14f30644d1994e2" category="list-text">使用 SID=SS3 和 ONTAP 9.7 或更早版本的 HANA 系统</block>
  <block id="e7f4f805e4b2edf4e5d40f8db1e51fd5" category="list-text">SAP HANA 单主机和多主机</block>
  <block id="0bad0fb3efdfa0349f059e6510652363" category="list-text">使用 SAP HANA 多个分区的 SAP HANA 单个主机</block>
  <block id="273f733be4b4eee98578fce71ccc7a70" category="list-text">使用 Linux 逻辑卷管理器（ LVM ）且 SID=FC5 和 ONTAP 9.8 的 HANA 系统</block>
  <block id="5ab9c3d59a0ecc9e30a1f938039d0ecf" category="summary">NFS 版本 4 及更高版本需要用户身份验证。可以使用轻型目录访问协议（ Lightweight Directory Access Protocol ， LDAP ）服务器等中央用户管理工具或使用本地用户帐户来完成此身份验证。</block>
  <block id="e3a77a70624c57f3f0e2fc7075e4f75f" category="doc">NFSv4 的 SAP HANA 安装准备</block>
  <block id="7f5e79baae33aa1aca5c990882a844cb" category="paragraph">NFS 版本 4 及更高版本需要用户身份验证。可以使用轻型目录访问协议（ Lightweight Directory Access Protocol ， LDAP ）服务器等中央用户管理工具或使用本地用户帐户来完成此身份验证。以下各节介绍如何配置本地用户帐户。</block>
  <block id="3e0be3ed453ef480d348366ac9692e0b" category="paragraph">在开始安装 SAP HANA 软件之前，必须在 SAP HANA 主机和存储控制器上手动创建管理用户 ` &lt;sidadm&gt;` 和 `sapsys` 组。</block>
  <block id="cbec60dce8dfbeca522952f14d38d3b1" category="section-title">SAP HANA 主机</block>
  <block id="6f99ed415d7b5330cfe770dc1088f66b" category="paragraph">如果不存在，则必须在 SAP HANA 主机上创建 `sapsys` 组。必须选择一个不与存储控制器上的现有组 ID 冲突的唯一组 ID 。</block>
  <block id="7bafe155f78e1791271552be40c162f4" category="paragraph">已在 SAP HANA 主机上创建用户 ` &lt;sidadm&gt;` 。必须选择一个与存储控制器上的现有用户 ID 不冲突的唯一 ID 。</block>
  <block id="8f35838ad2fe64a0c17ff23449515d26" category="paragraph">对于多主机 SAP HANA 系统，所有 SAP HANA 主机上的用户和组 ID 必须相同。通过将 ` /etc/group` 和 ` /etc/passwd` 中的受影响行从源系统复制到所有其他 SAP HANA 主机，可以在其他 SAP HANA 主机上创建组和用户。</block>
  <block id="2fa0eba92353ea7e1816fcc916b31030" category="admonition">在所有 Linux 服务器（` /etc/idmapd.conf` ）和 SVM 上， NFSv4 域必须设置为相同的值。在文件 ` /etc/idmapd.conf` 中为 Linux 主机设置域参数 "Domain = &lt;domain-name&gt; " 。</block>
  <block id="c16fea4c59b7f6d7ce28e4f656eb58f6" category="paragraph">启用并启动 NFS idmapd 服务。</block>
  <block id="8e70a1707d21dc1444e77d404e6ac2f0" category="admonition">最新的 Linux 内核不需要执行此步骤。可以安全地忽略警告消息。</block>
  <block id="22f78a96796d22d06c6c67652a374ffa" category="section-title">存储控制器</block>
  <block id="33414af712ec9cf5beb615810511c047" category="paragraph">SAP HANA 主机和存储控制器上的用户 ID 和组 ID 必须相同。可通过在存储集群上输入以下命令来创建组和用户：</block>
  <block id="2cb27363dc868bf23cc2ef137b8ee00a" category="paragraph">此外，将 SVM 的 UNIX 用户 root 的组 ID 设置为 0 。</block>
  <block id="2ad2e055e24d21da5d30dba91f44d731" category="summary">本节介绍在单主机和多主机系统上安装 SAP HANA 所需的准备工作。</block>
  <block id="919364909c7165636bc8715422a691ec" category="doc">SAP HANA 软件安装</block>
  <block id="3e1a84486a34f2de53acbb9a76a7dacc" category="section-title">在单主机系统上安装</block>
  <block id="9ffcf0639aa6ab06ceced36736b5807d" category="paragraph">SAP HANA 软件安装不需要为单主机系统做任何其他准备。</block>
  <block id="e4fd411b2330f50a5f169247fb9817ac" category="section-title">在多主机系统上安装</block>
  <block id="877357acf24fb0c198118a9551671417" category="paragraph">开始安装之前，请创建一个 `global.ini` 文件，以便在安装过程中使用 SAP 存储连接器。在安装过程中， SAP 存储连接器会在工作主机上挂载所需的文件系统。`global.ini` 文件必须位于可从所有主机访问的文件系统中，例如， ` /ha/shared` 文件系统。</block>
  <block id="dba154e032a79db94e79189eb47b028f" category="paragraph">在多主机系统上安装 SAP HANA 软件之前，必须完成以下步骤：</block>
  <block id="c0c2d256d9ee9ad617ad43119e6ad751" category="list-text">将以下数据 LUN 和日志 LUN 的挂载选项添加到 `global.ini` 文件中：</block>
  <block id="d00f7ccbbb090c63d2eb2e3a5ddbd0db" category="list-text">`relatime` 和 `inode64` 用于数据和日志文件系统</block>
  <block id="3daf48572816497403ca0d7b3ca79c5c" category="list-text">添加数据分区和日志分区的 WWID 。WWID 必须与 ` /etc/multipath.conf` 文件中配置的别名匹配。</block>
  <block id="c5e7e01683b04809035115f6c4c7e4aa" category="paragraph">以下输出显示了 2+1 多主机设置示例，其中系统标识符（ SID ）为 SS3 。</block>
  <block id="f206fb31ca322606be1acbaecf34f9fa" category="paragraph">如果使用的是 Linux LVM ，则所需的配置会有所不同。以下示例显示了一个 2+1 多主机设置，其中 SID 为 FC5 。</block>
  <block id="e698d9fadd050973bab2f9f855248cca" category="admonition">根据所使用的操作系统版本，可能需要先安装 Python 2.7 ，然后再安装 SAP HANA 数据库。</block>
  <block id="9659639598149d1609e9fcde405a759f" category="list-text">验证安装工具是否已在所有工作主机和备用主机上安装所有选定组件。</block>
  <block id="6f9f0e834814d7ad77b7ef8666f24988" category="summary">下一节概述了为 SAP HANA 估算存储系统规模所需的性能和容量注意事项。</block>
  <block id="894445e8ea6df545bfbc4247797a2162" category="doc">存储规模估算</block>
  <block id="dcf9ba0966947285c275da7a2e4983af" category="admonition">请联系 NetApp 或您的 NetApp 合作伙伴销售代表，帮助您创建大小合适的存储环境。</block>
  <block id="1261ba8eeb83d9d138ff9e9a37214a7e" category="section-title">性能注意事项</block>
  <block id="0133d1c5c524f1c132eeaabe81e24a26" category="paragraph">SAP 定义了一组静态存储 KPI ，这些 KPI 适用于所有生产 SAP HANA 环境，不受数据库主机和使用 SAP HANA 数据库的应用程序的内存大小的限制。这些 KPI 适用于单主机，多主机， HANA 上的 Business Suite ， HANA 上的 Business Warehouse ， S/4HANA 和 BB/4HANA 环境。因此，当前的性能规模估算方法仅取决于连接到存储系统的活动 SAP HANA 主机的数量。</block>
  <block id="66e21be29915de7ccd15e3f2259dfb2d" category="admonition">存储性能 KPI 仅适用于生产 SAP HANA 系统，但您可以在所有 HANA 系统中实施。</block>
  <block id="367a819110d98ed167caa72fba8c3476" category="paragraph">SAP 提供了一个性能测试工具，用于验证连接到存储的活动 SAP HANA 主机的存储系统性能。</block>
  <block id="209deb211357a5417a81e757fa385d98" category="paragraph">NetApp 测试并预定义了可连接到特定存储模型的最大 SAP HANA 主机数，同时仍满足 SAP 为基于生产的 SAP HANA 系统提供的所需存储 KPI 。</block>
  <block id="c7e4c0767ab9722c4f237d635d610c0c" category="admonition">认证的 FAS 产品系列中的存储控制器也可用于采用其他磁盘类型或磁盘后端解决方案的 SAP HANA 。但是，它们必须由 NetApp 提供支持，并满足 SAP HANA TDI 性能 KPI 要求。例如， NetApp 存储加密（ NetApp Storage Encryption ， NSE ）和 NetApp FlexArray 技术。</block>
  <block id="15d11459079dc48f1e85bea1313c9726" category="paragraph">本文档介绍了 SAS HDD 和固态驱动器（ SSD ）的磁盘大小调整。</block>
  <block id="4f99803ea06af8f6d9a1da5b19e96b61" category="section-title">HDD</block>
  <block id="409693e484428f0ddd3c7f9edad94110" category="paragraph">每个 SAP HANA 节点至少需要 10 个数据磁盘（ 10k RPM SAS ），才能满足 SAP 的存储性能 KPI 要求。</block>
  <block id="2b23f51631667ab0603ece64b7f523a3" category="admonition">此计算与使用的存储控制器和磁盘架以及数据库的容量要求无关。添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="9d8806ed6779e6a16f204fad2d0cdfc1" category="section-title">固态驱动器</block>
  <block id="0712272d8957e85acded217a85370070" category="paragraph">对于 SSD ，数据磁盘的数量取决于从存储控制器到 SSD 磁盘架的 SAS 连接吞吐量。</block>
  <block id="d7e101f5680bb6cef55b45b6400c7696" category="paragraph">可在单个磁盘架上运行的最大 SAP HANA 主机数以及每个 SAP HANA 主机所需的最小 SSD 数均通过运行 SAP 性能测试工具来确定。此测试不会考虑主机的实际存储容量要求。此外，您还必须计算容量要求，以确定所需的实际存储配置。</block>
  <block id="17034526fac893b51c72109e731e3150" category="list-text">如果磁盘架连接到 12 Gb ，则具有 24 个 SSD 的 12 Gb SAS 磁盘架（ DS224C ）最多可支持 14 个 SAP HANA 主机。</block>
  <block id="5a3f83272b733d11b72f90c6434634bc" category="list-text">具有 24 个 SSD 的 6 Gb SAS 磁盘架（ DS2246 ）最多支持 4 个 SAP HANA 主机。</block>
  <block id="4218dd2a9cf8d2a4ac0bf4b4418b6a8a" category="paragraph">SSD 和 SAP HANA 主机必须在两个存储控制器之间平均分布。</block>
  <block id="53186c8561352a2df976925dcabf62f0" category="paragraph">下表汇总了每个磁盘架支持的 SAP HANA 主机数。</block>
  <block id="6bb313266cb9beb41de9d6c9e38c1940" category="cell">满载 24 个 SSD 的 6 Gb SAS 磁盘架（ DS2246 ）</block>
  <block id="511314f062f8b637138c0e7691d63b28" category="cell">满载 24 个 SSD 的 12 GB SAS 磁盘架（ DS224C ）</block>
  <block id="aa2d00c9db46d97d9e46eaaf81d65e1d" category="cell">每个磁盘架的最大 SAP HANA 主机数</block>
  <block id="a87ff679a2f3e71d9181a67b7542122c" category="cell">4.</block>
  <block id="aab3238922bcc25a6f606eb525ffdc56" category="cell">14</block>
  <block id="67daefa02c71a745373981700ce5c943" category="admonition">此计算与所使用的存储控制器无关。添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="a341ad540524c27a40ee6f8e4c1de2e4" category="section-title">混合工作负载</block>
  <block id="53fc113bc08b6e6a4382d93d7b1beccf" category="paragraph">支持在同一存储控制器或同一存储聚合上运行的 SAP HANA 和其他应用程序工作负载。但是， NetApp 的最佳实践是将 SAP HANA 工作负载与所有其他应用程序工作负载分开。</block>
  <block id="e96e66eb5ca678b012ed829901a8e778" category="paragraph">您可能会决定在同一存储控制器或同一聚合上部署 SAP HANA 工作负载和其他应用程序工作负载。如果是，您必须确保在混合工作负载环境中为 SAP HANA 提供足够的性能。NetApp 还建议您使用服务质量（ QoS ）参数来控制这些其他应用程序可能产生的影响，并保证 SAP HANA 应用程序的吞吐量。</block>
  <block id="1d8d1934499ced39732f5c5099083c6b" category="paragraph">必须使用 SAP 性能测试工具检查是否可以在已用于其他工作负载的现有存储控制器上运行其他 SAP HANA 主机。SAP 应用程序服务器可以安全地放置在与 SAP HANA 数据库相同的存储控制器和 / 或聚合上。</block>
  <block id="8025837196ec3641307b0ebcb276143c" category="section-title">容量注意事项</block>
  <block id="244d98fed97800c3bc8073163dc1e3b2" category="inline-link">SAP HANA 存储要求</block>
  <block id="bbce32f30700e8b905762b8cfd022bc5" category="admonition">必须使用 NetApp 的 SAP HANA 存储规模估算工具来确定使用多个 SAP HANA 系统的整体 SAP 环境的容量规模估算。请联系 NetApp 或您的 NetApp 合作伙伴销售代表，以验证适当规模的存储环境的存储规模估算流程。</block>
  <block id="46fcaad64094e886321a215ecd47a4b6" category="section-title">配置性能测试工具</block>
  <block id="e69e9d3f5ed6c444c36582f4128ffd41" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。使用 SAP 性能测试工具测试存储性能时，还必须设置这些参数。</block>
  <block id="9a648a6755f45956100ee3fff99676a5" category="paragraph">NetApp 进行了性能测试以定义最佳值。下表列出了必须在 SAP 性能测试工具的配置文件中设置的参数。</block>
  <block id="83f499a540b1323009c200d6f8cc9396" category="cell">参数</block>
  <block id="689202409e48743b914713f96d93947c" category="cell">价值</block>
  <block id="a26ec55747d14548cbbfb785ba7235ca" category="cell">max_parlated_io_requests.</block>
  <block id="76dc611d6ebaafc66cc0879c71b5db5c" category="cell">128.</block>
  <block id="6ed7c95da7b1657525ed8f429f52b06a" category="cell">异步读取提交</block>
  <block id="ed2b5c0139cec8ad2873829dc1117d50" category="cell">开启</block>
  <block id="67e2efa65376a7aacd40ff40da1bddae" category="cell">异步写入提交活动</block>
  <block id="ac5e272fb590151aef3dd14286c416e0" category="cell">异步写入提交块</block>
  <block id="a181a603769c1f98ad927e7367c7aa51" category="cell">全部</block>
  <block id="149b8cb3de2ef5293654161397dd957b" category="inline-link">SAP 注释 1943937</block>
  <block id="cfc4a41d38a7e9272bd9608bb24765a7" category="inline-link">SAP 注释 2493172</block>
  <block id="21d0c248148c59a01600a5188cec24a7" category="paragraph">有关 SAP 测试工具配置的详细信息，请参见<block ref="ec90a615c6d378fa60ba8e7f2e7592b2" category="inline-link-rx"></block> 适用于 HWCCT （ SAP HANA 1.0 ）和<block ref="2912abb2c0271a2912b6a4a94888e0ec" category="inline-link-rx"></block> 适用于 HCMT/HCOT （ SAP HANA 2.0 ）。</block>
  <block id="f3ff9b33ed05e0cef1b1ae8cf470ea13" category="paragraph">以下示例显示了如何为 HCMT/HCOT 执行计划设置变量。</block>
  <block id="deab23bd3b868c986b7cb29f6fd4acc0" category="paragraph">必须在测试配置中使用这些变量。SAP 使用 HCMT/HCOT 工具提供的预定义执行计划通常会出现这种情况。以下 4K 日志写入测试示例来自执行计划。</block>
  <block id="9d9e7f5a6c25f736c782389b8599b38d" category="section-title">存储规模估算流程概述</block>
  <block id="b1dce9c1c938edf81a622f42fe8fc806" category="paragraph">每个 HANA 主机的磁盘数以及每个存储模型的 SAP HANA 主机密度均通过 SAP 性能测试工具确定。</block>
  <block id="a2a4e680f0b23836f4575f338d8b238e" category="paragraph">规模估算过程需要详细信息，例如生产和非生产 SAP HANA 主机的数量，每个主机的 RAM 大小以及基于存储的 Snapshot 副本的备份保留。SAP HANA 主机的数量决定了存储控制器和所需磁盘的数量。</block>
  <block id="4e22e31bf06b566da1fafaaf1f973f9d" category="paragraph">在容量规模估算期间， RAM 大小，每个 SAP HANA 主机磁盘上的净数据大小以及 Snapshot 副本备份保留期限均用作输入。</block>
  <block id="99be89615802a61d60cb75b091a02b81" category="paragraph">下图总结了规模估算过程。</block>
  <block id="535db3cbff51345ddc48fb6dbd091125" category="summary">在设置主机之前，必须从 NetApp 支持站点下载 NetApp SAN 主机实用程序，并将其安装在 HANA 服务器上。主机实用程序文档提供了有关根据所使用的 FCP HBA 而必须安装的其他软件的信息。</block>
  <block id="94b743cff45da9c23b8a3bc300657f21" category="doc">主机设置</block>
  <block id="09ea0908fbfc4cde85bf416e35dc55c8" category="inline-link">NetApp 支持</block>
  <block id="aec61b9198189c2192a934e97fa0ba6c" category="paragraph">在设置主机之前，必须从下载 NetApp SAN 主机实用程序<block ref="1a36b59ecae7684863b79a0f690b6840" category="inline-link-rx"></block> 站点和安装在 HANA 服务器上。主机实用程序文档提供了有关根据所使用的 FCP HBA 而必须安装的其他软件的信息。</block>
  <block id="ac2b4035dacf66e6bdd5bede88e20260" category="inline-link">《 Linux Host Utilities 7.1 安装和设置指南》</block>
  <block id="451ad01703fad985ae3358eaf6f2bd14" category="paragraph">文档还包含有关特定于所用 Linux 版本的多路径配置的信息。本文档介绍了 SLES 12 SP1 或更高版本以及 RHEL 7 所需的配置步骤。2 或更高版本，如中所述<block ref="c4b23c8c60f3faad406f8d46d87ba646" category="inline-link-rx"></block>。</block>
  <block id="41df23532b1b2095e93dfed170e3e95a" category="section-title">配置多路径</block>
  <block id="29c8d00954b1d81fd235004ad72cdc15" category="admonition">必须在 SAP HANA 多主机配置中的所有辅助主机和备用主机上执行步骤 1 到 6 。</block>
  <block id="face2730fdfb3061ad0f284515f9695d" category="paragraph">要配置多路径，请完成以下步骤：</block>
  <block id="d49e35527dee3aa4c0935558a3ccd40e" category="list-text">在每个服务器上运行 Linux `rescan-scsi-bus.sh -a` 命令以发现新的 LUN 。</block>
  <block id="75be82f3eaed4a8948bb32c324a96484" category="list-text">运行 `sanlun lun show` 命令并验证所有必需的 LUN 是否可见。以下示例显示了对于具有两个数据 LUN 和两个日志 LUN 的 2+1 多主机 HANA 系统的 `sanlun lun show` 命令输出。输出将显示 LUN 以及相应的设备文件，例如 LUN `SS3_data_mnt00001` 和设备文件 ` /dev/sdag` 每个 LUN 都有八条从主机到存储控制器的 FC 路径。</block>
  <block id="56674facde12d75bf46b49b5d6316f96" category="list-text">运行 `multipath -r` 命令以获取设备文件名的全球通用标识符（ WWID ）。</block>
  <block id="86551857b20d1627afd561e1111dd48c" category="admonition">在此示例中，有四个 LUN 。</block>
  <block id="b0a7dea9169ca74da0133eed343854ee" category="list-text">编辑 ` /etc/multipath.conf` 文件并添加 WWID 和别名。</block>
  <block id="649b8d1047ff4dbb68eac12144e5c1d5" category="admonition">示例输出显示了 ` /etc/multipath.conf` 文件的内容，其中包括 2+1 多主机系统中四个 LUN 的别名。如果没有可用的 multipath.conf 文件，则可以运行以下命令创建一个： `multipath -T &gt; /etc/multipath.conf` 。</block>
  <block id="9dc341408c35ffb21d021f873916b3be" category="list-text">运行 `multipath -r` 命令重新加载设备映射。</block>
  <block id="349df7a76ee939fd3552195d183e56a3" category="list-text">运行 `multipath -ll` 命令列出所有 LUN ，别名以及活动和备用路径，以验证配置。</block>
  <block id="3c440be39ee7b8ee32df76222e620417" category="admonition">以下示例输出显示了具有两个数据和两个日志 LUN 的 2+1 多主机 HANA 系统的输出。</block>
  <block id="f54213342718e90a288d6625eb733968" category="section-title">创建 LVM 卷组和逻辑卷</block>
  <block id="eeeec6c7d6ba3ce79b3e9a26d6ebed05" category="paragraph">只有在使用 LVM 时，才需要执行此步骤。以下示例适用于使用 SID FC5 的 2+1 主机设置。</block>
  <block id="72d8906ce88673b5ddc42cd605b2aaa9" category="admonition">对于基于 LVM 的设置，也必须完成上一节所述的多路径配置。在此示例中，必须为多路径配置八个 LUN 。</block>
  <block id="baf6ddaa837973f5c39837c3746535f5" category="list-text">将所有 LUN 初始化为物理卷。</block>
  <block id="e4eae96188ebd77284f0fc28c5c7413d" category="list-text">为每个数据和日志分区创建卷组。</block>
  <block id="fa0e9e0367bdf43a5c4d9ceba40a46db" category="list-text">为每个数据和日志分区创建一个逻辑卷。使用的条带大小等于每个卷组使用的 LUN 数量（在此示例中为 2 个），数据条带大小为 256k ，日志条带大小为 64k 。SAP 仅支持每个卷组一个逻辑卷。</block>
  <block id="a087a05338313c4f0b57c0d12c8ab31f" category="list-text">扫描所有其他主机上的物理卷，卷组和卷组。</block>
  <block id="58ccaa44e6f56ff65128a0b109099e56" category="admonition">如果这些命令未找到卷，则需要重新启动。</block>
  <block id="2fd29cd445709da647beada7d8568a19" category="paragraph">要挂载逻辑卷，必须激活逻辑卷。要激活卷，请运行以下命令：</block>
  <block id="e496d06cb94c67ede4a84c45f23a2df0" category="section-title">创建文件系统</block>
  <block id="fe1d650ecab92ef6fac725422fa64a17" category="paragraph">要在属于 HANA 系统的每个 LUN 上创建 XFS 文件系统，请执行以下操作之一：</block>
  <block id="21310a39c09dc5a86b6aa8b7ca24abda" category="list-text">对于单主机系统，请在数据，日志和 ` /ha/shared` LUN 上创建 XFS 文件系统。</block>
  <block id="c4802401f24cf9235459d06e324b1822" category="list-text">对于多主机系统，请在所有数据和日志 LUN 上创建 XFS 文件系统。</block>
  <block id="0c55b43772e02b7a7b21494f4ebb786e" category="list-text">如果使用 LVM ，请在所有数据卷和日志逻辑卷上创建 XFS 文件系统。</block>
  <block id="39cf4ec35983fa721c6b420b210c0675" category="admonition">多主机示例命令显示 2+1 多主机 HANA 系统。</block>
  <block id="da177ee5af51709ede3e62f55d81fee9" category="section-title">创建挂载点</block>
  <block id="fd9e946778d15df799e35ae9bfac94dc" category="paragraph">要创建所需的挂载点目录，请执行以下操作之一：</block>
  <block id="85db8406a3844549afcdbb507b8b4a00" category="list-text">对于单主机系统，设置权限并在数据库主机上创建挂载点。</block>
  <block id="88e0b55e191e70b52e4da6547b146c00" category="list-text">对于多主机系统，请在所有辅助主机和备用主机上设置权限并创建挂载点。</block>
  <block id="dc20c000dc7df08f0d52c68147bd32cc" category="admonition">示例命令显示 2+1 多主机 HANA 系统。</block>
  <block id="abf08e214081b9beed93c8754e4c2830" category="admonition">对于使用 Linux LVM 的系统配置，必须执行相同的步骤。</block>
  <block id="89c617c4ed9cac275e572a67b1c52b29" category="section-title">挂载文件系统</block>
  <block id="0cf8a62142dc06e1659f328c1b19b998" category="paragraph">要在系统启动期间使用 ` /etc/fstab` 配置文件挂载文件系统，请完成以下步骤：</block>
  <block id="6ddcbef1e37179143e2e2d6df9bd36e3" category="list-text">对于单主机系统，请将所需的文件系统添加到 ` /etc/fstab` 配置文件中。</block>
  <block id="f698665f2a88873767fbe21e3908ef17" category="admonition">必须使用 `relatime` 和 `inode64` 挂载选项挂载数据和日志 LUN 的 XFS 文件系统。</block>
  <block id="3a5164e3fb3ffa4aa2126eda14219ec2" category="paragraph">如果使用 LVM ，请对数据和日志使用逻辑卷名称。</block>
  <block id="6103fab32715f34b55faefb16a1ee20b" category="list-text">对于多主机系统，请将 ` /ha/shared` 文件系统添加到每个主机的 ` /etc/fstab` 配置文件中。</block>
  <block id="54720e6c9a787dee1a825e4ea3505728" category="admonition">所有数据和日志文件系统均通过 SAP HANA 存储连接器挂载。</block>
  <block id="5a3bf297b3cbbda0eaa792a3fc9aa696" category="paragraph">要挂载文件系统，请在每个主机上运行 `mount – a` 命令。</block>
  <block id="3a8315c9f707101d2111acb24fbc9655" category="summary">下面是 SAP HANA 软件安装的要求。</block>
  <block id="0c68d8a40313113ebbe5ac4a1f3d0dba" category="section-title">在单主机系统上安装</block>
  <block id="00cf3f3ec718b396e5e81b9c3fb6cf84" category="section-title">在多主机系统上安装</block>
  <block id="bb69fd52b05309d22618c8df73c8950e" category="admonition">以下安装操作步骤基于 SAP HANA 1.0 SPS12 或更高版本。</block>
  <block id="89a99a898a74d4f2ff80a5aa417e1639" category="paragraph">开始安装之前，请创建一个 `global.ini` 文件，以便在安装过程中使用 SAP 存储连接器。在安装过程中， SAP 存储连接器会在工作主机上挂载所需的文件系统。`global.ini` 文件必须位于可从所有主机访问的文件系统中，例如， ` /ha/shared/SID` 文件系统。</block>
  <block id="0e0c950ebceebc20ac07965f3d63f754" category="paragraph">如果使用 LVM ，则所需的配置会有所不同。以下示例显示了一个 2+1 多主机设置，其中 SID 为 FC5 。</block>
  <block id="912023f4eba0bf223e908e20d22ff92f" category="paragraph">以下各节提供了 SAP HANA 基础架构设置和配置准则，并介绍了设置 SAP HANA 系统所需的所有步骤。在这些部分中，使用了以下示例配置：</block>
  <block id="4bb047f8c530785002e490ef17fa725e" category="doc">从何处查找追加信息</block>
  <block id="345245c83d2b2c4c2a5eb9f2887da627" category="paragraph">要了解有关本文档中所述信息的更多信息，请参见以下文档和 / 或网站：</block>
  <block id="77187c93e0b43c549228506243592b1f" category="inline-link"><block ref="77187c93e0b43c549228506243592b1f" category="inline-link-rx"></block></block>
  <block id="06ad3435fb38e020aa7a36d8924c9f5c" category="inline-link"><block ref="06ad3435fb38e020aa7a36d8924c9f5c" category="inline-link-rx"></block></block>
  <block id="6137d44b5191549a06e7bea8ffd942d3" category="inline-link"><block ref="6137d44b5191549a06e7bea8ffd942d3" category="inline-link-rx"></block></block>
  <block id="1ffb329e128f9f021221cb333667e643" category="inline-link"><block ref="1ffb329e128f9f021221cb333667e643" category="inline-link-rx"></block></block>
  <block id="3a8abeead42ccd286a7d0cbd4af82313" category="cell">2014年4月</block>
  <block id="862ad23f517c987dec375a134fc0d5c0" category="cell">初始版本</block>
  <block id="4d07a3bdc1f6c260f91eff5a8c4732c0" category="cell">2014年8月</block>
  <block id="4b0b2617da1a441d88f736d71d3ac092" category="cell">更新了磁盘大小调整选择并添加了 SSD 配置添加了 Red Hat Enterprise Linux OS 配置添加了 SAP HANA 存储连接器信息添加了有关 VMware 配置的信息</block>
  <block id="76bc3a375f8e5795348c2e28143619d9" category="cell">2014年11月</block>
  <block id="db4466d6123c2bcdc9153e35eed5d67a" category="cell">更新了存储规模估算部分</block>
  <block id="bde49e4082500b233767ac0393f52c97" category="cell">2015年1月</block>
  <block id="18b29171bb9db10940df132fe30b02ef" category="cell">更新了存储连接器 API 部分更新了聚合和卷配置</block>
  <block id="e9d3c4f3be58e8eb9a2fe5ef80b5dbcd" category="cell">2015年3月</block>
  <block id="adceb3eeeca6d2e6e13cc707f1047b4d" category="cell">新增了 SAP HANA SPS9 的 STONITH 实施功能，增加了计算节点设置和 HANA 安装部分</block>
  <block id="6c37787225b6b2fa9a3a2d7f9c7b9b1f" category="cell">增加了对 cDOT 的 NFSv4 支持，更新了 sysctl 参数，包括 SAP HANA 的 I/O 参数和 HWVAL &gt; SPS10</block>
  <block id="357a6db4d8952d53bdb6f4eb953edf16" category="cell">更新了容量规模估算更新了 /has/shared 更新了 sysctl 参数的挂载选项</block>
  <block id="5d431191212b0f13c81937d63ee45577" category="cell">版本 4.0</block>
  <block id="3d4f06d9a20e1dd80d32a7be99445018" category="cell">新的 NetApp 存储系统和磁盘架 ONTAP 9 的新增功能支持 40GbE 新操作系统版本（ SUSE Linux Enterprise Server12 SP1 和 Red Hat Enterprise Linux 7.2 ）新的 SAP HANA 版本</block>
  <block id="4880361a9deda058baa93a9609f49c06" category="cell">新的 NetApp 存储系统新的操作系统版本（ SUSE Linux Enterprise Server 12 SP3 和 Red Hat Enterprise Linux 7.4 ） SAP HANA 2.0 SPS3 的其他次要更改</block>
  <block id="bbfb6d5a145f45ac380d5c56707a3b3f" category="cell">2019 年 9 月</block>
  <block id="b48c54ef40f55cf60865e423133eea27" category="cell">新的操作系统版本（ SUSE Linux Enterprise Server 12 SP4 ， SUSE Linux Enterprise Server 15 和 Red Hat Enterprise Linux 7.6 ） MAX Data 卷大小略有更改</block>
  <block id="42aef0714dca75b922449334f8354e29" category="cell">2019年12月</block>
  <block id="be4ee54ca2edc105b3af0d346b4fab97" category="cell">新的 NetApp 存储系统新的操作系统版本 SUSE Linux Enterprise Server 15 SP1</block>
  <block id="342aa26fa2cc7e365c1b819a4e86b6f1" category="cell">2020年3月</block>
  <block id="d41615a4f21c04431fed0afc578baede" category="cell">支持 NFSv3 新操作系统版本 Red Hat Enterprise Linux 8 的 nconnect</block>
  <block id="0fa56213ed5deea97598ccd1f1d3db87" category="cell">2020 年 5 月</block>
  <block id="1ab89c4e611ba31faab0f6bdb2081951" category="cell">自 SAP HANA 2.0 SPS4 以来，引入了多种数据分区功能</block>
  <block id="a5667679a016ee66ef9bc45c1a173b3b" category="cell">2020年12月</block>
  <block id="cdd33367f29c689bcb60e79e248c660e" category="cell">从 ONTAP 9.8 开始支持 NFSv4.1 的 nconnect 新操作系统版本新的 SAP HANA 版本</block>
  <block id="8aa90565fb34d8b0aeab74ab74ffdf4a" category="cell">2021年2月</block>
  <block id="6ed1463e8ca682ff7a3d60ed388dcefe" category="cell">更改主机网络设置和其他小更改</block>
  <block id="caedd77305f36805e5e9f71196bad9dc" category="summary">每个 SAP HANA 服务器都必须具有一个冗余 FCP SAN 连接，带宽至少为 8 Gbps 。对于连接到存储控制器的每个 SAP HANA 主机，必须在存储控制器上至少配置 8 Gbps 的带宽。</block>
  <block id="ac20a17ff8274dc0492aecef51b17cc3" category="doc">SAN 网络结构设置</block>
  <block id="b180b819c4be4e05edc4c7fb2025b37a" category="paragraph">下图显示了一个示例，其中四个 SAP HANA 主机连接到两个存储控制器。每个 SAP HANA 主机都有两个 FCP 端口连接到冗余网络结构。在存储层，配置了四个 FCP 端口，可为每个 SAP HANA 主机提供所需的吞吐量。</block>
  <block id="3537fc965bfc8258734281e905f0339b" category="paragraph">除了交换机层上的分区之外，您还必须将存储系统上的每个 LUN 映射到连接到此 LUN 的主机。使交换机上的分区保持简单，即定义一个分区集，使所有主机 HBA 都可以查看所有控制器 HBA 。</block>
  <block id="030c69314a5026a51c56546f16b3d52c" category="cell">2015年2月</block>
  <block id="d236c4295d03153cf4b58756ba35a16b" category="cell">包含 SAP HANA 和 HWVAL SPS 10 及更高版本的 I/O 参数</block>
  <block id="ca67bdac3e5296c9aca14c7757a45a43" category="cell">2016年2月</block>
  <block id="8511699ac8ab74e8202ea00e8605032a" category="cell">新的 NetApp 存储系统和磁盘架 ONTAP 9 新操作系统版本（ SLES12 SP1 和 Red Hat Enterprise Linux 7.2 ）的新功能全新 SAP HANA 版本</block>
  <block id="86c976bd97e98538a78594cffd1f4347" category="cell">新的 NetApp 存储系统新的操作系统版本（ SLES12 SP3 和 Red Hat Enterprise Linux 7.4 ） SAP HANA 2.0 SPS3 的其他次要更新</block>
  <block id="b2741985b04e7a670dd01c660734116f" category="cell">新操作系统会发布次要更新</block>
  <block id="0eb0e7ad4cb166bbccd693c2caa1bacd" category="cell">Linux LVM 支持新的 NetApp 存储系统新的操作系统版本（ SLES15SP2 ， RHEL 8 ）</block>
  <block id="9a4bface9098ff4cd4b35cca641c0042" category="cell">2021年4月</block>
  <block id="f389acb9c3b9da7fd00873307beefaf2" category="cell">添加了 VMware vSphere 专用信息</block>
  <block id="825584759100661fac8be910e01502e6" category="summary">您必须同步存储控制器与 SAP HANA 数据库主机之间的时间。</block>
  <block id="be8226fe0c6443f6cad5815ef0b97b33" category="doc">时间同步</block>
  <block id="f63d5e470adeffe7633a6b7dd6a766f0" category="paragraph">您必须同步存储控制器与 SAP HANA 数据库主机之间的时间。必须为所有存储控制器和所有 SAP HANA 主机设置相同的时间服务器。</block>
  <block id="283788d4b8f40899acef933a8b3cb2e7" category="paragraph">下一节概述了为 SAP HANA 估算存储系统规模所需的性能和容量注意事项。</block>
  <block id="d80e2fc4ceca3d26a3277e9ab88fda68" category="admonition">请联系您的 NetApp 或 NetApp 合作伙伴销售代表，为存储规模估算流程提供支持，并帮助您创建大小合适的存储环境。</block>
  <block id="42bd6e1e54cc980bd9322b30521321ca" category="paragraph">SAP 定义了一组静态存储关键性能指标（ KPI ）。无论数据库主机和使用 SAP HANA 数据库的应用程序的内存大小如何，这些 KPI 都适用于所有生产 SAP HANA 环境。这些 KPI 适用于单主机，多主机， HANA 上的 Business Suite ， HANA 上的 Business Warehouse ， S/4HANA 和 BB/4HANA 环境。因此，当前的性能规模估算方法仅取决于连接到存储系统的活动 SAP HANA 主机的数量。</block>
  <block id="c2c1b5b14996ab9aba9a186353eb6741" category="admonition">存储性能 KPI 仅适用于生产 SAP HANA 系统，但您可以在中为所有 HANA 系统实施。</block>
  <block id="8e1e38affc84c007b3fadf2fe3f94c0d" category="paragraph">SAP 提供了一个性能测试工具，必须使用该工具来验证连接到存储的活动 SAP HANA 主机的存储系统性能。</block>
  <block id="6149b256ad8746f06c3f529454afe3e0" category="paragraph">NetApp 测试并预定义了可连接到特定存储模型的最大 SAP HANA 主机数，同时仍满足 SAP 为基于生产的 SAP HANA 系统提供的所需存储 KPI 。</block>
  <block id="64b8a436222beafffe6cdd183786a7e7" category="paragraph">可以在磁盘架上运行的最大 SAP HANA 主机数以及每个 SAP HANA 主机所需的最小 SSD 数均通过运行 SAP 性能测试工具来确定。此测试不会考虑主机的实际存储容量要求。您还必须计算容量要求，以确定所需的实际存储配置。</block>
  <block id="a052dc95cd52f99e2150cc7afb3c9c46" category="section-title">SAS 磁盘架</block>
  <block id="b3ccef22c64fb18c4586c819217d0f8d" category="paragraph">对于 12 Gb SAS 磁盘架（ DS224C ），可使用固定磁盘架配置来执行性能规模估算：</block>
  <block id="627d56f1e06c43902409b38517d071d8" category="list-text">半负载磁盘架，带 12 个 SSD</block>
  <block id="caf4121cd1e84773f66f61f25a118b4f" category="list-text">满载磁盘架，含 24 个 SSD</block>
  <block id="f5bae058eb14b2365a397455cac09daa" category="paragraph">这两种配置都使用高级驱动器分区（ ADPv2 ）。半负载磁盘架最多可支持 9 个 SAP HANA 主机；一个全负载磁盘架最多可在一个磁盘架中支持 14 个主机。SAP HANA 主机必须在两个存储控制器之间平均分布。</block>
  <block id="801801c4a151eb328734c55f97c13ff3" category="admonition">必须使用 12 Gb SAS 连接 DS224C 磁盘架，以支持 SAP HANA 主机的数量。</block>
  <block id="5115380b0209eebdde0a83a569c67ac9" category="paragraph">6 Gb SAS 磁盘架（ DS2246 ）最多支持 4 个 SAP HANA 主机。SSD 和 SAP HANA 主机必须在两个存储控制器之间平均分布。下图总结了每个磁盘架支持的 SAP HANA 主机数。</block>
  <block id="043c223ee43975d6131cc23521e57f4d" category="cell">满载 24 个 SSD 的 6 Gb SAS 磁盘架（ DS2246 ）</block>
  <block id="2b0c391c7894ff251721538dc649534b" category="cell">12 GB SAS 磁盘架（ DS224C ），半负载，具有 12 个 SSD 和 ADPv2</block>
  <block id="7565d12fd6dd164a9dc8caa5e983cd6d" category="cell">12 GB SAS 磁盘架（ DS224C ），满载 24 个 SSD 和 ADPv2</block>
  <block id="45c48cce2e2d7fbdea1afc51c7c6ad26" category="cell">9</block>
  <block id="2b496b69f4c7aea7a8d59474a9bf6c8a" category="admonition">此计算与所使用的存储控制器无关。添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="58913e61815b0d5b4ebf09a2dbba07e5" category="section-title">NS224 NVMe 磁盘架</block>
  <block id="8bcf6b78575503f1caaf3d70970f3855" category="admonition">添加更多磁盘架不会增加存储控制器可以支持的 SAP HANA 主机的最大数量。</block>
  <block id="e2725d07d4b4cbeaff651e403b9ed0c2" category="paragraph">您可能会决定在同一存储控制器或同一聚合上部署 SAP HANA 工作负载和其他应用程序工作负载。如果是，您必须确保在混合工作负载环境中为 SAP HANA 提供足够的性能。NetApp 还建议您使用服务质量（ QoS ）参数来控制这些其他应用程序对 SAP HANA 应用程序可能产生的影响，并保证 SAP HANA 应用程序的吞吐量。</block>
  <block id="39d8b74e0095310309063c02410f6a20" category="paragraph">必须使用 SAP HCMT 测试工具检查是否可以在已用于其他工作负载的现有存储控制器上运行其他 SAP HANA 主机。SAP 应用程序服务器可以安全地放置在与 SAP HANA 数据库相同的存储控制器和 / 或聚合上。</block>
  <block id="fe49f707e4996a28b6c7f34609ee9475" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。使用 SAP 测试工具测试存储性能时，还必须为 SAP 的性能测试工具设置这些参数。</block>
  <block id="b86abe7931a3894ff977168fbdb8b7b6" category="paragraph">NetApp 进行了性能测试以定义最佳值。下表列出了必须在 SAP 测试工具的配置文件中设置的参数。</block>
  <block id="0e614553d2a8cc9424587a1d3acd9d09" category="paragraph">有关 SAP 测试工具配置的详细信息，请参见<block ref="ec90a615c6d378fa60ba8e7f2e7592b2" category="inline-link-rx"></block> 适用于 HWCCT （ SAP HANA 1.0 ）和<block ref="2912abb2c0271a2912b6a4a94888e0ec" category="inline-link-rx"></block> 适用于 HCMT/HCOT （ SAP HANA 2.0 ）。</block>
  <block id="410dd60427299621482167417a192d6f" category="paragraph">每个 HANA 主机的磁盘数以及每个存储模型的 SAP HANA 主机密度均通过 SAP HANA 测试工具确定。</block>
  <block id="365912103e9bce0d6c05c8ee64c9b43f" category="summary">从 SAP HANA 2.0 SPS4 开始，您可以配置其他数据卷分区，从而可以为 SAP HANA 租户数据库的数据卷配置两个或更多卷。</block>
  <block id="69a593c87ff666bb67c1207a32a24a79" category="doc">添加其他数据卷分区</block>
  <block id="35697e7b3429f60c725ef9d7b697ea1e" category="admonition">对于 SAP HANA 单主机和多主机系统，可以为数据卷使用两个或更多个单独的卷。您可以随时添加其他数据卷分区，但这样做可能需要重新启动 SAP HANA 数据库。</block>
  <block id="19ddc7e98eb6fa40c4ac62a77090bff2" category="section-title">启用其他数据卷分区</block>
  <block id="b4dbae4c26b3a936fe51ac6f503e18f7" category="list-text">要启用其他数据卷分区，请使用 SAP HANA Studio 或 SYSTEMDB 配置中的 Cockpit 在 `global.ini` 中添加以下条目。</block>
  <block id="6646190eb7b9d6c7a29ea115116c1c5e" category="admonition">手动将参数添加到 `global.ini` 文件需要重新启动数据库。</block>
  <block id="7935ac3c59536eb9c8a1b5f13e7f5716" category="section-title">单主机 SAP HANA 系统的卷配置</block>
  <block id="2583a9b74a1a2d8e89634e09b78f590d" category="paragraph">具有多个分区的单主机 SAP HANA 系统的卷布局与具有一个数据卷分区的系统的布局类似，但另一个数据卷存储在与日志卷和另一个数据卷不同的聚合上。下表显示了具有两个数据卷分区的 SAP HANA 单主机系统的示例配置。</block>
  <block id="94ef64dabfa4b51295dd875fa15a44de" category="cell">控制器 A 上的聚合 1</block>
  <block id="0da1566401e5a0582b6d811560cc8438" category="cell">控制器 A 上的聚合 2</block>
  <block id="747929c967a801a630de61c08e522b6b" category="cell">控制器 B 上的聚合 1</block>
  <block id="1d2c38f49539ebccd4cc3327d455942e" category="cell">控制器 b 上的聚合 2</block>
  <block id="a983282d84f231230a21d6e897fa5096" category="cell">数据卷： sid_data_mnt00001</block>
  <block id="3458d911e12a02c2c22c30c147e60dc7" category="cell">共享卷： sid_shared</block>
  <block id="d1ce9ffb9c761d5074baf3a5457e1bed" category="cell">数据卷： sid_data2_mnt00001</block>
  <block id="2849faa7f343c897c5059440d947d834" category="cell">日志卷： sid_log_mnt00001</block>
  <block id="1a7f6076f09280d452350c186d20b52c" category="paragraph">下表显示了具有两个数据卷分区的单主机系统的挂载点配置示例。</block>
  <block id="a75d0e69bd02dcf9fa585e045bc16d84" category="cell">Junction path</block>
  <block id="e73cda510e8bb947f7e61089e5581494" category="cell">目录</block>
  <block id="bf64a2d18066494ae65ae74fb4aae57d" category="cell">HANA 主机上的挂载点</block>
  <block id="bd8e6b40602529d6e57fdd885a48d151" category="cell">sid_data_mnt00001</block>
  <block id="37ce74088416f28dc9bb04355c2e5a28" category="cell">–</block>
  <block id="28645b4c3119792ae6fa1d7c40f5f3a8" category="cell">/ha/data/sid/mnt00001</block>
  <block id="25df05fd17104ffc9b29c882613281c6" category="cell">sid_data2_mnt00001</block>
  <block id="bb3dd4d1045ea603128872d169f40096" category="cell">/ha/data2/sid/mnt00001</block>
  <block id="b0344f7eade7f841bc1eb24d9175cad3" category="cell">sid_log_mnt00001</block>
  <block id="6adac4774bcd36fdc536601e6bdf18f5" category="cell">/ha/log/sid/mnt00001</block>
  <block id="07fe7fc9aa3cd33458708758a4a5854e" category="cell">sid_shared</block>
  <block id="c1ce059dbe7a4bf70cbd08a0fede6581" category="cell">use-sap 共享</block>
  <block id="96a082d267455fedce449479e429850b" category="cell">/usr/sap/SID /has/shared</block>
  <block id="afd44e74cb54a923d1cd4fe5065b370a" category="paragraph">创建新数据卷并使用 ONTAP 系统管理器或 ONTAP 集群命令行界面将其挂载到命名空间。</block>
  <block id="b7244e6e0957d367c131dd41458b8619" category="section-title">多主机 SAP HANA 系统的卷配置</block>
  <block id="0d93df55c1f3029fd5c21ba9e75aa25e" category="paragraph">具有多个分区的多主机 SAP HANA 系统的卷布局与具有一个数据卷分区的系统的布局类似，但另一个数据卷存储在与日志卷和另一个数据卷不同的聚合上。下表显示了具有两个数据卷分区的 SAP HANA 多主机系统的示例配置。</block>
  <block id="261addf78c7b2c961032b3dd08ba0b1f" category="cell">目的</block>
  <block id="15572572230ee081e530fd30f1a16139" category="cell">控制器 B 上的聚合 2</block>
  <block id="c50bebb751ab31a7b0e508e4dfdba06e" category="cell">节点 1 的数据卷和日志卷</block>
  <block id="d6b8eb7e3d6ddf4af2ac24f74f1ddee8" category="cell">Data2 卷： sid_data2_mnt00001</block>
  <block id="5585cc8b94529d9c0f345077289daeb3" category="cell">节点 2 的数据卷和日志卷</block>
  <block id="7efb64be9f62e8f3406e303538204110" category="cell">日志卷： sid_log_mnt00002</block>
  <block id="79c44c08a641df91246f70b5f4721b31" category="cell">Data2 卷： sid_data2_mnt00002</block>
  <block id="f26af5ab0fdf7a3063e0701448193969" category="cell">数据卷： sid_data_mnt00002</block>
  <block id="b62802686db75d9aaba27ff8baea5457" category="cell">节点 3 的数据卷和日志卷</block>
  <block id="93b4e1912193293e4191e8d10ca4086e" category="cell">数据卷： sid_data_mnt00003</block>
  <block id="8d4ffa81992169c71fc47a58aa110819" category="cell">Data2 卷： sid_data2_mnt00003</block>
  <block id="3051e617efdca60e945d64ca6067b3a2" category="cell">日志卷： sid_log_mnt00003</block>
  <block id="66bb8e08981a9eb2e93115ca07d2d372" category="cell">节点 4 的数据卷和日志卷</block>
  <block id="e841538cca9e2cf1fae81ffe21df7466" category="cell">Data2 卷： sid_data2_mnt00004</block>
  <block id="3ed5556fee96de062d644851208dd660" category="cell">日志卷： sid_log_mnt00004</block>
  <block id="03a60a69cee7408b407e8ed18de961e5" category="cell">数据卷： sid_data_mnt00004</block>
  <block id="7ad8ef5e9493431c100fe1929275d46f" category="cell">所有主机的共享卷</block>
  <block id="693ff1bb9789154e19ce882511f832d6" category="cell">SAP HANA 主机上的挂载点</block>
  <block id="3b0649c72650c313a357338dcdfb64ec" category="cell">注意</block>
  <block id="3834b3356eaa1553006c5471596d35c1" category="cell">已挂载到所有主机上</block>
  <block id="aed47d1036974391b87115f518c5ad9d" category="cell">sid_data_mnt00002</block>
  <block id="014e151088a15dadd29fbd3ddd2eece8" category="cell">/ha/data/sid/mnt00002</block>
  <block id="33536390a7276b2c74b95566e3d0d297" category="cell">sid_data2_mnt00002</block>
  <block id="ab22798507bc37ab18a91947cfbe50e6" category="cell">/ha/data2/sid/mnt00002</block>
  <block id="8eaf7e9b1604430bac4e6dfd5939d3b3" category="cell">sid_log_mnt00002</block>
  <block id="36fb6deade219e3cfdee0d1e5382afa8" category="cell">/ha/log/sid/mnt00002</block>
  <block id="2289ec88b37b878c492747449a18a549" category="cell">sid_data_mnt00003</block>
  <block id="fef79e4721fe570e8a193320c7d270ce" category="cell">/ha/data/sid/mnt00003</block>
  <block id="bbff3274b9791230c96c20a7db005976" category="cell">sid_data2_mnt00003</block>
  <block id="ca0cf1c880cd5ab76a6c51562746eb04" category="cell">/ha/data2/sid/mnt00003</block>
  <block id="4439e6ea1822110931ae0b346803a4ac" category="cell">sid_log_mnt00003</block>
  <block id="380d4f0ad324c2dfd6c1ca68fd7bafbf" category="cell">/ha/log/sid/mnt00003</block>
  <block id="e8305dfe00f0309c92a6206d66e79543" category="cell">sid_data_mnt00004</block>
  <block id="a4f33e779d1944af098aa7eb8e8b7af4" category="cell">/ha/data/sid/mnt00004</block>
  <block id="218ad8a689f58dc4e5ba92853698500b" category="cell">sid_data2_mnt00004</block>
  <block id="08dc2448980b987da62e9d1e4ca018c9" category="cell">/ha/data2/sid/mnt00004</block>
  <block id="772d9b9673f172efa79c1a7882b6d979" category="cell">sid_log_mnt00004</block>
  <block id="69c78d157fba71e316ca5acf4eb8cb75" category="cell">/ha/log/sid/mnt00004</block>
  <block id="9e81e7b963c71363e2fb3eefcfecfc0e" category="cell">共享</block>
  <block id="9c7f13d493df94d57a532cd79c0ffa64" category="cell">/ha/shared/SID</block>
  <block id="f4c8435e4cbde93f00e4d1d5f25bedb2" category="cell">usr-sap-host1</block>
  <block id="e049803e41fabe0f53c4ead4b0f14350" category="cell">/usr/sap/SID</block>
  <block id="8d653d19a4cbb5862c5b1fc62193bed3" category="cell">挂载在主机 1 上</block>
  <block id="2c1dcadb291b7285e8a1001552fcc6d1" category="cell">usr-sap-host2.</block>
  <block id="33a6785666ac3aaa1c087db254ded2cb" category="cell">挂载在主机 2 上</block>
  <block id="340e8bd3e6491f3fe8bd43fca2c60e95" category="cell">usr-sap-host3.</block>
  <block id="2a7bf7921d279ab9a00111b11d3ae899" category="cell">挂载在主机 3 上</block>
  <block id="123a9fde0665e6f3dee96c9c40722de3" category="cell">usr-sap-host4.</block>
  <block id="6e3dcff90b7ca24cdf923aff68ce5b00" category="cell">挂载在主机 4 上</block>
  <block id="907d47ee5162569b082834e89adfec7c" category="cell">usr-sap-host5</block>
  <block id="fc0236f60f516ce4f48a70a9736de333" category="cell">挂载在主机 5 上</block>
  <block id="13d80777c8fd43e555c1f5b1b72d7ef0" category="section-title">主机配置</block>
  <block id="b688483cd0a2e330c81c99abb3e612b1" category="inline-link-macro">" 主机设置 " ，</block>
  <block id="835c0d8e2099421bae5671f87d4583ab" category="paragraph">除了一节中所述的任务之外 <block ref="b752442e7fb5d355acb77dfb5e05753a" category="inline-link-macro-rx"></block> 您必须为新的附加数据卷创建其他挂载点和 fstab 条目，并且必须挂载新卷。</block>
  <block id="560dda3ab3afa61eb803bc19cb5acc84" category="list-text">创建其他挂载点：</block>
  <block id="ae184ec9bdba806be5988da85e799c3a" category="list-text">对于单主机系统，创建挂载点并在数据库主机上设置权限。</block>
  <block id="3a4afc3d4465684d9924e5bca29c53fe" category="list-text">对于多主机系统，创建挂载点并在所有工作主机和备用主机上设置权限。以下示例命令适用于 2+1 多主机 HANA 系统。</block>
  <block id="fc99a71532d5fc19420f3089b094e40c" category="list-text">第一员工主机：</block>
  <block id="74ce80ef80982f26e052c73c94a02637" category="list-text">第二工作主机：</block>
  <block id="411d2b952bb67be5147ad7888b44819f" category="list-text">备用主机：</block>
  <block id="fffa779fc8dbbf30d23e4f7dba0bce07" category="list-text">将其他文件系统添加到所有主机上的 ` /etc/fstab` 配置文件中。以下是使用 NFSv4.1 的单主机系统的示例：</block>
  <block id="38f49054cf8e175dd49c721b8e9b5584" category="admonition">使用不同的存储虚拟接口连接到每个数据卷，以确保每个卷使用不同的 TCP 会话。如果 nconnect 挂载选项可用于您的操作系统，您也可以使用它。</block>
  <block id="1aa3240e835a1ccee1c1455ab8240cfa" category="list-text">要挂载文件系统，请运行 `mount – a` 命令。</block>
  <block id="f24c14c86fe4885372ee7537f12b5831" category="section-title">添加其他数据卷分区</block>
  <block id="140aa7f2a42d2786e74cffaa9b3cae98" category="paragraph">对租户数据库执行以下 SQL 语句，以便向租户数据库添加额外的数据卷分区。使用指向其他卷的路径：</block>
  <block id="8517d48ff677af656392e116dabd2ac9" category="summary">每个 SAP HANA 服务器都必须具有一个冗余 FCP SAN 连接，带宽至少为 8 Gbps 。对于连接到存储控制器的每个 SAP HANA 主机，必须在存储控制器上至少配置 8 Gbps 的带宽。</block>
  <block id="e368e008d79a3b2079d973871fd38c35" category="summary">本节介绍 NetApp 存储系统的配置。您必须根据相应的 ONTAP 设置和配置指南完成主安装和设置。</block>
  <block id="331f03787d9544cd97e5b3a31e2b31bc" category="doc">存储控制器设置</block>
  <block id="fd18465573ec21a6218982055981f6b1" category="section-title">存储效率</block>
  <block id="cc9ff39c9f631978557ae00fd8f5865d" category="paragraph">在 SSD 配置中， SAP HANA 支持实时重复数据删除，跨卷实时重复数据删除，实时数据压缩和实时数据缩减。</block>
  <block id="ed6036f9cee51fdd7e2a091bbae50c50" category="paragraph">不支持在基于 HDD 的配置中启用存储效率功能。</block>
  <block id="a662d487b875a4e232a16649f36fb399" category="section-title">Quality of service</block>
  <block id="7686322155849443f06959615c011bf4" category="paragraph">QoS 可用于限制共享使用控制器上特定 SAP HANA 系统或其他应用程序的存储吞吐量。其中一个使用情形是，限制开发和测试系统的吞吐量，使其不会影响混合环境中的生产系统。</block>
  <block id="6c86cfdf44739a850a7a1248b66cb537" category="paragraph">在规模估算过程中，您应确定非生产系统的性能要求。开发和测试系统的规模可以采用较低的性能值进行调整，通常在 SAP 定义的生产系统 KPI 的 20% 到 50% 范围内。</block>
  <block id="6ab5df7290e481b70e28b2b6f494b241" category="paragraph">从 ONTAP 9 开始， QoS 会在存储卷级别进行配置，并使用最大吞吐量值（ MBps ）和 I/O 量（ IOPS ）。</block>
  <block id="652c99b312d2d799385f153fd324ef46" category="paragraph">大型写入 I/O 对存储系统的性能影响最大。因此，应将 QoS 吞吐量限制设置为数据卷和日志卷中相应写入 SAP HANA 存储性能 KPI 值的百分比。</block>
  <block id="2e985af49c448d15c7b99987586e6b15" category="section-title">NetApp FabricPool</block>
  <block id="06ef1046368829b825e8266554a89dcb" category="paragraph">SAP HANA 系统中的活动主文件系统不能使用 NetApp FabricPool 技术。这包括数据和日志区域的文件系统以及 ` /hana 或共享` 文件系统。这样做会导致性能不可预测，尤其是在启动 SAP HANA 系统期间。</block>
  <block id="7bb98c896519df010b68c8bdb336edc7" category="paragraph">可以使用 " 仅快照 " 分层策略，也可以在 FabricPool 或 SnapMirror 目标等备份目标上使用 SnapVault 。</block>
  <block id="b76091ebd2ebee3eceba1434b0e25665" category="admonition">使用 FabricPool 在主存储上分层 Snapshot 副本或在备份目标上使用 FabricPool 会更改还原和恢复数据库或执行其他任务（例如创建系统克隆或修复系统）所需的时间。在规划整个生命周期管理策略时，请考虑这一点，并检查以确保在使用此功能时仍符合 SLA 要求。</block>
  <block id="46727fb1b4c25171c126d53a75e860d4" category="paragraph">FabricPool 是将日志备份移动到另一存储层的理想选择。移动备份会影响恢复 SAP HANA 数据库所需的时间。因此，应将选项 " 分层最小冷却天数 " 设置为一个值，以便在本地快速存储层上放置恢复所需的日志备份。</block>
  <block id="6e8775bd755a8835ce86806d669677ea" category="section-title">存储配置</block>
  <block id="6e2e713144257635582dbbf70df45c90" category="paragraph">以下概述总结了所需的存储配置步骤。后续章节将详细介绍每个步骤。在本节中，我们假定已设置存储硬件，并且已安装 ONTAP 软件。此外，存储端口（ 10GbE 或更快）与网络之间的连接必须已建立。</block>
  <block id="1a6713a2ed51f26877113c77d1ed10d7" category="inline-link-macro">磁盘架连接。</block>
  <block id="8a256fca82b713e79a5c2eb58989ed1c" category="list-text">按照中所述检查正确的 SAS 堆栈配置 <block ref="43af2724f5082b46987a75d8ab006aa5" category="inline-link-macro-rx"></block></block>
  <block id="9b58b6eeca17fb4fe9e5352e926cdcfa" category="inline-link-macro">聚合配置</block>
  <block id="b36aec9930308e0171ace274b1435446" category="list-text">创建并配置所需的聚合，如中所述 <block ref="148e1b9e1ae72918ac5182a6a0ab42d1" category="inline-link-macro-rx"></block></block>
  <block id="b198e02504c91a496ce6aa963575c839" category="inline-link-macro">Storage Virtual Machine 配置</block>
  <block id="a4c777849af1dc862ca5ddb9889e2147" category="list-text">创建 Storage Virtual Machine （ SVM ），如中所述 <block ref="74536016401b3037fbe7880f8456140d" category="inline-link-macro-rx"></block></block>
  <block id="345bb6af01988bbf21faec0cf43efa4c" category="inline-link-macro">逻辑接口配置。</block>
  <block id="777b1870d452642485ec2e8132ec404c" category="list-text">按照中所述创建 LIF <block ref="45280be6ff9e6c2edb75908a8c6b0fe9" category="inline-link-macro-rx"></block></block>
  <block id="6e12a7f11b9c2161720afb5f8de85d45" category="inline-link-macro">SAP HANA 单主机系统的卷配置</block>
  <block id="2d96346a98280eefa1ce52a6dc646347" category="inline-link-macro">SAP HANA 多主机系统的卷配置。</block>
  <block id="46ea27c06cfac2a7e50a216fe2b74d19" category="list-text">在聚合中创建卷，如中所述 <block ref="4a942275534568641e8ed37ef94c8909" category="inline-link-macro-rx"></block> 和 <block ref="b26ec3c7473556fe12ca09dc77e0d3a7" category="inline-link-macro-rx"></block></block>
  <block id="5f8947cce1567cd7d0eddcfc20683ac3" category="inline-link-macro">卷选项</block>
  <block id="ff5cec781d4485d5ace27e41224dab40" category="list-text">按照中所述设置所需的卷选项 <block ref="f565a9290b750486a8840d8d88264b3a" category="inline-link-macro-rx"></block></block>
  <block id="8011b09d28d54ea23274d28560d4fd1e" category="inline-link-macro">NFSv3 的 NFS 配置</block>
  <block id="a0212bd1cf31c1a185f0f29d94897927" category="inline-link-macro">NFSv4 的 NFS 配置。</block>
  <block id="01bd8be115ec4094d2f4c35689305ec5" category="list-text">为 NFSv3 设置所需的选项，如中所述 <block ref="8c64733e7fb76bbd4650c0bf29ed950b" category="inline-link-macro-rx"></block> 或 NFSv4 ，如中所述 <block ref="ab5c20669050c73ba24d89c4b271e9e7" category="inline-link-macro-rx"></block></block>
  <block id="00e211cc0d199a4dc3e5894015258add" category="inline-link-macro">将卷挂载到命名空间并设置导出策略。</block>
  <block id="cf0e53f3e79fba7d9a1e67ec1a7f6efd" category="list-text">将卷挂载到命名空间并设置导出策略，如中所述 <block ref="b8bd45dc69d8895b4fc3769108729cc4" category="inline-link-macro-rx"></block></block>
  <block id="a2c22f5fc8f18d8d87dd5a34087a8c8e" category="section-title">磁盘架连接</block>
  <block id="d999c97b7b1008a316e18c6626bbd3f9" category="paragraph">对于 HDD ，最多可以将两个 DS2246 磁盘架或四个 DS224C 磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。</block>
  <block id="be1f49d12074a6591e9316baeac9bd63" category="paragraph">使用 SSD 时，最多可以将一个磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。对于 DS224C 磁盘架，也可以使用四路径 SAS 布线，但这不是必需的。</block>
  <block id="10ae1f9130fbbe975a644b0f325c6b31" category="section-title">聚合配置</block>
  <block id="6d83330b28ca1a77d72839b80db66f91" category="paragraph">通常，您必须为每个控制器配置两个聚合，而不受所使用的磁盘架或驱动器技术（ SSD 或 HDD ）的影响。对于 FAS2000 系列系统，一个数据聚合就足够了。</block>
  <block id="1033ef32c4f49ab33d841963d284959e" category="section-title">使用 HDD 的聚合配置</block>
  <block id="f86ec3e0c9a63d44ac0e2e4b954909f2" category="paragraph">下图显示了八个 SAP HANA 主机的配置。每个存储控制器连接四个 SAP HANA 主机。配置了两个单独的聚合，每个存储控制器一个。每个聚合都配置有 4 × 10 = 40 个数据磁盘（ HDD ）。</block>
  <block id="d6cced120b68f4aa019b47531e1ca2a2" category="section-title">使用纯 SDD 系统进行聚合配置</block>
  <block id="6133edaaabe85a9df71198b718da08cd" category="paragraph">通常，您必须为每个控制器配置两个聚合，而与使用的磁盘架或磁盘技术（ SSD 或 HDD ）无关。对于 FAS2000 系列系统，一个数据聚合就足够了。</block>
  <block id="db04b8526d641576c657ab1ab39cc830" category="paragraph">下图显示了在配置了 ADPv2 的 12 Gb SAS 磁盘架上运行的 12 个 SAP HANA 主机的配置。每个存储控制器连接六个 SAP HANA 主机。配置了四个单独的聚合，每个存储控制器两个。每个聚合都配置有 11 个磁盘，其中包含九个数据分区和两个奇偶校验磁盘分区。每个控制器都有两个备用分区。</block>
  <block id="4e777d3b2a8b458c7f1f8e99e8ee985b" category="section-title">Storage Virtual Machine 配置</block>
  <block id="f138253c8e7297962c645362420d9aa2" category="paragraph">使用 SAP HANA 数据库的多个 SAP 环境可以使用一个 SVM 。如果需要，还可以为每个 SAP 环境分配一个 SVM ，以防这些 SVM 由公司内的不同团队管理。</block>
  <block id="ea2e61216b6ebab627ba8bbb11a9ed06" category="paragraph">如果在创建新 SVM 期间自动创建和分配了 QoS 配置文件，请从 SVM 中删除自动创建的配置文件，以提供 SAP HANA 所需的性能：</block>
  <block id="d1a14b5b7465c90ccf63dce24060e194" category="section-title">逻辑接口配置</block>
  <block id="a7546acf86ebe6ec3fca7a6d1722c1c3" category="paragraph">对于 SAP HANA 生产系统，您必须使用不同的 LIF 从 SAP HANA 主机挂载数据卷和日志卷。因此，至少需要两个 LIF 。</block>
  <block id="11b3a97ddf63560e6780cfe906220e5c" category="paragraph">不同 SAP HANA 主机的数据和日志卷挂载可以通过使用相同的 LIF 或为每个挂载使用单独的 LIF 来共享物理存储网络端口。</block>
  <block id="9c5c8b7c01b0aefdbe9a08c959df1a52" category="paragraph">下表显示了每个物理接口的最大数据和日志卷挂载数。</block>
  <block id="bb065ebf8bee13d3c6ea634c4584fc80" category="cell">以太网端口速度</block>
  <block id="0cc5c79089d6ca0752529568758efc4c" category="cell">10GbE</block>
  <block id="dec94f7ee4a8bd795f860764b38b4bfe" category="cell">25GbE</block>
  <block id="d577a779ffdacd409ec756e191be8c6b" category="cell">40GbE</block>
  <block id="797c6d8f4bdab58ccf0409871daa900d" category="cell">100 个地理位置</block>
  <block id="29350e56cf985cc1c3055886a585be16" category="cell">每个物理端口的最大日志或数据卷挂载数</block>
  <block id="c20ad4d76fe97759aa27a0c99bff6710" category="cell">12</block>
  <block id="4f405e1a75e4b7b8ec6f50946f0734fc" category="admonition">在不同 SAP HANA 主机之间共享一个 LIF 可能需要将数据或日志卷重新挂载到其他 LIF 。如果将卷移动到其他存储控制器，此更改可避免性能降低。</block>
  <block id="ea4399c89609128e15e361a718a71f5a" category="paragraph">开发和测试系统可以在物理网络接口上使用更多的数据和卷挂载或 LIF 。</block>
  <block id="93dc7819b20008ad7611ec3405b515ef" category="paragraph">对于生产，开发和测试系统， ` /ha/shared` 文件系统可以使用与数据或日志卷相同的 LIF 。</block>
  <block id="6fb40a9890e4f86fa48bd658ab16833b" category="paragraph">下图显示了四个单主机 SAP HANA 系统的卷配置。每个 SAP HANA 系统的数据卷和日志卷会分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID1_data_mnt00001` ，在控制器 B 上配置了卷 `SID1_log_mnt00001`</block>
  <block id="7ba23b870b3412fc76e2335500441f60" category="admonition">如果 SAP HANA 系统仅使用 HA 对中的一个存储控制器，则数据和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="39d162ac72e2fe9f7198155ac712dbc1" category="admonition">如果数据卷和日志卷存储在同一控制器上，则必须使用两个不同的 LIF 从服务器访问存储：一个 LIF 用于访问数据卷，一个 LIF 用于访问日志卷。</block>
  <block id="073ab5784fc6b184fe0dffe3c4a47dd9" category="paragraph">对于每个 SAP HANA DB 主机，都会为 ` 或 HANA 或 Shared` 配置一个数据卷，一个日志卷和一个卷。下表显示了单主机 SAP HANA 系统的配置示例。</block>
  <block id="bec4d7ba62d8818495dd8047fe16febc" category="cell">系统 SID1 的数据，日志和共享卷</block>
  <block id="3ff612b88bbeb6483579591b4b16a8c2" category="cell">数据卷： SID1_data_mnt00001</block>
  <block id="f32db5be1eba03edf6b74cb2c307a926" category="cell">共享卷： sid1_shared</block>
  <block id="e27dc2a68e5af6cb931b3784bf308897" category="cell">日志卷： SID1_LOG_mnt00001</block>
  <block id="bbe315bb9712be033b109b8cc20809c7" category="cell">系统 SID2 的数据，日志和共享卷</block>
  <block id="3b8347a425c00d6aaef68430847885d8" category="cell">日志卷： SID2_LOG_mnt00001</block>
  <block id="d655f9e8f5e3c0ab2d138ad9ceb5b0a4" category="cell">数据卷： SID2_data_mnt00001</block>
  <block id="383766abb3257650122592338d6ddfe8" category="cell">共享卷： sid2_shared</block>
  <block id="a8c9456b945dda42b7cb811cdeeeb569" category="cell">系统 SID3 的数据，日志和共享卷</block>
  <block id="7f2a7203636ecb8154977fbc4165ad52" category="cell">共享卷： sID3_shared</block>
  <block id="75bc4903743cacb7ec299172f9a7a923" category="cell">数据卷： SID3_data_mnt00001</block>
  <block id="ac9f0ccc380a2cf30aca6416dca9dc26" category="cell">日志卷： SID3_LOG_mnt00001</block>
  <block id="e415aa3c6982d40c43978fa59557a7af" category="cell">系统 SID4 的数据，日志和共享卷</block>
  <block id="5572f58fe3ff25e3eb168eea2fc37e6b" category="cell">日志卷： SID4_LOG_mnt00001</block>
  <block id="5e45398818752a3a8c885762ddfc9916" category="cell">共享卷： SID4_shared</block>
  <block id="5541ec8e99b4baa58cb2afaed5fc63bf" category="cell">数据卷： SID4_data_mnt00001</block>
  <block id="57d26add59c4bcc2f219b2d2e8666bd7" category="paragraph">下表显示了单主机系统的挂载点配置示例。要将 `sidadm` 用户的主目录放在中央存储上，应从 `SID_shared` 卷挂载 ` us/sap/SID` 文件系统。</block>
  <block id="2b20636173a684fa0d66246f2351348f" category="cell">Junction path</block>
  <block id="139518e6703ff17871be2e881429d302" category="section-title">SAP HANA 多主机系统的卷配置</block>
  <block id="f7122248eb9bb754dcbae085218e1595" category="paragraph">下图显示了 4+1 SAP HANA 系统的卷配置。每个 SAP HANA 主机的数据卷和日志卷分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID1_data1_mnt00001` ，在控制器 B 上配置了卷 `SID1_log1_mnt00001`</block>
  <block id="85c5636d02be1f0b907841ad58213447" category="admonition">如果 SAP HANA 系统仅使用 HA 对的一个存储控制器，则数据和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="d75f982c7fa083a511e12080e3a4cfd5" category="admonition">如果数据卷和日志卷存储在同一控制器上，则必须使用两个不同的 LIF 从服务器访问存储：一个用于访问数据卷，一个用于访问日志卷。</block>
  <block id="3aaed26996523c93d5f3f1362bf3a698" category="paragraph">对于每个 SAP HANA 主机，系统会创建一个数据卷和一个日志卷。` HANA 系统的所有主机都使用` /hana / 共享 卷。下表显示了具有四个活动主机的多主机 SAP HANA 系统的配置示例。</block>
  <block id="e1b0e513c8bb3fb181664dfb11823d82" category="paragraph">下表显示了具有四个活动 SAP HANA 主机的多主机系统的配置和挂载点。要将每个主机的 `sidadm` 用户的主目录放置在中央存储上，会从 `SID_shared` 卷挂载 ` us/sap/SID` 文件系统。</block>
  <block id="8afc05cfcca59bdc514fcb80e6c0d949" category="cell">/ha/shared/</block>
  <block id="66cbf41a87a685e6ad37ed18e6f61f06" category="section-title">卷选项</block>
  <block id="6e52e9b5049ecde797509957559efadd" category="paragraph">您必须在所有 SVM 上验证并设置下表中列出的卷选项。对于某些命令，您必须在 ONTAP 中切换到高级权限模式。</block>
  <block id="004bf6c9a40003140292e97330236c53" category="cell">Action</block>
  <block id="ee97be03cb04119af45014d815621ce1" category="cell">命令</block>
  <block id="59dafe6ffe356573f4a59e43b8c2a12d" category="cell">禁用 Snapshot 目录可见性</block>
  <block id="bfcee32efb1a622a6e587e6e46aabb35" category="cell">vol modify -vserver &lt;vserver-name&gt; -volume &lt;volname&gt; -snapdir-access false</block>
  <block id="d9802677b2dd550f4d0177de99399b0d" category="cell">禁用自动 Snapshot 副本</block>
  <block id="bba4f772e426d2e1201535827315e250" category="cell">vol modify – vserver &lt;vserver-name&gt; -volume &lt;volname&gt; -snapshot-policy none</block>
  <block id="85314edd158f5145de1023ea7992a73d" category="cell">禁用除 SID_shared 卷以外的访问时间更新</block>
  <block id="d06aa9b498f490322d6b75ab763868c4" category="paragraph">设置高级 vol modify -vserver &lt;vserver-name&gt; -volume &lt;volname&gt; -atime-update false set admin</block>
  <block id="69b5be9d0ad62cad1fe29832746d89fc" category="paragraph">下表中列出的 NFS 选项必须在所有存储控制器上进行验证和设置。</block>
  <block id="7b0c54ca1e88f6ef7461709ba20843e4" category="paragraph">对于所示的某些命令，您必须在 ONTAP 中切换到高级权限模式。</block>
  <block id="d696a6a2b32bd5b7e510d3c088fce207" category="cell">启用 NFSv3 ：</block>
  <block id="d9a7640ac46e3f8cf9816a8ab8caaabb" category="cell">NFS modify -vserver &lt;vserver-name&gt; v3.0 已启用</block>
  <block id="88a84b59bbf7c31014bc6e5332d54d69" category="paragraph">设置 advanced nfs modify -vserver &lt;vserver_name&gt; -tcp-max-xfer-size 1048576 set admin</block>
  <block id="4b3b3fba259d5ac2ca622fa9160b1fb5" category="section-title">NFSv4 的 NFS 配置</block>
  <block id="c8542833574cfec9920af77661a766e0" category="paragraph">下表中列出的 NFS 选项必须在所有 SVM 上进行验证和设置。</block>
  <block id="214d7b06b7a82576ad3cc8dda3a23b58" category="paragraph">对于某些命令，您必须在 ONTAP 中切换到高级权限模式。</block>
  <block id="70f982c83fe296db3a8fc01d6800eeb5" category="cell">启用 NFSv4 ：</block>
  <block id="b4a26338e6b2855edb75ec84606be72f" category="cell">NFS modify -vserver &lt;vserver-name&gt; -v4.1 已启用</block>
  <block id="ddf50f4def54fc42e1e3c48d60dc6360" category="cell">禁用 NFSv4 访问控制列表（ ACL ）</block>
  <block id="77fd2d8c2c348207e3e8aa8833c161c4" category="cell">nfs modify -vserver &lt;vserver_name&gt; -v4.1-acl 已禁用</block>
  <block id="75a14711dc56291ed980640b0097eeda" category="cell">设置 NFSv4 域 ID</block>
  <block id="33f975af5bcb6d72979c2b52e31d0a40" category="cell">nfs modify -vserver &lt;vserver_name&gt; -v4-id-domain &lt;domain-name&gt;</block>
  <block id="098bb5f97d963ff34a01a7b3ceb37e49" category="cell">禁用 NFSv4 读取委派</block>
  <block id="a7a4297edce035892ff20e78720f0828" category="cell">nfs modify -vserver &lt;vserver_name&gt; -v4.1-read-delegation disabled</block>
  <block id="67b5b0ca237f222e8fc13c6b113fed2f" category="cell">禁用 NFSv4 写入委派</block>
  <block id="7654c857db3169792d3c5833ad28cd37" category="cell">NFS modify -vserver &lt;vserver_name&gt; -v4.1-write-delegation 已禁用</block>
  <block id="ffea0284d7bfb3aad7e0d7a07765b424" category="cell">禁用 NFSv4 数字 ID</block>
  <block id="96adb5308418a0e6a16e78f391a5725d" category="cell">nfs modify -vserver &lt;vserver_name&gt; -v4-numeric-id 已禁用</block>
  <block id="4a762e476d9eda379d2de2de4266fb64" category="inline-link-macro">NFSv4 的 SAP HANA 安装准备。</block>
  <block id="ad357b093f7cd3e6d382bfe20cd1f2bd" category="admonition">在所有 Linux 服务器（ /`etc/idmapd.conf` ）和 SVM 上，必须将 NFSv4 域 ID 设置为相同的值，如中所述 <block ref="7cbf1992917906c8f8c329ad679d4886" category="inline-link-macro-rx"></block></block>
  <block id="58c8eee50f8f52237271f796e3c1123f" category="cell">部分 nameserver.ini</block>
  <block id="3ad6e9988864aeae2ef386345946dc6d" category="cell">故障转移</block>
  <block id="af175fe1a76f8f5124de60f5d01ca78b" category="cell">normal 重试</block>
  <block id="19d4f3d1b35d2e82f1cec6bde8a752c8" category="cell">Distributed watchdog</block>
  <block id="2a81c8748d4d99f78d015104c26e9e58" category="cell">deactivation_retries</block>
  <block id="6512bd43d9caa6e02c990b0a82652dca" category="cell">11.</block>
  <block id="e83d9d66a13e5beb6fcd73e9458bd812" category="cell">takeover_retries</block>
  <block id="8b59115254ff7312d8a47a3558d2ef5a" category="section-title">将卷挂载到命名空间并设置导出策略</block>
  <block id="118d2a12d0ab217e6a53a464692c141a" category="paragraph">创建卷时，必须将卷挂载到命名空间。在本文档中，我们假定接合路径名称与卷名称相同。默认情况下，使用默认策略导出卷。如果需要，可以调整导出策略。</block>
  <block id="5a8b82a0bfb2e7625d351720d4376bdf" category="summary">只有具有故障转移功能的多主机环境才需要存储连接器。在多主机设置中， SAP HANA 可提供高可用性功能，以便 SAP HANA 数据库主机可以故障转移到备用主机。在这种情况下，备用主机将访问并使用故障主机的 LUN 。</block>
  <block id="cfb64066e9063f57ad27ccf9e4e06e87" category="doc">SAP HANA 存储连接器 API</block>
  <block id="143f136fe7528a58d8f5256ccaa89109" category="paragraph">只有具有故障转移功能的多主机环境才需要存储连接器。在多主机设置中， SAP HANA 可提供高可用性功能，以便 SAP HANA 数据库主机可以故障转移到备用主机。在这种情况下，备用主机将访问并使用故障主机的 LUN 。存储连接器用于确保一次只能由一个数据库主机主动访问存储分区。</block>
  <block id="89814b29e88510280af62ae60925b251" category="inline-link">SAP 注释 1900823</block>
  <block id="e078b828a6bb770866173121ebdf49eb" category="paragraph">在采用 NetApp 存储的 SAP HANA 多主机配置中，使用 SAP 提供的标准存储连接器。《 SAP HANA 光纤通道存储连接器管理指南》可作为的附件找到<block ref="fb03c315acf5bdf850546480c01e7306" category="inline-link-rx"></block>。</block>
  <block id="42adc1bfcd3235fac4ff951f70ecd835" category="paragraph">您必须同步存储控制器与 SAP HANA 数据库主机之间的时间。为此，请为所有存储控制器和所有 SAP HANA 主机设置相同的时间服务器。</block>
  <block id="e91f856fa9e93a1406d354f1fb9df553" category="summary">本节所述的所有步骤对物理服务器上的 SAP HANA 环境和在 VMware vSphere 上运行的 SAP HANA 均有效。</block>
  <block id="ec222a30e1c5681ed56787b00bda2116" category="section-title">SUSE Linux Enterprise Server 的配置参数</block>
  <block id="8740018c375cf2d0f4d463d0bbd4d8d4" category="paragraph">必须根据 SAP HANA 生成的工作负载调整每个 SAP HANA 主机上的其他内核和配置参数。</block>
  <block id="efcd9df071a570f7c5ed3559b172bce3" category="section-title">SUSE Linux Enterprise Server 12 和 15</block>
  <block id="ebb8355d8accfb697b6808ce518c8666" category="paragraph">从 SUSE Linux Enterprise Server （ SLES ） 12 SP1 开始，必须在 ` /etc/sysctl.d` 目录的配置文件中设置内核参数。例如，必须创建一个名为 `91-netapp-hana` 的配置文件。</block>
  <block id="68d9ac2d7e973e347e878b223355bf31" category="inline-link">SAP 注释 3024346</block>
  <block id="82740b25df395d68a79118ebc5c4da80" category="section-title">适用于 Red Hat Enterprise Linux 7.2 或更高版本的配置参数</block>
  <block id="c2e770dd6d768668395e4b8d3b9291d1" category="paragraph">从 Red Hat Enterprise Linux 7.2 开始，您必须在 ` /etc/sysctl.d` 目录的配置文件中设置内核参数。例如，必须创建一个名为 `91-netapp-hana` 的配置文件。</block>
  <block id="4142bd640477d1c4292c7fcbb3bb1f57" category="section-title">在 /has/ 共享卷中创建子目录</block>
  <block id="67435e0588f5cb039a7fb0f4578e90a7" category="admonition">这些示例显示了一个 SID=NF2 的 SAP HANA 数据库。</block>
  <block id="73534bc746cc8b23b1e96428d64fb98d" category="paragraph">要创建所需的子目录，请执行以下操作之一：</block>
  <block id="4dedcda7bf51022c092ff39d3a6d5686" category="list-text">对于多主机系统，请挂载 ` /ha/shared` 卷，然后为每个主机创建 `shared` 和 `usr-sap` 子目录。</block>
  <block id="d434026f127f46b1327fb139872c6f31" category="list-text">对于多主机系统，创建挂载点并在所有工作主机和备用主机上设置权限。</block>
  <block id="456f14e4dccd61c74e863ee833a9ca13" category="paragraph">以下示例命令适用于 2+1 多主机 HANA 系统。</block>
  <block id="436b2f88b88434a5965be45b319737cd" category="paragraph">根据 NFS 版本和 ONTAP 版本，必须使用不同的挂载选项。必须将以下文件系统挂载到主机：</block>
  <block id="2f44a4485ee99d4db07e6c780160d663" category="list-text">` /ha/data/SID/mnt0000*`</block>
  <block id="cbc27a44a01f5f9f44192601795600d7" category="list-text">` /ha/log/SID/mnt0000*`</block>
  <block id="e7152fc8e9f9294e574fc844aa9126ef" category="list-text">` /hana / 共享`</block>
  <block id="8b82ac8f276252de930b321606714ed5" category="list-text">` usr/sap/SID`</block>
  <block id="a73f318e7c68296dbc2c1fc7dc495dc8" category="paragraph">下表显示了单主机和多主机 SAP HANA 数据库的不同文件系统必须使用的 NFS 版本。</block>
  <block id="3b18b13f059019d19211f8a9f36f7e4e" category="cell">文件系统</block>
  <block id="c5a3e92c7aeb0572333d41454f2c2695" category="cell">SAP HANA 单台主机</block>
  <block id="6cfacba9e34e52124b1a2bcc7c4645a3" category="cell">SAP HANA 多台主机</block>
  <block id="9fdd313c432a6ee693f5c8f5cc8fdf3c" category="cell">/ha/data/sid/mnt0000*</block>
  <block id="a3fc88f53929bc60dc3ca6c7a4b19b35" category="cell">NFSv3 或 NFSv4</block>
  <block id="08e90903fe145a9dcc2fb967259a1755" category="cell">NFSv4</block>
  <block id="8f6fb4f6458a23be27986bb84613b874" category="cell">/ha/log/sid/mnt0000*</block>
  <block id="b61595b5b7b716bd6b8bd21e4fa4a3bf" category="cell">/has/ 共享</block>
  <block id="1f34f4f6ae42ad0e5ccc8d8a4399150c" category="paragraph">下表显示了各种 NFS 版本和 ONTAP 版本的挂载选项。通用参数与 NFS 和 ONTAP 版本无关。</block>
  <block id="b79b53eefbb492c96c4e5c552596db5a" category="admonition">SAP Lama 要求 /usr/sap/SID 目录为本地目录。因此，如果使用的是 SAP Lama ，请勿挂载 /usr/sap/SID 的 NFS 卷。</block>
  <block id="cd5a202e71fd003517be23ed41f89f8d" category="paragraph">对于 NFSv3 ，您必须关闭 NFS 锁定，以避免在软件或服务器出现故障时执行 NFS 锁定清理操作。</block>
  <block id="93827363c57822e58dfbd5f05b9beac8" category="paragraph">使用 ONTAP 9 ， NFS 传输大小最多可配置为 1 MB 。具体而言，如果与存储系统建立 40GbE 或更快的连接，则必须将传输大小设置为 1 MB ，才能达到预期吞吐量值。</block>
  <block id="6f5e55da455474f8c585cb463a2d639e" category="cell">通用参数</block>
  <block id="5b12ee0369243579651edca43ff65c85" category="cell">NFSv3</block>
  <block id="0614a261ce2e53d5987e97a60496a434" category="cell">ONTAP 9 中的 NFS 传输大小</block>
  <block id="54b941646e65c3622af659cd9d965169" category="cell">使用 ONTAP 8 时的 NFS 传输大小</block>
  <block id="1017e4c4798ba77b88c85f3b8c6fdf03" category="cell">rw ， bg ， hard ， timeo=600 ， noatime ，</block>
  <block id="7d7894f31c9b83146d2bc22185ed5db0" category="cell">rsize=65536 ， wsize=65536 ，</block>
  <block id="ae2c578e6abfee06e6c468fd4e7cb392" category="paragraph">要在系统启动期间使用 ` /etc/fstab` 配置文件挂载文件系统，请完成以下步骤：</block>
  <block id="f731bd3074578aba0a3c1b5ab0ca78ee" category="list-text">将所需的文件系统添加到 ` /etc/fstab` 配置文件中。</block>
  <block id="aff8bbab4f16423ec5907aed644aead6" category="list-text">运行 `mount – a` 在所有主机上挂载文件系统。</block>
  <block id="2555851d01cabd281a371497bed0a9a9" category="list-text">将所需的文件系统添加到所有主机上的 ` /etc/fstab` 配置文件中。</block>
  <block id="019dc6de8e76037cb2c701eebcc7885a" category="summary">要了解有关本文档中所述信息的更多信息，请参见以下文档和 / 或网站。</block>
  <block id="e34a4f0f85c6affc800c8d9647e17923" category="summary">本节介绍如何配置系统，以便在单主机和多主机系统上安装 SAP HANA 软件。</block>
  <block id="22b91f6553e0cbb7685f9eb877cf188d" category="section-title">在单主机系统上安装</block>
  <block id="8e74883ab7ca2d81b61cfaad2ddf19d2" category="section-title">在多主机系统上安装</block>
  <block id="2c5a7a5ceaf9ad774a81a7201b4dd250" category="paragraph">要在多主机系统上安装 SAP HANA ，请完成以下步骤：</block>
  <block id="ae2868fd55605b6107ba93c6890a3b53" category="summary">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 IO 行为并针对所使用的文件和存储系统优化数据库。</block>
  <block id="1bd81531313378d0d4283de4cbbc35d1" category="doc">SAP HANA 的 I/O 堆栈配置</block>
  <block id="67844e82ab322c50575db48293bd0359" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所使用的文件和存储系统优化数据库。</block>
  <block id="26ab8f65129b11e214b8281e8c3aaa83" category="paragraph">NetApp 进行了性能测试以定义理想值。下表列出了从性能测试中推断的最佳值。</block>
  <block id="1274865f8edcaa13006383f553d00582" category="inline-link">2267798 ：使用 hdbparam 在安装期间配置 SAP HANA 数据库</block>
  <block id="8fc6942b9d902fde53ed01fa7625aae8" category="paragraph">对于 SPS12 之前的 SAP HANA 1.0 版本，可以在安装 SAP HANA 数据库期间设置这些参数，如 SAP 注释所述<block ref="2b0fd22ead842cf1665d70f8909d17e2" category="inline-link-rx"></block>。</block>
  <block id="4e0f8b3ee102e5b52cc383fd8b0d90f9" category="paragraph">或者，也可以在安装 SAP HANA 数据库后使用 `hdbparam` framework 设置这些参数。</block>
  <block id="ec8a4b40a7d633a3cf77ecd95d9d5df1" category="inline-link">2399079 ：在 HANA 2 中消除了 hdbparam</block>
  <block id="834a8b3050b2226b4812fb49026571b3" category="paragraph">从 SAP HANA 2.0 开始， `hdbparam` 已弃用，并且参数已移至 `global.ini` 。可以使用 SQL 命令或 SAP HANA Studio 设置这些参数。有关详细信息，请参见 SAP 注释<block ref="6af86c07e5a30516e9705c5fc7252793" category="inline-link-rx"></block>。您还可以在 global.ini 中设置参数，如以下文本所示：</block>
  <block id="31835039a339b5b0f4d95c207e26b5e3" category="paragraph">自 `sHANA 2.0 SPS5 以来，可以使用 v í` etParameter.py 脚本设置正确的参数：</block>
  <block id="482a7b20dc0168fcd798c01f92ff4f90" category="summary">文档还包含有关特定于所用 Linux 版本的多路径配置的信息。</block>
  <block id="f1b2831b8f22303f2f43d48d0f147f3a" category="paragraph">在设置主机之前，必须从下载 NetApp SAN Host Utilities<block ref="1a36b59ecae7684863b79a0f690b6840" category="inline-link-rx"></block> 站点和安装在 HANA 服务器上。Host Utility 文档提供了有关根据使用的 FCP HBA 而必须安装的其他软件的信息。</block>
  <block id="e077bd74583341fa1e17ee8fc0b5c0b4" category="paragraph">文档还包含有关特定于所用 Linux 版本的多路径配置的信息。本文档介绍了 SLES 15 和 Red Hat Enterprise Linux 7.6 或更高版本所需的配置步骤，如中所述<block ref="c4b23c8c60f3faad406f8d46d87ba646" category="inline-link-rx"></block>。</block>
  <block id="4d8b576322bf7d5677701855a54e6977" category="admonition">必须对 SAP HANA 多主机配置中的所有辅助主机和备用主机执行步骤 1 到 6 。</block>
  <block id="f0e0bdbc42c37dae577b18eb8dbd1386" category="list-text">运行 `sanlun lun show` 命令并验证所有必需的 LUN 是否可见。以下示例显示了对于具有两个数据 LUN 和两个日志 LUN 的 2+1 多主机 HANA 系统的 `sanlun lun show` 命令输出。输出将显示 LUN 和相应的设备文件，例如 LUN `SS3_data_mnt00001` 和设备文件 ` /dev/sdag` 。每个 LUN 都有八条从主机到存储控制器的 FC 路径。</block>
  <block id="26414ff85e6b93c3631085373a3c9e8c" category="list-text">运行 `multipath -r` 命令以获取设备文件名的全球通用标识符（ WWID ）：</block>
  <block id="22ab51ff386eeec071034ae781990962" category="admonition">示例输出显示了 ` /etc/multipath.conf` 文件的内容，其中包括 2+1 多主机系统中四个 LUN 的别名。如果没有可用的 `multipath.conf` 文件，则可以运行以下命令创建一个： `multipath -T &gt; /etc/multipath.conf` 。</block>
  <block id="1b95bd550160c56e99e04b6458dfcf6a" category="paragraph">只有在使用 LVM 时才需要执行此步骤。以下示例适用于使用 SID FC5 的 2+1 主机设置。</block>
  <block id="ad08495729cc8eaf90d420ef1e6f12b4" category="list-text">为每个数据和日志分区创建一个逻辑卷。使用的条带大小等于每个卷组使用的 LUN 数量（示例 2 ），数据条带大小为 256k ，日志条带大小为 64k 。SAP 仅支持每个卷组一个逻辑卷。</block>
  <block id="5c5bd50a3cfa405915bc6892659042ce" category="admonition">如果上述命令未找到卷，则需要重新启动。</block>
  <block id="4d65ef8cf84d37cbb99560183afc8431" category="list-text">执行以下操作之一：</block>
  <block id="c9b9bdcff428106a20521627c72baa32" category="admonition">必须使用 `relatime` 和 `inode64` 挂载选项挂载数据和日志 LUN 的 XFS 文件系统。</block>
  <block id="ff3f1e894014f4c26eac8cab49b8a0f4" category="doc">使用 VMware vSphere 的 SAP HANA</block>
  <block id="e6bbcb3e4d889de6d1cf73dee0f9eac9" category="inline-link-macro">基于采用 NFS 的 NetApp AFF 系统的 SAP HANA</block>
  <block id="c96bf665650aa48ececa7a9b878579a4" category="paragraph">此外，还支持原始设备映射（ RDM ）， FCP 数据存储库或具有 FCP 的 VVol 数据存储库。对于这两个数据存储库选项，数据存储库中只能存储一个 SAP HANA 数据或日志卷，以便在高效使用情形下使用。此外，无法实施由 SnapCenter 和基于此的解决方案协调的基于 Snapshot 的备份和恢复，例如 SAP 系统克隆。</block>
  <block id="5363a1e8e1763bb11c4b91b2868d5584" category="paragraph">有关将 vSphere 与 SAP HANA 结合使用的详细信息，请参见以下链接：</block>
  <block id="f02780ddcfc1bddf0683bf8de02155d5" category="inline-link">基于 VMware vSphere 的 SAP HANA —虚拟化—社区 Wiki</block>
  <block id="a98079dcafc3bc09ff53c1843096b51d" category="paragraph"><block ref="a98079dcafc3bc09ff53c1843096b51d" category="inline-link-rx"></block></block>
  <block id="685faeffbf3c0039314a5071b5798f2c" category="inline-link">在 VMware vSphere 上纵向扩展 SAP HANA 的最佳实践和建议</block>
  <block id="2f9b2abd933de82f868c9111de78674c" category="list-text"><block ref="2f9b2abd933de82f868c9111de78674c" category="inline-link-rx"></block></block>
  <block id="6a3ba410820602029c0289b87ca24a63" category="inline-link">在 VMware vSphere 上横向扩展 SAP HANA 的最佳实践和建议</block>
  <block id="976acfa42022d691038e2ff7dc503713" category="list-text"><block ref="976acfa42022d691038e2ff7dc503713" category="inline-link-rx"></block></block>
  <block id="ab1b1647c4e88f4d70b589d5781012ca" category="inline-link">2161991 — VMware vSphere 配置准则— SAP One Support Launchpad （需要登录）</block>
  <block id="77735103527f028107b29d19df178798" category="list-text"><block ref="77735103527f028107b29d19df178798" category="inline-link-rx"></block></block>
  <block id="37139cc09cc8bc80e9ca73af4d3c785b" category="paragraph">或者，也可以在安装 SAP HANA 数据库后使用 `hdbparam` framework 设置这些参数。</block>
  <block id="ae8838acb9cb389ab57ac7e29427fe50" category="paragraph">从 SAP HANA 2.0 开始， `hdbparam` 已弃用，并且参数已移至 `global.ini` 。可以使用 SQL 命令或 SAP HANA Studio 设置这些参数。有关详细信息，请参见 SAP 注释<block ref="6af86c07e5a30516e9705c5fc7252793" category="inline-link-rx"></block>。这些参数也可以在 global.ini 中进行设置，如下所示：</block>
  <block id="57011fe1859f006c6ec7d602edb7a5a4" category="paragraph">从 SAP HANA 2.0 SPS5 开始，您可以使用 `setParameter.py` 脚本设置正确的参数：</block>
  <block id="fef2c24f71a084e813005b395f827515" category="paragraph">在 SSD 配置中， SAP HANA 支持实时重复数据删除，跨卷实时重复数据删除，实时压缩和实时数据缩减。</block>
  <block id="8bc14f0cb78851f59e85c1d447c2c99f" category="section-title">Quality of service</block>
  <block id="37464f39e18200cea48c4d9c6761a91b" category="paragraph">在规模估算过程中，您应确定非生产系统的性能要求。开发和测试系统的规模可以采用较低的性能值进行调整，通常在 SAP 定义的生产系统 KPI 的 20% 到 50% 范围内。</block>
  <block id="67a6bbb8d3e29659ce53d34fa70d088f" category="paragraph">可以使用 " 仅快照 " 分层策略，也可以在 NetApp SnapVault 或 SnapMirror 目标等备份目标上使用 FabricPool 。</block>
  <block id="cbafb452655573815d095edb344c9594" category="admonition">使用 FabricPool 在主存储上分层 Snapshot 副本或在备份目标上使用 FabricPool 会更改还原和恢复数据库或执行其他任务（例如创建系统克隆或修复系统）所需的时间。在规划整体生命周期管理策略时，请考虑此因素，并检查以确保在使用此功能时仍符合 SLA 。</block>
  <block id="390af04511c942a81559a2b17fca6eb5" category="list-text">按照中所述检查正确的磁盘架配置 "<block ref="039cb3f1d3f19b24b2d3e1a57595e88d" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="e138f99dc0c2e735649f097e067d3c91" category="list-text">按照中所述创建和配置所需的聚合 "<block ref="19f0aba2b822910f53ba3966ee7c8d59" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="71f431043ca74922b294e83922284844" category="list-text">创建 Storage Virtual Machine （ SVM ），如 "<block ref="9943aaa2798622d6311d148886b936da" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="6daaa42b583f68f6a1719fe98bb43ec6" category="list-text">按照中所述创建 LIF"<block ref="023ebc077eb941ef66f2a9b14dc7710e" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="4871e71c94c222ec35408f3579ea5aef" category="list-text">按照中所述设置所需的卷选项 "<block ref="8045d57af453a5d82abf825155790be5" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="50382f37b1d5817b19a1416d66a869ab" category="list-text">按照中所述为 NFSv3 设置所需的选项 "<block ref="12f4a1429ee236ba2b69187511d66e29" category="inline-xref-macro-rx"></block>" 或 NFSv4 ，如 "<block ref="446c862a0c96e5df798af38fe615a410" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="77e8c1a1e836e9cc2d6f7071ed8ff48b" category="list-text">将卷挂载到命名空间并设置导出策略，如 "<block ref="11ce1c973ef514d254ac6cb22131e75f" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="625393be624ef9b6c1788fc2acdc4a1f" category="section-title">SAS 磁盘架</block>
  <block id="9b62b24b8d9ba375e94ccacca94fc52d" category="paragraph">最多可以将一个磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。ADPv2 可用于 ONTAP 9 和 DS224C 磁盘架。</block>
  <block id="03ec21b0d762028e928e8b7603d1b5a0" category="admonition">对于 DS224C 磁盘架，也可以使用四路径 SAS 布线，但这并不是必需的。</block>
  <block id="bdf2df4b25ef7731104da665fef6a0bc" category="section-title">NVMe （ 100GbE ）磁盘架</block>
  <block id="c95631e026846b434e73e4f8b624c435" category="paragraph">每个 NS224 NVMe 磁盘架使用每个控制器的两个 100GbE 端口进行连接。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。聚合配置一章中所述的 ADPv2 也用于 NS224 磁盘架。下图显示了磁盘架与 NVMe 驱动器的连接。</block>
  <block id="f1c8039bfd9034e917c3ee25c37b6e80" category="paragraph">下图显示了在配置了 ADPv2 的 12 Gb SAS 磁盘架上运行的 12 个 SAP HANA 主机的配置。每个存储控制器连接六个 SAP HANA 主机。配置了四个单独的聚合，每个存储控制器两个。每个聚合都配置有 11 个磁盘，其中包含九个数据分区和两个奇偶校验磁盘分区。每个控制器都有两个备用分区。</block>
  <block id="99897c39b8224cf5a25fe9c6f599b3a7" category="section-title">SVM 配置</block>
  <block id="b37f183111116179ae8b8190b10de385" category="paragraph">使用 SAP HANA 数据库的多个 SAP 环境可以使用一个 SVM 。如果需要，还可以为每个 SAP 环境分配一个 SVM ，以防这些 SVM 由公司内的不同团队管理。</block>
  <block id="8740ae6e0d37fe62c3e22cc10d6808f0" category="paragraph">如果在创建新的 SVM 时自动创建和分配了 QoS 配置文件，请从 SVM 中删除此自动创建的配置文件，以便为 SAP HANA 启用所需的性能：</block>
  <block id="cb001cd493365720d42ec425b1721062" category="section-title">LIF 配置</block>
  <block id="0b2bb5856cc4dea0b040a3b21fd8dd64" category="paragraph">对于 SAP HANA 生产系统，您必须使用不同的 LIF 从 SAP HANA 主机挂载数据卷和日志卷。因此，至少需要两个 LIF 。</block>
  <block id="960aa85c03f033763848fa3aa9fe340a" category="paragraph">不同 SAP HANA 主机的数据和日志卷挂载可以通过使用相同的 LIF 或为每个挂载使用单独的 LIF 来共享物理存储网络端口。</block>
  <block id="5722c99f4a5680ae1ee34f95cc81e80c" category="paragraph">下表显示了每个物理接口的最大数据和日志卷装载量。</block>
  <block id="36913193033e347ca8ec536cf018744d" category="admonition">如果数据卷和日志卷存储在同一控制器上，则必须使用两个不同的 LIF 从服务器访问存储：一个 LIF 用于访问数据卷，另一个 LIF 用于访问日志卷。</block>
  <block id="34a9cf7a71d5de61eb0516df58caeb4d" category="paragraph">对于每个 SAP HANA 主机，都会为 ` 或 HANA 或 Shared` 配置一个数据卷，一个日志卷和一个卷。下表显示了单主机 SAP HANA 系统的配置示例。</block>
  <block id="7a2dcccea93b2a3993b37840c369bf46" category="cell">/usr/sap/SID /has/shared/</block>
  <block id="08ddf4f39e81c4a0e663d6db2274b8d0" category="cell">控制器 A 上的聚合 1</block>
  <block id="4991d6ed5c177c09528f1b08e62e870b" category="cell">控制器 A 上的聚合 2</block>
  <block id="70ea877d22047c4d7b3160f2dfbb602e" category="cell">控制器 B 上的聚合 1</block>
  <block id="b01794ad3843a1780c443788733b44ac" category="cell">控制器 B 上的聚合 2</block>
  <block id="edf427eb9e76414a3f84589e9f2ecf37" category="paragraph">下表显示了具有四个活动 SAP HANA 主机的多主机系统的配置和挂载点。要将每个主机的 `sidadm` 用户的主目录放置在中央存储上，会从 `SID_shared` 卷挂载 ` us/sap/SID` 文件系统。</block>
  <block id="6c973aa519b6f8499c2dc9a71251b4f7" category="cell">禁用访问时间更新， SID_shared 卷除外</block>
  <block id="8ec2236fd6ed4715167a8899b66d149b" category="paragraph">下表中列出的 NFS 选项必须在所有存储控制器上进行验证和设置。对于此表中显示的某些命令，您必须切换到高级权限模式。</block>
  <block id="5c87e78153c1f2e2e2b534049bdc60f9" category="paragraph">对于此表中的某些命令，您必须切换到高级权限模式。</block>
  <block id="b78ad1fd79e9fc7773f87edda4742199" category="cell">NFS modify -vserver &lt;vserver-name&gt; -v4.1 已启用</block>
  <block id="c480c17814d28d6a9b00fd06a87dee2a" category="inline-link-macro">《 NFSv4 的 SAP HANA 安装准备工作》。</block>
  <block id="9fa840f16cd7cf7f80145507faa2a523" category="admonition">在所有 Linux 服务器（` /etc/idmapd.conf` ）和 SVM 上，必须将 NFSv4 域 ID 设置为相同的值，如一节所述 <block ref="19618adae76246007b68ca646cc14e2b" category="inline-link-macro-rx"></block></block>
  <block id="f337a835d86e0c289439e035a0e76f48" category="cell">更新了容量规模估算更新了 ` /ha/shared` 更新了 sysctl 参数的挂载选项</block>
  <block id="bc879b28cd3f4053f1a4fb6a09b4059b" category="cell">新的 NetApp 存储系统和磁盘架 ONTAP 9 的新增功能支持 40GbE 新操作系统版本（ SUSE Linux Enterprise Server 12 SP1 和 Red Hat Enterprise Linux 7.2 ）新的 SAP HANA 版本</block>
  <block id="fec3e19d5453902e6d2d2f07b445096e" category="cell">新 NetApp 存储系统支持 100GbE 新操作系统版本（ SUSE Linux Enterprise Server 12 SP3 和 Red Hat Enterprise Linux 7.4 ） SAP HANA 2.0 SPS3 的其他小更改</block>
  <block id="e10986a4d8d7c27e4a9031d551cb15f3" category="cell">2019年10月</block>
  <block id="42cb7cd8194fc37a66ecbcf38853bc47" category="cell">新的 NetApp 存储系统和 NVMe 磁盘架新的操作系统版本（ SUSE Linux Enterprise Server 12 SP4 ， SUSE Linux Enterprise Server 15 和 Red Hat Enterprise Linux 7.6 ） MAX Data 卷大小略有更改</block>
  <block id="4a93378c0090bfbf8b8bc50a06815950" category="cell">支持 NFSv3 新操作系统版本 Red Hat Enterprise Linux 8 的 nconnect</block>
  <block id="10ac19f67b5c625d18963e0639db41ec" category="cell">版本 3.4</block>
  <block id="1f8f179d086bf23bb88de92da36a278f" category="cell">支持 SAP HANA 2.0 SPS4 提供多个数据卷分区</block>
  <block id="27cf29d3ba2e543cc0a860ffea48422c" category="cell">版本 3.5</block>
  <block id="26287cafb4ea7add00d9de270496dd80" category="paragraph">SAP HANA 主机使用冗余 FCP 基础架构和多路径软件连接到存储控制器。如果交换机或主机总线适配器（ HBA ）发生故障，则需要一个冗余 FCP 交换机基础架构来提供容错 SAP HANA 主机到存储连接。必须在交换机上配置适当的分区，以使所有 HANA 主机能够访问存储控制器上所需的 LUN 。</block>
  <block id="017a3133a467238fee42563e68a614f9" category="paragraph">AFF 系统产品系列的不同型号可以在存储层混用并匹配，以满足增长以及不同的性能和容量需求。可以连接到存储系统的最大 SAP HANA 主机数由 SAP HANA 性能要求和所用 NetApp 控制器型号定义。所需磁盘架的数量仅取决于 SAP HANA 系统的容量和性能要求。</block>
  <block id="06cf62788076915ae55f580212c2bf1e" category="paragraph">下图显示了一个配置示例，其中八个 SAP HANA 主机连接到一个存储 HA 对。</block>
  <block id="2900e6adf5856ac968de15d89cb194b9" category="paragraph">此架构可扩展到两个方面：</block>
  <block id="d4a057bb51f816211a65deedffe4b054" category="list-text">如果存储控制器提供的性能足以满足当前的 SAP HANA KPI 要求，请将更多的 SAP HANA 主机和存储容量附加到现有存储</block>
  <block id="8ca9a95d490a682ea8d4488876c744a4" category="paragraph">下图显示了一个配置示例，其中，更多 SAP HANA 主机连接到存储控制器。在此示例中，需要更多磁盘架来满足 16 个 SAP HANA 主机的容量和性能要求。根据总吞吐量要求，您必须为存储控制器添加额外的 FC 连接。</block>
  <block id="7ebb858993c6febaa60f7bc7602d20dc" category="paragraph">除了已部署的 AFF 系统之外，还可以通过添加任何经过认证的存储控制器来扩展 SAP HANA 环境，以满足所需的节点密度，如下图所示。</block>
  <block id="3ad7f7aed9ec06eff738c0dcda85c37c" category="summary">从 SAP HANA 2.0 SPS4 开始，可以配置其他数据卷分区。这样，您就可以为 SAP HANA 租户数据库的数据卷配置两个或更多卷，并可扩展到超出单个卷的大小和性能限制。</block>
  <block id="0b3d2dc69d0ecef48ed4d97711abe783" category="admonition">对于 SAP HANA 单主机和 SAP HANA 多主机系统，可以为数据卷使用两个或更多个单独的卷。您可以随时添加其他数据卷分区。</block>
  <block id="13a679c566e6214fe896e24a695761e4" category="paragraph">要启用其他数据卷分区，请使用 SYSTEMDB 配置中的 SAP HANA Studio 或 Cockpit 在 `global.ini` 中添加以下条目。</block>
  <block id="9d32fa1f9d8d59813a1ef11682a4f5bf" category="section-title">单主机 SAP HANA 系统的卷配置</block>
  <block id="517b7c43e6e06ed83a71808ad5423407" category="paragraph">具有多个分区的单主机 SAP HANA 系统的卷布局与具有一个数据卷分区，但另有一个数据卷存储在与日志卷和另一个数据卷不同的聚合上的系统的布局类似。下表显示了具有两个数据卷分区的 SAP HANA 单主机系统的示例配置。</block>
  <block id="6cc4be8865a78ca53ed1eaf173bd28a3" category="cell">控制器 b 上的聚合 2</block>
  <block id="4facf56b8e32b968748dc3f301c82b59" category="paragraph">您可以使用 NetApp ONTAP 系统管理器或 ONTAP 命令行界面创建新数据卷并将其挂载到命名空间。</block>
  <block id="1d63ad99e78bdad7469de07c7f318451" category="section-title">多主机 SAP HANA 系统的卷配置</block>
  <block id="2f9bf27ae27db05dcf966a759ab139d7" category="paragraph">卷的布局类似于多主机 SAP HANA 系统的布局，该系统具有一个数据卷分区，但另一个数据卷作为日志卷存储在另一个聚合上，而另一个数据卷则存储在另一个聚合上。下表显示了具有两个数据卷分区的 SAP HANA 多主机系统的示例配置。</block>
  <block id="2b59fb89728efdb7c494694c3a85a129" category="paragraph">您可以使用 ONTAP 系统管理器或 ONTAP 命令行界面创建新数据卷并将其挂载到命名空间。</block>
  <block id="baeebc68f3b64a7c3291f0ca7f4df4f4" category="inline-link-macro">主机设置，</block>
  <block id="5638843af2d8de8b12e567f3b97df4dd" category="paragraph">除了一节中所述的任务之外 <block ref="39826558a7f1485d436120c70d356cd5" category="inline-link-macro-rx"></block> 必须为新的附加数据卷创建附加挂载点和 `fstab` 条目，并且必须挂载新卷。</block>
  <block id="5b44880dacc6b2708bb197731958315d" category="list-text">创建其他挂载点。</block>
  <block id="b6a2046ad9f2856608b23df9628204f9" category="list-text">对于单主机系统，创建挂载点并在数据库主机上设置权限：</block>
  <block id="16761c2a0fb024c597b40911ae9db317" category="paragraph">以下示例命令适用于 2 加 1 多主机 HANA 系统。</block>
  <block id="83ae0722b3e48679da7a55d190be5e44" category="list-text">将其他文件系统添加到所有主机上的 ` /etc/fstab` 配置文件中。</block>
  <block id="474fcd58a82b43abb0995925c1918bb9" category="paragraph">对于使用 NFSv4.1 的单主机系统，请参见以下示例：</block>
  <block id="d3bc1dd8c6c3cc7ddb77b7e695a19878" category="list-text">运行 `mount – a` 命令挂载文件系统。</block>
  <block id="356dd722b5b14363393c40db43145fba" category="paragraph">对租户数据库执行以下 SQL 语句，以便向租户数据库添加额外的数据卷分区。使用指向其他卷的路径：</block>
  <block id="523ed46a1b80ff97206086ca1cf66c74" category="paragraph">SAP 已定义一组静态存储 KPI 。无论数据库主机和使用 SAP HANA 数据库的应用程序的内存大小如何，这些 KPI 都适用于所有生产 SAP HANA 环境。这些 KPI 适用于单主机，多主机， HANA 上的 Business Suite ， HANA 上的 Business Warehouse ， S/4HANA 和 BB/4HANA 环境。因此，当前的性能规模估算方法仅取决于连接到存储系统的活动 SAP HANA 主机的数量。</block>
  <block id="9f9af9fdd084ad8eda305ac55f4cfd99" category="paragraph">SAP 提供了一个性能测试工具，必须使用该工具来验证连接到存储的活动 SAP HANA 主机的存储系统性能。</block>
  <block id="3f54db3fa7dd353cd2bf6e94f663b8ea" category="paragraph">NetApp 测试并预定义了可附加到特定存储模型的最大 SAP HANA 主机数，同时仍满足 SAP 为基于生产的 SAP HANA 系统提供的所需存储 KPI 。</block>
  <block id="372b4c73d2b83a38a4fb94c562f53c6d" category="paragraph">对于 12 Gb 串行连接 SCSI （ SAS ）磁盘架（ DS224C ），可使用以下固定磁盘架配置来执行性能规模估算：</block>
  <block id="27cd945eb6d2a58787f658282dc8c114" category="admonition">这两种配置都使用高级磁盘分区（ Advanced Disk Partitioning ， ADPv2 ）。半负载磁盘架最多可支持九个 SAP HANA 主机，而满载磁盘架最多可在一个磁盘架中支持 14 个主机。SAP HANA 主机必须在两个存储控制器之间平均分布。相同的适用场景 AFF A700s 系统的内部磁盘。必须使用 12 Gb SAS 连接 DS224C 磁盘架，以支持 SAP HANA 主机的数量。</block>
  <block id="7168b6fab3d1fdb1f905b5d9064d3a24" category="paragraph">6 Gb SAS 磁盘架（ DS2246 ）最多支持四个 SAP HANA 主机。SSD 和 SAP HANA 主机必须在两个存储控制器之间平均分布。</block>
  <block id="f1ae15f6fd143c9e1276af68c06658c7" category="cell">12 GB SAS 磁盘架（ DS224C ），半个装有 12 个 SSD 和 ADPv2</block>
  <block id="fac3c55a3cdc98c6d08b96c048885f29" category="section-title">配置性能测试工具</block>
  <block id="918724fe4fec0578cd9e798f8152194e" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。使用 SAP 性能测试工具测试存储性能时，还必须为 SAP 的性能测试工具设置这些参数。</block>
  <block id="c2cbcc154a82de8081d9414e0f5a0e72" category="paragraph">有关配置不同 SAP 测试工具的详细信息，请参见<block ref="ec90a615c6d378fa60ba8e7f2e7592b2" category="inline-link-rx"></block> 适用于 HWCCT （ SAP HANA 1.0 ）和<block ref="2912abb2c0271a2912b6a4a94888e0ec" category="inline-link-rx"></block> 适用于 HCMT/HCOT （ SAP HANA 2.0 ）。</block>
  <block id="819c1f9958e8bb33d727e63084453a6d" category="paragraph">每个 HANA 主机的磁盘数以及每个存储模型的 SAP HANA 主机密度均通过性能测试工具确定。</block>
  <block id="f0c841de9af65f567936371d382c94ec" category="paragraph">规模估算过程需要详细信息，例如生产和非生产 SAP HANA 主机的数量，每个主机的 RAM 大小以及基于存储的 Snapshot 副本的备份保留。SAP HANA 主机的数量决定了存储控制器和所需磁盘的数量。</block>
  <block id="e41020e64935329a6db54f4c483b9113" category="summary">本节所述的所有主机设置步骤对物理服务器上的 SAP HANA 环境和在 VMware vSphere 上运行的 SAP HANA 均有效。</block>
  <block id="179a425489e8da15ef704b42e37645c8" category="section-title">适用于 Red Hat Enterprise Linux 7.2 或更高版本的配置参数</block>
  <block id="e19cf298e039e5acff1dbe7e98090d84" category="paragraph">您必须在每个 SAP HANA 主机上为 SAP HANA 生成的工作负载调整其他内核和配置参数。</block>
  <block id="5491b828c5fede318e582fdb0621d64f" category="paragraph">从 Red Hat Enterprise Linux 7.2 开始，您必须在 ` /etc/sysctl.d` 目录的配置文件中设置内核参数。例如，您必须创建一个名为 `91-netapp-hana` 的配置文件。</block>
  <block id="b57aa9745ef1f47f50b9a81013b110fc" category="admonition">以下示例显示了 SID=NF2 的 SAP HANA 数据库。</block>
  <block id="efa2100424814ed736c66e231fca168e" category="paragraph">下表显示了单主机和多主机 SAP HANA 数据库的不同文件系统必须使用的 NFS 版本。</block>
  <block id="2f47d7fd74fc1974289ac9986bf3aadc" category="admonition">SAP Lama 要求 /usr/sap/SID 目录为本地目录。因此，如果使用的是 SAP Lama ，请勿挂载 /usr/sap/SID 的 NFS 卷。</block>
  <block id="2d10c7ea8ceb7d4d67cf331de62acb84" category="paragraph">对于 NFSv3 ，您必须关闭 NFS 锁定，以避免在软件或服务器出现故障时执行 NFS 锁定清理操作。</block>
  <block id="d8ad267f2c46ff97a15a2d97678f0e5d" category="cell">rw ， bg ， hard ， timeo=600 ， noatime</block>
  <block id="9fdcbaccc733453d8e7687d8e14a4e06" category="cell">rsize=65536 ， wsize=65536</block>
  <block id="a6b3bab4792cb8cb5eda6f38e11a69e7" category="admonition">要提高 NFSv3 的读取性能， NetApp 建议您使用 `nconnect=n` mount 选项，该选项可在 SUSE Linux Enterprise Server 12 SP4 或更高版本以及 RedHat Enterprise Linux （ RHEL ） 8.3 或更高版本中使用。</block>
  <block id="af4ba9ef9ab9bd07d7c649c6d51dfa19" category="summary">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。</block>
  <block id="044185db5eecc41b1eff832a2449939e" category="doc">适用于 SAP HANA 的 I/O 堆栈配置</block>
  <block id="9b9a22cabf9c193636cd9f07c91af320" category="paragraph">NetApp 进行了性能测试以定义理想值。下表列出了从性能测试中推断的最佳值。</block>
  <block id="5a47372463f3478c00e62fe8d0fab323" category="inline-link">2267798 —使用 hdbparam 在安装期间配置 SAP HANA 数据库</block>
  <block id="c310dbb2184ad240ae5b0efe2fa7161c" category="paragraph">对于 SAP HANA 1.0 - SPS12 ，可以在安装 SAP HANA 数据库期间设置这些参数，如 SAP 注释中所述<block ref="c391dcebb4d33a6a0f840983455654bf" category="inline-link-rx"></block>。</block>
  <block id="cae4446a780e78b5b18c423d76e75bb3" category="paragraph">从 SAP HANA 2.0 开始， `hdbparam` 已弃用，并且参数将移至 `global.ini` 文件。可以使用 SQL 命令或 SAP HANA Studio 设置这些参数。有关详细信息，请参见 SAP 注释<block ref="6af86c07e5a30516e9705c5fc7252793" category="inline-link-rx"></block>。也可以在 `global.ini` 文件中设置这些参数。</block>
  <block id="35e29c7133f7345ff12b812a10716c82" category="paragraph">对于 SAP HANA 2.0 SPS5 及更高版本，请使用 `setParameter.py` 脚本设置正确的参数。</block>
  <block id="c7d5014cd251a0d4b223b8a8c9d0d690" category="paragraph">SAP HANA 主机使用冗余 FCP 基础架构和多路径软件连接到存储控制器。如果交换机或主机总线适配器（ HBA ）发生故障，则需要一个冗余 FCP 交换机基础架构来提供容错 SAP HANA 主机到存储连接。必须在交换机上配置适当的分区，以使所有 HANA 主机能够访问存储控制器上所需的 LUN 。</block>
  <block id="10de0f7913b47a7c113fc4c77c57b582" category="paragraph">与部署的 AFF 系统无关， SAP HANA 环境也可以通过添加任何经过认证的存储控制器来进行扩展，以满足所需的节点密度，如下图所示。</block>
  <block id="6e885a25dfabc924cf867ada3aeb785e" category="paragraph">所有 NetApp 存储控制器上的 ONTAP 软件都提供了一种内置机制，可在运行期间备份 SAP HANA 数据库，而不会影响性能。基于存储的 NetApp Snapshot 备份是一种完全受支持的集成备份解决方案，可用于 SAP HANA 单个容器以及具有单个租户或多个租户的 SAP HANA MDC 系统。</block>
  <block id="c2934ecf3d665eb48045a5c0a76aaa32" category="paragraph">基于存储的 Snapshot 备份可使用适用于 SAP HANA 的 NetApp SnapCenter 插件来实施。这样，用户就可以使用 SAP HANA 数据库本机提供的界面创建一致的基于存储的 Snapshot 备份。SnapCenter 会将每个 Snapshot 备份注册到 SAP HANA 备份目录中。因此， SnapCenter 所做的备份可以在 SAP HANA Studio 或 Cockpit 中查看，您可以直接选择这些备份来执行还原和恢复操作。</block>
  <block id="c821c77589b970937599a027069b75fa" category="paragraph">通过 NetApp SnapMirror 技术，可以将在一个存储系统上创建的 Snapshot 副本复制到由 SnapCenter 控制的二级备份存储系统。然后，可以为主存储上的每个备份集以及二级存储系统上的备份集定义不同的备份保留策略。适用于 SAP HANA 的 SnapCenter 插件可自动管理基于 Snapshot 副本的数据备份和日志备份的保留，包括备份目录的管理。适用于 SAP HANA 的 SnapCenter 插件还允许通过执行基于文件的备份对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="e2f0b48a9d9947c9b7911e4ac2346676" category="paragraph">与基于文件的传统备份相比，基于存储的 Snapshot 备份具有显著优势。这些优势包括但不限于：</block>
  <block id="d953c3b1d4ebbca797ea1cbd2db09e48" category="list-text">由于存储层上的恢复时间（几分钟）更快，备份频率更高，因此 RTO 减少</block>
  <block id="1901dda5acbabe5dc59a8bf332104608" category="paragraph">SAP HANA 灾难恢复既可以在数据库层使用 SAP HANA 系统复制，也可以在存储层使用存储复制技术。下一节概述了基于存储复制的灾难恢复解决方案。</block>
  <block id="4d7265e8ab9e98481c57ad3467a13264" category="paragraph">下图显示了一个三站点灾难恢复解决方案，它使用同步 SnapMirror 复制到本地灾难恢复数据中心，并使用异步 SnapMirror 将数据复制到远程灾难恢复数据中心。</block>
  <block id="ccb93370e2c5ea05681c87d10716cb76" category="paragraph">使用同步 SnapMirror 进行数据复制可提供零 RPO 。主灾难恢复数据中心与本地灾难恢复数据中心之间的距离限制为 100 公里左右。</block>
  <block id="fb05024902b454ea7eaf93ee5c249633" category="paragraph">通过使用异步 SnapMirror 将数据复制到第三个远程灾难恢复数据中心，可以防止主灾难恢复站点和本地灾难恢复站点发生故障。RPO 取决于复制更新的频率以及传输更新的速度。理论上，距离是无限的，但限制取决于必须传输的数据量以及数据中心之间的可用连接。典型的 RPO 值介于 30 分钟到多小时之间。</block>
  <block id="38a27392aa0b0ea2c83916c20bd81d8f" category="paragraph">这两种复制方法的 RTO 主要取决于在灾难恢复站点启动 HANA 数据库并将数据加载到内存所需的时间。假设数据的读取吞吐量为 1000 Mbps ，则加载 1 TB 数据大约需要 18 分钟。</block>
  <block id="d58470687869446fe4f35300048a7a2a" category="paragraph">正常运行期间，灾难恢复站点上的服务器可用作开发 / 测试系统。发生灾难时，需要关闭开发 / 测试系统并将其作为灾难恢复生产服务器启动。</block>
  <block id="494407c34ad1fbd6885e474888931b49" category="paragraph">这两种复制方法均允许您执行灾难恢复工作流测试，而不会影响 RPO 和 RTO 。FlexClone 卷在存储上创建并连接到灾难恢复测试服务器。</block>
  <block id="66ea2532c88937e1b2fec44c9c66cdc2" category="paragraph">同步复制提供 StrictSync 模式。如果由于任何原因未完成对二级存储的写入，则应用程序 I/O 将失败，从而确保主存储系统和二级存储系统完全相同。只有在 SnapMirror 关系恢复为 InSync 状态后，主系统的应用程序 I/O 才会恢复。如果主存储发生故障，则在故障转移后可以在二级存储上恢复应用程序 I/O ，而不会丢失数据。在 StrictSync 模式下， RPO 始终为零。</block>
  <block id="4812f5d5dcef7b57ffc92a05d9b87dab" category="section-title">基于 NetApp MetroCluster 的存储复制</block>
  <block id="f831142d32986e69abb23ade52461f9f" category="paragraph">下图简要展示了解决方案。每个站点上的存储集群可提供本地高可用性，并用于生产工作负载。每个站点的数据会同步复制到另一位置，并可在发生灾难故障转移时使用。</block>
  <block id="c51b24aaab462fd7294e78e8c4e9e241" category="summary">本节介绍 SAP HANA 主机的专用存储网络设置。</block>
  <block id="4d9de89d8dc9bb9db25b8c5a5aa836cc" category="doc">网络设置</block>
  <block id="7853be0a719416aa35b3da38940c0ce2" category="paragraph">配置网络时，请遵循以下准则：</block>
  <block id="5aa2ed1209919c655eae0cb94df9bae3" category="list-text">必须使用专用存储网络将 SAP HANA 主机连接到具有 10GbE 或更快网络的存储控制器。</block>
  <block id="4404b42b626eaf177ab6e6e9125dfe97" category="list-text">对存储控制器和 SAP HANA 主机使用相同的连接速度。如果无法做到这一点，请确保存储控制器和 SAP HANA 主机之间的网络组件能够处理不同的速度。例如，您必须提供足够的缓冲区空间，以便在存储和主机之间的 NFS 级别进行速度协商。网络组件通常是交换机，但也必须考虑刀片式服务器机箱中的其他组件，例如背板。</block>
  <block id="a32bac621f038e27eb9c7bba7b82a094" category="list-text">在存储网络交换机和主机层上用于存储流量的所有物理端口上禁用流量控制。</block>
  <block id="9f9c9a0f31b06a64351ba948107beb87" category="list-text">每个 SAP HANA 主机都必须具有一个冗余网络连接，带宽至少为 10 Gb 。</block>
  <block id="83b25287cb23c57a7801df3c84079ee0" category="list-text">必须在 SAP HANA 主机和存储控制器之间的所有网络组件上启用最大传输单元（ MTU ）大小为 9 ， 000 的巨型帧。</block>
  <block id="8e07acfd1437feec339a101261f3d33e" category="list-text">在 VMware 设置中，必须为每个正在运行的虚拟机分配专用 VMXNET3 网络适配器。有关更多要求，请查看 " 简介 " 中提及的相关文章。</block>
  <block id="ba1e4c91d87d340db9164d860b5fae70" category="list-text">为避免彼此干扰，请在日志和数据区域使用单独的网络 /IO 路径。</block>
  <block id="faee62bb79701f4ef71263923314ff62" category="paragraph">下图显示了一个示例，其中四个 SAP HANA 主机使用 10GbE 网络连接到一个存储控制器 HA 对。每个 SAP HANA 主机都与冗余网络结构建立主动 - 被动连接。</block>
  <block id="1efc1e7690d351bfed1ced8c36c4ee03" category="paragraph">在存储层，将配置 MTU 大小为 9000 的广播域，并将所有必需的物理接口添加到此广播域。此方法会自动将这些物理接口分配给同一故障转移组。分配给这些物理接口的所有逻辑接口（ LIF ）都会添加到此故障转移组中。</block>
  <block id="0e9b7a6bc69692a6125fb9b457a42e62" category="admonition">根据 SAP HANA 主机的数量和使用的连接速度，需要不同数量的活动物理端口。有关详细信息，请参见一节 <block ref="53f775602a3eaa10214452e4a87da1ea" category="inline-link-macro-rx"></block>。</block>
  <block id="283bdd66e3d6ab214e33d303e668536e" category="section-title">VMware 专用网络设置</block>
  <block id="970db5841ccfee51a6e5d4efea5c84f3" category="paragraph">正确的网络设计和配置至关重要，因为 SAP HANA 实例的所有数据，包括数据库的性能关键型数据和日志卷，均通过此解决方案中的 NFS 提供。专用存储网络用于将 NFS 流量与 SAP HANA 节点之间的通信和用户访问流量分开。每个 SAP HANA 节点都需要一个冗余专用网络连接，带宽至少为 10 Gb 。此外，还支持更高的带宽。此网络必须通过网络交换和计算从存储层端扩展到端，直到 VMware vSphere 上托管的子操作系统为止。除了物理交换基础架构之外，还可以使用 VMware 分布式交换机（ VDS ）在虚拟机管理程序层为网络流量提供足够的性能和易管理性。</block>
  <block id="60777d420c292249b3947e8807f44971" category="paragraph">如上图所示，每个 SAP HANA 节点都会在 VMware 分布式交换机上使用一个专用端口组。通过此端口组，可以在 ESX 主机上增强服务质量（ QoS ）并专用分配物理网络接口卡（ NIC ）。要在发生 NIC 故障时使用专用物理 NIC 并保留 HA 功能，专用物理 NIC 将配置为活动上行链路。其他 NIC 会在 SAP HANA 端口组的绑定和故障转移设置中配置为备用上行链路。此外，物理和虚拟交换机上必须端到端启用巨型帧（ MTU 9 ， 000 ）。此外，关闭服务器，交换机和存储系统上用于存储流量的所有以太网端口上的流量控制。下图显示了此类配置的一个示例。</block>
  <block id="0e4dfad25f5529b5f21a75404c509772" category="admonition">对于用于 NFS 流量的接口，必须关闭 LRO （大型接收卸载）。有关所有其他网络配置准则，请参见相应的适用于 SAP HANA 的 VMware 最佳实践指南。</block>
  <block id="7db55fece99cd60241eaadd5b0b310da" category="summary">下一节概述了为 SAP HANA 估算存储系统规模时的性能和容量注意事项。</block>
  <block id="83814b9c4a7b826717cc464aa8fb78ac" category="admonition">请联系您的 NetApp 或 NetApp 合作伙伴销售代表，为存储规模估算流程提供支持，并创建适当规模的存储环境。</block>
  <block id="9b5082bba6ed43c3e4659d132b4df7f3" category="paragraph">SAP 已定义一组静态存储 KPI 。无论数据库主机和使用 SAP HANA 数据库的应用程序的内存大小如何，这些 KPI 都适用于所有生产 SAP HANA 环境。这些 KPI 适用于单主机，多主机， HANA 上的 Business Suite ， HANA 上的 Business Warehouse ， S/4HANA 和 BB/4HANA 环境。因此，当前的性能规模估算方法仅取决于连接到存储系统的活动 SAP HANA 主机的数量。</block>
  <block id="f2de3e3b437bebbf070dca38090a29ca" category="admonition">只有生产 SAP HANA 系统才需要存储性能 KPI 。</block>
  <block id="e4dda14ad0a8b54fc49903f1eeb3764e" category="paragraph">SAP 提供了一个性能测试工具，必须使用该工具来验证连接到存储的活动 SAP HANA 主机的存储性能。</block>
  <block id="5e2e10cba29f5251b72e245ca5e627be" category="admonition">认证 FAS 产品系列中的存储控制器也可用于采用其他磁盘类型或磁盘后端解决方案的 SAP HANA ，但前提是它们受 NetApp 支持并满足 SAP HANA TDI 性能 KPI 要求。例如， NetApp 存储加密（ NetApp Storage Encryption ， NSE ）和 NetApp FlexArray 技术。</block>
  <block id="99724050fbff82fec44c60c3ee4f7aee" category="paragraph">本文档介绍了 SAS 硬盘驱动器和固态驱动器的磁盘大小调整。</block>
  <block id="4506c934d7af90d5123a60cf609a388b" category="section-title">硬盘驱动器</block>
  <block id="c89d32b6013ce9723a96c107be1c4d48" category="admonition">此计算与使用的存储控制器和磁盘架无关。</block>
  <block id="e21e8a6bac2619ab0247181c81f6fd10" category="paragraph">对于固态驱动器（ SSD ），数据磁盘的数量取决于从存储控制器到 SSD 磁盘架的 SAS 连接吞吐量。</block>
  <block id="b3e9f6494455275ea6b6edb7295ebd0e" category="paragraph">可以在磁盘架上运行的最大 SAP HANA 主机数以及每个 SAP HANA 主机所需的最小 SSD 数均通过运行 SAP 性能测试工具来确定。</block>
  <block id="2befc3957b70e50f23dacfb3bcf86c2c" category="list-text">如果磁盘架连接到 12 Gb ，则具有 24 个 SSD 的 12 Gb SAS 磁盘架（ DS224C ）最多可支持 14 个 SAP HANA 主机。</block>
  <block id="03de450915ad58bd89ba02bcc1724c69" category="cell">满载 24 个 SSD 的 6 Gb SAS 磁盘架（ DS2246 ）</block>
  <block id="c1fe2a19a34d1ba0d03c9b34ed6d6dc0" category="cell">满载 24 个 SSD 的 12 GB SAS 磁盘架（ DS224C ）</block>
  <block id="f703381fdb02047b96e8a08ccd787c3d" category="paragraph">您可能会决定在同一存储控制器或同一聚合上部署 SAP HANA 工作负载和其他应用程序工作负载。如果是，您必须确保混合工作负载环境中的 SAP HANA 始终具有足够的性能。NetApp 还建议您使用服务质量（ QoS ）参数来控制这些其他应用程序可能对 SAP HANA 应用程序产生的影响。</block>
  <block id="4af2232eb1cbb56b9ad9f27dd1436328" category="paragraph">必须使用 SAP HCMT 测试工具检查是否可以在已用于其他工作负载的存储控制器上运行其他 SAP HANA 主机。但是， SAP 应用程序服务器可以安全地放置在与 SAP HANA 数据库相同的存储控制器和聚合上。</block>
  <block id="b0f9650ddfbaa04c69d0afbc401f6dce" category="paragraph">从 SAP HANA 1.0 SPS10 开始， SAP 引入了一些参数来调整 I/O 行为并针对所用文件和存储系统优化数据库。使用 SAP 测试工具测试存储性能时，还必须为 SAP （ fsperf ）的性能测试工具设置这些参数。</block>
  <block id="3555c6a1af2c71b84c5e56f0d1e1bf9a" category="paragraph">NetApp 进行了性能测试，以定义最佳值。下表列出了必须在 SAP 测试工具的配置文件中设置的参数。</block>
  <block id="4ee612e0e9020cc8630b9f3c2a731f47" category="paragraph">每个 HANA 主机的磁盘数以及每个存储模型的 SAP HANA 主机密度均通过 SAP HANA 测试工具确定。</block>
  <block id="c047f42ac7558995af3a7e8b7e1c8c65" category="paragraph">规模估算过程需要详细信息，例如生产和非生产 SAP HANA 主机的数量，每个主机的 RAM 大小以及基于存储的 Snapshot 副本的备份保留期限。SAP HANA 主机的数量决定了存储控制器和所需磁盘的数量。</block>
  <block id="72512f57a9671c8fd7e4e6c720f19f86" category="paragraph">在容量规模估算期间， RAM 大小，每个 SAP HANA 主机磁盘上的净数据大小以及 Snapshot 副本备份保留期限均用作输入。</block>
  <block id="888a97817eb269434426d56de56528fa" category="summary">默认情况下， SAP HANA 在每个 SAP HANA 服务中仅使用一个数据卷。由于文件系统的最大文件大小限制，我们建议限制最大数据卷大小。</block>
  <block id="c7c8b48fd23d939958d032aa4f897d35" category="doc">SAP HANA 数据卷大小</block>
  <block id="2313d7e75b1293ec19e67b10399a5b36" category="paragraph">要自动执行此操作，请在 `global.ini` 中的 ` [ 持久性 ]` 部分设置以下参数：</block>
  <block id="bcd4783f16a6a90aaaeb9703e35b2183" category="inline-link">SAP 注释 240005 问题 15</block>
  <block id="02fb0663b2b25ed3058835e1a2db5762" category="paragraph">这将在达到 8 ， 000 GB 限制后创建一个新的数据卷。<block ref="0d7b59f229b453865b91c5e952a7b217" category="inline-link-rx"></block> 提供了更多信息。</block>
  <block id="0f41d05d80faf4e3a75a6b4e2292f1c0" category="summary">NetApp AFF 产品系列已通过认证，可在 TDI 项目中与 SAP HANA 结合使用。经过认证的企业级存储平台采用 NetApp ONTAP 软件。</block>
  <block id="0db6b81db5bd35e1eef1e83e154c3cb5" category="doc">TR-4436 ：《基于采用光纤通道协议的 NetApp AFF 系统的 SAP HANA 》</block>
  <block id="0b79795d3efc95b9976c7c5b933afce2" category="section-title">简介</block>
  <block id="e4509a748ae3ce7cb528662f2f9f7e10" category="paragraph">此认证适用于以下型号：</block>
  <block id="130c9ce9d2909449cb229a98c66f9d29" category="inline-link">经过认证并受支持的 SAP HANA 硬件目录</block>
  <block id="171ad4663cdfb492651e0357292fbe82" category="paragraph">本文档介绍了使用光纤通道协议（ FCP ）的 AFF 配置。</block>
  <block id="a08e3f55ac1bf243274ee454a477749b" category="admonition">要为 SAP HANA 实现所需的 SAP HANA KPI 和最佳性能，必须采用本文所述的配置。更改此处未列出的任何设置或使用的功能可能会导致发生原因性能下降或出现意外行为，只有在 NetApp 支持人员建议的情况下，才应执行此操作。</block>
  <block id="9ba59bf1b64e9d129b41dbb49f3c385f" category="paragraph">有关使用 NFS 和 NetApp FAS 系统的 AFF 系统的配置指南，请访问以下链接：</block>
  <block id="6e309be8793679276c5f6a7bdd2bfdfa" category="inline-link">基于采用 FCP 的 NetApp FAS 系统的 SAP HANA</block>
  <block id="794aa68d1e6abb7bdd6b9ecf4a1125fd" category="inline-link">基于采用 NFS 的 NetApp FAS 系统的 SAP HANA</block>
  <block id="5f6e041a9634120ceb1ee084f6acde8a" category="inline-link">SAP 注释 2235581 — SAP HANA 支持的操作系统</block>
  <block id="10fba2fd8d2b0860517a92eefbfce26b" category="paragraph">在 SAP HANA 多主机环境中，标准 SAP HANA 存储连接器用于在发生 SAP HANA 主机故障转移时提供隔离。有关操作系统配置准则和 HANA 专用 Linux 内核依赖关系，请始终参考相关 SAP 注释。有关详细信息，请参见<block ref="362348e4aadbc3b1dc4fa3ddcce8fb65" category="inline-link-rx"></block>。</block>
  <block id="c28f239d8c4b11cfe19d1dcf078100b9" category="section-title">SAP HANA 量身定制的数据中心集成</block>
  <block id="e13ebe7bf91deecb41098f3561e752bf" category="paragraph">NetApp AFF 存储系统已通过 SAP HANA TDI 计划的认证，该计划同时使用 NFS （ NAS ）和 FC （ SAN ）协议。它们可以部署在任何当前 SAP HANA 方案中，例如采用单主机或多主机配置的基于 HANA 的 SAP Business Suite ， S/4HANA ， BB/4HANA 或基于 HANA 的 SAP Business Warehouse 。任何经认证可与 SAP HANA 结合使用的服务器均可与 NetApp 认证的存储解决方案结合使用。下图显示了一个架构概述。</block>
  <block id="14a31d6554fa48b10cc86d1aaf656a07" category="inline-link">SAP HANA 定制数据中心集成常见问题解答</block>
  <block id="9282f2106e2ecc166cf241e78c58163e" category="list-text"><block ref="9282f2106e2ecc166cf241e78c58163e" category="inline-link-rx"></block></block>
  <block id="0efd230d120bc177f0918dac852f2cf2" category="list-text">适用于 SAP HANA 的 SAP 认证企业存储硬件</block>
  <block id="3710f13cc62644ea40b0af38f0b1198e" category="paragraph"><block ref="3710f13cc62644ea40b0af38f0b1198e" category="inline-link-rx"></block></block>
  <block id="c54847a2046020d06d345fd8b61fc169" category="list-text">NetApp 文档中心</block>
  <block id="1f97b7a68d0268791593f9152a2471f4" category="list-text">SAP HANA 软件解决方案</block>
  <block id="02e9c064fb16f4d7c921173e0ea3e1d4" category="summary">SAP HANA 主机通过使用冗余 10GbE 或速度更快的网络基础架构连接到存储控制器。SAP HANA 主机和存储控制器之间的数据通信基于 NFS 协议。如果交换机或网络接口卡（ Network Interface Card ， NIC ）发生故障，则需要一个冗余交换基础架构来提供容错 SAP HANA 主机到存储连接。</block>
  <block id="9ebc0606dc606ba3c824288cbcec4b6a" category="paragraph">这些交换机可能会将各个端口的性能与端口通道进行聚合，以便在主机级别显示为一个逻辑实体。</block>
  <block id="ec7778649625767bca80e5172b3215f8" category="paragraph">下图显示了一个配置示例，其中八个 SAP HANA 主机连接到一个存储高可用性（ HA ）对。</block>
  <block id="f000fef8626763ce732cc75182f80de1" category="list-text">如果存储控制器提供的性能足以满足当前 SAP HANA 主要性能指标（ KPI ）的要求，则可以将更多的 SAP HANA 主机和存储容量附加到现有存储。</block>
  <block id="af0b30d5f97bb5800d0d429f5f501e85" category="paragraph">下图显示了一个配置示例，其中，更多 SAP HANA 主机连接到存储控制器。在此示例中，要满足 16 个 SAP HANA 主机的容量和性能要求，需要更多的磁盘架。根据总吞吐量要求，您必须向存储控制器添加更多 10GbE 或更快的连接。</block>
  <block id="014f96dd954f0cad52c8dd1e4a0f6c0c" category="paragraph">无论部署的 AFF 系统如何， SAP HANA 环境也可以通过添加任何经过认证的存储控制器来进行扩展，以满足所需的节点密度，如下图所示。</block>
  <block id="403661a7cc1e3bdbdbb3bc83a0e07b79" category="paragraph">所有 NetApp 存储控制器上的 ONTAP 软件都提供了一种内置机制，可在运行期间备份 SAP HANA 数据库，而不会影响性能。基于存储的 NetApp Snapshot 备份是一种完全受支持的集成备份解决方案，可用于 SAP HANA 单个容器以及具有单个租户或多个租户的 SAP HANA 多租户数据库容器（ MDG ）系统。</block>
  <block id="d27691a65309de7a848f265e2a85db07" category="paragraph">通过 NetApp SnapMirror 技术，可以将在一个存储系统上创建的 Snapshot 副本复制到由 SnapCenter 控制的二级备份存储系统。然后，可以为主存储上的每个备份集以及二级存储系统上的备份集定义不同的备份保留策略。适用于 SAP HANA 的 SnapCenter 插件可自动管理基于 Snapshot 副本的数据备份和日志备份的保留，包括备份目录的管理。适用于 SAP HANA 的 SnapCenter 插件还允许通过执行基于文件的备份对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="37a72a4ef96da2b1b4de8dfd6a6578e1" category="paragraph">与基于文件的传统备份相比，基于存储的 Snapshot 备份具有显著优势。这些优势包括但不限于：</block>
  <block id="a87b95aa164115fe66d032fbca70ca68" category="paragraph">SAP HANA 灾难恢复（ DR ）可以通过 SAP HANA 系统复制在数据库层上完成，也可以通过存储复制技术在存储层完成。下一节概述了基于存储复制的灾难恢复解决方案。</block>
  <block id="d8c167d8f4fbaa19b28b96b8f9830293" category="paragraph">正常运行期间，灾难恢复站点上的服务器可用作开发 / 测试系统。发生灾难时，需要关闭开发 / 测试系统并将其作为灾难恢复生产服务器启动。</block>
  <block id="5a19cb1f3722bd59393efe7cbc853747" category="summary">NetApp AFF 系统产品系列已通过认证，可在定制数据中心集成（ TDI ）项目中与 SAP HANA 结合使用。经过认证的企业级存储系统采用 NetApp ONTAP 软件的特征。</block>
  <block id="8290e539e87b39f4743f2a941a37d00d" category="doc">TR-4435 ：《采用 NFS 的 NetApp AFF 系统上的 SAP HANA —配置指南》</block>
  <block id="af01ac16ca42b9b924b834a3199131e9" category="paragraph">此认证适用于以下型号：</block>
  <block id="793f62e70c31f71a93161db091bea2c0" category="paragraph">有关使用 FCP 的 NetApp AFF 系统以及使用 NFS 或 FCP 的 FAS 系统的配置指南，请访问以下链接：</block>
  <block id="fd645c3ffaeed1c3efb140082b037a69" category="inline-link">基于采用光纤通道协议的 NetApp FAS 系统的 SAP HANA</block>
  <block id="d3eeeac9b8ca9512c68dfff9f3b301a2" category="inline-link">基于采用光纤通道协议的 NetApp AFF 系统的 SAP HANA</block>
  <block id="36fafbaf89be825de435f50a73ce793c" category="paragraph">下表显示了 NFS 版本， NFS 锁定和所需隔离实施的受支持组合，具体取决于 SAP HANA 数据库配置。</block>
  <block id="4a74ba49b2778c7cf6b73600b7dfe758" category="paragraph">对于不使用主机自动故障转移的 SAP HANA 单主机系统或多个主机，支持 NFSv3 和 NFSv4 。</block>
  <block id="8456bce54ecacb824d3f0f3333eec164" category="paragraph">对于采用主机自动故障转移的 SAP HANA 多主机系统， NetApp 仅支持 NFSv4 ，而使用 NFSv4 锁定作为服务器专用 STONITH （ SAP HANA HA/DR 提供程序）实施的替代方案。</block>
  <block id="86083f3ea21c2385b4f013aae3c57858" category="cell">SAP HANA</block>
  <block id="b09bc640e0761651dfc89ddfb932bca4" category="cell">NFS 版本</block>
  <block id="4dc6f2785947994abb17dafc579b385c" category="cell">NFS 锁定</block>
  <block id="112546829b39fc0ca5f6864abb9eb36b" category="cell">SAP HANA HA/DR 提供程序</block>
  <block id="11b07481dbca2b152fe454ec6b2bda1b" category="cell">SAP HANA 单个主机，多个主机，而不具有主机自动故障转移功能</block>
  <block id="d15305d7a4e34e02489c74a5ef542f36" category="cell">关闭</block>
  <block id="274b68192b056e268f128ff63bfcd4a4" category="cell">不适用</block>
  <block id="521c36a31c2762741cf0f8890cbe05e3" category="cell">开启</block>
  <block id="17f561d1407ffe04f736722475cbc0d4" category="cell">使用主机自动故障转移的 SAP HANA 多个主机</block>
  <block id="fbe7f3b8db20ca64d74a09b5069fe001" category="cell">必须实施特定于服务器的 STONITH</block>
  <block id="6fd5e95dc0bce8329da87e1152677b48" category="cell">不需要</block>
  <block id="c522b313eec5744e458e23dab3741128" category="admonition">本指南不包括特定于服务器的 STONITH 实施。请联系您的服务器供应商进行此类实施。</block>
  <block id="8543c5790a0b5260e2446fad651e5ade" category="paragraph">本文档介绍了在物理服务器和使用 VMware vSphere 的虚拟服务器上运行的 SAP HANA 的配置建议。</block>
  <block id="e0f43a4c6e28079f6afdc78865b7782e" category="admonition">有关操作系统配置准则和特定于 HANA 的 Linux 内核依赖关系，请参见相关 SAP 注释。有关详细信息，请参见 SAP 注释 2235581 ： SAP HANA 支持的操作系统。</block>
  <block id="5d75848b6169b06c4cd7d6a8c2ec2337" category="paragraph">NetApp AFF 存储控制器已通过 SAP HANA TDI 计划的认证，并同时使用 NFS （ NAS ）和 FC （ SAN ）协议。它们可以部署在任何当前 SAP HANA 方案中，例如采用单主机或多主机配置的基于 HANA 的 SAP Business Suite ， S/4HANA ， BB/4HANA 或基于 HANA 的 SAP Business Warehouse 。任何经认证可与 SAP HANA 结合使用的服务器均可与 NetApp 认证的存储解决方案结合使用。有关 SAP HANA TDI 的架构概述，请参见下图。</block>
  <block id="4769b140b92a70ffdab406be16d30122" category="paragraph">可通过多种方法将存储连接到虚拟机（ VM ）。首选选项是直接从子操作系统中连接具有 NFS 的存储卷。使用此选项时，物理主机和 VM 的主机和存储配置不会有所不同。</block>
  <block id="f7fbf8be79b2dbbf7cca7d63ea2aaa3e" category="paragraph">本文档介绍了从子操作系统直接挂载 NFS 的建议设置。</block>
  <block id="181fc43b08ba57214c4bbd2448ec470d" category="list-text"><block ref="181fc43b08ba57214c4bbd2448ec470d" category="inline-link-macro-rx"></block></block>
  <block id="302092b20c647fa4f675ff96913675f9" category="list-text"><block ref="302092b20c647fa4f675ff96913675f9" category="inline-link-macro-rx"></block></block>
  <block id="4f0141ecc04bee7dc293f8992542b4bd" category="summary">NetApp FAS 产品系列已通过认证，可在 TDI 项目中与 SAP HANA 结合使用。经过认证的企业级存储平台采用 NetApp ONTAP 操作系统。</block>
  <block id="088c8c258db90c09658a39d2839f52b0" category="doc">TR-4384 ：《采用光纤通道协议的 NetApp FAS 系统上的 SAP HANA 配置指南》</block>
  <block id="42eb56ae1e83db3afce70f056a668205" category="inline-link">经过认证并受支持的 SAP HANA 硬件目录</block>
  <block id="b448d121930edfc4a956027d7533c403" category="paragraph">本文档介绍了使用光纤通道协议（ FCP ）的 FAS 配置。</block>
  <block id="bd06b22fab5b6b92f9bf2b53d26f4805" category="admonition">要为 SAP HANA 实现所需的 SAP HANA KPI 和最佳性能，必须采用本文所述的配置。更改此处未列出的任何设置或使用的功能可能会导致性能下降或出现意外行为，只有在 NetApp 支持人员建议的情况下，才应执行此操作。</block>
  <block id="b33f6954e7bec0569d3be6ef5cea4d1d" category="paragraph">有关使用 NFS 和 NetApp AFF 系统的 FAS 系统的配置指南，请访问以下链接：</block>
  <block id="1800d8919a8de7dbf0bdd4d4ef0a94f4" category="paragraph">在 SAP HANA 多主机环境中，标准 SAP HANA 存储连接器用于在发生 SAP HANA 主机故障转移时提供隔离。有关操作系统配置准则和 HANA 专用 Linux 内核依赖关系的信息，请参见相关 SAP 注释。有关详细信息，请参见<block ref="362348e4aadbc3b1dc4fa3ddcce8fb65" category="inline-link-rx"></block>。</block>
  <block id="324c1541e14a4687bde362da7f340662" category="paragraph">NetApp FAS 存储控制器已通过使用 NFS （ NAS ）和光纤通道（ SAN ）协议的 SAP HANA 定制数据中心集成（ TDI ）计划的认证。它们可以部署在任何 SAP HANA 方案中，例如采用单主机或多主机配置的基于 HANA 的 SAP Business Suite ， S/4HANA ， BB/4HANA 或基于 HANA 的 SAP Business Warehouse 。任何经认证可与 SAP HANA 结合使用的服务器均可与经过认证的存储解决方案结合使用。有关架构概述，请参见下图。</block>
  <block id="3823dde38e881edb5563cdd3b64099ba" category="summary">以下是 SAP HANA 软件安装的要求。</block>
  <block id="d62e297e0f46d31deba4b84efdfafc32" category="paragraph">安装 SAP HANA 软件不需要为单主机系统做任何其他准备。</block>
  <block id="07f50886cb51dc3f90123d42cf009896" category="summary">SAP HANA 主机使用冗余 FCP 基础架构和多路径软件连接到存储控制器。</block>
  <block id="adff62b08f2c542a637f6a31fbda8673" category="paragraph">SAP HANA 主机使用冗余 FCP 基础架构和多路径软件连接到存储控制器。如果交换机或主机总线适配器（ HBA ）发生故障，则需要一个冗余 FCP 交换机基础架构来提供容错 SAP HANA 主机到存储连接。必须在交换机上配置适当的分区，以使所有 HANA 主机能够访问存储控制器上所需的 LUN 。</block>
  <block id="bae63c2771206a25f50da057ce067a9c" category="paragraph">可以在存储层使用不同型号的 FAS 产品系列。连接到存储的最大 SAP HANA 主机数由 SAP HANA 性能要求定义。所需的磁盘架数量取决于 SAP HANA 系统的容量和性能要求。</block>
  <block id="6afb369a6dbb704834887d425d781975" category="list-text">假设存储控制器可以在新负载下提供足够的性能以满足关键性能指标（ KPI ）要求，则将额外的 SAP HANA 主机和磁盘容量附加到存储</block>
  <block id="03f9c73bd24a38ac275bf81d436e85a9" category="list-text">为其他 SAP HANA 主机添加更多存储系统和磁盘容量</block>
  <block id="dd7ae5d97763211b9ba0c4fb173c8ba0" category="paragraph">无论部署的 FAS 系统存储模式如何， SAP HANA 环境也可以通过添加更多存储控制器进行扩展，如下图所示。</block>
  <block id="b29e296e3fc82d9667053e3613da9983" category="paragraph">NetApp ONTAP 软件提供了用于备份 SAP HANA 数据库的内置机制。基于存储的 Snapshot 备份是一种完全受支持的集成备份解决方案，可用于 SAP HANA 单容器系统和 SAP HANA MDC 单租户系统。</block>
  <block id="850e88ceda74d905d2efd5ea7c4b192d" category="paragraph">基于存储的 Snapshot 备份可通过适用于 SAP HANA 的 NetApp SnapCenter 插件来实施，该插件可通过 SAP HANA 数据库提供的接口实现基于存储的一致 Snapshot 备份。SnapCenter 会在 SAP HANA 备份目录中注册 Snapshot 备份，以便备份在 SAP HANA Studio 中可见，并可选择用于还原和恢复操作。</block>
  <block id="bbfb7e54dd17cf679279af8ea2a15ae3" category="paragraph">通过使用 NetApp SnapVault 软件，可以将在主存储上创建的 Snapshot 副本复制到由 SnapCenter 控制的二级备份存储。可以为主存储上的备份和二级存储上的备份定义不同的备份保留策略。适用于 SAP HANA 数据库的 SnapCenter 插件可管理基于 Snapshot 副本的数据备份和日志备份的保留，包括备份目录的管理。此外，适用于 SAP HANA 数据库的 SnapCenter 插件还可以通过执行基于文件的备份来对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="467d52bc18a84a9e401464296b95f32a" category="paragraph">与基于文件的备份相比，基于存储的 Snapshot 备份具有显著优势。这些优势包括：</block>
  <block id="7be39960baf9da92a5fd16aff336d896" category="list-text">备份速度更快（几分钟）</block>
  <block id="e48202a443acc7da9527083f2193be67" category="list-text">存储层上的还原速度更快（几分钟）</block>
  <block id="0fc3856f751e6cb653d303821aef3541" category="list-text">备份期间不会影响 SAP HANA 数据库主机，网络或存储的性能</block>
  <block id="3228fe22c23747656168738709bc6bd1" category="paragraph">SAP HANA 灾难恢复可以通过 SAP 系统复制在数据库层执行，也可以通过存储复制技术在存储层执行。下一节概述了基于存储复制的灾难恢复解决方案。</block>
  <block id="ad3b35bfc8ee4f5dee91390584d5b8cd" category="paragraph">下图显示了一个三站点灾难恢复解决方案，它使用同步 SnapMirror 复制到本地灾难恢复数据中心，并使用异步 SnapMirror 将数据复制到远程灾难恢复数据中心。</block>
  <block id="c3a14b2b8a8f3abd4f577b36ff5a89d7" category="paragraph">下图简要展示了解决方案。每个站点上的存储集群均可提供本地高可用性，并用于生产工作负载。每个站点上的数据会同步复制到另一位置，并可在发生灾难故障转移时使用。</block>
  <block id="766c3ec7b91d6121d225b55cf37f9e60" category="paragraph">如果尚未创建，则必须在 SAP HANA 主机上创建 `sapsys` 组。选择一个不与存储控制器上现有组 ID 冲突的唯一组 ID 。</block>
  <block id="96affa74630cd326f32e3a646b2bf9ad" category="admonition">所有 Linux 服务器和 SVM 上的 NFSv4 域必须设置为相同的值。在文件 ` /etc/idmapd.conf` 中为 Linux 主机设置域参数 `Domain = &lt;domain_name&gt;` 。</block>
  <block id="90c5b46276106ab7121fe824091fdfde" category="paragraph">启用并启动 NFS idmapd 服务：</block>
  <block id="82d9f02aa4638adac22e7bc4604d9e25" category="admonition">最新的 Linux 内核不需要执行此步骤。您可以安全地忽略警告消息。</block>
  <block id="fe772f1f05ae8cbd39b88886e4d0fcf5" category="summary">配置网络时，请遵循以下准则。</block>
  <block id="875a868e535d44216d12214375a99823" category="list-text">在 VMware 设置中，必须为每个正在运行的虚拟机分配专用 VMXNET3 网络适配器。查看中提及的相关文章 <block ref="d760bbf7570648527297b475f5b883a1" category="inline-link-macro-rx"></block> 以满足更多要求。</block>
  <block id="716afef9353a2aa423b9fbffb89b8377" category="paragraph">在存储层，配置了四个活动连接，可为每个 SAP HANA 主机提供 10 Gb 吞吐量。此外，还会在每个存储控制器上配置一个备用接口。</block>
  <block id="620672771873ad77b081be6daf96e1b2" category="paragraph">通常，也可以在服务器（绑定）和存储系统（例如链路聚合控制协议（ Link Aggregation Control Protocol ， LACP ）和 ifgroups ）上使用 HA 接口组。使用 HA 接口组，验证负载是否在组内的所有接口之间平均分布。负载分布取决于网络交换机基础架构的功能。</block>
  <block id="eabdde73a31467e22fe277441a349672" category="admonition">根据 SAP HANA 主机的数量和使用的连接速度，需要不同数量的活动物理端口。</block>
  <block id="f462972ec98ad35d3b6e515013a43ef9" category="paragraph">由于 SAP HANA 实例的所有数据（包括数据库的性能关键型数据和日志卷）均通过此解决方案中的 NFS 提供，因此正确的网络设计和配置至关重要。专用存储网络用于将 NFS 流量与 SAP HANA 节点之间的通信和用户访问流量分开。每个 SAP HANA 节点都需要一个冗余专用网络连接，带宽至少为 10 Gb 。此外，还支持更高的带宽。此网络必须通过网络交换和计算从存储层端扩展到端，直到 VMware vSphere 上托管的子操作系统为止。除了物理交换基础架构之外，还可以使用 VMware 分布式交换机（ VDS ）在虚拟机管理程序层为网络流量提供足够的性能和易管理性。</block>
  <block id="df3398ff3a0d523a63128a7ec386096f" category="paragraph">下图提供了网络概述。</block>
  <block id="25c6d04f8538068cb7dacb7934148082" category="paragraph">每个 SAP HANA 节点都会在 VMware 分布式交换机上使用一个专用端口组。通过此端口组，可以在 ESX 主机上增强服务质量（ QoS ）并专用分配物理网络接口卡（ NIC ）。要在发生 NIC 故障时使用专用物理 NIC 并保留 HA 功能，专用物理 NIC 将配置为活动上行链路。其他 NIC 会在 SAP HANA 端口组的绑定和故障转移设置中配置为备用上行链路。此外，物理和虚拟交换机上必须端到端启用巨型帧（ MTU 9 ， 000 ）。此外，关闭服务器，交换机和存储系统上用于存储流量的所有以太网端口上的流量控制。下图显示了此类配置的一个示例。</block>
  <block id="fe7a2cce203f9009f4435ee3db743d2f" category="summary">默认情况下， SAP HANA 在每个 SAP HANA 服务中仅使用一个数据卷。由于文件系统的最大文件大小限制， NetApp 建议限制最大数据卷大小。</block>
  <block id="a28520e00868027d025d2aaa3bdcc208" category="paragraph">这将在达到 8 ， 000 GB 限制后创建一个新的数据卷。<block ref="0d7b59f229b453865b91c5e952a7b217" category="inline-link-rx"></block> 提供了更多信息。</block>
  <block id="ae36d6b58fffa77bdfe0d08c2e56cf30" category="summary">从 SAP HANA 2.0 SPS4 开始，可以配置其他数据卷分区。通过此功能，您可以为 SAP HANA 租户数据库的数据卷配置两个或更多 LUN ，并可扩展到超出单个 LUN 的大小和性能限制。</block>
  <block id="347050b0ee6af8facb503abbf8ce92c2" category="doc">为 SAP HANA 单主机系统添加其他数据卷分区</block>
  <block id="b843f6375afb3db0cfb7caa278c6cde4" category="admonition">无需使用多个分区来实现 SAP HANA KPI 。具有单个分区的单个 LUN 可满足所需的 KPI 。</block>
  <block id="ac2de546fdfde82672b56ccdf9ca6d81" category="admonition">仅 SAP HANA 单主机系统可以为数据卷使用两个或更多个单独的 LUN 。SAP HANA 多主机系统所需的 SAP 存储连接器仅支持数据卷使用一个设备。</block>
  <block id="58c9cbe15952cf82eac3f861da23b041" category="paragraph">您可以随时添加更多数据卷分区，但可能需要重新启动 SAP HANA 数据库。</block>
  <block id="c18741487d69f1af9206f4577e19dbc1" category="paragraph">要启用其他数据卷分区，请完成以下步骤：</block>
  <block id="b35b93682ba2c90dfcdb9d223fe9a37f" category="list-text">在 `global.ini` 文件中添加以下条目：</block>
  <block id="f6a6e9954258aa0392a80c08caf1ff27" category="list-text">重新启动数据库以启用此功能。使用 SYSTEMDB 配置通过 SAP HANA Studio 将参数添加到 `global.ini` 文件中可阻止重新启动数据库。</block>
  <block id="1696d347b6aa4302eae1d97bae40de76" category="section-title">卷和 LUN 配置</block>
  <block id="5ffce73a813932a4b86f329f6b66a796" category="paragraph">卷和 LUN 的布局与具有一个数据卷分区的单个主机的布局类似，但附加数据卷和 LUN 作为日志卷存储在另一个聚合上，而另一个数据卷则存储在另一个聚合上。下表显示了具有两个数据卷分区的 SAP HANA 单主机系统的配置示例。</block>
  <block id="c9ed70b94b01f7131a326f6bae3eff65" category="paragraph">下表显示了具有两个数据卷分区的单主机系统的挂载点配置示例。</block>
  <block id="b26e74ed6e2892c7e2bb95e414d460c6" category="cell">LUN</block>
  <block id="649c9030e92d8cd4b009650fea137825" category="cell">已使用 /etc/fstab 条目挂载</block>
  <block id="72097bd4370b0b19d48c67e981158544" category="paragraph">使用 ONTAP 系统管理器或 ONTAP 命令行界面创建新的数据 LUN 。</block>
  <block id="8c74ac3f77233a64ddd5171869c51c2a" category="paragraph">要配置主机，请完成以下步骤：</block>
  <block id="d9fec5dcb66d8fefe671f1719e1ee97d" category="list-text">为其他 LUN 配置多路径，如第 0 节所述。</block>
  <block id="a81a698c2f4b08044a08db7d32e1af81" category="list-text">在属于 HANA 系统的每个附加 LUN 上创建 XFS 文件系统。</block>
  <block id="f255815987a5727cdc75e965673dc603" category="list-text">将其他文件系统添加到 ` /etc/fstab` 配置文件中。</block>
  <block id="ab129d4dcc57fb1586e0730518f15ee9" category="admonition">必须使用 `relatime` 和 `inode64` 挂载选项挂载数据 LUN 的 XFS 文件系统。日志 LUN 的 XFS 文件系统必须使用 `relatime` ， `inode64` 和 `nodarrier` 挂载选项进行挂载。</block>
  <block id="88717870e2f46492c2e9147aafeac98f" category="list-text">创建挂载点并在数据库主机上设置权限。</block>
  <block id="beb45bc6e1a41c7a0a9e399cd74843b5" category="section-title">添加额外的数据卷分区</block>
  <block id="07a78873f27afab791279f5d19e3f88c" category="paragraph">要向租户数据库添加额外的数据卷分区，请完成以下步骤：</block>
  <block id="9b76b6c583544a2f5372da2ae89b54d5" category="list-text">对租户数据库执行以下 SQL 语句。每个附加 LUN 可以具有不同的路径。</block>
  <block id="a1f3bfe21fa4a014b71cdb6f5c22ed48" category="summary">NetApp FAS 产品系列已通过认证，可在定制数据中心集成（ TDI ）项目中与 SAP HANA 结合使用。经过认证的企业级存储系统采用 NetApp ONTAP 软件的特征。</block>
  <block id="3ba2c0f2dd07fd36730e20b6bcba3d0a" category="paragraph">此认证目前仅适用于以下型号：</block>
  <block id="ae9c01e101eba86b0e6ff092df062fae" category="inline-link">经过认证并受支持的 SAP HANA 硬件目录</block>
  <block id="134a6ecca2c7d98e325ad00ee461d25a" category="admonition">要为 SAP HANA 实现所需的 SAP HANA KPI 和最佳性能，必须采用本文所述的配置。更改任何设置或使用本文未列出的功能可能会导致发生原因性能下降或出现意外行为，只有在 NetApp 支持人员建议的情况下，才应执行此操作。</block>
  <block id="c79fca4f33a4c23e62509e315c7a3415" category="paragraph">有关使用 FCP 的 NetApp FAS 系统以及使用 NFS 或 FC 的 AFF 系统的配置指南，请访问以下链接：</block>
  <block id="90a239e164a24bfe58142290491d6a2c" category="paragraph">对于不具有主机自动故障转移功能的 SAP HANA 单主机系统或多个主机，支持 NFSv3 和 NFSv4 。</block>
  <block id="97e382ecf7e6f1064476764cbcc5b429" category="cell">NFS 版本</block>
  <block id="63bed36f11f7ad7653116b5a06c528d7" category="cell">NFS 锁定</block>
  <block id="1aa0b40b5a76a1d683cb73122ad91018" category="cell">SAP HANA HA/DR 提供程序</block>
  <block id="1d753a89bf8a361dbe3f6356d640806b" category="cell">SAP HANA 多个主机，具有主机自动故障转移功能</block>
  <block id="6b576fbe1d4469d95e2d87dc73f75226" category="inline-link">SAP 注释 2235581 ： SAP HANA 支持的操作系统</block>
  <block id="9321b95e47f982056a8fbe2dbfe57bc0" category="admonition">有关操作系统配置准则和特定于 HANA 的 Linux 内核依赖关系，请始终参考相关 SAP 注释。有关详细信息，请参见<block ref="731cf6347f8c9e1ff069ebd907984a5f" category="inline-link-rx"></block>。</block>
  <block id="fdb63fa26dfca812f4f453ca18a829c7" category="section-title">SAP HANA 量身定制的数据中心集成</block>
  <block id="c2798d82f6c464fd30d247919005bc5b" category="paragraph">NetApp FAS 存储控制器已通过 SAP HANA TDI 计划的认证，并同时使用 NFS （ NAS ）和 FC （ SAN ）协议。它们可以部署在任何当前 SAP HANA 方案中，例如采用单主机或多主机配置的基于 HANA 的 SAP Business Suite ， S/4HANA ， BB/4HANA 或基于 HANA 的 SAP Business Warehouse 。任何经认证可与 SAP HANA 结合使用的服务器均可与 NetApp 认证的存储解决方案结合使用。有关架构概述，请参见下图。</block>
  <block id="cd67947f6f1984974a5e507afaa2222d" category="paragraph">可以通过多种方法将存储连接到虚拟机（ VM ）。首选方法是，将具有 NFS 的存储卷直接从子操作系统中连接起来。使用此选项时，物理主机和 VM 之间的主机和存储配置不会有所不同。</block>
  <block id="a3bc23f60d8778684d75db7b4d688fae" category="summary">本节介绍 NetApp 存储系统的配置。您必须根据相应的 Data ONTAP 设置和配置指南完成主安装和设置。</block>
  <block id="429f30a2f19f5542c01260900f1268d8" category="paragraph">QoS 可用于限制共享控制器上特定 SAP HANA 系统或非 SAP 应用程序的存储吞吐量。其中一个使用情形是，限制开发和测试系统的吞吐量，使其不会影响混合环境中的生产系统。</block>
  <block id="dc8101343408623d860369896b9691df" category="paragraph">您可以在 FabricPool 或 SnapMirror 目标等备份目标上使用仅 Snapshot 分层策略和 SnapVault 。</block>
  <block id="0b70acc9e842036e1675b7fd08e43ff6" category="admonition">使用 FabricPool 在主存储上分层 Snapshot 副本或在备份目标上使用 FabricPool 会更改还原和恢复数据库或执行其他任务（例如创建系统克隆或修复系统）所需的时间。在规划整个生命周期管理策略时，请考虑此因素，并检查以确保在使用此功能时仍符合 SLA 。</block>
  <block id="2ac3f8b0b798078f242ae9b0249081bc" category="paragraph">FabricPool 是将日志备份移动到另一存储层的理想选择。移动备份会影响恢复 SAP HANA 数据库所需的时间。因此，选项 `tiering-minimum-cooling-days` 应设置为一个值，用于在本地快速存储层上放置恢复所需的日志备份。</block>
  <block id="d25223f4065ca21361aff2e7cdc61203" category="section-title">配置存储</block>
  <block id="c2cd71459709a9b877c06b5e5f772f9d" category="paragraph">以下概述总结了所需的存储配置步骤。后续章节将更详细地介绍每个步骤。在本节中，我们假定已设置存储硬件，并且已安装 ONTAP 软件。此外，必须已将存储 FCP 端口连接到 SAN 网络结构。</block>
  <block id="5130b49486508cbe5c2d0b023d415091" category="list-text">检查磁盘架配置是否正确，如 "<block ref="039cb3f1d3f19b24b2d3e1a57595e88d" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="5ed0e891e8b990c7168739eb02edd6a3" category="list-text">创建并配置所需的聚合，如 "<block ref="19f0aba2b822910f53ba3966ee7c8d59" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="f9a28c46fbd1f4dfd78367e2b160714f" category="list-text">创建 Storage Virtual Machine （ SVM ），如 "<block ref="7c58f6887f41bcea1635c2c18a7a4529" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="9629532b191c2dfd3156fe8e116bbe3b" category="list-text">创建逻辑接口（ LIF ），如 "<block ref="fc903155b67a1626f9032f79a26da71f" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="2630ee9d2d6404a0be197b5cefef0514" category="section-title">SAS-based 磁盘架</block>
  <block id="dd253c07b5e479b9a57c4dff19990513" category="section-title">基于 NVMe （ 100GbE ）的磁盘架</block>
  <block id="9edbcb82e27829dd83ad8ddf87b121c5" category="paragraph">如果在创建新 SVM 时自动创建和分配了 QoS 配置文件，请从 SVM 中删除此自动创建的配置文件，以确保 SAP HANA 具有所需的性能：</block>
  <block id="5d32d4572d40717acaf8b9ef008f4901" category="paragraph">在存储集群配置中，必须创建一个网络接口（ LIF ）并将其分配给一个专用 FCP 端口。例如，如果出于性能原因需要四个 FCP 端口，则必须创建四个 LIF 。下图显示了在 `HANA` SVM 上配置的八个 LIF （名为 `fc_*` ）的屏幕截图。</block>
  <block id="3dc0bb550ffeb410b2cbe908abda2020" category="section-title">SAP HANA 单主机系统的卷和 LUN 配置</block>
  <block id="2cd30dd459c96f8423572cfd0315dd72" category="paragraph">下图显示了四个单主机 SAP HANA 系统的卷配置。每个 SAP HANA 系统的数据卷和日志卷会分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID1_data_mnt00001` ，在控制器 B 上配置了卷 `SID1_log_mnt00001`在每个卷中，会配置一个 LUN 。</block>
  <block id="a2ab47e506561509501f3015dfd353bb" category="admonition">如果 SAP HANA 系统仅使用 HA 对中的一个存储控制器，则数据卷和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="4a6aff734b6925db0b295309b406bb09" category="paragraph">对于每个 SAP HANA 主机，都会为 ` 或 HANA 或 Shared` 配置一个数据卷，一个日志卷和一个卷。下表显示了一个使用四个 SAP HANA 单主机系统的配置示例。</block>
  <block id="bf2694976353bf0fd87866d930f0f42d" category="paragraph">下表显示了单主机系统的挂载点配置示例。</block>
  <block id="aaef8ff6bbc08e9efaddebd078c4777c" category="cell">SID1_data_mnt00001</block>
  <block id="6ae93bb41469fd4a9d5c05c492392242" category="cell">/ha/data/SID1/mnt00001</block>
  <block id="eedd0dd4abbe982364bb7aa4dc29237b" category="cell">SID1_LOG_mnt00001</block>
  <block id="867844c1d35f4b67a56a71e776d4a8ad" category="cell">/ha/log/SID1/mnt00001</block>
  <block id="ab07e4bbf6e507a26a731683320de6e3" category="cell">SID1_shared</block>
  <block id="d8ee68f6803fad6b40fde1bf30891d5c" category="cell">/has/shared/SID1</block>
  <block id="f26f6073b7776e8f86f6bf13d02a97ca" category="admonition">按照所述配置，存储用户 SID1adm 默认主目录的 ` /usr/sap/SID1` 目录位于本地磁盘上。在采用基于磁盘的复制的灾难恢复设置中， NetApp 建议在 `SID1_shared` 卷中为 ` /usr/sap/sid1` 目录创建一个额外的 LUN ，以便所有文件系统都位于中央存储上。</block>
  <block id="8d4e658f528a31efe4237fe11774716f" category="section-title">使用 Linux LVM 为 SAP HANA 单主机系统配置卷和 LUN</block>
  <block id="4f2eb711021dab33e5ff7c3395979045" category="paragraph">Linux LVM 可用于提高性能并解决 LUN 大小限制。LVM 卷组中的不同 LUN 应存储在不同的聚合和不同的控制器中。下表显示了每个卷组两个 LUN 的示例。</block>
  <block id="bf2b73e5a1069f54823f3690829c44f7" category="admonition">无需将 LVM 与多个 LUN 结合使用即可实现 SAP HANA KPI 。单个 LUN 设置可满足所需的 KPI 要求。</block>
  <block id="50c8a736d0d7665eb46c9696d32e54b3" category="cell">基于 LVM 的系统的数据，日志和共享卷</block>
  <block id="e419668a145069bd5df27d1d94e5bf5a" category="cell">共享卷： SID1_shared log2 卷： SID1_log2_mnt00001</block>
  <block id="c5a46bab63449b2e1afaed056128e704" category="cell">Data2 卷： SID1_data2_mnt00001</block>
  <block id="f077106d32b9bc50fe9eeac1cd3d7c18" category="paragraph">在 SAP HANA 主机上，需要创建和挂载卷组和逻辑卷，如下表所示。</block>
  <block id="20c772a627871f53550c990cac40e436" category="cell">逻辑卷 /LUN</block>
  <block id="4dbf191e4ed6b7c6ecc5f37903313222" category="cell">LV ： SID1_data_mnt0000-vol</block>
  <block id="45cf28b4bb0bed9fa061ae20911813ad" category="cell">LV ： SID1_LOG_mnt00001-vol</block>
  <block id="0a0eb6344c43262455dfef7dd783c9a2" category="cell">LUN ： SID1_shared</block>
  <block id="b25b558581b55b9f2fe2ef166b8c7153" category="section-title">SAP HANA 多主机系统的卷和 LUN 配置</block>
  <block id="6b7ff1a28666a16440c8c6ea6637d7a5" category="paragraph">下图显示了 4+1 多主机 SAP HANA 系统的卷配置。每个 SAP HANA 主机的数据卷和日志卷会分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID_data_mnt00001` ，在控制器 B 上配置了卷 `SID_log_mnt00001`每个卷都配置了一个 LUN 。</block>
  <block id="159562ba9c8d36ce5afba352e4de35a9" category="paragraph">所有 HANA 主机都必须能够访问 ` /HANA / 共享` 卷，因此可以使用 NFS 导出此卷。即使对于 ` /ha/shared` 文件系统没有特定的性能 KPI ， NetApp 建议使用 10 Gb 以太网连接。</block>
  <block id="11862afda87479323583a609effa0913" category="admonition">如果 SAP HANA 系统仅使用 HA 对中的一个存储控制器，则数据和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="453b8497395d5bbd79a0c8e798f0c9cc" category="admonition">NetApp ASA AFF 系统不支持 NFS 协议。NetApp 建议为 ` /ha/shared` 文件系统使用额外的 AFF 或 FAS 系统。</block>
  <block id="f4674e3b297184ff65e01cfe3e66e78c" category="paragraph">对于每个 SAP HANA 主机，系统会创建一个数据卷和一个日志卷。` HANA 系统的所有主机都使用` /hana / 共享 卷。下表显示了 4+1 多主机 SAP HANA 系统的配置示例。</block>
  <block id="8bb34960315f3235a2496b26df78d447" category="paragraph">下表显示了具有四个活动 SAP HANA 主机的多主机系统的配置和挂载点。</block>
  <block id="18eff1c18c750a16e21791332618bb66" category="cell">LUN 或卷</block>
  <block id="0afec29b8027d3f045fedf178d620337" category="cell">LUN ： SID_data_mnt00001</block>
  <block id="0295216fc17b8b84178853eef4b264c9" category="cell">使用存储连接器挂载</block>
  <block id="3598df8aff573874a41c3383272e1be8" category="cell">LUN ： sid_log_mnt00001</block>
  <block id="ffeef75de08f2bf3ae65edc9f2fefdd3" category="cell">LUN ： SID_data_mnt00002</block>
  <block id="5a9c6a41898da03d863b855e51215c74" category="cell">LUN ： sid_log_mnt00002</block>
  <block id="f4ea076d315fa65da2bc595e9aa84d32" category="cell">LUN ： SID_data_mnt00003</block>
  <block id="0a3a86cff137cfa7fef2f6b7347b6a19" category="cell">LUN ： sid_log_mnt00003</block>
  <block id="f946b7889ddc57388b641916a63b4fe2" category="cell">LUN ： SID_data_mnt00004</block>
  <block id="11b774b700c0644e1f4311df2fcb05be" category="cell">LUN ： sid_log_mnt00004</block>
  <block id="b7db253f6e3bac8aad3ab6a0941fb70d" category="cell">卷： sid_shared</block>
  <block id="7e81644459f05c7fe5ef716463a0b0fd" category="cell">使用 NFS 和 /etc/fstab 条目挂载在所有主机上</block>
  <block id="3e7047d2bf94461f14196805112df4f5" category="admonition">在所述配置中，存储用户 SIDadm 默认主目录的 ` /usr/sap/SID` 目录位于每个 HANA 主机的本地磁盘上。在采用基于磁盘的复制的灾难恢复设置中， NetApp 建议在 `SID_shared` 卷中为 ` /usr/sap/SID` 文件系统另外创建四个子目录，以便每个数据库主机的所有文件系统都位于中央存储上。</block>
  <block id="c054b3fc8b39c77b600c774805522378" category="section-title">使用 Linux LVM 为 SAP HANA 多主机系统配置卷和 LUN</block>
  <block id="fb98d6eb62d89d96b064be4fe17f583e" category="paragraph">Linux LVM 可用于提高性能并解决 LUN 大小限制。LVM 卷组中的不同 LUN 应存储在不同的聚合和不同的控制器中。</block>
  <block id="3ba3509b7579ef045ff4c77476c7cf11" category="admonition">无需使用 LVM 组合多个 LUN 即可实现 SAP HANA KPI 。单个 LUN 设置可满足所需的 KPI 要求。</block>
  <block id="f7be036cddf21af55fc52689e1f3055b" category="paragraph">下表显示了 2+1 SAP HANA 多主机系统中每个卷组两个 LUN 的示例。</block>
  <block id="4d9935e6cd83034a64b5ac62866a0738" category="cell">log2 卷： sid_log2_mnt00001</block>
  <block id="ce92b52ec6796984f134f3d663d31dd9" category="cell">log2 卷： sid_log2_mnt00002</block>
  <block id="120bb07a74c62db6e646c3e4c6894343" category="cell">逻辑卷（ LV ）或卷</block>
  <block id="e0aca5a9c63604d53aca20804da97330" category="cell">LV ： sid_data_mnt00001-vol</block>
  <block id="e865dd471095d94a2e4b63c8a0f33860" category="cell">LV ： sid_log_mnt00001-vol</block>
  <block id="711212cf75d514aac51d33222c3265b1" category="cell">LV ： sid_data_mnt00002-vol</block>
  <block id="57d1d1afeed57e5be9d3694589233736" category="cell">LV ： sid_log_mnt00002-vol</block>
  <block id="941ad2feba868268ee283fe1886c4440" category="paragraph">下表中列出的卷选项必须在所有 SVM 上进行验证和设置。</block>
  <block id="b9c48200eb9eba714e3c88803e97b4ce" category="section-title">创建 LUN ，卷并将 LUN 映射到启动程序组</block>
  <block id="c2e3c2f5e5887a87fcfac0e555a07a70" category="paragraph">您可以使用 NetApp ONTAP System Manager 创建存储卷和 LUN 并将其映射到服务器。</block>
  <block id="092e6a6bc4923c6cfc72d214ce390535" category="paragraph">NetApp 在 ONTAP System Manager 9.7 及更早版本中为 SAP HANA 提供了自动化应用程序向导，从而显著简化了卷和 LUN 配置过程。它会根据适用于 SAP HANA 的 NetApp 最佳实践自动创建和配置卷和 LUN 。</block>
  <block id="0c71c668e5ae926e6d75aa8bbbc09dd2" category="paragraph">使用 `sanlun` 工具，运行以下命令以获取每个 SAP HANA 主机的全球通用端口名称（ WWPN ）：</block>
  <block id="a86be254d15f1254d56b97c8755a5b77" category="admonition">`sanlun` 工具是 NetApp Host Utilities 的一部分，必须安装在每个 SAP HANA 主机上。有关详细信息，请参见 "host_setup" 一节。</block>
  <block id="8c4751bd2d7d17062a8b536388ba69bc" category="section-title">使用 CLI 创建 LUN ，卷并将 LUN 映射到启动程序组</block>
  <block id="6204c72c80408db453e7fea0b62d2e36" category="paragraph">本节显示了一个使用命令行和 ONTAP 9.8 的示例配置，该配置适用于 2+1 SAP HANA 多主机系统，其中 SID 为 FC5 ，使用 LVM ，每个 LVM 卷组具有两个 LUN ：</block>
  <block id="c48caf1c739d7975abd91d926cd56982" category="list-text">创建所有必要的卷。</block>
  <block id="8e5c1549db5f0e31853b6809f7049388" category="list-text">创建所有 LUN 。</block>
  <block id="d595b9142c1fd0d3ea19c8cd10165661" category="list-text">为属于系统 FC5 的所有服务器创建启动程序组。</block>
  <block id="f987b1e962233a1893b72bf1d65f3a21" category="list-text">将所有 LUN 映射到已创建的启动程序组。</block>
  <block id="47c97f5b5374f82578ea21329859f8cb" category="summary">只有具有故障转移功能的多主机环境才需要存储连接器。</block>
  <block id="7a22a81622f7d339ee9037f01614a95e" category="paragraph">在采用 NetApp 存储的 SAP HANA 多主机配置中，使用 SAP 提供的标准存储连接器。《 SAP HANA FC 存储连接器管理指南》可作为的附件找到<block ref="fb03c315acf5bdf850546480c01e7306" category="inline-link-rx"></block>。</block>
  <block id="0d3eab0b9e96ff06837e191b39218d16" category="paragraph">不支持在 HDD 配置中启用存储效率功能。</block>
  <block id="e2a82c831a3a4651879482e858053e83" category="paragraph">QoS 可用于限制特定 SAP HANA 系统的存储吞吐量。其中一个使用情形是，限制开发和测试系统的吞吐量，使其不会影响混合环境中的生产系统。</block>
  <block id="6897ebb03b24bb6d57001cdf55ad2d30" category="paragraph">在规模估算过程中，必须确定非生产系统的性能要求。开发和测试系统的规模可以使用较低的性能值进行调整，通常在生产系统的 20% 到 50% 范围内。</block>
  <block id="8469b8e3a88a77acf02664f233b3cb72" category="paragraph">从 ONTAP 9 开始， QoS 会在存储卷级别进行配置，并使用最大吞吐量值（ MBps ）和 I/O 数（ IOPS ）。</block>
  <block id="0df676e828d9cc9486e1b8e0aaf1b692" category="paragraph">可以使用 " 仅快照 " 分层策略，也可以在 SnapVault 或 SnapMirror 目标等备份目标上使用 FabricPool 。</block>
  <block id="5a5237a6a98f8795e5ef541300be3602" category="admonition">使用 FabricPool 在主存储上分层 Snapshot 副本或在备份目标上使用 FabricPool 会更改还原和恢复数据库或执行其他任务（例如创建系统克隆或修复系统）所需的时间。在规划整个生命周期管理策略时，请考虑这一点，并检查以确保在使用此功能时仍符合 SLA 要求。</block>
  <block id="562283819997e7573d7ef1bcd25f02e9" category="paragraph">以下概述总结了所需的存储配置步骤。后续章节将更详细地介绍每个步骤。在启动这些步骤之前，请完成存储硬件设置， ONTAP 软件安装以及存储 FCP 端口与 SAN 网络结构的连接。</block>
  <block id="2cb20ba4c0eb0eb9f98e21ec7aca47f3" category="list-text">检查正确的 SAS 堆栈配置，如一节所述 <block ref="7f61bd8ed95dde5d117ac18e531c2392" category="inline-link-macro-rx"></block></block>
  <block id="3e99cd10c9ef85534f3816fe698acf36" category="list-text">创建和配置所需的聚合，如一节所述 <block ref="1eb0235695db5698c097351f88f0747b" category="inline-link-macro-rx"></block></block>
  <block id="e8bb33c4475cdd668aa10b272a23134c" category="list-text">按照一节中所述创建 Storage Virtual Machine （ SVM ） <block ref="d13b32bfc05b789abfa54d62f28177c3" category="inline-link-macro-rx"></block></block>
  <block id="e8edc3c35ca6d470bb586a19c4ba2a77" category="list-text">按照一节中所述创建逻辑接口（ LIF ） <block ref="304794730509f6f33e41081c9ea9ada6" category="inline-link-macro-rx"></block></block>
  <block id="247671c13d2daa0ebab96556f7a23c0f" category="inline-link-macro">FCP 端口集。</block>
  <block id="0641e7ab6ca260dd1687ed64f731567d" category="list-text">按照一节中所述创建 FCP 端口集 <block ref="80e993b4c7204adfd3e99dcfc8b61878" category="inline-link-macro-rx"></block></block>
  <block id="eb0ef7e6e2bb01610d7af0b64d45f273" category="inline-link-macro">启动程序组。</block>
  <block id="f737bc3e8b1df8cd01c46b1f8bad3991" category="list-text">按照一节中所述，使用 HANA 服务器的全球通用名称（ WWN ）创建启动程序组（ igroup ） <block ref="3616ae8884995c0f6d38b378a7c408ce" category="inline-link-macro-rx"></block></block>
  <block id="5480184205f8be2fc64d333da844de90" category="inline-link-macro">SAP HANA 多主机系统的卷和 LUN 配置。</block>
  <block id="2c6aedb572dccc5a20423edb6df1e593" category="list-text">在聚合中创建卷和 LUN ，如一节所述 <block ref="19ba03664bebb02274f7bd74909fcde5" category="inline-link-macro-rx"></block> 和 <block ref="8ca29b6ed94f0b5f4fd7893d15f21ff7" category="inline-link-macro-rx"></block></block>
  <block id="b7483c1a479d4fef5cff97bd81ff277b" category="paragraph">使用 SSD 时，最多可以将一个磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。对于 DS224C 磁盘架，也可以使用四路径 SAS 布线，但这并不是必需的。</block>
  <block id="fbd0736dc070b8c1ab4ca37b6ff6a1c2" category="paragraph">通常，您必须为每个控制器配置两个聚合，而与使用的磁盘架或磁盘技术（ SSD 或 HDD ）无关。要使用所有可用的控制器资源，必须执行此步骤。对于 FAS 2000 系列系统，一个数据聚合就足够了。</block>
  <block id="5739a58e7053e7fb6bd6f313b759b5fd" category="paragraph">通常，每个控制器必须配置两个聚合，而与使用的磁盘架或磁盘技术（ SSD 或 HDD ）无关。对于 FAS2000 系列系统，一个数据聚合就足够了。</block>
  <block id="15780b309192b18b065fdcb3276b82b6" category="paragraph">采用 SAP HANA 数据库的多主机 SAP 环境可以使用一个 SVM 。如果需要，还可以为每个 SAP 环境分配一个 SVM ，以使其由公司内的不同团队进行管理。本文档中的屏幕截图和命令输出使用名为 `HANA` 的 SVM 。</block>
  <block id="e9fc49c5c730458783a8ccd4b98a94c5" category="paragraph">在存储集群配置中，必须创建一个网络接口（ LIF ）并将其分配给一个专用 FCP 端口。例如，如果出于性能原因需要四个 FCP 端口，则必须创建四个 LIF 。下图显示了在 `HANA` SVM 上配置的四个 LIF （名为 `fc_* ）` 的屏幕截图。</block>
  <block id="34cf3cce20e89b361817cb8171e434a6" category="paragraph">在使用 ONTAP 9.8 System Manager 创建 SVM 期间，可以选择所有必需的物理 FCP 端口，并自动为每个物理端口创建一个 LIF 。</block>
  <block id="d5b418c423bd08ad0961e2eb57962d5a" category="paragraph">下图展示了使用 ONTAP 9.8 System Manager 创建 SVM 和 LIF 的过程。</block>
  <block id="6651fd2f7a600a31e0103b2ff23752ca" category="section-title">启动程序组</block>
  <block id="517f95ae0c03c21432632bd009cdff0d" category="paragraph">可以为每个服务器或需要访问 LUN 的一组服务器配置 igroup 。igroup 配置需要服务器的全球通用端口名称（ Worldwide Port Name ， WWPN ）。</block>
  <block id="3f87e8b9731d5a43155ef27ca0b567af" category="paragraph">使用 `sanlun` 工具，运行以下命令以获取每个 SAP HANA 主机的 WWPN ：</block>
  <block id="bc7b122f8c7d1a7a700fe37744267ae2" category="inline-link-macro">主机设置。</block>
  <block id="64a7d37bc5bbadc99e0094b3d4046ae2" category="admonition">`sanlun` 工具是 NetApp Host Utilities 的一部分，必须安装在每个 SAP HANA 主机上。有关更多详细信息，请参见第节 <block ref="0b358a640d1236c691cca4bd6fb10205" category="inline-link-macro-rx"></block></block>
  <block id="0cac098cb7f23089be44b592277de000" category="paragraph">下图显示了 SS3_HANA 的启动程序列表。igroup 包含服务器的所有 WWPN ，并分配给存储控制器的端口集。</block>
  <block id="4ca4e2a0d4e5c589a8ad70a95925a37a" category="paragraph">下图显示了四个单主机 SAP HANA 系统的卷配置。每个 SAP HANA 系统的数据卷和日志卷会分布到不同的存储控制器。例如 `d，在 `m 控制器 A 上配置了卷 `SID1` _tata` _nt00001 `，在 `m 控制器 B 上配置了卷 `SID1` _`log` _nt00001`在每个卷中，会配置一个 LUN 。</block>
  <block id="2c8d2683acd00fc6b7bdbecbc4077a74" category="admonition">如果 SAP HANA 系统仅使用高可用性（ HA ）对中的一个存储控制器，则数据卷和日志卷也可以存储在同一个存储控制器上。</block>
  <block id="7a1a0bd259dd739b7d810124fe9f4440" category="paragraph">下表显示了单主机系统的挂载点配置示例。</block>
  <block id="05ba29e62de470cece1f33d7d960bebc" category="admonition">按照所述配置，存储用户 SID1adm 默认主目录的 ` /usr/sap/SID1` 目录位于本地磁盘上。在采用基于磁盘的复制的灾难恢复设置 `s中， NetApp 建议在 `SID1` _sbr hared `卷中为 ` /usr/sap/sid1` 目录创建一个额外的 LUN ，以便所有文件系统都位于中央存储上。</block>
  <block id="414644d9944d8acf448d00964757d116" category="admonition">无需将 LVM 与多个 LUN 结合使用即可实现 SAP HANA KPI 。单个 LUN 设置可满足所需的 KPI 要求。</block>
  <block id="6ca08fbeb2f69e5ac6d7d31de1c0d50e" category="paragraph">必须在 SAP HANA 主机上创建和挂载卷组和逻辑卷。下表列出了使用 LVM 的单主机系统的挂载点。</block>
  <block id="b63455a0893e3fe36b2f2d95447d0b75" category="paragraph">下图显示了 4+1 多主机 SAP HANA 系统的卷配置。每个 SAP HANA 主机的数据卷和日志卷会分布到不同的存储控制器。例如，在控制器 A 上配置了卷 `SID` `d` ata `m _nt00001` ，在 `m 控制器 B 上配置了卷 `SID` _`log` _nt00001`每个卷都配置了一个 LUN 。</block>
  <block id="ebcead3815b9e992a87a9c31a4be99fe" category="paragraph">对于每个 SAP HANA 主机，系统会创建一个数据卷和一个日志卷。` HANA 系统的所有主机都使用` /hana / 共享 卷。下图显示了 4+1 多主机 SAP HANA 系统的配置示例。</block>
  <block id="47efb02d47f9965ca8839f52ecc182bc" category="paragraph">下表显示了具有四个活动 SAP HANA 主机的多主机系统的配置和挂载点。</block>
  <block id="415dc524f4e8d720ce545c8d6263459c" category="cell">LUN 或卷</block>
  <block id="db7586f46a08d4a865d9fcc187eccdc6" category="admonition">在所述配置中，存储用户 SIDadm 默认主目录的 ` /usr/sap/SID` 目录位于每个 HANA 主机的本地磁盘上。在采用基于磁盘的复制的灾难恢复设置 `s中， NetApp 建议在 `SID` _sap hared` 卷中为 ` /usr/sap/SID` 文件系统另外创建四个子目录，以便每个数据库主机的所有文件系统都位于中央存储上。</block>
  <block id="ea15b968cdc22cb1b865eba6daa0eae0" category="paragraph">Linux LVM 可用于提高性能并解决 LUN 大小限制。LVM 卷组中的不同 LUN 应存储在不同的聚合和不同的控制器中。下表显示了 2+1 SAP HANA 多主机系统中每个卷组两个 LUN 的示例。</block>
  <block id="7e819a8bd73b862fc9b80deb044fa7da" category="admonition">无需使用 LVM 组合多个 LUN 即可实现 SAP HANA KPI 。单个 LUN 设置可满足所需的 KPI 要求。</block>
  <block id="70993f32e0c2ae5000f9a5a9cbf641e4" category="paragraph">在 SAP HANA 主机上，需要创建和挂载卷组和逻辑卷：</block>
  <block id="df6802a99a754c5978954aef9c7f4784" category="admonition">在所述配置中，存储用户 SIDadm 默认主目录的 ` /usr/sap/SID` 目录位于每个 HANA 主机的本地磁盘上。在采用基于磁盘的复制的灾难恢复设置 `s中， NetApp 建议在 `SID` _sap hared` 卷中为 ` /usr/sap/SID` 文件系统另外创建四个子目录，以便每个数据库主机的所有文件系统都位于中央存储上。</block>
  <block id="203165a49e3a391bdbc44e3a05d54279" category="cell">ONTAP 9.</block>
  <block id="f0f3c94fb860d8ed677a7fd92098c982" category="paragraph">您可以使用 NetApp OnCommand 系统管理器创建存储卷和 LUN 并将其映射到服务器的 igroup 。</block>
  <block id="628f62b19dac88e4e877b52b00325d1c" category="paragraph">以下步骤显示了使用 SID SS3 配置 2+1 多主机 HANA 系统的情况。</block>
  <block id="99576f0b50cbef6a3dc3e755211ba4df" category="list-text">在 NetApp ONTAP 系统管理器中启动创建 LUN 向导。</block>
  <block id="cc3bbd3870b19b5988056892345656f8" category="list-text">输入 LUN 名称，选择 LUN 类型，然后输入 LUN 的大小。</block>
  <block id="19cca4c2caf04d464b286b57631c5cf3" category="list-text">输入卷名称和托管聚合。</block>
  <block id="3e7bbfdb3982e2648add19277beb4be0" category="list-text">选择 LUN 应映射到的 igroup 。</block>
  <block id="f78e3cdb43aaa763020ac7b127b79352" category="list-text">提供 QoS 设置。</block>
  <block id="59cd39f269f7e809ddc94cf9eb25d4fc" category="list-text">单击摘要页面上的下一步。</block>
  <block id="de93591f8d085ca64b0997731f1a32d8" category="list-text">单击完成页面上的完成。</block>
  <block id="1f0d5a0003e2a9d29d9bdbdb42528453" category="list-text">对每个 LUN 重复步骤 2 到 7 。</block>
  <block id="a0e202053c694786bc442dd83a386ff7" category="paragraph">下图显示了 2+1 多主机设置需要创建的所有 LUN 的摘要。</block>
  <block id="77656454768235b0e1954805bd92d9c9" category="section-title">使用 CLI 创建 LUN ，卷并将 LUN 映射到 igroup</block>
  <block id="90242878213f2eef96eb3fcc1d8e3ad6" category="paragraph">本节显示了一个使用命令行和 ONTAP 9.8 的示例配置，该配置适用于 2+1 SAP HANA 多主机系统，其中 SID 为 FC5 ，使用 LVM ，每个 LVM 卷组具有两个 LUN 。</block>
  <block id="d21a66a2fd717a4acd6dd449ecac4839" category="list-text">为属于系统 FC5 的所有服务器创建 igroup 。</block>
  <block id="3a630997b07207edb38c5c79a4f7d867" category="list-text">将所有 LUN 映射到创建的 igroup 。</block>
  <block id="60a5608aa352e15e7648da1d39cb299b" category="paragraph">对于 SAP HANA 1.0 - SPS12 ，可以在安装 SAP HANA 数据库期间设置这些参数，如 SAP 注释中所述<block ref="c391dcebb4d33a6a0f840983455654bf" category="inline-link-rx"></block>。</block>
  <block id="8192071b4f7b02996ec3cdeddd07d1d8" category="paragraph">或者，也可以在安装 SAP HANA 数据库后使用 `hdbparam` framework 设置这些参数。</block>
  <block id="c0b08fa9f53bd588cf26dd04b2bf1c29" category="inline-link">2399079 —在 HANA 2 中消除了 hdbparam</block>
  <block id="25acda0af7df7e8f6aaedc308080d2f2" category="paragraph">从 SAP HANA 2.0 开始， `hdbparam` 已弃用，并且参数已移至 `global.ini` 文件。可以使用 SQL 命令或 SAP HANA Studio 设置这些参数。有关详细信息，请参见 SAP 注释<block ref="936e80e83aa8101d48722d387f096a5f" category="inline-link-rx"></block>。也可以在 `global.ini` 文件中设置这些参数。</block>
  <block id="a1dc0f5c23c4490d01718a8d6b05872e" category="paragraph">对于 SAP HANA 2.0 SPS5 及更高版本，您可以使用 `setParameter.py `s脚本设置上述参数。</block>
  <block id="2a986cf5abe7b7785ffcdece33cfc433" category="admonition">无需使用多个分区来实现 SAP HANA KPI 。具有单个分区的单个 LUN 可满足所需的 KPI 。</block>
  <block id="e7e3db35c66fbc08aba59377e767d66f" category="paragraph">可以随时添加其他数据卷分区，但可能需要重新启动 SAP HANA 数据库。</block>
  <block id="0da243913a454541b5b0036cfd8f8135" category="list-text">在 `global.ini` 文件中添加以下条目。</block>
  <block id="2b304fd148da024e97f54db599c2f521" category="paragraph">卷和 LUN 的布局与单个主机的布局类似，该主机具有一个数据卷分区，但另有一个数据卷和 LUN 存储在与日志卷和另一个数据卷不同的聚合上。下表显示了具有两个数据卷分区的 SAP HANA 单主机系统的配置示例。</block>
  <block id="d7021f52f260e11c8c2dd980991f38ae" category="paragraph">使用 ONTAP 系统管理器或 ONTAP 命令行界面创建新的数据 LUN 。</block>
  <block id="5bcb0bf87ac10e193de11e3c3c8eb488" category="list-text">为其他 LUN 配置多路径，如第 0 章所述。</block>
  <block id="572b2316d0cecf8ccd134b71ee2fce66" category="list-text">在属于 HANA 系统的每个附加 LUN 上创建 XFS 文件系统：</block>
  <block id="23c80196123eb12634dbeb70874872fe" category="list-text">在数据库主机上创建挂载点并设置权限。</block>
  <block id="ab876b2fc77b49d4799c8317c49e7fdc" category="list-text">挂载文件系统，运行 `mount – a` 命令。</block>
  <block id="cccc40b2b949eb5631f1a7625e3bbb28" category="paragraph">要向租户数据库添加额外的数据卷分区，请对租户数据库执行以下 SQL 语句。每个附加 LUN 可以具有不同的路径：</block>
  <block id="269e48a148be46c6e5fb065e74629d57" category="doc">SAP 业务应用程序和 SAP HANA 数据库解决方案</block>
  <block id="f01120deea316d303519ad5ab689a57f" category="list-text">解决方案简介</block>
  <block id="2f5f480c2cb54884152c412765dd0565" category="summary">要实施有效的灾难恢复策略，您必须测试所需的工作流。测试可证明该策略是否有效以及内部文档是否充足，同时还允许管理员对所需的程序进行培训。</block>
  <block id="1135ff8da5df72747612faee39237919" category="doc">灾难恢复测试</block>
  <block id="78c7aecd30426566c46ffded8977d5e8" category="paragraph">ANF 跨区域复制支持灾难恢复测试，而不会使 RTO 和 RPO 面临风险。可以在不中断数据复制的情况下执行灾难恢复测试。</block>
  <block id="937c6624e4ad8af35fa4c42dd6d29b86" category="inline-link">Azure NetApp Files 快照的工作原理 | Microsoft 文档</block>
  <block id="2596187dfded21d3da704d17cb465012" category="paragraph">灾难恢复测试工作流利用 ANF 功能集，根据灾难恢复目标上的现有 Snapshot 备份创建新卷。请参见<block ref="db53ffad00e09cba73a4fdfc74cb3775" category="inline-link-rx"></block>。</block>
  <block id="5cc40200131ad81d8bcd56e79458f4e9" category="paragraph">根据日志备份复制是否属于灾难恢复设置的一部分，灾难恢复的步骤略有不同。本节介绍了针对纯数据备份复制以及结合日志备份卷复制的数据卷复制进行的灾难恢复测试。</block>
  <block id="287204f88222f0f0fc17fea019460c2e" category="paragraph">要执行灾难恢复测试，请完成以下步骤：</block>
  <block id="5d15c22569bad82e3c259149418a5567" category="list-text">准备目标主机。</block>
  <block id="c47b80a6b3e3eeb1c46a9097541a0186" category="list-text">在灾难恢复站点基于 Snapshot 备份创建新卷。</block>
  <block id="3a35566accf9e51bcdeef178bd7f83e7" category="list-text">在目标主机上挂载新卷。</block>
  <block id="69a3fff9d66404b6c7c43fe548a89488" category="list-text">恢复 HANA 数据库。</block>
  <block id="63fe05915e48317fa2d299c9aa6b20e9" category="list-text">仅限数据卷恢复。</block>
  <block id="69a5087055235e78cdb882da9f585b30" category="list-text">使用复制的日志备份进行正向恢复。</block>
  <block id="c4ac05b35ef0c84121e3311d4bfceacc" category="paragraph">以下各小节详细介绍了这些步骤。</block>
  <block id="0bd9242ade1764d7b05344c462c5945f" category="summary">现在，可以根据之前创建的 /etc/fstab 文件在目标主机上挂载新卷。</block>
  <block id="0b31021246b10bf3eae6d1d87ea727ab" category="doc">在目标主机上挂载新卷</block>
  <block id="37b6bf2117a49bac550ea7fbde01cbe6" category="paragraph">现在，可以根据之前创建的 ` /etc/fstab` 文件在目标主机上挂载新卷。</block>
  <block id="a8c746bca5da7073413ffa2079797496" category="paragraph">以下输出显示了所需的文件系统。</block>
  <block id="a4d54b1dcfdae0e1a0573e950b1d490a" category="summary">在配置卷复制之前，必须在灾难恢复站点上执行几个准备步骤。</block>
  <block id="86ba0d39a4ca51b69c6fa7d6c445e674" category="doc">ANF 跨区域复制的配置步骤</block>
  <block id="b42a1bf66a549b8645aa369e72b6892a" category="list-text">NetApp 帐户必须可用，并且必须与源帐户配置相同的 Azure 订阅。</block>
  <block id="e3b7f7acd631c2ed58d549c927044283" category="list-text">必须使用上述 NetApp 帐户配置可用的容量池。</block>
  <block id="ab41f73f5c2b7b260e66bd7135be55df" category="list-text">虚拟网络必须可用并已配置。</block>
  <block id="625218459fa15c0fb1b7d5528cb91ccb" category="list-text">在虚拟网络中，必须有一个委派子网可用，并将其配置为可用于 ANF 。</block>
  <block id="458d95f9ec4fff8dd9312e51b3c2a7fb" category="paragraph">现在，可以为 HANA 数据， HANA 共享卷和 HANA 日志备份卷创建保护卷。下表显示了我们实验室设置中配置的目标卷。</block>
  <block id="d6b016ece56ccaef1fd3fcd56391468c" category="admonition">为了实现最佳延迟，在发生灾难故障转移时，必须将卷放置在靠近运行 SAP HANA 的 VM 的位置。因此， DR 卷需要与任何其他 SAP HANA 生产系统相同的固定过程。</block>
  <block id="449a0fc6c7996b28a64846e892cd6926" category="cell">HANA 卷</block>
  <block id="f31bbdd1b3e85bccd652680e16935819" category="cell">源</block>
  <block id="12007e1d59f4d09c87dbe2c438256244" category="cell">目标</block>
  <block id="c17d95dc84bb02bde4b5e15d2626b9ca" category="cell">复制计划</block>
  <block id="79d64f73cfdf4a123fdce2f6c75d002b" category="cell">HANA 数据卷</block>
  <block id="26468341ce2b86a76711548bf32d5374" category="cell">PR1-data-mnt00001</block>
  <block id="dc2ff9902e7813acfb09f85544bb029e" category="cell">PR1-data-mnt00001-sm-dest</block>
  <block id="c512b685438f41daa7386329a3b8f8d3" category="cell">每天</block>
  <block id="1d57310cd0156e7d3039997b3c4fcf49" category="cell">HANA 共享卷</block>
  <block id="79b9df781b053a904e15f901469d5b15" category="cell">PR1-shared</block>
  <block id="48a9062e4add008eae1409d0f6180ff5" category="cell">PR1-shared-sm-dest</block>
  <block id="769cb50c95fd3a43c659aa73aba99e5b" category="cell">每小时</block>
  <block id="175080ca3e495fc5f25b31acc5ea2565" category="cell">HANA 日志 / 目录备份卷</block>
  <block id="043b690b7fa6b658a34cfe4eddef0f66" category="cell">哈纳巴克 up</block>
  <block id="f607dbc7c9b584df2af13aa1e3effa0a" category="cell">hanabackup-sm-dest</block>
  <block id="c2bd6dc7b8af91e4e8d66ba495a405e1" category="paragraph">对于每个卷，必须执行以下步骤：</block>
  <block id="825b53aa3215a8ff5af004871350973b" category="list-text">在灾难恢复站点创建新的保护卷：</block>
  <block id="e84a39f7b4c4e2ad94dca482db6fbc12" category="list-text">提供卷名称，容量池，配额和网络信息。</block>
  <block id="cae87a876f3a8abb3eb23f4af3e93517" category="list-text">提供协议和卷访问信息。</block>
  <block id="27c07ed9c69be3dccb35efafedd4eba8" category="list-text">提供源卷 ID 和复制计划。</block>
  <block id="e8cef5b7d1f6a0653baaed122e42e586" category="list-text">创建目标卷。</block>
  <block id="b686ca8bbff390a495e7e60451ecb210" category="list-text">在源卷上授权复制。</block>
  <block id="f81db0f887d96ce44293b99102b352a6" category="list-text">提供目标卷 ID 。</block>
  <block id="5ae1ee782233392892b749a4f5d850ce" category="paragraph">以下屏幕截图详细显示了配置步骤。</block>
  <block id="e2be47b4fb660d20573336e8663f54db" category="paragraph">在灾难恢复站点上，通过选择卷并单击添加数据复制来创建新的保护卷。在基础选项卡中，您必须提供卷名称，容量池和网络信息。</block>
  <block id="e99589f2cbac6c085c73aea3c0c28855" category="admonition">可以根据容量要求设置卷的配额，因为卷性能不会影响复制过程。如果发生灾难恢复故障转移，则必须调整配额以满足实际的性能要求。</block>
  <block id="54eafc6acb43f4d58b79a36ccfbff752" category="admonition">如果已为容量池配置手动 QoS ，则除了容量要求之外，您还可以配置吞吐量。与上述相同，您可以在正常操作期间将吞吐量配置为低值，并在发生灾难恢复故障转移时增加吞吐量。</block>
  <block id="09cc677ff6f2db7b9e0c9f462c378118" category="paragraph">在协议选项卡中，您必须提供网络协议，网络路径和导出策略。</block>
  <block id="964f72274255c85554e9bc4d2c7d3507" category="admonition">此协议必须与源卷使用的协议相同。</block>
  <block id="aff73926e77c6491902270e665038623" category="paragraph">在复制选项卡中，您必须配置源卷 ID 和复制计划。对于数据卷复制，我们为实验室设置配置了每日复制计划。</block>
  <block id="716f8c04301b81d7636c064e03f9e95a" category="admonition">可以从源卷的属性屏幕复制源卷 ID 。</block>
  <block id="f9ce4d292d3839d7942d11754c497e99" category="paragraph">最后一步是，您必须提供目标卷的 ID 来在源卷上授权复制。</block>
  <block id="588edd807dcaffd38e6d9dc085f71430" category="admonition">您可以从目标卷的属性屏幕复制目标卷 ID 。</block>
  <block id="e2a531679c8b0e87dfd7ecbf1e367682" category="paragraph">必须对 HANA 共享卷和日志备份卷执行相同的步骤。</block>
  <block id="57a1cc592fec58eb1405f0d119665eda" category="summary">本节介绍服务器上所需的准备步骤，这些步骤用于灾难恢复故障转移测试。</block>
  <block id="1805b1ce31eaa33fbab9adfcf5046164" category="doc">准备目标主机</block>
  <block id="7a4ba7d447a3ae928cd0b4b1338a8785" category="paragraph">本节介绍用于灾难恢复故障转移测试的服务器所需的准备步骤。</block>
  <block id="29349c3a78cce5cc29808cecf45b06e7" category="paragraph">在正常操作期间，目标主机通常用于其他目的，例如 HANA QA 或测试系统。因此，在执行灾难故障转移测试时，必须运行大多数这些步骤。另一方面，只需复制配置文件，即可准备相关配置文件，例如 ` /etc/fstab` 和 ` usr/sapservices` ，然后将其投入生产。灾难恢复测试操作步骤可确保正确配置准备好的相关配置文件。</block>
  <block id="48170b1147f65f7e4f0ee89771e5ff12" category="paragraph">目标主机准备工作还包括关闭 HANA QA 或测试系统，以及使用 `systemctl stop sapinit` 停止所有服务。</block>
  <block id="e90afee4e0255e92692e4dbb455fab0b" category="section-title">目标服务器主机名和 IP 地址</block>
  <block id="bb4741b9acd629bc36e0a0afe5a882b0" category="paragraph">目标服务器的主机名必须与源系统的主机名相同。IP 地址可以不同。</block>
  <block id="930aaee5905613c0fde11375bafb6008" category="admonition">必须正确隔离目标服务器，使其无法与其他系统通信。如果未设置适当的隔离，则克隆的生产系统可能会与其他生产系统交换数据，从而导致数据在逻辑上损坏。</block>
  <block id="c5d62e4cd93b13ecc40d972d26905aae" category="section-title">安装所需的软件</block>
  <block id="e6d9f482b1a3219db22a8c75173e86bf" category="inline-link">SAP 主机代理</block>
  <block id="0f64c6a225bf532d108a3a45af534297" category="paragraph">SAP 主机代理软件必须安装在目标服务器上。有关详细信息，请参见<block ref="dfb99acb3a5bfb8e56c9630a62e67a77" category="inline-link-rx"></block> 在 SAP 帮助门户上。</block>
  <block id="8c606d54e77d50b5b8be96eba8964fd9" category="admonition">如果主机用作 HANA QA 或测试系统，则已安装 SAP 主机代理软件。</block>
  <block id="7499cb244ac7c7d171d96246d84cfff2" category="section-title">配置用户，端口和 SAP 服务</block>
  <block id="f7188f776339935568f9082e226a74bf" category="paragraph">SAP HANA 数据库所需的用户和组必须在目标服务器上可用。通常使用中央用户管理；因此，不需要在目标服务器上执行任何配置步骤。必须在目标主机上配置 HANA 数据库所需的端口。可以通过将 ` /etc/services` 文件复制到目标服务器来从源系统复制配置。</block>
  <block id="e7ab0414c80c78c499518651c496b99b" category="paragraph">所需的 SAP 服务条目必须在目标主机上可用。可通过将 ` /usr/sapservices` 文件复制到目标服务器来从源系统复制配置。以下输出显示了在实验室设置中使用的 SAP HANA 数据库所需的条目。</block>
  <block id="c6f4d12bfe279cd224db1ab7d3bafeee" category="section-title">准备 HANA 日志卷</block>
  <block id="8ab1ea416a553309f101937f88feadd0" category="paragraph">由于 HANA 日志卷不是复制的一部分，因此目标主机上必须存在一个空的日志卷。日志卷必须包含与源 HANA 系统相同的子目录。</block>
  <block id="ebe6e77fe278b0c44da179596e20dc10" category="section-title">准备日志备份卷</block>
  <block id="d8c860bb68ca61783d80f8661d53179d" category="paragraph">由于源系统为 HANA 日志备份配置了一个单独的卷，因此，目标主机上也必须具有一个日志备份卷。必须在目标主机上配置并挂载用于日志备份的卷。</block>
  <block id="d38e15ac7cf20e8efaf731e3439051e7" category="paragraph">如果日志备份卷复制是灾难恢复设置的一部分，则会在目标主机上挂载基于快照的新卷，而无需准备其他日志备份卷。</block>
  <block id="991bc387262467ee7383a884e1ae528c" category="section-title">准备文件系统挂载</block>
  <block id="e760b9f68755a85c0afb655724f76716" category="paragraph">下表显示了实验室设置中使用的命名约定。灾难恢复站点上新卷的卷名称包含在 ` /etc/fstab` 中。这些卷名称将在下一节的卷创建步骤中使用。</block>
  <block id="c62201a5e4ec1f272c1c685c418cae86" category="cell">HANA PR1 卷</block>
  <block id="43e10a0fc1c9f32ec01b5567dcb26478" category="cell">灾难恢复站点上的新卷和子目录</block>
  <block id="93b8bd1267fc89b2ca2efe06e289f955" category="cell">目标主机上的挂载点</block>
  <block id="a4d45ebfbb892aaa3c0aba5e7211fea0" category="cell">数据卷</block>
  <block id="bf35244369ab029517ff319ae89cbc62" category="cell">pr1-data-mnt00001-sm-dest-clone</block>
  <block id="09e9cb8a4e8275fd4a5db4146ca1609d" category="cell">/ha/data/PR1/mnt00001</block>
  <block id="46e458e62cbb1b2e6d36191ae52d7467" category="cell">共享卷</block>
  <block id="21fe8dccc7ab9a5d0a38ed0c84bb5132" category="cell">PR1-shared-sm-dest-clone/shared PR1-shared-sm-dest-clone/user-sap-pr1</block>
  <block id="3c6826d6950803e805a42a4d006c4a77" category="cell">/has/shared /usr/sap/pr1</block>
  <block id="a38c36c25709867c8eb52bece271a213" category="cell">记录备份卷</block>
  <block id="170f75e41745b7414599fc04eb427e58" category="cell">hanabackup-sm-dest-clone</block>
  <block id="ac32f37d2501e6d25aef85bf49a3a09d" category="cell">/hanabackup</block>
  <block id="4c6241952cf0bebf817c8004f43c828f" category="admonition">必须在目标主机上创建此表中列出的挂载点。</block>
  <block id="5aa4fa30550ad8c9254246ba03f89777" category="paragraph">以下是所需的 ` /etc/fstab` 条目。</block>
  <block id="0715cc7b6d956cc1bcb7ae80046f1cda" category="summary">以下是 HANA 数据库恢复的步骤。</block>
  <block id="91511a18af650a7ce055d8ec78c57f99" category="doc">HANA 数据库恢复</block>
  <block id="7988012007cbc71947d6a647a8c8e726" category="paragraph">启动所需的 SAP 服务。</block>
  <block id="cd963b480c3cb24fbb41cb17a8d85134" category="paragraph">以下输出显示了所需的进程。</block>
  <block id="41f34e0a65027292639585b25be966d8" category="paragraph">以下各小节介绍了使用复制的日志备份进行正向恢复的恢复过程。可以使用系统数据库的 HANA 恢复脚本和租户数据库的 hdbsql. 命令执行恢复。</block>
  <block id="d6c45a48e2dacb7d6bfbf425e93935ed" category="inline-link-macro">恢复到最新的 HANA 数据卷备份 Savepoint</block>
  <block id="99974cb8c998a4d922f9111a6a600bba" category="paragraph">第章介绍了用于恢复到最新数据保存点的命令 <block ref="0be310dc1ba7e1c7766b9cbfdeb6e0df" category="inline-link-macro-rx"></block>。</block>
  <block id="5025c24ec3e0df190e43cbbe151b2633" category="section-title">使用日志备份进行正向恢复</block>
  <block id="09ee90eaa98c13b5a23451eb4bd876bc" category="paragraph">使用所有可用日志备份执行恢复时，使用以下命令作为用户 pr1adm 执行：</block>
  <block id="557c60d90ae6fa286bf7c2d4c8e08cf2" category="list-text">系统数据库</block>
  <block id="47dbd31d59cd136040f750cf889b52fd" category="list-text">租户数据库</block>
  <block id="b7d3f82143b80eb5e90acd916d55348d" category="admonition">要使用所有可用日志进行恢复，您可以在恢复语句中随时使用作为时间戳。</block>
  <block id="a4d94df5aaf94ce5a337f9770dd73652" category="paragraph">您还可以使用 HANA Studio 或 Cockpit 执行系统和租户数据库的恢复。</block>
  <block id="3b67a0f0dbbe2252de94c9cb25faa5bd" category="paragraph">以下命令输出显示了恢复执行情况。</block>
  <block id="5204ae5afd7ee53686a6f99190f93e37" category="section-title">系统数据库恢复</block>
  <block id="3973b179e7f3c7f23b37daa55f8b718c" category="section-title">租户数据库恢复</block>
  <block id="410b822ca485235d4570285ab55bd4fc" category="paragraph">如果尚未在源系统上为 pr1adm 用户创建用户存储密钥，则必须在目标系统上创建密钥。在密钥中配置的数据库用户必须具有执行租户恢复操作的权限。</block>
  <block id="b88213d578dadf0b58255002cdc3235f" category="section-title">检查最新日志备份的一致性</block>
  <block id="b855006be612f8de44edd56b1cbe599e" category="paragraph">由于日志备份卷复制是独立于 SAP HANA 数据库执行的日志备份过程执行的，因此灾难恢复站点上可能存在不一致的开放日志备份文件。只有最新的日志备份文件可能不一致，在使用 `hdbbackupcheck` 工具在灾难恢复站点执行正向恢复之前，应先检查这些文件。</block>
  <block id="2a473356118b695e14aecea6717f8038" category="paragraph">必须对系统和租户数据库的最新日志备份文件执行检查。</block>
  <block id="668fadc42f8855257306656060627f86" category="paragraph">如果 `hdbbackupcheck` 工具报告最新日志备份出错，则必须删除或删除最新的日志备份集。</block>
  <block id="81dbd9083542b5058eeff2a69b9df0f1" category="summary">有关跨区域复制的应用程序无关信息，请访问以下位置。</block>
  <block id="1cc8efad9ef8bc01d2445bfc8d04e15c" category="doc">利用 SAP HANA 实现跨区域复制</block>
  <block id="a9f4d9aafbea086205494239b45e7d8a" category="inline-link">Azure NetApp Files 文档 | Microsoft 文档</block>
  <block id="4a822cebdc9c9ffddab9b72668b15b82" category="summary">已对 SAP HANA 单主机系统执行解决方案验证。适用于 ANF 的 Microsoft AzAcSnap Snapshot 备份工具已用于配置 HANA 应用程序一致的 Snapshot 备份。</block>
  <block id="2ed67d7b0221292a52e0dad8b778413a" category="doc">实验室设置</block>
  <block id="c377a17bdb4b49ee81ed4b850d7aa82f" category="paragraph">已对 SAP HANA 单主机系统执行解决方案验证。适用于 ANF 的 Microsoft AzAcSnap Snapshot 备份工具已用于配置 HANA 应用程序一致的 Snapshot 备份。每天配置数据卷，每小时日志备份和共享卷复制。灾难恢复测试和故障转移已通过保存点以及正向恢复操作进行验证。</block>
  <block id="ee0a08337c36a2e1dc94c66920bc1c53" category="paragraph">实验室设置中使用了以下软件版本：</block>
  <block id="49821fb7d46ce72a906d5558cc7fb49c" category="list-text">一个主机 SAP HANA 2.0 SPS5 系统，一个租户</block>
  <block id="338f7cb0bac9744a3d8f0e058609d27c" category="list-text">适用于 SAP 15 SP1 的 SUSE SLES</block>
  <block id="f169231424331b8331517b539b422205" category="list-text">AzAcSnap 5.0</block>
  <block id="2f756956567b07d5ae865a7961038f49" category="paragraph">灾难恢复站点上配置了一个具有手动 QoS 的容量池。</block>
  <block id="8aa3c19ab9d67a7c99258a236498a316" category="paragraph">下图显示了实验室设置。</block>
  <block id="2ebc3727a62e108be8ad065c82185b2a" category="section-title">使用 AzAcSnap 的 Snapshot 备份配置</block>
  <block id="dea36c580776ee186f7bd3a729fdadae" category="paragraph">在主站点上， AzAcSnap 配置为为为 HANA 系统 PR1 创建应用程序一致的 Snapshot 备份。这些 Snapshot 备份可从 PR1 HANA 系统的 ANF 数据卷获得，它们也会注册到 SAP HANA 备份目录中，如以下两个图所示。计划每 4 小时执行一次 Snapshot 备份。</block>
  <block id="db9218292bb42bb03cca44310ac971c4" category="paragraph">通过使用 ANF 跨区域复制复制数据卷，这些 Snapshot 备份将复制到灾难恢复站点，并可用于恢复 HANA 数据库。</block>
  <block id="6aeab84a5441035790ad6afb0f70ebbd" category="paragraph">下图显示了 HANA 数据卷的 Snapshot 备份。</block>
  <block id="e5d963ae30a5059019279dfe93dc08fd" category="paragraph">下图显示了 SAP HANA 备份目录。</block>
  <block id="6ea9fa207b22b88f7a1b71067c28b27c" category="summary">全面的灾难恢复解决方案必须能够使客户从主站点的完全故障中恢复。</block>
  <block id="e83bab5b97dcd6d1ab9fd10e243e00a2" category="doc">灾难恢复解决方案比较</block>
  <block id="c8b28dac8aa9627eba845b258700d143" category="paragraph">全面的灾难恢复解决方案必须能够使客户从主站点的完全故障中恢复。因此，必须将数据传输到二级站点，并且在站点发生故障时，要运行所需的生产 SAP HANA 系统，需要一个完整的基础架构。根据应用程序的可用性要求以及要保护的灾难类型，必须考虑双站点或三站点灾难恢复解决方案。</block>
  <block id="efdfd61135978b48927ebefc9a85bac0" category="paragraph">下图显示了一种典型配置，其中数据会在同一 Azure 区域内同步复制到另一个可用性区域。短距离允许您同步复制数据，以实现零 RPO （通常用于提供 HA ）。</block>
  <block id="6b38154114f7c1d2f1f851414e66cdb5" category="paragraph">此外，当主区域受到影响时，还会将数据异步复制到二级区域，以防止发生灾难。可实现的最小 RPO 取决于数据复制频率，该频率受主区域和二级区域之间可用带宽的限制。典型的最小 RPO 介于 20 分钟到多小时之间。</block>
  <block id="08c05e932772c12e2978ada46a1f6fde" category="paragraph">本文档讨论了双区域灾难恢复解决方案的不同实施选项。</block>
  <block id="66ae478deb0faaf5c7e1c6c30e561515" category="section-title">SAP HANA 系统复制</block>
  <block id="aeea0de8341a54a856110ddcce703647" category="paragraph">SAP HANA 系统复制在数据库层运行。解决方案基于灾难恢复站点上的另一个 SAP HANA 系统，该系统可从主系统接收更改。此二级系统必须与主系统相同。</block>
  <block id="ef484be15551dd90fef91c2c2e1282f1" category="paragraph">SAP HANA 系统复制可在以下两种模式之一下运行：</block>
  <block id="d6c8e17e761081d42a482d42d4f77766" category="list-text">将数据预加载到内存中，并在灾难恢复站点上配置一个专用服务器：</block>
  <block id="f5c7666e551b7dcd0fb7f6bf74abeccb" category="list-text">此服务器专用于 SAP HANA 系统复制二级主机。</block>
  <block id="ffc1f03746fb6cf99cdec6f3abc213eb" category="list-text">可以实现极低的 RTO 值，因为数据已加载到内存中，在发生故障转移时不需要启动数据库。</block>
  <block id="a3ebd8ee4ae26bbbfa2ea01be47e0a0d" category="list-text">在灾难恢复站点的内存和共享服务器中未预加载数据的情况下：</block>
  <block id="477f056d84ccdedcc2b8da7c0fe2f21e" category="list-text">此服务器作为 SAP HANA System Replication 二级系统和开发 / 测试系统共享。</block>
  <block id="1f15430c22b1c4d0b83cbf3df1b2e9f4" category="list-text">RTO 主要取决于启动数据库并将数据加载到内存所需的时间。</block>
  <block id="0dbe2efb71acfabc184da717728493bc" category="inline-link">《 SAP HANA 管理指南》</block>
  <block id="24fc91edc6ddc9820730d1097931adb5" category="paragraph">有关所有配置选项和复制场景的完整问题描述，请参见<block ref="9cdea1030de1a49498ea242aace833a6" category="inline-link-rx"></block>。</block>
  <block id="61fd3b86c424b68c3025dfa4d7435573" category="paragraph">下图显示了使用 SAP HANA 系统复制的双区域灾难恢复解决方案的设置。在同一 Azure 区域，但在不同的可用性区域，本地 HA 会使用预加载到内存中的数据进行同步复制。为远程灾难恢复区域配置了不预加载数据的异步复制。</block>
  <block id="de6b408d617cacbaebc5613e7bae767a" category="paragraph">下图显示了 SAP HANA 系统复制。</block>
  <block id="5ad9de507b94a9e35c82779c07b66112" category="section-title">将数据预加载到内存中的 SAP HANA 系统复制</block>
  <block id="ad09da2a8b21e5c941bff9931f0257fc" category="paragraph">只有在将数据预加载到内存中的 SAP HANA 系统复制功能下， SAP HANA 才能实现极低的 RTO 值。在灾难恢复站点使用专用二级服务器运行 SAP HANA 系统复制时， RTO 值大约可以为 1 分钟或更短。复制的数据会在二级系统上接收并预加载到内存中。由于故障转移时间较短， SAP HANA 系统复制也经常用于近乎零停机的维护操作，例如 HANA 软件升级。</block>
  <block id="2f8b151742608c981dfe2a7be31eb254" category="paragraph">通常， SAP HANA 系统复制配置为在选择数据预加载时同步复制。同步复制支持的最大距离在 100 公里范围内。</block>
  <block id="3f9cb7e4fa20fef95aea32cdc69e8460" category="section-title">SAP 系统复制，而不将数据预加载到内存中</block>
  <block id="694c53f0877cbba373135629373bd319" category="paragraph">对于不太严格的 RTO 要求，您可以在不预加载数据的情况下使用 SAP HANA 系统复制。在此操作模式下，灾难恢复区域的数据不会加载到内存中。灾难恢复区域的服务器仍用于处理运行所有所需 SAP HANA 进程的 SAP HANA 系统复制。但是，服务器的大部分内存可用于运行其他服务，例如 SAP HANA 开发 / 测试系统。</block>
  <block id="2b44d8f81b2975c63242c95c59996df6" category="paragraph">发生灾难时，必须关闭开发 / 测试系统，启动故障转移，并将数据加载到内存中。这种冷备用方法的 RTO 取决于数据库大小以及加载行和列存储期间的读取吞吐量。假设数据的读取吞吐量为 1000 Mbps ，则加载 1 TB 数据大约需要 18 分钟。</block>
  <block id="9bcfdabaf14710772f17b0493d653584" category="section-title">使用 ANF 跨区域复制实现 SAP HANA 灾难恢复</block>
  <block id="b2c9700ba0816986783177a06a90716d" category="paragraph">ANF 跨区域复制内置在 ANF 中，作为使用异步数据复制的灾难恢复解决方案。anf 跨区域复制通过主 Azure 区域和二级 Azure 区域上的两个 ANF 卷之间的数据保护关系进行配置。如果跨区域复制使用高效的块增量复制来更新二级卷。可以在复制配置期间定义更新计划。</block>
  <block id="35df9d5566869e97350fa1c3c40102d9" category="paragraph">下图显示了一个使用 ANF 跨区域复制的双区域灾难恢复解决方案示例。在本示例中， HANA 系统通过主区域中的 HANA 系统复制进行保护，如上一章所述。使用 ANF 跨区域复制功能复制到二级区域。RPO 由复制计划和复制选项定义。</block>
  <block id="7e70869a8c06362cbdb278f6d317ceec" category="paragraph">RTO 主要取决于在灾难恢复站点启动 HANA 数据库以及将数据加载到内存所需的时间。假设数据的读取吞吐量为 1000 MB/ 秒，则加载 1 TB 数据大约需要 18 分钟。根据复制配置的不同，还需要进行正向恢复，并会增加总 RTO 值。</block>
  <block id="333d88bd70b0ad524022e4b15f89a870" category="inline-link-macro">使用 SAP HANA 跨区域复制的配置选项</block>
  <block id="47fee6f62b40967ce289036f382d6aa0" category="paragraph">正常运行期间，灾难恢复站点上的服务器可用作开发 / 测试系统。发生灾难时，必须关闭开发 / 测试系统并将其作为灾难恢复生产服务器启动。</block>
  <block id="56f51c8398e16c6c97472e682d0549cd" category="paragraph">通过 ANF 跨区域复制，您可以在不影响 RPO 和 RTO 的情况下测试灾难恢复工作流。这是通过创建卷克隆并将其附加到灾难恢复测试服务器来实现的。</block>
  <block id="1300b1f384765a2d6f6642aa7d71b546" category="section-title">灾难恢复解决方案摘要</block>
  <block id="c3cb469f59db6d8e60f13c8b3e5fad50" category="paragraph">下表对本节中讨论的灾难恢复解决方案进行了比较，并重点介绍了最重要的指标。</block>
  <block id="f484ed4f391844d7fadc29244749f39c" category="paragraph">主要调查结果如下：</block>
  <block id="6622cfdf1e725d8b4135a456e357be05" category="list-text">如果需要极低的 RTO ，则只能选择预加载到内存中的 SAP HANA 系统复制。</block>
  <block id="b116f45c5b2c42d1e8138d258d2f5fe8" category="list-text">灾难恢复站点需要一台专用服务器来接收复制的数据并将数据加载到内存中。</block>
  <block id="2d8a377fde672fd724220780b842a83d" category="list-text">此外，还需要对数据库外部的数据（例如共享文件，接口等）进行存储复制。</block>
  <block id="ecb2ed817ee95fa396911576436c27ba" category="list-text">如果 RTO 或 RPO 要求不太严格，则也可以使用 ANF 跨区域复制来：</block>
  <block id="e8c0f0174ad6150d9635ee7aa99e4228" category="list-text">将数据库和非数据库数据复制结合使用。</block>
  <block id="6266f60d19983a11b58c24924930b95e" category="list-text">涵盖其他使用情形，例如灾难恢复测试和开发 / 测试更新。</block>
  <block id="68f3fced0a17e5de6db735bd1ca45890" category="list-text">通过存储复制，可以在正常操作期间将灾难恢复站点上的服务器用作 QA 或测试系统。</block>
  <block id="f2d77916dea94337c3b46fd53e9685c7" category="list-text">将 SAP HANA 系统复制作为高可用性解决方案与 RPO=0 以及远程存储复制相结合，对于满足不同的要求是有意义的。</block>
  <block id="0a636bae693e759b89cfb2c0eb9cc58d" category="paragraph">下表对灾难恢复解决方案进行了比较。</block>
  <block id="6b0f1320c0ca34e38fda2a62b7d85f42" category="cell">存储复制</block>
  <block id="061f2f8944130376248327444c4e04f3" category="cell">SAP HANA 系统复制</block>
  <block id="b34347ddf6e48f7eb5aee09d6f7b92a6" category="cell">* 跨区域复制 *</block>
  <block id="a590feeee99c4eece8151edeebf0f29f" category="cell">* 具有数据预加载 *</block>
  <block id="7a6d071835a5d748a307424938d7828f" category="cell">* 无数据预加载 *</block>
  <block id="81acff625024c4f103c5facbd0fd49ea" category="cell">RTO</block>
  <block id="765e065e77ae2adb36770b0a057e2e5b" category="cell">低到中，具体取决于数据库启动时间和正向恢复</block>
  <block id="23011c5407fa1798961babe5803602f3" category="cell">非常低</block>
  <block id="89d26991942cf55ebbc2208a4c545bf9" category="cell">低到中，具体取决于数据库启动时间</block>
  <block id="7617de228058c641a638d21a9e3fbd7c" category="cell">RPO</block>
  <block id="161da3361681a0410ce6d369a9f4e50c" category="cell">RPO &gt; 20 分钟异步复制</block>
  <block id="f13811b02fa6f16283beed9446f9fc82" category="cell">RPO &gt; 20 分钟异步复制 RPO=0 同步复制</block>
  <block id="fcf1ef373c2215be6974c8f48b7e76e1" category="cell">灾难恢复站点的服务器可用于开发 / 测试</block>
  <block id="93cba07454f06a4a960172bbd6e2a435" category="cell">是的。</block>
  <block id="bafd7322c6e97d25b6299b5d6fe8920b" category="cell">否</block>
  <block id="e9a0c7e28ba3eab1bc6af3c80e34b8a2" category="cell">复制非数据库数据</block>
  <block id="31dbf042d36f2d2466e8c84d4eb1d5f2" category="cell">灾难恢复数据可用于刷新开发 / 测试系统</block>
  <block id="978cc4a302a1b7555072ef943e882f05" category="cell">在不影响 RTO 和 RPO 的情况下执行灾难恢复测试</block>
  <block id="4715bf8add38a289ec23829f68ca6ab1" category="summary">研究表明，业务应用程序停机对企业业务产生了重大负面影响。</block>
  <block id="48d5e63e9107995e8ea0ce708339c7bd" category="doc">TR-4891 ：《使用 Azure NetApp Files 实现 SAP HANA 灾难恢复》</block>
  <block id="ffca3d9db8dc584e54dd8dc3551eabb9" category="paragraph">通过在 Azure NetApp Files 上运行 SAP HANA （ ANF ），客户可以访问其他功能，这些功能可以扩展和改进 SAP HANA 的内置数据保护和灾难恢复功能。本概述部分介绍了这些选项，以帮助客户选择支持其业务需求的选项。</block>
  <block id="8a675f2a23ea4c44524efb908ae11cc8" category="paragraph">要制定全面的灾难恢复策略，客户必须了解数据保护和灾难恢复所需的业务应用程序要求和技术功能。下图概述了数据保护。</block>
  <block id="0bfad55781cf801dfc13ccd9a530fc19" category="section-title">业务应用程序要求</block>
  <block id="0703f72eebc09724abffe00a84eccd17" category="paragraph">业务应用程序有两个关键指标：</block>
  <block id="f5075c8d0b3fde0d177163438d4169b9" category="list-text">恢复点目标（ RPO ）或最大容许数据丢失</block>
  <block id="86c0854362b4108af9e516077a22dcc1" category="list-text">恢复时间目标（ RTO ）或允许的最大业务应用程序停机时间</block>
  <block id="34a5165e4ff0cd4794a05c9d055ec269" category="paragraph">这些要求是根据所使用的应用程序类型和业务数据的性质来定义的。如果您要在一个 Azure 区域防止出现故障，则 RPO 和 RTO 可能会有所不同。如果您正在准备应对灾难，例如丢失完整的 Azure 区域，则它们可能也会有所不同。评估用于定义 RPO 和 RTO 的业务要求非常重要，因为这些要求会对可用的技术选项产生重大影响。</block>
  <block id="05807e454c19f244770adae059b3c330" category="section-title">高可用性</block>
  <block id="02894d06d27b56212ed6fbfccbf5b46d" category="paragraph">SAP HANA 基础架构（例如虚拟机，网络和存储）必须具有冗余组件，以确保不会出现单点故障。MS Azure 可为不同的基础架构组件提供冗余。</block>
  <block id="2056be3e7fe4aad29d8cf504dbe6cad9" category="paragraph">为了在计算和应用程序端提供高可用性，可以使用 SAP HANA 多主机系统配置备用 SAP HANA 主机以实现内置的高可用性。如果服务器或 SAP HANA 服务发生故障， SAP HANA 服务将故障转移到备用主机，从而导致应用程序停机。</block>
  <block id="4acc4b54b5bc31fe21ee19d247c247ba" category="paragraph">如果在服务器或应用程序发生故障时无法接受应用程序停机，您也可以使用 SAP HANA 系统复制作为高可用性解决方案，以便在极短的时间内实现故障转移。SAP 客户使用 HANA 系统复制不仅可以解决计划外故障的高可用性问题，还可以最大限度地减少计划内操作（例如 HANA 软件升级）的停机时间。</block>
  <block id="4cf7b593d5e437dfa0b7b2a5ee3efa97" category="section-title">逻辑损坏</block>
  <block id="5d107f9aa3c669862cfdd15f14788e11" category="paragraph">逻辑损坏可能是由软件错误，人为错误或破坏引起的。遗憾的是，使用标准高可用性和灾难恢复解决方案往往无法解决逻辑损坏问题。因此，根据发生逻辑损坏的层，应用程序，文件系统或存储，有时无法满足 RTO 和 RPO 要求。</block>
  <block id="443448e75fe6177a59a73cd194626ddb" category="paragraph">最糟糕的情况是 SAP 应用程序中的逻辑损坏。SAP 应用程序通常在不同应用程序相互通信并交换数据的环境中运行。因此，不建议使用还原和恢复发生逻辑损坏的 SAP 系统。将系统还原到损坏发生前的某个时间点会导致数据丢失，因此 RPO 会大于零。此外， SAP 环境将不再同步，需要额外的后处理。</block>
  <block id="04262f34451f36f688f3d8e90f5e8c3c" category="paragraph">更好的方法是尝试通过在单独的修复系统中分析问题来修复系统中的逻辑错误，而不是还原 SAP 系统。根发生原因分析需要业务流程和应用程序所有者的参与。在这种情况下，您可以根据发生逻辑损坏之前存储的数据创建修复系统（生产系统的克隆）。在修复系统中，可以将所需数据导出并导入到生产系统中。通过这种方法，无需停止生产系统，在最佳情况下，不会丢失任何数据，也不会丢失一小部分数据。</block>
  <block id="59ccab7de24ca9bc19407633e26a3cf6" category="admonition">设置修复系统所需的步骤与本文档所述的灾难恢复测试场景相同。因此，可以轻松扩展所述的灾难恢复解决方案，以解决逻辑损坏问题。</block>
  <block id="1414cdc093d39dd56d0b0d20049e17fc" category="section-title">备份</block>
  <block id="0cfa2764bd4e71a51de20746e90e6611" category="paragraph">创建备份，以便从不同的时间点数据集进行还原和恢复。通常，这些备份会保留几天到几周。</block>
  <block id="df76538ee7be2473592123c0402f7491" category="paragraph">根据损坏的类型，无论是否丢失数据，都可以执行还原和恢复。如果 RPO 必须为零，即使主存储和备份存储丢失，备份也必须与同步数据复制结合使用。</block>
  <block id="742cd7a760d5086ea1510d8d642c6ba0" category="paragraph">用于还原和恢复的 RTO 由所需还原时间，恢复时间（包括数据库启动）以及将数据加载到内存中来定义。对于大型数据库和传统备份方法， RTO 可能很容易需要几个小时，这可能是不可接受的。要使 RTO 值非常低，必须将备份与热备用解决方案结合使用，其中包括将数据预加载到内存中。</block>
  <block id="9fa6087af3062ad3648dc5977dfb040b" category="paragraph">相反，备份解决方案必须解决逻辑损坏问题，因为数据复制解决方案无法涵盖所有类型的逻辑损坏。</block>
  <block id="5e9d83ea8e8a00e0f5cb9f9049b4ee80" category="section-title">同步或异步数据复制</block>
  <block id="549dd6ad7c9bb8e1ffa4e26090ad44b9" category="paragraph">RPO 主要确定您应使用的数据复制方法。如果 RPO 必须为零，即使主存储和备份存储丢失，也必须同步复制数据。但是，同步复制存在技术限制，例如两个 Azure 区域之间的距离。在大多数情况下，由于延迟，同步复制不适用于 100 公里以上的距离，因此，这不是 Azure 区域之间数据复制的选项。</block>
  <block id="5515876e48f77fbadc732d2d0b61fb6e" category="paragraph">如果可以接受更大的 RPO ，则可以在远距离使用异步复制。在这种情况下， RPO 由复制频率定义。</block>
  <block id="50a4caaa98ec68a105f1a2f046046b49" category="section-title">无论是否预加载数据，均可执行 HANA 系统复制</block>
  <block id="19fe37735fc2d812bd3ae9b350c9042b" category="paragraph">SAP HANA 数据库的启动时间比传统数据库的启动时间长得多，因为在数据库提供预期性能之前，必须将大量数据加载到内存中。因此， RTO 的很大一部分是启动数据库所需的时间。对于任何基于存储的复制以及不预加载数据的 HANA 系统复制，在故障转移到灾难恢复站点时，必须启动 SAP HANA 数据库。</block>
  <block id="e2fc131564c468ee9b36f0286ca4ca75" category="paragraph">SAP HANA 系统复制提供了一种操作模式，在该模式下，数据会在二级主机上进行预加载并持续更新。此模式启用的 RTO 值非常低，但它还需要一个专用服务器，该服务器仅用于从源系统接收复制数据。</block>
  <block id="4854d6f0814f33fab723d723df86a202" category="summary">下面显示了 HANA 数据库恢复的步骤</block>
  <block id="7bda2d80ff35cc44a2e131e0160f8093" category="paragraph">以下各小节介绍了使用复制的日志备份进行正向恢复和不转发恢复的恢复过程。可以使用系统数据库的 HANA 恢复脚本和租户数据库的 hdbsql. 命令执行恢复。</block>
  <block id="59c7c30c56560af87e5171c311185571" category="section-title">恢复到最新的 HANA 数据卷备份保存点</block>
  <block id="99deca0459bb05c2895cfaffbd802eef" category="paragraph">使用以下命令以用户 pr1adm 的身份执行到最新备份 savepoint 的恢复：</block>
  <block id="0795408f76a4c59ab10d4b68b30e2b26" category="paragraph">租户恢复现在使用 hdbsql.</block>
  <block id="fbff45b2905a411c1ec2710a73ba047f" category="paragraph">HANA 数据库现在已启动并正在运行，并且 HANA 数据库的灾难恢复工作流已进行测试。</block>
  <block id="180f6a3cc920cbfac7b9138f31af3be1" category="section-title">使用日志 / 目录备份进行正向恢复</block>
  <block id="46fdca8f1816e8f0fba1ae53b20a312a" category="paragraph">正在从源系统复制日志备份和 HANA 备份目录。</block>
  <block id="7713e703c3de9d49c8be8c5a144941ec" category="admonition">要使用所有可用日志进行恢复，您可以在恢复语句中随时使用作为时间戳。</block>
  <block id="9aa362cc10f78dc9c324638e14784e6d" category="paragraph">必须对系统和租户数据库的最新日志备份文件执行检查。</block>
  <block id="89c00df8ab7faebd2081b13849c02f6d" category="summary">现在，可以根据之前创建的 ` /etc/fstab` 文件将卷挂载到目标主机上。</block>
  <block id="13b6058df71d238dde34faeb0f23ca53" category="doc">在目标主机上挂载卷</block>
  <block id="8781b56e6525bf79ec3510bf11e251db" category="doc">灾难恢复测试</block>
  <block id="87dee89423a5f714e7dec138750cc5e4" category="summary">根据灾难恢复设置（包括或不包括日志备份复制），必须根据 Snapshot 备份创建两个或三个新卷。</block>
  <block id="3599970764d2d96426abf88cbe76d48f" category="doc">在灾难恢复站点基于 Snapshot 备份创建新卷</block>
  <block id="6d1f3c07ad25da0bbbcd07ddc688135f" category="list-text">系统会选择一个应用程序一致的快照备份作为 HANA 数据卷的新卷的源。选择还原到新卷以根据快照备份创建新卷。</block>
  <block id="479340e25e53263cccbe4d400974554e" category="list-text">必须在用户界面中提供新的卷名称和配额。</block>
  <block id="60949ae1e8e73bbec42287a8cd6f8ed0" category="list-text">在协议选项卡中，配置文件路径和导出策略。</block>
  <block id="8759ff9c6ca36d554091c45e68dc83bd" category="list-text">创建和查看屏幕总结了配置。</block>
  <block id="55114f27f28823ee3356c20ed9fef0ef" category="list-text">现在，已根据 HANA 快照备份创建了一个新卷。</block>
  <block id="fa6abbf0782170b61d3fdc6372a0efe0" category="paragraph">现在，必须对 HANA 共享卷和日志备份卷执行相同的步骤，如以下两个屏幕截图所示。由于尚未为 HANA 共享和日志备份卷创建其他快照，因此必须选择最新的 SnapMirror Snapshot 副本作为新卷的源。这是非结构化数据， SnapMirror Snapshot 副本可用于此用例。</block>
  <block id="b1c029a960afc679b7835cedb8343cc0" category="paragraph">以下屏幕截图显示了已还原到新卷的 HANA 共享卷。</block>
  <block id="620ba589298c0daf613aef8a49ec1187" category="admonition">如果已使用性能层较低的容量池，则现在必须将卷移至可提供所需性能的容量池。</block>
  <block id="2fd2064e7ce5a3879663f0a4fe612413" category="paragraph">所有这三个新卷现在都可用，并且可以挂载到目标主机上。</block>
  <block id="483be6f3dd37511b4c6b3e752d378767" category="summary">发生灾难故障转移时，必须断开目标卷，以便目标主机可以挂载这些卷以执行读写操作。</block>
  <block id="5facbc8db35e3716949290f0b40e7de4" category="doc">中断并删除复制对等关系</block>
  <block id="9266018f113912af184108e98c050efd" category="admonition">对于 HANA 数据卷，您必须将该卷还原到使用 AzAcSnap 创建的最新 HANA 快照备份。如果由于复制对等关系而将最新复制快照标记为繁忙，则无法执行此卷还原操作。因此，您还必须删除复制对等关系。</block>
  <block id="cb41ee3647c83dda0f32ae3d0c0bbdeb" category="paragraph">接下来的两个屏幕截图显示了 HANA 数据卷的中断和删除对等操作。此外，还必须对日志备份和 HANA 共享卷执行相同的操作。</block>
  <block id="46b67b68e6f57344571ed5e6deb96640" category="paragraph">由于复制对等关系已删除，因此可以将卷还原到最新的 HANA 快照备份。如果未删除对等关系，则对还原卷的选择将灰显且不可选。以下两个屏幕截图显示了卷还原操作。</block>
  <block id="44bc131dcbc031dad5c60665d0e777cb" category="paragraph">执行卷还原操作后，数据卷将基于一致的 HANA 快照备份，现在可用于执行正向恢复操作。</block>
  <block id="26a7c251db745e0e6e323b2d2a1f06f7" category="admonition">如果已使用性能层较低的容量池，则现在必须将卷移至可提供所需性能的容量池。</block>
  <block id="611474da8104a1c517f6d3e00b794bad" category="summary">本节介绍用于灾难恢复故障转移的服务器所需的准备步骤。</block>
  <block id="fd0f9a84ad1162accae744eb4e8720bc" category="paragraph">在正常运行期间，目标主机通常用于其他目的，例如 HANA QA 或测试系统。因此，在执行灾难故障转移测试时，必须执行所述的大部分步骤。另一方面，只需复制配置文件，即可准备相关配置文件，例如 ` /etc/fstab` 和 ` usr/sapservices` ，然后将其投入生产。灾难恢复故障转移操作步骤可确保正确配置准备好的相关配置文件。</block>
  <block id="68414e630c2410427f8528f7531641e3" category="paragraph">目标主机准备工作还包括关闭 HANA QA 或测试系统，以及使用 `systemctl stop sapinit` 停止所有服务。</block>
  <block id="8660a2116ae3634df0fd5dc665458840" category="paragraph">SAP 主机代理软件必须安装在目标服务器上。有关完整信息，请参见<block ref="dfb99acb3a5bfb8e56c9630a62e67a77" category="inline-link-rx"></block> 在 SAP 帮助门户上。</block>
  <block id="42b048440c50c198439a3f5cf6b2f8fc" category="paragraph">如果日志备份卷复制是灾难恢复设置的一部分，则复制的日志备份卷将挂载到目标主机上，而无需准备额外的日志备份卷。</block>
  <block id="cb03fc2ba6f5264a1d18ec731940b865" category="paragraph">下表显示了实验室设置中使用的命名约定。灾难恢复站点上的卷名称包含在 ` /etc/fstab` 中。</block>
  <block id="3371b95f5c42f5eee8e2e58a6f48fa14" category="cell">灾难恢复站点上的卷和子目录</block>
  <block id="1dc43cfb2d7ee9173ee71963196e6560" category="cell">PR1-shared-sm-dest/shared PR1-shared-sm-dest/usr-sap-pr1</block>
  <block id="b22da6ced8752b012e3da78c79177c72" category="admonition">必须在目标主机上创建此表中的挂载点。</block>
  <block id="d6592b2b5e0e3f570578edc3ab023e7a" category="summary">根据日志备份复制是否属于灾难恢复设置的一部分，灾难恢复的步骤略有不同。</block>
  <block id="baaf26c3cc1634b64f550cbbc10d58ed" category="doc">灾难恢复故障转移</block>
  <block id="e8bee4c9f7418a9fa7423012c3115980" category="paragraph">根据日志备份复制是否属于灾难恢复设置的一部分，灾难恢复的步骤略有不同。本节介绍了适用于纯数据备份复制以及与日志备份卷复制结合使用的数据卷复制的灾难恢复故障转移。</block>
  <block id="1db54f8e2a972ae70747d37496118790" category="paragraph">要执行灾难恢复故障转移，请完成以下步骤：</block>
  <block id="1f61cc07babe71682a84ca95fe1c7d13" category="list-text">中断并删除复制关系。</block>
  <block id="c14c2fe0d30d26aa71b42b15a55b4ac8" category="list-text">将数据卷还原为最新的应用程序一致的 Snapshot 备份。</block>
  <block id="4eee8932f478fb4d431ea7945a48e97a" category="list-text">在目标主机上挂载卷。</block>
  <block id="7f40610e983d6f727ad40881c5a306b8" category="paragraph">以下各小节详细介绍了这些步骤，下图介绍了灾难故障转移测试。</block>
  <block id="89b5eb16af03c7090de707cc37ac1f09" category="summary">下图显示了使用 ANF 跨区域复制的 SAP HANA 系统的卷复制关系。</block>
  <block id="7d224183d244c3eb1b578f3d5d711cfb" category="doc">使用 SAP HANA 进行跨区域复制的配置选项</block>
  <block id="3743669162e4cca4ba5fb8da0d3aa70a" category="paragraph">下图显示了使用 ANF 跨区域复制的 SAP HANA 系统的卷复制关系。使用 ANF 跨区域复制时，必须复制 HANA 数据和 HANA 共享卷。如果仅复制 HANA 数据卷，则典型 RPO 值的范围为一天。如果需要较低的 RPO 值，则还必须复制 HANA 日志备份以进行正向恢复。</block>
  <block id="a5fce1269f63c611b20450b2bb542581" category="admonition">本文档中使用的术语 " 日志备份 " 包括日志备份和 HANA 备份目录备份。执行正向恢复操作需要 HANA 备份目录。</block>
  <block id="114e1274446139d76dc9144e2b14ccc1" category="admonition">以下问题描述和实验室设置侧重于 HANA 数据库。其他共享文件（例如 SAP 传输目录）将采用与 HANA 共享卷相同的方式进行保护和复制。</block>
  <block id="edeecb7503e77b90ed51e96e450bce5f" category="inline-link">什么是适用于 Azure NetApp Files 的 Azure 应用程序一致性 Snapshot 工具 | Microsoft 文档</block>
  <block id="3a325ee10c0e0cbba17bbb780ab5ee2c" category="paragraph">要使用日志备份启用 HANA 保存点恢复或正向恢复，必须在主站点为 HANA 数据卷创建应用程序一致的数据 Snapshot 备份。例如，可以使用 ANF 备份工具 AzAcSnap 执行此操作（另请参见<block ref="ad4a6e6049ad4c7fd5609e852333bc9f" category="inline-link-rx"></block>）。然后，在主站点创建的 Snapshot 备份将复制到灾难恢复站点。</block>
  <block id="23a57e4f9acbbc326b84af2c9f4d23c7" category="paragraph">在发生灾难故障转移时，必须中断复制关系，将卷挂载到灾难恢复生产服务器，并且必须将 HANA 数据库恢复到最后一个 HANA 保存点，或者使用复制的日志备份进行正向恢复。章节 <block ref="baf54569999503bd576caeb99186c047" category="inline-link-macro-rx"></block>，介绍了所需的步骤。</block>
  <block id="713aae56a240e325bb34a0d833729e8f" category="paragraph">下图展示了跨区域复制的 HANA 配置选项。</block>
  <block id="600ce73f728ef876696aea07da944d48" category="paragraph">对于当前版本的跨区域复制，只能选择固定计划，用户无法定义实际复制更新时间。可用计划包括每日，每小时和每 10 分钟。使用这些计划选项，根据 RPO 要求，有两种不同的配置是有意义的：不执行日志备份复制的数据卷复制以及按不同计划执行的日志备份复制，每小时或每 10 分钟执行一次。可实现的最低 RPO 约为 20 分钟。下表总结了配置选项以及生成的 RPO 和 RTO 值。</block>
  <block id="fcd256654a3c5292023efa55d739bc80" category="cell">数据卷复制</block>
  <block id="1a77af3d4771bcb235680750736a7963" category="cell">数据和日志备份卷复制</block>
  <block id="ecd2e667aef672cef20ccf5d1999bae6" category="cell">CRR 计划数据卷</block>
  <block id="766c1532a762dac9ff24af748740e26b" category="cell">CRR 计划日志备份卷</block>
  <block id="7dd6a6ab32fdea4f29883abb60388da7" category="cell">10 分钟</block>
  <block id="2b1f07f9d71545257dcca60137caef28" category="cell">最大 RPO</block>
  <block id="ca17d9638aadac1ac94c382ca423aa5f" category="cell">24 小时 + Snapshot 计划（例如 6 小时） +</block>
  <block id="72ab9d0304d3e84c6aa2dd15eda282f2" category="cell">1 小时</block>
  <block id="5bc5ed69f9c54b9d85a1cce3e6d1e921" category="cell">2 x 10 分钟</block>
  <block id="55786705935c6a97b4d23698d008516f" category="cell">最大 RTO</block>
  <block id="d7d2ff11a56a872692dbbb3d19ff76cd" category="cell">主要由 HANA 启动时间定义</block>
  <block id="c13edbe874bb6cf35b0de53cd31a1b74" category="cell">HANA 启动时间 + 恢复时间 +</block>
  <block id="842dc6b7f9e3a2c7e84f044e11faeed2" category="cell">正向恢复</block>
  <block id="d4cd0dabcf4caa22ad92fab40844c786" category="cell">不适用</block>
  <block id="49daf1624ce66f46e9b73f92beaa8bdd" category="cell">过去 24 小时的日志 + Snapshot 计划（例如 6 小时） +</block>
  <block id="4486fa7cd414376cc3abe9834a582117" category="summary">Microsoft Azure 不保证特定虚拟机（ VM ）类型在创建时或启动已取消分配的 VM 时可用。</block>
  <block id="9671268467391e7f925a038c0f83e411" category="doc">要求和最佳实践</block>
  <block id="0041be80697e591a22095c3fa9c2bad7" category="paragraph">Microsoft Azure 不保证特定虚拟机（ VM ）类型在创建时或启动已取消分配的 VM 时可用。具体而言，如果某个区域发生故障，许多客户端可能需要在灾难恢复区域添加更多 VM 。因此，建议主动使用具有灾难故障转移所需大小的虚拟机作为灾难恢复区域的测试或 QA 系统，以便分配所需的虚拟机类型。</block>
  <block id="7e0f2788f79e7e6dac3c7a1763ea03ce" category="paragraph">为了优化成本，在正常运行期间使用性能层较低的 ANF 容量池是有意义的。数据复制不需要高性能，因此可以使用具有标准性能层的容量池。对于灾难恢复测试，或者如果需要进行灾难故障转移，则必须将卷移至具有高性能层的容量池。</block>
  <block id="d94877e8e507baf3981ecd776b02880f" category="paragraph">如果不能选择第二个容量池，则应根据容量要求而不是正常操作期间的性能要求来配置复制目标卷。然后，可以调整配额或吞吐量（对于手动 QoS ），以便在发生灾难故障转移时进行灾难恢复测试。</block>
  <block id="4884cf9b8aa0c3a663b5ef3d5ca2e108" category="inline-link">使用 Azure NetApp Files 卷跨区域复制的要求和注意事项 | Microsoft 文档</block>
  <block id="d51d9722e039d6d29e55b83f4505f1e2" category="paragraph">有关详细信息，请参见<block ref="2b5439903546a140450c472c2abf9f4b" category="inline-link-rx"></block>。</block>
  <block id="55d9365909b3a315103ca1908bd396c7" category="summary">以下三个屏幕截图显示了数据，日志备份和共享卷的复制状态。</block>
  <block id="7cc288aea34413093faffad51bc084c1" category="doc">监控 ANF 跨区域复制</block>
  <block id="134c4bbaf0ae858e55b84b72f15d414a" category="paragraph">卷复制滞后时间是了解 RPO 预期的有用值。例如，日志备份卷复制显示最长滞后时间为 58 分钟，这意味着最大 RPO 具有相同的值。</block>
  <block id="ba11fe397b6f7c72532ba24515066c28" category="paragraph">传输持续时间和传输大小可提供有关带宽要求以及更改复制卷的速率的宝贵信息。</block>
  <block id="b7ecf615e3ff0c312f16190ab1ee41c8" category="paragraph">以下屏幕截图显示了 HANA 数据卷的复制状态。</block>
  <block id="22846a31a2d2e3242432376dc19b200a" category="paragraph">以下屏幕截图显示了 HANA 日志备份卷的复制状态。</block>
  <block id="6d58b85d280817df770609a622725eb4" category="paragraph">以下屏幕截图显示了 HANA 共享卷的复制状态。</block>
  <block id="5bb8b8dab26f014e5b3079efa0dd3754" category="section-title">复制的 Snapshot 备份</block>
  <block id="cfb95d4ab5955fc882056df6c5353ec9" category="paragraph">每次从源卷到目标卷的复制更新都会将上次更新到当前更新之间发生的所有块更改复制到目标卷。这还包括在源卷上创建的快照。以下屏幕截图显示了目标卷上可用的快照。如前文所述， AzAcSnap 工具创建的每个快照都是 HANA 数据库中应用程序一致的映像，可用于执行保存点或正向恢复。</block>
  <block id="e8f1ac642d75f5f86a7154d6dd39a32e" category="admonition">在源卷和目标卷中，还会创建 SnapMirror Snapshot 副本，用于重新同步和复制更新操作。从 HANA 数据库角度来看，这些 Snapshot 副本的应用程序不一致；只有通过 AzaCSnap 创建的应用程序一致的快照才能用于 HANA 恢复操作。</block>
  <block id="39827364402eb7a6398af8c1194aa72d" category="doc">数据保护概述</block>
  <block id="677f2e7e550075f7bbbdac91e0918f2f" category="sidebar">SAP 解决方案</block>
  <block id="fcf140abed196b8eba71c45f21312bce" category="sidebar">NetApp 解决方案</block>
  <block id="cd47dd01745339787e4c7300389401f2" category="sidebar">最佳实践</block>
  <block id="88aa48beec8729be73be99084cd76b79" category="sidebar">《采用 FCP 的 NetApp AFF 系统上的 SAP HANA 配置指南》</block>
  <block id="87aea504b228b108e5161db60e63e422" category="sidebar">基础架构设置和配置概述</block>
  <block id="a1893b920bc48a028abc56e282719481" category="sidebar">《采用 NFS 的 NetApp AFF 系统上的 SAP HANA 配置指南》</block>
  <block id="566e71293623024943bf4c66fa54d2c8" category="sidebar">《采用 NFS 的 NetApp FAS 系统上的 SAP HANA 配置指南》</block>
  <block id="c8ff9dc5c718603eec8564e06ee7b058" category="sidebar">《采用 FCP 的 FAS 系统上的 SAP HANA 配置指南》</block>
  <block id="00495563450af6bcde40cb96d650076e" category="sidebar">基于 IBM Power Systems 的 SAP HANA 和采用 NFS 的 NetApp AFF 系统</block>
  <block id="d5d6ed7727f0e542e6846a58af1d02ba" category="sidebar">SAP HANA 生命周期管理</block>
  <block id="68cc439f4e585883d2aaa26a4e3bcef2" category="sidebar">SAP HANA 灾难恢复</block>
  <block id="fa532045e834ec2fac1200964a189516" category="sidebar">生命周期管理</block>
  <block id="91a1838980cefe2d841b83794fd6d4a1" category="sidebar">将 NetApp 存储与 SAP Landscape Management 集成</block>
  <block id="992418be64e705531aba529adefec66f" category="sidebar">备份，还原和灾难恢复</block>
  <block id="972d8dadb82724623a226062c52b514d" category="sidebar">使用 Azure NetApp Files 实现 SAP HANA 灾难恢复</block>
  <block id="0435a2de9b6c71fb28e3ba4071b531de" category="sidebar">《使用 SAP HANA 进行跨区域复制》概述</block>
  <block id="6c45d41e933130a1d4e3729dad7439f3" category="sidebar">灾难恢复测试概述</block>
  <block id="6db8771af1e20f8b4493135fb9b2465f" category="sidebar">灾难恢复故障转移概述</block>
  <block id="f41a551d63cd5cff04cf3c09ee2c3dea" category="sidebar">使用 SnapCenter 实现 SAP HANA 备份和恢复</block>
  <block id="dd0dec62b557e33c38d24dc3cbaed4bc" category="sidebar">使用存储复制实现 SAP HANA 灾难恢复</block>
  <block id="fceb9e9a7a8e75da09a45b74960f3ce3" category="sidebar">使用 Snap Creator 备份和恢复 SAP HANA</block>
  <block id="0f1df2d5d1f6e9db4283f9e9814fa12a" category="sidebar">使用 NetApp 存储和 Commvault 软件进行 SAP HANA 备份和恢复</block>
  <block id="c1fd2d028e3fff9cae781db6954eb52b" category="summary">本文档为客户和合作伙伴提供了部署 NetApp ONTAP 以支持在 Windows 环境中的 Microsoft SQL Server 中运行 SAP 业务套件解决方案的最佳实践。</block>
  <block id="c5dacd8b175c8c2367525c37eea1dc59" category="doc">TR-4467 ： SAP 与 Windows 上的 Microsoft SQL Server —使用 NetApp ONTAP 和 SnapCenter 的最佳实践</block>
  <block id="611a4a6b98272a717f8e1f6bf5ba787b" category="paragraph">NetApp 公司 Marco Schoen</block>
  <block id="3be0224caa6f122d821c38b09efdbac7" category="inline-link-macro"><block ref="3be0224caa6f122d821c38b09efdbac7" category="inline-link-rx"></block></block>
  <block id="386b4fc148c87ad6a824fb6645fff9ca" category="paragraph"><block ref="386b4fc148c87ad6a824fb6645fff9ca" category="inline-link-macro-rx"></block></block>
  <block id="77856469e4786d81c487dfc174833e29" category="summary">TR-4757 提供了使用适用于 SAP 应用程序的 Azure NetApp Files 和 SAP HANA 部署的最佳实践。此外，本文档还详细介绍了 SAP 共享文件系统的不同使用情形。本文档介绍了利用 NetApp Cloud Volumes ONTAP for SAP Applications 和 SAP HANA 部署的最佳实践。它包括与 SAP 共享文件系统不同的使用情形，以及基于 Cloud Volumes ONTAP 的 SAP HANA 的特定性能注意事项。</block>
  <block id="0e03d1132f9763756b2e5e8f46c33610" category="doc">TR-4757 ：《 Microsoft Azure 上的 SAP 应用程序—使用 NetApp Cloud Volumes ONTAP 》</block>
  <block id="bc2f77b802672aed5e74bfb91aa5eee4" category="inline-link-macro"><block ref="bc2f77b802672aed5e74bfb91aa5eee4" category="inline-link-rx"></block></block>
  <block id="8e3940acd5b42b2156bc15a3fdf1827d" category="paragraph"><block ref="8e3940acd5b42b2156bc15a3fdf1827d" category="inline-link-macro-rx"></block></block>
  <block id="5176c066b53609fe56eb537ca7fcac89" category="summary">IBM Power Systems 专为 SAP HANA 等数据密集型和任务关键型工作负载而设计。IBM Power Systems 通过提供四项关键功能来简化和加速 SAP HANA 部署—卓越的虚拟化和灵活性，更快的配置速度，经济实惠的可扩展性以及最大限度地延长正常运行时间。NetApp AFF 产品系列已通过认证，可在定制数据中心集成（ TDI ）项目中与 SAP HANA 结合使用，并与 IBM Power Systems 完美地相辅相成。本文档介绍将 NetApp ONTAP 与 AFF 产品系列和 IBM Power Systems 结合使用的 NAS （ NFS ）存储设置的最佳实践。</block>
  <block id="f20a40b88879c634d62a1183049bd409" category="doc">TR-4821 ：基于 IBM Power Systems 和采用 NFS 的 NetApp AFF 系统的 SAP HANA</block>
  <block id="68708a2f0db2622048ef976e3d1ceb61" category="paragraph">IBM Power Systems 专为 SAP HANA 等数据密集型和任务关键型工作负载而设计。IBM Power Systems 通过提供四项关键功能来简化和加速 SAP HANA 部署：卓越的虚拟化和灵活性，更快的配置速度，经济实惠的可扩展性以及最大限度地延长正常运行时间。NetApp AFF 产品系列已通过认证，可在定制数据中心集成（ TDI ）项目中与 SAP HANA 结合使用，并与 IBM Power Systems 完美地相辅相成。本文档介绍将 NetApp ONTAP 与 AFF 产品系列和 IBM Power Systems 结合使用的 NAS （ NFS ）存储设置的最佳实践。</block>
  <block id="25c8459cf1533ecc02d4453baf422ef2" category="inline-link-macro"><block ref="25c8459cf1533ecc02d4453baf422ef2" category="inline-link-rx"></block></block>
  <block id="5223a61d48ab537c433cb2cd2b7238ff" category="paragraph"><block ref="5223a61d48ab537c433cb2cd2b7238ff" category="inline-link-macro-rx"></block></block>
  <block id="6382b55c5f4c721a7046327b2675c2a6" category="summary">本文档介绍了在设计存储解决方案以使用 Oracle 数据库支持 SAP 业务套件产品时所面临的挑战。本文档的主要重点是使用最新一代 SAP 解决方案的业务和 IT 主管面临的常见存储基础架构设计，部署，操作和管理挑战。本文档中的建议是通用的；它们并不特定于 SAP 应用程序或 SAP 实施的规模和范围。</block>
  <block id="205c68d6779218d7af7da356dc6a9da2" category="doc">TR-4250 ： SAP 与基于 UNIX 的 Oracle 和 NFS 以及适用于 SAP 3.4 的 NetApp ONTAP 和 SnapManager</block>
  <block id="bb8cd3f7aec777de29cee988f4ade068" category="paragraph">NetApp 公司 Nil Bauser</block>
  <block id="4a889ac1eab815e3cc9e7d0066d4360d" category="paragraph">本文档介绍了在设计存储解决方案以使用 Oracle 数据库支持 SAP 业务套件产品时所面临的挑战。本文档的主要重点是使用最新一代 SAP 解决方案的业务和 IT 主管面临的常见存储基础架构设计，部署，操作和管理挑战。本文档中的建议是通用的；它们并不特定于 SAP 应用程序或 SAP 实施的规模和范围。本文档假定读者已基本了解 NetApp 和 SAP 产品的技术和操作。本文档是在 NetApp ， SAP ， Oracle 和我们的客户技术人员的互动基础上编写的。</block>
  <block id="72b1d38d81a57d1482ce5708d98653f1" category="inline-link-macro"><block ref="72b1d38d81a57d1482ce5708d98653f1" category="inline-link-rx"></block></block>
  <block id="d30f42b2a88310780291191529d76b18" category="paragraph"><block ref="d30f42b2a88310780291191529d76b18" category="inline-link-macro-rx"></block></block>
  <block id="81c2f60fe1cd3484018d62f2addc343a" category="summary">本参考架构文档可帮助客户在 VMware vSphere 虚拟机（ VM ）以及 NetApp FAS 和全闪存 FAS （ AFF ）存储系统上设计和部署 SAP HANA 单主机和多主机解决方案。</block>
  <block id="fc21beda63f542908cf6ffb86e8a9b91" category="doc">TR-4338 ：《采用 NetApp 技术的 VMware vSphere 上的 SAP HANA — FAS 和全闪存 FAS 系统》</block>
  <block id="492dbdbda06cf15ce343cbe404369a3d" category="paragraph">本参考架构文档可帮助客户在 VMware vSphere 虚拟机（ VM ）以及 NetApp FAS 和全闪存 FAS （ AFF ）存储系统上设计和部署 SAP HANA 单主机和多主机解决方案。此参考架构是根据现有 VMware 和 NetApp 客户的经验，真实模拟以及 NetApp 工程实验室验证而部署并记录的解决方案。本文档可帮助客户完成整个项目生命周期，包括需求评估，解决方案设计，安装和管理。</block>
  <block id="07d3b62fe245f06a68daa5268016da79" category="inline-link-macro"><block ref="07d3b62fe245f06a68daa5268016da79" category="inline-link-rx"></block></block>
  <block id="234856f07739c90d237a9a99b3d9e24c" category="paragraph"><block ref="234856f07739c90d237a9a99b3d9e24c" category="inline-link-macro-rx"></block></block>
  <block id="1b957531101399d0f744aec724e69fa1" category="summary">NetApp 通过提供一个生命周期管理解决方案来应对功能实施缓慢，缺乏自动化以及工作效率下降带来的挑战，该 已完全集成到 SAP 管理员用于日常运营的工具中，例如 SAP Landscape Management （ SAP LaMa ）。目标是简化从预处理到后处理的配置工作流，包括创建生产系统副本所需的所有软件和存储层任务。借助此解决方案，管理员只需单击几下鼠标即可创建开发和测试环境，从而改善生命周期管理。</block>
  <block id="643fa590028dacc026f165afdf4fb795" category="doc">SB-3978 ：《 SAP HANA 生命周期管理》</block>
  <block id="2302484597c5b4089c4a24a850b7f489" category="inline-link-macro"><block ref="2302484597c5b4089c4a24a850b7f489" category="inline-link-rx"></block></block>
  <block id="33876e03541db5898b573e9322b655e7" category="paragraph"><block ref="33876e03541db5898b573e9322b655e7" category="inline-link-macro-rx"></block></block>
  <block id="3616b54049026f3c3013256a38ff9c91" category="summary">本文档介绍了适用于 SAP HANA 的 NetApp 备份和恢复解决方案的安装和配置。解决方案基于 NetApp Snap Creator 框架和适用于 SAP HANA 的 Snap Creator 插件。经认证的 Cisco SAP HANA 多节点设备与 NetApp 存储相结合，可支持此解决方案。在定制数据中心集成（ TDI ）项目中，单节点和多节点 SAP HANA 系统也支持此解决方案。</block>
  <block id="b20847dfaf8bda0f5d26c73527a7a402" category="doc">TR-4313 ：《使用 Snap Creator 备份和恢复 SAP HANA 》</block>
  <block id="a696566e7ab3f2276919a2f7c509c31b" category="paragraph">TR-4313 介绍了适用于 SAP HANA 的 NetApp 备份和恢复解决方案的安装和配置。解决方案基于 NetApp Snap Creator 框架和适用于 SAP HANA 的 Snap Creator 插件。经认证的 Cisco SAP HANA 多节点设备与 NetApp 存储相结合，可支持此解决方案。在定制数据中心集成（ TDI ）项目中，单节点和多节点 SAP HANA 系统也支持此解决方案。</block>
  <block id="2447c9d3e154873d9458d9f21f9d9e82" category="inline-link-macro"><block ref="2447c9d3e154873d9458d9f21f9d9e82" category="inline-link-rx"></block></block>
  <block id="c48a0c69bdeb4ba64f1a756390dd148d" category="paragraph"><block ref="c48a0c69bdeb4ba64f1a756390dd148d" category="inline-link-macro-rx"></block></block>
  <block id="7b84e8d1abd1ca9b58ab3e77d620c832" category="summary">TR-4711 介绍了适用于 SAP HANA 的 NetApp 和 Commvault 解决方案的设计，其中包括 Commvault IntelliSnap 快照管理技术和 NetApp Snapshot 技术。解决方案基于 NetApp 存储和 Commvault 数据保护套件。</block>
  <block id="8fb21969b8486293a6e9aad64bfdce52" category="doc">TR-4711 ：《使用 NetApp 存储系统和 Commvault 软件的 SAP HANA 备份和恢复》</block>
  <block id="6b6da8403e50e999c81fff1b93ddd075" category="inline-link-macro"><block ref="6b6da8403e50e999c81fff1b93ddd075" category="inline-link-rx"></block></block>
  <block id="974fc1d6f48a5236cf23f9d95df8992c" category="paragraph"><block ref="974fc1d6f48a5236cf23f9d95df8992c" category="inline-link-macro-rx"></block></block>
  <block id="1991f9bd90d7f79579e13fb5b25da162" category="summary">这一经过 NetApp 验证的架构涵盖了在采用 Brocade FC SAN Fabric 的 NetApp 全 SAN 阵列（ ASA ）存储系统上为 SAP HANA 打造现代化 SAP 系统和运营。它包括备份和恢复，灾难恢复和数据保护。</block>
  <block id="6f0f948f8224ca6abd264e8990372af6" category="doc">NVA-1147-design ：基于 NetApp 全 SAN 阵列的 SAP HANA —现代 SAN ，数据保护和灾难恢复</block>
  <block id="bd3a2bd89a649bf3f808ac6c8cc752ef" category="paragraph">这一经过 NetApp 验证的架构涵盖了在采用 Brocade FC SAN Fabric 的 NetApp 全 SAN 阵列（ ASA ）存储系统上为 SAP HANA 打造现代化 SAP 系统和运营。它包括备份和恢复，灾难恢复和数据保护。解决方案利用 NetApp SnapCenter 自动执行 SAP HANA 备份，还原和恢复以及克隆工作流。本节将使用同步 NetApp SnapMirror 数据复制软件介绍灾难恢复配置，测试和故障转移场景。此外，还概述了使用 Commvault 进行 SAP 数据保护。</block>
  <block id="731764091ffe7cacd12c33c9048bfd8f" category="inline-link-macro"><block ref="731764091ffe7cacd12c33c9048bfd8f" category="inline-link-rx"></block></block>
  <block id="a064ef72c49c2eebe828ed0cd3a38305" category="paragraph"><block ref="a064ef72c49c2eebe828ed0cd3a38305" category="inline-link-macro-rx"></block></block>
  <block id="47f5c5f7b80224cb7832ed3973296f38" category="doc">TR-4614 ：《使用 SnapCenter 实现 SAP HANA 备份和恢复》</block>
  <block id="8132c1d54d27cf7a67ac0e563e82c329" category="summary">TR-4646 概述了 SAP HANA 灾难恢复保护的选项。其中包括基于同步和异步 NetApp SnapMirror 存储复制的三站点灾难恢复解决方案的详细设置信息和用例问题描述。所述的解决方案将 NetApp SnapCenter 与 SAP HANA 插件结合使用来管理数据库一致性。</block>
  <block id="c79cdf002876c8be8a196f93f344a33f" category="inline-link-macro"><block ref="c79cdf002876c8be8a196f93f344a33f" category="inline-link-rx"></block></block>
  <block id="d925ae253e076ec94fce589bf0750a31" category="paragraph"><block ref="d925ae253e076ec94fce589bf0750a31" category="inline-link-macro-rx"></block></block>
  <block id="e12451ca8917b29faae9e966a7ef40f6" category="summary">TR-4719 介绍了如何在 SAP HANA 系统复制环境中使用 NetApp SnapCenter 技术和 SAP HANA 插件进行备份和恢复。</block>
  <block id="ef5cc7c8780ee87a124c0fd66dd44867" category="doc">TR-4719 ： SAP HANA 系统复制—使用 SnapCenter 进行备份和恢复</block>
  <block id="1a7acb5247a596ecf14f6381a5824bd7" category="inline-link-macro"><block ref="1a7acb5247a596ecf14f6381a5824bd7" category="inline-link-rx"></block></block>
  <block id="d5dfc6464276a185ca9edd33cbc78835" category="paragraph"><block ref="d5dfc6464276a185ca9edd33cbc78835" category="inline-link-macro-rx"></block></block>
  <block id="aabf604423d1b54f70e80a6e69d7cc9b" category="sidebar">SAP 与基于 UNIX 的 Oracle 以及 NFS 与 NetApp ONTAP</block>
  <block id="41af34746c13d49348031a1fca6a2938" category="sidebar">SAP 与使用 ONTAP 的 Windows 上的 Microsoft SQL Server</block>
  <block id="9feb66d55a80dea870deeb88fab704c9" category="sidebar">SAP HANA 备份和恢复</block>
  <block id="eeb338bfcd3ad35ad6983ecfa31efba2" category="sidebar">基于 NetApp 全 SAN 阵列的 SAP HANA —现代 SAN ，数据保护和灾难恢复</block>
  <block id="e9c44bbfd795a5d63d74c6a77afee70d" category="summary">法律声明提供对版权声明、商标、专利等的访问。</block>
  <block id="30d965eef5ba25c6b9998ae38270b43e" category="doc">法律声明</block>
  <block id="6016a2b341113bf496b719905398ecd2" category="section-title">版权</block>
  <block id="126a02652da6de02962cf1b654fd6376" category="section-title">商标</block>
  <block id="c4ce4761e466527d26b3e3d5ed1006fd" category="paragraph">NetApp 、 NetApp 徽标和 NetApp 商标页面上列出的标记是 NetApp 、 Inc. 的商标。其他公司和产品名称可能是其各自所有者的商标。</block>
  <block id="be89498d2f8a22ce47c02ba9795fe2af" category="section-title">专利</block>
  <block id="d0b19d36be2c5f16e9aef46c8a452d3d" category="paragraph">有关 NetApp 拥有的专利的最新列表，请访问：</block>
  <block id="56c34c6410dd45c5cec44149ad0ce037" category="section-title">隐私政策</block>
  <block id="c0227cef6f07a8cd2ac72f2945b031aa" category="section-title">开放源代码</block>
  <block id="9b73989307c1975dfa4d5e1581e4afe8" category="paragraph">通知文件提供有关 NetApp 软件中使用的第三方版权和许可证的信息。</block>
  <block id="bca5b2fa001874580bf261991fd79806" category="cell">从 ONTAP 9.8 新操作系统版本新 SAP HANA 版本开始，支持 NFSv4.1 的 nconnect 功能</block>
  <block id="896435116179bed2dde76b00414b4fa5" category="cell">新的 NetApp 存储系统会更改主机网络设置</block>
  <block id="7e0efdf8314ae57608296d0f91d73af0" category="list-text">对于单主机系统，请挂载 ` /ha/shared` 卷并创建 `shared` 和 `usr-sp` 子目录。</block>
  <block id="80bf104cdee8b8f9c92f9e4ff0972dab" category="inline-link-macro">" 数据保护策略 " ，</block>
  <block id="c578586071a895e1a24fdb22dd828e77" category="paragraph">典型的最低配置包含以下策略：</block>
  <block id="1a738a5297df57433f24d32effcccf4f" category="section-title">每小时 Snapshot 备份策略</block>
  <block id="b2264bb8d2d665cb70a23e37bcd51220" category="paragraph">下图显示了已配置策略的摘要。</block>
  <block id="f6a738f75f76f62a241636eca02cd87d" category="doc">版本历史记录</block>
  <block id="8002bc13927c65b5f265b031079ce1d4" category="cell">文档版本历史记录</block>
  <block id="ea9349a37bfee247df0f87cbcacca796" category="cell">初始版本。</block>
  <block id="7d5b957cd473f6eaf5ad335a9c63c4ff" category="paragraph">要了解有关本文档中所述信息的更多信息，请查看以下文档和 / 或网站：</block>
  <block id="f97a9615a6fd001bdf5fbaad3e762adc" category="section-title">数据保护策略</block>
  <block id="b02aece9e47a65d17a12859d410988d1" category="paragraph">一种常见方法是定义系统类型，例如生产，开发，测试或沙盒系统。所有系统类型相同的 SAP 系统通常具有相同的数据保护参数。</block>
  <block id="3225a10b07f1580f10dee4abc3779e6c" category="cell">Parameters</block>
  <block id="04184473c3677aaa3fdc23c8adf9ab11" category="cell">生产系统</block>
  <block id="6598f2cf94bde191c18961b9844ea3b8" category="cell">开发系统</block>
  <block id="58973466166271c2e12475c970facc8b" category="cell">测试系统</block>
  <block id="c913695f49476696caed8e3ec2a9fbbc" category="cell">每 4 小时</block>
  <block id="ccd21fd3ff614e4ea81e358d4b9dad4f" category="cell">每 6 小时</block>
  <block id="45fe0d3293152fa29cf10ef8a3c1871d" category="cell">3 天</block>
  <block id="27b749b17e9dce038e22b1cb63840cfd" category="cell">每周一次</block>
  <block id="a3c82f66d39159c3e9d428cd534beb34" category="cell">备份类型</block>
  <block id="bfe4cb821fcce8a234fb6991bc72e925" category="cell">计数 = 12</block>
  <block id="4338f6486dc5d5a5832b758c3d22518e" category="cell">计数 = 3</block>
  <block id="5cd0336074a40ef0493567cff8dc3eb0" category="cell">基于文件</block>
  <block id="6c25e6a6da95b3d583c6ec4c3f82ed4d" category="cell">每周</block>
  <block id="eaf6efa0c22d2f77a7e8c84b08564fa8" category="cell">计数 = 1</block>
  <block id="e7c7c0ead110b5e0656460f4785bebf0" category="section-title">备份操作</block>
  <block id="43e6569b52fe76a3f2f6e68ae12ba5af" category="admonition">当一个或多个租户停止时， SAP 不支持对 MDC 系统执行 Snapshot 备份操作。</block>
  <block id="3e736a3cbf8d29dd995a15423e614970" category="paragraph">下图显示了备份工作流的概述。</block>
  <block id="373d0b19f95f30915a259780f1e42683" category="section-title">HANA 数据库的 Snapshot 备份的备份工作流</block>
  <block id="6f57f256df1b508ce741be6998f13777" category="section-title">用于块完整性检查操作的备份工作流</block>
  <block id="6a01bd07e34e6ee4ae8c5d876de38f3e" category="section-title">数据和日志备份的备份保留管理和管理</block>
  <block id="4c86e375d8017415e5820e0dda39bc9b" category="list-text">基于文件的备份</block>
  <block id="437fd9c44077715ae57f9988105650f3" category="list-text">SAP HANA 备份目录中的数据备份</block>
  <block id="23fabc748ef59beac69090d6468dbf50" category="list-text">在 SAP HANA 备份目录和文件系统中记录备份</block>
  <block id="9ba5c6960af3983228e48ddca02fcc8a" category="paragraph">下图概述了不同的工作流以及每个操作的依赖关系。以下各节将详细介绍不同的操作。</block>
  <block id="c86bb70cd07f9b1870bd94c202cc545e" category="section-title">基于文件的备份的保留管理</block>
  <block id="30045cea939eb38d6a07ae386520d93f" category="section-title">SAP HANA 备份目录中的数据备份保留管理</block>
  <block id="576bd3a8485aa05c1d0ffd6e07cdc22e" category="section-title">日志备份的保留管理</block>
  <block id="ad55e29b285f391746a7617dc2491e24" category="paragraph">SAP HANA 数据库会自动创建日志备份。这些日志备份会在 SAP HANA 中配置的备份目录中为每个 SAP HANA 服务创建备份文件。</block>
  <block id="09de968635c1dc837bf4362d72aa3f9c" category="section-title">Snapshot 备份的容量要求</block>
  <block id="6be8f3086a30e59e908d53eb620b51dd" category="doc">还原和恢复</block>
  <block id="6ce7acfe97d30fdc19c079a65ba07e22" category="list-text">使用 SAP HANA Studio 准备还原和恢复过程：</block>
  <block id="217b91e8b34ae4d89f6ce0aea3eae3e0" category="list-text">选择恢复类型和日志备份位置。</block>
  <block id="6f1c0c39a0a9457611f720a7e3f727f0" category="list-text">使用 SAP HANA Studio 对系统数据库运行恢复过程：</block>
  <block id="3290aa29be79f07d8193b526384a1119" category="list-text">从备份列表中单击刷新，然后选择可用于恢复的备份（以绿色图标表示）。</block>
  <block id="2fc425e07c82682fe2a27c132290ee3a" category="list-text">使用 SAP HANA Studio 对租户数据库运行恢复过程：</block>
  <block id="864972bbadf73d1b9129bd44ce27a736" category="list-text">选择恢复租户数据库并选择要恢复的租户。</block>
  <block id="d224ae0a4d51e7c29e63a7687b30517d" category="list-text">选择恢复类型，然后单击下一步。</block>
  <block id="c3b11a2f5f2eee64b9649be717bb5932" category="list-text">提供备份目录的位置，然后单击下一步。</block>
  <block id="86a3a7022ed0b6c13289fcbf758e3d5d" category="list-text">卸载所有数据卷。</block>
  <block id="71cb1faebb7f639c1b5a4238f49846f4" category="list-text">提供日志备份的位置。单击下一步。</block>
  <block id="498b10487f14bcddf044e9c0ce0997fb" category="list-text">根据需要选择其他设置。确保未选择使用增量备份。单击下一步。</block>
  <block id="ac359853b48f05fcb2cdd263bd2d14e2" category="list-text">查看恢复设置，然后单击完成。</block>
  <block id="2e40b2a74f9689cc8abbd4feebd9b496" category="paragraph">恢复过程开始。请等待系统数据库恢复完成。</block>
  <block id="52f086817629608d1c9271f5b8ecd51d" category="list-text">选择要恢复的租户，然后单击下一步。</block>
  <block id="fc49bdb5ad0943d1647fac2e1b0c5944" category="list-text">指定恢复类型，然后单击下一步。</block>
  <block id="cc9536c3856cee6b3ae895ffe692fc31" category="list-text">确认备份目录位置，然后单击下一步。</block>
  <block id="57f97e9e6892dd6ef20f4c4bb68ab888" category="list-text">确认租户数据库已脱机。单击确定继续。</block>
  <block id="ae0a00cc6d706f8a9fea3f175b6629a1" category="list-text">确认日志备份位置，然后单击下一步。</block>
  <block id="e4fdc1fd67853318f040ef298f53dde3" category="list-text">查看恢复设置，然后单击完成启动租户数据库的恢复过程。</block>
  <block id="b3eba0eb79b198a3876779400c4884c7" category="list-text">请等待恢复完成并启动租户数据库。</block>
  <block id="a05d610051777823f28850102c89dd02" category="paragraph">SAP HANA 系统已启动且正在运行。</block>
  <block id="2da06d509fa82d9f4e048f53fdd59f2f" category="summary">本技术报告介绍了使用 NetApp SnapCenter 服务和 Azure NetApp Files 保护 SAP HANA 数据的最佳实践。其中包括 SnapCenter 服务概念，配置建议和操作工作流，包括备份，还原和恢复操作。</block>
  <block id="84f6a50de79d49013e595a0b9fd524e0" category="doc">TR-4905 ：《使用 SnapCenter 服务在 Azure NetApp Files 上备份和恢复 SAP HANA 》</block>
  <block id="2090e19c47d41004ac9d83b4c834c1d8" category="paragraph">如今，企业需要为其 SAP 应用程序提供持续，无中断的可用性。面对不断增加的数据量以及系统备份等日常维护任务的需求，他们希望性能水平保持一致。执行 SAP 数据库备份是一项关键任务，可能会对生产 SAP 系统产生显著的性能影响。</block>
  <block id="26c67fe7078b8352435776ec2a49de01" category="paragraph">备份窗口在缩减，而要备份的数据量在增加。因此，很难找到对业务流程影响最小的备份时间。恢复和恢复 SAP 系统所需的时间值得关注，因为 SAP 生产系统和非生产系统的停机时间必须尽可能地减少，以减少数据丢失和业务成本。</block>
  <block id="ce081e1ccd185ea759e068ff2571ccb5" category="paragraph">以下几点总结了 SAP 备份和恢复面临的挑战：</block>
  <block id="e11f2988b7e8f11f425c365fe8cf0392" category="list-text">* 性能对生产 SAP 系统的影响。 * 通常，由于数据库服务器，存储系统和存储网络上的负载过重，基于副本的传统备份会显著降低生产 SAP 系统的性能。</block>
  <block id="cab54e2b3d87df10220254fdc951d470" category="list-text">* 正在缩减备份时间。 * 只有在 SAP 系统上正在进行的对话或批处理活动很少时，才能进行常规备份。当 SAP 系统 24 小时运行时，备份计划变得更加困难。</block>
  <block id="f0e5827e00cf900f71151c63c4f3a68b" category="list-text">* 数据快速增长。 * 数据快速增长和备份时间不断缩短需要对备份基础架构进行持续投资。换言之，您必须购买额外的备份磁盘空间和更快的备份网络。您还必须支付这些备份资产的持续存储和管理费用。增量备份或差异备份可以解决这些问题，但这种安排会导致还原过程非常缓慢，繁琐且复杂，难以验证。此类系统通常会以业务无法接受的方式增加恢复时间目标（ RTO ）和恢复点目标（ RPO ）时间。</block>
  <block id="a8f8133e051f5ce157248709bac6d380" category="list-text">* 停机成本不断增加。 * SAP 系统的计划外停机通常会影响业务财务。在任何计划外停机中，很大一部分是由于需要还原和恢复 SAP 系统而造成的。因此，所需的 RTO 决定了备份和恢复架构的设计。</block>
  <block id="2a6ae4b4f6c920b26c01df5da7c2e422" category="list-text">* SAP 升级项目的备份和恢复时间。 * SAP 升级项目计划至少包括 SAP 数据库的三个备份。这些备份可显著缩短升级过程所需的时间。决定是否继续通常取决于从先前创建的备份还原和恢复数据库所需的时间。快速还原可以提供更多时间来解决升级期间可能发生的问题，而不仅仅是将系统还原到先前的状态。</block>
  <block id="f811314d17a1d16a1faad0f452dc6860" category="doc">用于此报告的实验室设置</block>
  <block id="7e897f23ed71aef1c0a8acf1ae54e9e4" category="section-title">解决方案组件</block>
  <block id="01b841fc3abde7f02e3fc6d20ce2490e" category="list-text">使用基于存储的 Snapshot 副本进行 SAP HANA 数据备份：</block>
  <block id="b91349a37c07cbc607967b352d27ac85" category="list-text">备份计划</block>
  <block id="3dff72048413a2d2a95ad3e613d65664" category="list-text">保留管理</block>
  <block id="868fc3042a779c3102d74797f55dbcb8" category="list-text">维护 SAP HANA 备份目录</block>
  <block id="08982f6d9b754b9de2af69edceefff75" category="list-text">还原操作</block>
  <block id="43390268352d31fc3a2bfe63eda69144" category="list-text">HANA 数据库日志备份的保留管理：</block>
  <block id="f3afcc2a29b00a45585e1d8c2259abaf" category="list-text">基于数据备份保留进行保留管理</block>
  <block id="8c58572df982588195422e103d78a3e6" category="section-title">支持的 SAP HANA 版本和配置</block>
  <block id="c8d591b036c6345c614160fd9eb8e2b7" category="doc">NetApp 解决方案</block>
  <block id="923600a8a9a4e2aae6be8141e3fc623d" category="section-title">Snapshot 备份的运行时</block>
  <block id="20225b7353738f995acfabb75d63c79e" category="paragraph">本节将对基于文件的 Snapshot 备份和基于存储的 Snapshot 备份进行 RTO 比较。RTO 由还原数据库所需时间与启动和恢复数据库所需时间之和定义。</block>
  <block id="3595bb49b6abd88938e481ccc0d97119" category="section-title">还原数据库所需的时间</block>
  <block id="9abaa35fafe6af9114d3f925f652af20" category="section-title">启动数据库所需的时间</block>
  <block id="60ea11645c6193ef1631453b24f6f3ca" category="section-title">恢复数据库所需的时间</block>
  <block id="5cec17cdb7f328cdc9f69b7b0a90d673" category="paragraph">恢复时间取决于还原后必须应用的日志数量。此数字由执行数据备份的频率决定。</block>
  <block id="bd187d40a614fe4ea78dfa6fca960882" category="paragraph">下图显示了使用基于文件的数据备份时 1 TB 数据库的 RTO 示例。在此示例中，每天执行一次备份。RTO 因执行还原和恢复的时间而异。如果在创建备份后立即执行还原和恢复，则 RTO 主要基于还原时间，在示例中为 1 小时 10 分钟。在进行下次备份之前立即执行还原和恢复时，恢复时间增加到 2 小时 50 分钟，最大 RTO 为 4 小时 30 分钟。</block>
  <block id="a61c800d17b38f8aa5ba586ab3ca9a7b" category="paragraph">下图显示了不同数据库大小和不同 Snapshot 备份频率下基于文件和基于存储的 Snapshot 备份的 RTO 比较。绿色条显示了基于文件的备份。其他条形显示备份频率不同的 Snapshot 副本备份。</block>
  <block id="9146086648c59ec16c636f6376bdfd2e" category="paragraph">保留管理逻辑会对 SnapCenter 中的每个备份工作流执行。</block>
  <block id="253e2318e8893b42b0160e70f2371673" category="summary">讨论 SAP 备份，还原和灾难恢复的系列博客</block>
  <block id="3c076a182be1751030f4612f09c54ab2" category="doc">SAP 备份，还原和灾难恢复博客</block>
  <block id="dcfb0772c9f2c9e98d41f5f0e799a89a" category="paragraph">重点介绍 SAP 备份，还原和灾难恢复的博客概述。</block>
  <block id="081d1afe0d87e9b2f649876627d99a0a" category="summary">SAP 备份，还原和灾难恢复解决方案的工具和 TOPS</block>
  <block id="65f93f3854f9150cd54c99843445d646" category="doc">SAP 备份，还原和灾难恢复工具</block>
  <block id="9092d7a45a663f04d4f2be7740ad8f82" category="paragraph">SAP 备份，还原和灾难恢复解决方案和解决方案宣传材料工具概述。</block>
  <block id="4de557ac24bd2fc25bd82bba339024b6" category="inline-link-macro">适用于 MaxDB ， DB2 和 ASE 的 SnapCenter 自定义插件</block>
  <block id="0a01ff5d4ad68f1f814d0d67480b3b30" category="list-text"><block ref="0a01ff5d4ad68f1f814d0d67480b3b30" category="inline-link-macro-rx"></block></block>
  <block id="23083712546bfb74d3153dd83b152769" category="summary">SAP 解决方案产品组合的最新新增功能</block>
  <block id="ff0018dfdf641d75e04d581743c81f22" category="paragraph">最新 SAP 解决方案和解决方案宣传材料概述。</block>
  <block id="91e3a26ea4105ecd20561989c3c58a32" category="inline-link-macro">TR-4290 ：《采用 NFS 配置的 NetApp FAS 系统上的 SAP HANA 》指南</block>
  <block id="6408743c7b0a502fe49fed25ac968c17" category="summary">讨论 SAP 生命周期管理的一系列视频和演示</block>
  <block id="18c100c6d8f14819ac80ee276eb251a6" category="doc">SAP 生命周期管理视频和演示</block>
  <block id="1e36c812f9450a024b52c0b4085d0776" category="paragraph">重点介绍 SAP 生命周期管理的视频和演示概述。</block>
  <block id="5673b57ca1dc3ec2a9c2adcc115e3718" category="inline-link-macro">在发生意外事件时确保业务部门的连续性</block>
  <block id="5fb4ff4d48cdc2aa80ff2d0945e1a23c" category="inline-link-macro">SnapCenter 用例</block>
  <block id="c54076227bebe4b120f17a0f5a22ce81" category="summary">NetApp 提供了大量针对 SAP 和 SAP HANA 的技术报告，经验证的设计，视频，博客和解决方案简介。</block>
  <block id="824aec17cb9bd27843cf6addb92b57fc" category="summary">重点介绍 SAP 解决方案的一系列视频和演示</block>
  <block id="293e9d744a4c2a3dfc4088f7b8aa25d5" category="doc">SAP 解决方案视频和演示</block>
  <block id="2259bdd472d4d2949e3eea23b5e4ef34" category="paragraph">重点介绍 SAP 解决方案的视频和演示概述。</block>
  <block id="aa5b0840e871ca382a477398de4a7243" category="section-title">SAP 配置最佳实践视频和演示</block>
  <block id="ed2640c6c02db4ce182af25c797097d8" category="section-title">SAP 备份，还原和灾难恢复视频和演示</block>
  <block id="eabc448bcef35b3d5eb92882f22f6f0c" category="inline-link-macro">适用于 SAP HANA 的灾难恢复选项</block>
  <block id="dd39ffa36b8ed682c45520c7d7dc8517" category="summary">SAP 生命周期管理工具和提示</block>
  <block id="9ed86ffbd478752ccf2baab032a8e364" category="doc">SAP 生命周期管理工具</block>
  <block id="08fc5b32a35c491189156ebd21b39ecf" category="paragraph">SAP 生命周期管理解决方案和解决方案宣传材料工具概述。</block>
  <block id="3336391ac14de02458baea06fda369fd" category="inline-link-macro">适用于 SAP LaMa 的存储服务连接器（ SSC ）</block>
  <block id="64089c921d1f873faaec351a3fbb7b06" category="list-text"><block ref="64089c921d1f873faaec351a3fbb7b06" category="inline-link-macro-rx"></block></block>
  <block id="9ae2a6f9c25e674f13f60775bc219616" category="summary">讨论 SAP 配置最佳实践的一系列视频和演示</block>
  <block id="e3f458e2f7c3ee2f08aa3f0f84d2057a" category="paragraph">重点介绍 SAP 配置最佳实践的视频和演示概述。</block>
  <block id="99ba99217dcc4bc08573dd9b9c599881" category="summary">讨论 SAP 解决方案的系列博客</block>
  <block id="d1f7df907dee6bb993a5921834e8af81" category="doc">SAP 解决方案博客</block>
  <block id="dd3e5e982b28f1c82ee7d812bb5ef8b6" category="paragraph">重点介绍基于 NetApp 的 SAP 的博客概述。</block>
  <block id="2f473b758c3d7720634f7b7236d0e7bf" category="section-title">SAP 配置最佳实践博客</block>
  <block id="7817ea28831bda7c38bf222b46e04cdd" category="section-title">SAP 生命周期管理博客</block>
  <block id="cda880af5848ab641df0654037dabc8b" category="inline-link-macro">NetApp 的 SAP Landscape Management</block>
  <block id="bc48aec540da03e5e4106e1896968eb5" category="list-text"><block ref="bc48aec540da03e5e4106e1896968eb5" category="inline-link-macro-rx"></block></block>
  <block id="8c0446786df20f3bab9e76c7238785bb" category="summary">有关 SAP 配置最佳实践的工具和提示</block>
  <block id="c22c310ff34da15c4cf9e24071a8d99a" category="doc">SAP 配置最佳实践工具</block>
  <block id="37efeba04a4ec5b4f483120771d49605" category="paragraph">SAP 配置最佳实践解决方案和解决方案宣传材料工具概述。</block>
  <block id="375187184a6023d3a0c03cb49eac0f2f" category="summary">讨论 SAP 配置最佳实践的系列博客</block>
  <block id="926e1400cb4a7cc5855810bdb87175d9" category="paragraph">重点介绍 SAP 配置最佳实践的博客概述。</block>
  <block id="08a3dd34b6649d68580f425952a735ac" category="summary">有关 SAP 备份，还原和灾难恢复的系列视频和演示</block>
  <block id="fc405c6c18eb854c5bfa5e386da6706c" category="paragraph">重点介绍 SAP 备份，还原和灾难恢复的视频和演示概述。</block>
  <block id="dd8cf04faf0e63219895ef355bac05f9" category="summary">讨论 SAP 生命周期管理的系列博客</block>
  <block id="ab6524564d590a2cf59d10dcc63ff99e" category="paragraph">重点介绍 SAP 生命周期管理的博客概述。</block>
  <block id="b45ecd3afcfa865514a59b475de3e93e" category="sidebar">FlexPod SAP 解决方案</block>
  <block id="cd0aa799857a204938b1d6cabb99618f" category="doc">SAP 的新增功能</block>
  <block id="243e854b0d7da6e16a4a87f0f9ea87ba" category="paragraph">要了解有关本文档中所述信息的更多信息，请参见以下文档：</block>
  <block id="b1cd4632a9cd8998e7a0017f528fcc5b" category="list-text">利用 SnapCenter 自动执行 SAP HANA 系统复制和克隆操作</block>
  <block id="36352fdf713e8c1508666c9640668e0a" category="summary">SnapCenter 4.6 支持对配置有 HANA 系统复制的 HANA 系统进行自动发现。SnapCenter 4.6 包含一个逻辑，用于在备份操作期间识别主和二级 HANA 主机，并处理两个 HANA 主机之间的保留管理。</block>
  <block id="8b1c808eafbee9527d4e168ef1f16c09" category="doc">使用资源组的 SnapCenter 4.6 配置</block>
  <block id="b39fd9047d2089b24c418d3512b8c903" category="paragraph">SnapCenter 4.6 支持对配置有 HANA 系统复制的 HANA 系统进行自动发现。SnapCenter 4.6 包含一个逻辑，用于在备份操作期间识别主和二级 HANA 主机，并处理两个 HANA 主机之间的保留管理。此外，自动还原和恢复现在也可用于 HANA 系统复制环境。</block>
  <block id="6a24c6a18054ecbcf8919b90f4ff5eb8" category="section-title">HANA 系统复制环境的 SnapCenter 4.6 配置</block>
  <block id="ef7979296ea2465331699c64e5450ad0" category="paragraph">下图显示了本章使用的实验室设置。两个 HANA 主机 HANA 3 和 HANA 4 配置了 HANA 系统复制。</block>
  <block id="3719dabf545d56e27391b4c1bb73b944" category="paragraph">从较高的角度来看，您必须执行以下步骤在 SnapCenter 中设置 HANA 系统复制。</block>
  <block id="bc1873525b8d9ae5c49626cd6b47592c" category="list-text">在主主机和二级主机上安装 HANA 插件。系统将对每个主主机或二级主机执行自动发现并检测到 HANA 系统复制状态。</block>
  <block id="3b7407b92790f4d78d820c6ebd3e159d" category="list-text">执行 SnapCenter `configure database` 并提供 `hdbuserstore` 密钥。将执行更多自动发现操作。</block>
  <block id="93564a49cedf2137deead20877f792cd" category="list-text">创建一个资源组，包括两个主机并配置保护。</block>
  <block id="b9e7f8ca0dd679eb7244d3b0c456f58e" category="paragraph">在两台 HANA 主机上安装 SnapCenter HANA 插件后， HANA 系统将以与其他自动发现的资源相同的方式显示在 SnapCenter 资源视图中。从 SnapCenter 4.6 开始，将显示一个附加列，其中显示 HANA 系统复制的状态（已启用 / 已禁用，主 / 二级）。</block>
  <block id="d6fc9c8644818503f282251021723ef4" category="paragraph">通过单击资源， SnapCenter 请求 HANA 系统的 HANA 用户存储密钥。</block>
  <block id="8b0bc5e36095bf09eb695be9b8de1862" category="paragraph">此时将执行其他自动发现步骤， SnapCenter 将显示资源详细信息。在 SnapCenter 4.6 中，系统复制状态和二级服务器将在此视图中列出。</block>
  <block id="28fd5edae03b34a5e3181325d18aaf9b" category="paragraph">对第二个 HANA 资源执行相同步骤后，自动发现过程完成，两个 HANA 资源均在 SnapCenter 中配置。</block>
  <block id="3a6aa9f1c27d2d807b9c4b5cc15c0c66" category="paragraph">对于启用了 HANA 系统复制的系统，您必须配置 SnapCenter 资源组，包括两个 HANA 资源。</block>
  <block id="78110de010c4ee1945de37cc79b3b7cf" category="paragraph">NetApp 建议对 Snapshot 名称使用自定义名称格式，其中应包括主机名，策略和计划。</block>
  <block id="7ca4e5c2fcfa31585e0bf441458f2cfc" category="paragraph">您必须将这两个 HANA 主机添加到资源组中。</block>
  <block id="ed775f1c4384259d73349821be6c2694" category="paragraph">已为资源组配置策略和计划。</block>
  <block id="91804b09f65a1f54267e7fa96cbfd6f1" category="admonition">策略中定义的保留将在两个 HANA 主机上使用。例如，如果在策略中定义了保留 10 ，则会将两个主机的备份总数用作备份删除的标准。如果最旧的备份是在当前主主机或二级主机上创建的，则 SnapCenter 会单独删除该备份。</block>
  <block id="d963f6f8f451d72b26442e3c2c35bcf1" category="paragraph">现在，资源组配置已完成，可以执行备份。</block>
  <block id="fb04e74862dcc89c849934898ae20df8" category="section-title">Snapshot 备份操作</block>
  <block id="c14b7fc8184ded19e7d1d53f9e7ab803" category="paragraph">执行资源组的备份操作时， SnapCenter 会确定哪个主机为主主机，并且仅会在主主机上触发备份。这意味着，只会对主主机的数据卷进行快照。在我们的示例中， HANA 3 是当前主主机，并在此主机上执行备份。</block>
  <block id="779618797296fde495820a84f779ecab" category="paragraph">SnapCenter 作业日志显示了当前主主机 HANA — 3 上的标识操作和备份执行情况。</block>
  <block id="c652f5e24fbe7fb888911613189b45da" category="paragraph">现在，已在主 HANA 资源上创建 Snapshot 备份。备份名称中包含的主机名显示 HANA — 3 。</block>
  <block id="bcb05d93e0f8deb7992f97c99b67a704" category="paragraph">同一 Snapshot 备份也会显示在 HANA 备份目录中。</block>
  <block id="227417a294975cfdd600c953a7227e0a" category="paragraph">如果执行接管操作，则现在，进一步的 SnapCenter 备份会将以前的二级主机（ HANA 4 ）标识为主主机，并在 HANA 4 上执行备份操作。同样，只有新主主机（ HANA 4 ）的数据卷才会进行快照。</block>
  <block id="126fd58f4273ad597cbcab66140a53bf" category="admonition">SnapCenter 标识逻辑仅涵盖 HANA 主机处于主 - 二级关系或其中一个 HANA 主机脱机的情形。</block>
  <block id="146a3e54d7baf77bf5f24736862b2e87" category="paragraph">SnapCenter 作业日志显示了当前主主机 HANA — 4 上的标识操作和备份执行情况。</block>
  <block id="bbd4f4df2e21b1ce421727b7362f417b" category="paragraph">现在，已在主 HANA 资源上创建 Snapshot 备份。备份名称中包含的主机名显示 HANA 。</block>
  <block id="4964ef2f01ba430e3456e779528b2769" category="section-title">使用基于文件的备份执行块完整性检查操作</block>
  <block id="b69253be3260fc04bd3bfddc522b4fc4" category="paragraph">SnapCenter 4.6 使用的逻辑与基于文件的备份对块完整性检查操作执行 Snapshot 备份操作时所述的逻辑相同。SnapCenter 可识别当前的主 HANA 主机，并为此主机执行基于文件的备份。保留管理也会在这两个主机上执行，因此，无论哪个主机当前是主主机，都将删除最旧的备份。</block>
  <block id="6856414db85233a8e045263f695b175e" category="section-title">SnapVault 复制</block>
  <block id="061d3cb22e674e47881a1e516fec08eb" category="paragraph">要在发生接管时无需手动交互即可执行透明备份操作，并且与当前主主机是哪个 HANA 主机无关，您必须为这两个主机的数据卷配置 SnapVault 关系。每次运行备份时， SnapCenter 都会对当前主主机执行 SnapVault 更新操作。</block>
  <block id="6d2237ec4d6cf324b50a6aa67d5813d6" category="admonition">如果接管到二级主机的时间较长，则二级主机上首次 SnapVault 更新所更改的块数将较高。</block>
  <block id="8bcfb1be8ac0f60d97f95518b3e7f466" category="paragraph">由于 SnapVault 目标上的保留管理由 ONTAP 在 SnapCenter 外部进行管理，因此无法在两个 HANA 主机上处理保留。因此，在接管之前创建的备份不会随前一个二级系统上的备份操作一起删除。这些备份会一直保留，直到以前的主备份重新成为主备份为止。为了使这些备份不会阻止日志备份的保留管理，必须在 SnapVault 目标或 HANA 备份目录中手动删除它们。</block>
  <block id="e16ff6e568f8eb35263ae87e0b2fb4c7" category="admonition">无法清理所有 SnapVault Snapshot 副本，因为一个 Snapshot 副本会被阻止作为同步点。如果也需要删除最新的 Snapshot 副本，则必须删除 SnapVault 复制关系。在这种情况下， NetApp 建议删除 HANA 备份目录中的备份，以解除日志备份保留管理的阻止。</block>
  <block id="dc89ca90a524118bdb23dfe95009d16c" category="paragraph">SnapCenter 4.6 可管理两个 HANA 主机中 Snapshot 备份，块完整性检查操作， HANA 备份目录条目和日志备份（如果未禁用）的保留，因此，无论当前是主主机还是二级主机，都无关紧要。无论当前主主机还是二级主机上是否需要执行删除操作， HANA 目录中的备份（数据和日志）和条目都会根据定义的保留时间进行删除。换言之，如果执行接管操作和 / 或在另一方向配置复制，则无需手动交互。</block>
  <block id="6db8f8c174516b1dc5a1f3305fe43190" category="paragraph">下图显示了在两个站点上执行了多个接管并创建了 Snapshot 备份的情形。在当前状态下，主机 HANA 为主主机，最新备份为 T4 ，该备份已在主机 HANA 3 上创建。如果需要执行还原和恢复操作，可以在 SnapCenter 中使用备份 T1 和 T4 进行还原和恢复。在主机 HANA 4 （ t2 ， t3 ）上创建的备份无法使用 SnapCenter 进行还原。必须手动将这些备份复制到 HANA 3 的数据卷以进行恢复。</block>
  <block id="50ff1d24fad3646f6fdf9aea77002929" category="inline-link-macro">从在另一主机上创建的备份还原和恢复</block>
  <block id="6f14e8618cb532fa598b498e9c3fc455" category="paragraph">一节介绍了从另一主机上创建的备份执行的还原操作 <block ref="383e6e7e7573de7f2a0f06e6daaee412" category="inline-link-macro-rx"></block>。</block>
  <block id="1fd25d525832cdf3655a067856ae6010" category="summary">SnapCenter 资源使用 HANA 系统复制环境的虚拟 IP 地址（主机名）进行配置。通过这种方法，无论主机 1 还是主机 2 是主主机， SnapCenter 始终与主主机进行通信。</block>
  <block id="260f08a78b9b41762b41f2772c1cda65" category="doc">使用单个资源的 SnapCenter 配置</block>
  <block id="5411f416854228c6901553a528a29ad7" category="paragraph">SnapCenter 资源使用 HANA 系统复制环境的虚拟 IP 地址（主机名）进行配置。通过这种方法，无论主机 1 还是主机 2 是主主机， SnapCenter 始终与主主机进行通信。两个 SAP HANA 主机的数据卷均包含在 SnapCenter 资源中。</block>
  <block id="d223d6e73fef21ec370c1a5c0e109630" category="admonition">我们假定虚拟 IP 地址始终绑定到主 SAP HANA 主机。在 HANA 系统复制故障转移工作流中，虚拟 IP 地址的故障转移会在 SnapCenter 外部执行。</block>
  <block id="6f723c4c9a56249ef6ad0fc5205452b8" category="paragraph">在主机 1 作为主主机执行备份时，系统会在主机 1 的数据卷上创建数据库一致的 Snapshot 备份。由于主机 2 的数据卷是 SnapCenter 资源的一部分，因此会为此卷创建另一个 Snapshot 副本。此 Snapshot 副本不是数据库一致的，而是只是二级主机的崩溃映像。</block>
  <block id="748f9383138a6d21a5f9dc95cf69b88c" category="paragraph">SAP HANA 备份目录和 SnapCenter 资源包括在主机 1 上创建的备份。</block>
  <block id="9b9c7d8b5c0d0fafbea9ea847faf4e80" category="paragraph">下图显示了故障转移到主机 2 以及从主机 2 复制到主机 1 后的备份操作。SnapCenter 会使用 SnapCenter 资源中配置的虚拟 IP 地址自动与主机 2 通信。现在，备份会在主机 2 上创建。SnapCenter 会创建两个 Snapshot 副本：主机 2 的数据卷上的数据库一致备份和主机 1 的数据卷上的崩溃映像 Snapshot 副本。SAP HANA 备份目录和 SnapCenter 资源现在包括在主机 1 上创建的备份以及在主机 2 上创建的备份。</block>
  <block id="2b26158b4aff092cc0728d277d344a5a" category="paragraph">数据和日志备份的管理是根据定义的 SnapCenter 保留策略进行的，无论主主机还是二级主机，备份都将被删除。</block>
  <block id="b3c7f675aa9e386d0aaa73f2de847188" category="inline-link-macro">存储 Snapshot 备份和 SAP 系统复制</block>
  <block id="102f334e96097bebfae58a079388d7f2" category="paragraph">如本节所述 <block ref="570e066d63188ae45a45b07d6865440b" category="inline-link-macro-rx"></block>，使用基于存储的 Snapshot 备份执行的还原操作有所不同，具体取决于必须还原的备份。请务必确定在哪个主机上创建备份，以确定是否可以在本地存储卷上执行还原，或者是否必须在另一主机的存储卷上执行还原。</block>
  <block id="76668f896551ee021941705402feda3b" category="paragraph">使用单资源 SnapCenter 配置时， SnapCenter 无法识别备份的创建位置。因此， NetApp 建议您在 SnapCenter 备份工作流中添加备份前脚本，以确定哪个主机当前是主 SAP HANA 主机。</block>
  <block id="bb9f6626d16fda2d847f88dabedc7961" category="paragraph">下图显示了备份主机的标识。</block>
  <block id="4b152f4bba0a5ca6345daa47736e4622" category="section-title">SnapCenter 配置</block>
  <block id="32423786e97f4f83fdc90f030727503b" category="paragraph">下图显示了实验室设置以及所需 SnapCenter 配置的概述。</block>
  <block id="c1968668fc5cbc2c5e8b49c18c362b55" category="paragraph">要执行备份操作，而无论哪个 SAP HANA 主机是主主机，甚至在一个主机关闭时也是如此，必须在中央插件主机上部署 SnapCenter SAP HANA 插件。在实验室设置中，我们使用 SnapCenter 服务器作为中央插件主机，并在 SnapCenter 服务器上部署 SAP HANA 插件。</block>
  <block id="bd5c6333eef324e59a3de18aa6e29173" category="paragraph">在 HANA 数据库中创建了一个用户来执行备份操作。在安装了 SAP HANA 插件的 SnapCenter 服务器上配置了用户存储密钥。用户存储密钥包括 SAP HANA 系统复制主机的虚拟 IP 地址（ `sSR-VIP` ）。</block>
  <block id="d7e2061a39f4790783431f1963349b9b" category="paragraph">在 SnapCenter 中，使用之前配置的用户存储密钥和 SnapCenter 服务器作为 `hdbsql` 通信主机来配置资源，如下图所示。</block>
  <block id="2a64b18e126555fa2ca4e7fb0bf3bc37" category="paragraph">两个 SAP HANA 主机的数据卷都包含在存储占用空间配置中，如下图所示。</block>
  <block id="90323af735fbe3861cb8bc49a36914b1" category="paragraph">如前文所述， SnapCenter 不知道备份的创建位置。因此， NetApp 建议您在 SnapCenter 备份工作流中添加备份前脚本，以确定哪个主机当前是主 SAP HANA 主机。您可以使用添加到备份工作流中的 SQL 语句执行此标识，如下图所示。</block>
  <block id="0b345bf9ce49cf6e06f2ca4c412deff5" category="section-title">SnapCenter 备份操作</block>
  <block id="82e7650ccab95a6d3386e10752618019" category="paragraph">现在，备份操作将照常执行。数据和日志备份的管理独立于主或二级 SAP HANA 主机。</block>
  <block id="d0c6300a20b1a2c2c3b854a631ac2e32" category="paragraph">备份作业日志包含 SQL 语句的输出，通过该语句，您可以确定创建备份的 SAP HANA 主机。</block>
  <block id="6354370842f86dd420800ec685504912" category="paragraph">下图显示了将主机 1 作为主主机的备份作业日志。</block>
  <block id="21707873392b599f402b6c2e8519e23a" category="paragraph">此图显示了将主机 2 作为主主机的备份作业日志。</block>
  <block id="13dea575ccfa5ca9cd3d63c2e68f6d10" category="paragraph">下图显示了 SAP HANA Studio 中的 SAP HANA 备份目录。当 SAP HANA 数据库处于联机状态时，创建备份的 SAP HANA 主机将显示在 SAP HANA Studio 中。</block>
  <block id="193b24cf7c478d099c4fbbe19f8ad124" category="admonition">还原和恢复操作期间使用的文件系统上的 SAP HANA 备份目录不包含创建备份的主机名。在数据库关闭时识别主机的唯一方法是，将备份目录条目与两个 SAP HANA 主机的 `backup.log` 文件结合使用。</block>
  <block id="2e0e4fbbcdc158520c486ebd1cb95f4e" category="paragraph">如前所述，您必须能够确定所选备份的创建位置，以定义所需的还原操作。如果 SAP HANA 数据库仍处于联机状态，您可以使用 SAP HANA Studio 确定创建备份的主机。如果数据库处于脱机状态，则只有 SnapCenter 备份作业日志中才会提供此信息。</block>
  <block id="ec3a3d8d3490fe3ecd7daa9a92d23e25" category="paragraph">下图显示了根据选定备份的不同还原操作。</block>
  <block id="f3f8ad38930fbe26474c020c9937d5e0" category="paragraph">如果必须在时间戳 T3 且主机 1 为主主机之后执行还原操作，则可以使用 SnapCenter 还原在 T1 或 T3 创建的备份。这些 Snapshot 备份可在连接到主机 1 的存储卷上使用。</block>
  <block id="a039a31368090cbccac747771d4314fe" category="paragraph">如果您需要使用在主机 2 （ t2 ）上创建的备份进行还原，该备份是主机 2 存储卷上的 Snapshot 副本，则需要使该备份可供主机 1 使用。您可以通过从备份创建 NetApp FlexClone 副本，将 FlexClone 副本挂载到主机 1 以及将数据复制到原始位置来使此备份可用。</block>
  <block id="cc77c2d84c4d0532580c7648fb527068" category="paragraph">使用单个 SnapCenter 资源配置时，会在两个 SAP HANA 系统复制主机的两个存储卷上创建 Snapshot 副本。只有在主 SAP HANA 主机的存储卷上创建的 Snapshot 备份才可用于正向恢复。在二级 SAP HANA 主机的存储卷上创建的 Snapshot 副本是一个崩溃映像，不能用于正向恢复。</block>
  <block id="914fe0e173ea134cf6a261a23bb9be7c" category="paragraph">使用 SnapCenter 执行还原操作的方法有两种：</block>
  <block id="da47f45ee3786a65f83ac527b48e3368" category="list-text">仅还原有效的备份</block>
  <block id="efa0a43a073fecc57325043414b7410e" category="list-text">还原整个资源，包括有效的备份和崩溃映像以下各节将更详细地讨论这两种不同的还原操作。</block>
  <block id="cae4c5e22b0e817592c5813faad601cf" category="paragraph">下图显示了使用单个 SnapCenter 资源配置执行的还原操作。</block>
  <block id="999b37dc80676993381a9707924e29c3" category="section-title">仅对有效备份执行 SnapCenter 还原</block>
  <block id="f17433ab3965bf2e142fb4e1dff405e2" category="paragraph">下图显示了本节所述的还原和恢复方案概览。</block>
  <block id="36859b36c1aed5070a33950066055b92" category="paragraph">已在主机 1 的 T1 创建备份。已对主机 2 执行故障转移。经过一段时间后，再次故障转移到主机 1 。在当前时间点，主机 1 为主主机。</block>
  <block id="880f2e960b16f01349f2ca3486d1bd6a" category="list-text">发生故障，您必须还原到主机 1 的 T1 上创建的备份。</block>
  <block id="4af51d00fac3b893eeec6663c152d51a" category="list-text">二级主机（主机 2 ）已关闭，但不执行任何还原操作。</block>
  <block id="7ded02ea0206a70a9c98edbe7828dcdb" category="list-text">主机 1 的存储卷将还原到在 T1 创建的备份。</block>
  <block id="dd764570723e348d81f59c7841180784" category="list-text">使用主机 1 和主机 2 中的日志执行正向恢复。</block>
  <block id="209c12c254cf841cccc9a950309a933e" category="list-text">主机 2 已启动，主机 2 的系统复制重新同步将自动启动。</block>
  <block id="c37725f2a48f8baeb00c03c364ea3a90" category="paragraph">下图显示了 SAP HANA Studio 中的 SAP HANA 备份目录。突出显示的备份显示了在主机 1 的 T1 上创建的备份。</block>
  <block id="5b426b49c093dba7596721df7ef7ef47" category="paragraph">在 SAP HANA Studio 中启动还原和恢复操作。如下图所示，在还原和恢复工作流中看不到创建备份的主机的名称。</block>
  <block id="f608de875db67dd46fec88060326d0b1" category="admonition">在我们的测试场景中，我们能够在数据库仍处于联机状态时在 SAP HANA Studio 中确定正确的备份（在主机 1 上创建的备份）。如果数据库不可用，则必须检查 SnapCenter 备份作业日志以确定正确的备份。</block>
  <block id="53b821249032276c494242cb38256d19" category="paragraph">在 SnapCenter 中，选择备份并执行文件级还原操作。在文件级还原屏幕上，仅选择主机 1 卷，以便仅还原有效的备份。</block>
  <block id="b01c5d1bb46aad41f5286805bebfd4f0" category="paragraph">还原操作完成后，备份将在 SAP HANA Studio 中以绿色突出显示。您无需输入其他日志备份位置，因为主机 1 和主机 2 的日志备份的文件路径包含在备份目录中。</block>
  <block id="f286578015316aaefdf2a9d71504270e" category="paragraph">完成正向恢复后，将启动二级主机（主机 2 ），并启动 SAP HANA 系统复制重新同步。</block>
  <block id="4fb7470490997c95ffa1c5600ec5ecd3" category="admonition">即使二级主机是最新的（未对主机 2 执行还原操作）， SAP HANA 也会对所有数据执行完全复制。在使用 SAP HANA 系统复制执行还原和恢复操作后，此行为是标准行为。</block>
  <block id="79dc576ddf59dc20fca6834461f7ac09" category="section-title">对有效备份和崩溃映像进行 SnapCenter 还原</block>
  <block id="da1933d80ef83cf1ec0c167fcc7d7f1e" category="list-text">二级主机（主机 2 ）将关闭，并还原 T1 崩溃映像。</block>
  <block id="184f8e362eb69a36b78d905cfdd2bf4e" category="list-text">主机 2 已启动，主机 2 的系统复制重新同步将自动启动。</block>
  <block id="95069540deba789e6c51a01cc226e5b2" category="paragraph">SAP HANA Studio 的还原和恢复操作与一节中所述的步骤相同 <block ref="873b82be62d7406e4e13ae8683307096" category="inline-link-macro-rx"></block>。</block>
  <block id="ce7fc220814189df737dd5a85d9ec6fe" category="paragraph">要执行还原操作，请在 SnapCenter 中选择 Complete Resource 。两台主机的卷均已还原。</block>
  <block id="a2d30341e8760144a82505e4f2584b74" category="paragraph">完成正向恢复后，将启动二级主机（主机 2 ），并启动 SAP HANA 系统复制重新同步。执行所有数据的完全复制。</block>
  <block id="8b882a288d6cd3bd9c486a64d890100d" category="summary">对于这两种 SnapCenter 配置选项，从在另一个 SAP HANA 主机上创建的备份执行还原操作都是有效的。</block>
  <block id="9256b11afc32bceb372c74dfeeb3433a" category="doc">从在另一主机上创建的备份进行还原和恢复</block>
  <block id="a45630ea5c1a78685a85cc9991055838" category="paragraph">已在主机 1 的 T1 创建备份。已对主机 2 执行故障转移。在当前时间点，主机 2 是主主机。</block>
  <block id="7f7f6d932a287ba353121a42032e859c" category="list-text">主主机（主机 1 ）已关闭。</block>
  <block id="08ab08de2b84a1abeec853852fbb270b" category="list-text">主机 1 的备份数据 T1 会还原到主机 2 。</block>
  <block id="54a006a73eb9494b19b57e09390aac49" category="list-text">使用主机 1 和主机 2 中的日志执行正向恢复。</block>
  <block id="61eb913111b23af6c5cbbc8dbc814cc4" category="list-text">主机 1 已启动，主机 1 的系统复制重新同步将自动启动。</block>
  <block id="420b1e4ee829dd3eb714e9041891238b" category="paragraph">下图显示了 SAP HANA 备份目录，并突出显示了在主机 1 上创建的用于还原和恢复操作的备份。</block>
  <block id="cd5d505ca2373cdc7d18efb2869033ed" category="paragraph">还原操作包括以下步骤：</block>
  <block id="2d08d5136ddc4086894bda34d14b24d0" category="list-text">使用在主机 1 上创建的备份创建克隆。</block>
  <block id="6043974c0cea7ef12e2b91ac16162035" category="list-text">在主机 2 上挂载克隆的卷。</block>
  <block id="451bde33fa7b247f83d7b14fd93c467a" category="list-text">将数据从克隆的卷复制到原始位置。</block>
  <block id="9fcc4360269dfed6a58662eaaff3f7a4" category="paragraph">在 SnapCenter 中，选择备份并启动克隆操作。</block>
  <block id="3b8d6cba3e9f1c4ec4c62eaa46003ff0" category="paragraph">您必须提供克隆服务器和 NFS 导出 IP 地址。</block>
  <block id="50d76361ddca8e22e3d17e0f39e45c9c" category="admonition">在 SnapCenter 单资源配置中， SAP HANA 插件不会安装在数据库主机上。要执行 SnapCenter 克隆工作流，可以使用安装了 HANA 插件的任何主机作为克隆服务器。</block>
  <block id="59edb5bba2c252f423a3013c5a80ed7a" category="paragraph">+ 在具有单独资源的 SnapCenter 配置中， HANA 数据库主机将被选择为克隆服务器，并使用挂载脚本将克隆挂载到目标主机。</block>
  <block id="fe739341f732db5aff63cb28381d9cdc" category="paragraph">要确定挂载克隆卷所需的接合路径，请检查克隆作业的作业日志，如下图所示。</block>
  <block id="a5f909bb980ebce8c8c504b2b21da69a" category="paragraph">现在可以挂载克隆的卷。</block>
  <block id="c5dcd428c947792bd217fd89ee812f51" category="paragraph">克隆的卷包含 HANA 数据库的数据。</block>
  <block id="1f20a3a37744f93109db368fed3d4d72" category="paragraph">数据将复制到原始位置。</block>
  <block id="691b6e8cda25aff0ec57af52318e1685" category="paragraph">使用 SAP HANA Studio 进行恢复的过程如一节所述 <block ref="873b82be62d7406e4e13ae8683307096" category="inline-link-macro-rx"></block>。</block>
  <block id="cb014ba864354c430b0d6d7e306d1c0c" category="summary">此页面介绍 SAP 系统复制的配置选项。</block>
  <block id="76c0a8113c74eb76e36c8c87f7095211" category="doc">适用于 SAP 系统复制的 SnapCenter 配置选项</block>
  <block id="b65fb91c7466f471e73d7a165cddad8f" category="paragraph">在 SAP HANA 系统复制环境中，使用 NetApp SnapCenter 软件配置数据保护有两种选择：</block>
  <block id="a6161fc735dff46e0f1e300b07198882" category="list-text">SnapCenter 资源组，包括 SAP HANA 主机和 SnapCenter 4.6 或更高版本的自动发现。</block>
  <block id="27cd07c42b7b1163d4ec30ce77a50ba7" category="list-text">使用虚拟 IP 地址为两个 SAP HANA 主机提供一个 SnapCenter 资源。</block>
  <block id="8cf962f6ac56a026f883cf2e827b0423" category="paragraph">从 SnapCenter 4.6 开始， SnapCenter 支持自动发现在 HANA 系统复制关系中配置的 HANA 系统。每个主机都使用其物理 IP 地址（主机名）及其存储层上的单个数据卷进行配置。这两个 SnapCenter 资源将组合在一个资源组中， SnapCenter 会自动确定主主机或二级主机，并相应地执行所需的备份操作。对 SnapCenter 创建的 Snapshot 备份和基于文件的备份执行保留管理，以确保旧备份也会在当前二级主机上被删除。</block>
  <block id="cbcfd6defd0fc62b33d3178fca9312bf" category="paragraph">对于两个 SAP HANA 主机的单资源配置，使用 SAP HANA 系统复制主机的虚拟 IP 地址配置单个 SnapCenter 资源。SAP HANA 主机的两个数据卷都包含在 SnapCenter 资源中。由于它是一个 SnapCenter 资源，因此 SnapCenter 创建的 Snapshot 和基于文件的备份的保留管理与当前的主主机或二级主机无关。所有 SnapCenter 版本均可使用此选项。</block>
  <block id="56360ee768eb6691b2c48a27f2d5295a" category="paragraph">下表总结了这两个配置选项的主要区别。</block>
  <block id="624d27e661ea476c564f0a0e3d4759da" category="cell">使用 SnapCenter 4.6 的资源组</block>
  <block id="26fa56c884b002243efdac83893ee4ce" category="cell">单个 SnapCenter 资源和虚拟 IP 地址</block>
  <block id="99f1744d8b70ed4b0920b180edf0fcaf" category="cell">备份操作（ Snapshot 和基于文件）</block>
  <block id="b683f173eb3a957cb9fcf3dee8b98d20" category="cell">自动标识资源组中的主主机</block>
  <block id="d0a2e35f97d84456638a2e94141fefe0" category="cell">自动使用虚拟 IP 地址</block>
  <block id="cba3252df7023060b9d2ea4794c05c95" category="cell">保留管理（基于 Snapshot 和文件）</block>
  <block id="d7689d65ad93f6364ea756a32efbf386" category="cell">在两个主机上自动执行</block>
  <block id="8d7c7381c71c46d6b299eed1ea14ad55" category="cell">自动使用单个资源</block>
  <block id="c8fa3fe6d9be52e4e17b9869fed3de64" category="cell">备份容量要求</block>
  <block id="5bb47a2dec0018ff60254946131850c6" category="cell">备份仅在主主机卷上创建</block>
  <block id="0bd97517cd8fd61a12818f7ae5a32550" category="cell">备份始终在两个主机卷上创建。第二台主机的备份仅保持崩溃状态一致，不能用于前滚。</block>
  <block id="9ab07fad125b53ff193b9837f7d654bb" category="cell">当前活动主机的备份可用于还原操作</block>
  <block id="85afbaa0de4ef1ff6c48b160c1b340ff" category="cell">需要使用备份前脚本来确定哪些备份有效且可用于还原</block>
  <block id="8d5e0cfc83e98d36864aa5b7f1ba6186" category="cell">恢复操作</block>
  <block id="a92469fe3f104489efc5db9c40bbbea5" category="cell">所有恢复选项均可用，与任何自动发现的资源相同</block>
  <block id="54bdadbafa35816a3af014e9c09e968a" category="cell">需要手动恢复</block>
  <block id="bae3dca5f2cc89808cfbe3a06c9cb114" category="admonition">通常， NetApp 建议在 SnapCenter 4.6 中使用资源组配置选项来保护启用了 HANA 系统复制的 HANA 系统。只有在 SnapCenter 操作方法基于中央插件主机且 HANA 插件未部署在 HANA 数据库主机上时，才需要使用单个 SnapCenter 资源配置。</block>
  <block id="075a31e8a9e4995876239319585370dc" category="paragraph">以下各节将详细讨论这两个选项。</block>
  <block id="02d0cc60ddfcc9dc29916a6b5d3b6cf2" category="summary">备份操作始终在主 SAP HANA 主机上执行。无法在二级 SAP HANA 主机上执行备份操作所需的 SQL 命令。</block>
  <block id="8acd7da6dce942a7c8148e0a6e5875e2" category="doc">Storage Snapshot 备份和 SAP 系统复制</block>
  <block id="1d3a0cbc6231799f2858090710d6f945" category="paragraph">对于 SAP HANA 备份操作，主 SAP HANA 主机和二级 SAP HANA 主机是一个实体。它们共享同一个 SAP HANA 备份目录，并使用备份进行还原和恢复，而不管备份是在主 SAP HANA 主机还是在二级 SAP HANA 主机上创建的。</block>
  <block id="c492ffff6ae308c1f530d6498d7ecfe5" category="paragraph">要使用任何备份进行还原并使用日志备份从两个主机执行正向恢复，需要一个可从两个主机访问的共享日志备份位置。NetApp 建议您使用共享存储卷。但是，您还应将日志备份目标分隔为共享卷中的子目录。</block>
  <block id="0dc8552d7c114c04ba4721d2bfce22a8" category="paragraph">每个 SAP HANA 主机都有自己的存储卷。使用基于存储的 Snapshot 执行备份时，系统会在主 SAP HANA 主机的存储卷上创建数据库一致的 Snapshot 。</block>
  <block id="20298f12913ee9159d89657f340f41d0" category="paragraph">执行到主机 2 的故障转移时，主机 2 将成为主主机，备份在主机 2 上执行， Snapshot 备份在主机 2 的存储卷上创建。</block>
  <block id="ec9f7dc4c9415267c560fe9756643a87" category="paragraph">在主机 2 上创建的备份可以直接在存储层进行还原。如果必须使用在主机 1 上创建的备份，则必须将备份从主机 1 存储卷复制到主机 2 存储卷。正向恢复使用两个主机的日志备份。</block>
  <block id="d53230f85b50903f17f7e6099737f107" category="summary">SAP HANA 系统复制通常用作 SAP HANA 数据库的高可用性或灾难恢复解决方案。SAP HANA 系统复制提供了不同的操作模式，您可以根据使用情形或可用性要求使用这些模式。</block>
  <block id="ac95c867fdf2157d0248719b002ae0f0" category="paragraph">可以将两种主要用例结合使用：</block>
  <block id="c34a01f37570a68dbcba0f7ef58b79c6" category="list-text">使用专用二级 SAP HANA 主机实现高可用性，恢复点目标（ RPO ）为零，恢复时间目标（ RTO ）为最短。</block>
  <block id="d824f0f483d8766968c3873c43c7e813" category="list-text">远距离灾难恢复。在正常运行期间，还可以使用二级 SAP HANA 主机进行开发或测试。</block>
  <block id="f5c1fbf48c6494a4f2e5ddc50e73ce6e" category="section-title">高可用性， RPO 为零， RTO 最小</block>
  <block id="af656bf36a5e2d1cdf132f7992f06b9e" category="paragraph">系统复制使用预加载到二级 SAP HANA 主机内存中的表来配置同步复制。此高可用性解决方案可用于解决硬件或软件故障，并在 SAP HANA 软件升级期间减少计划内停机时间（几乎为零停机操作）。</block>
  <block id="1634b98ad5173e165735c803c11fe9d5" category="paragraph">故障转移操作通常通过使用第三方集群软件或使用 SAP Landscape Management 软件的一键式工作流实现自动化。</block>
  <block id="3d3f4f563a8744c58df8ea6e38510f02" category="paragraph">从备份要求角度来看，您必须能够创建备份，而不受主或二级 SAP HANA 主机的影响。共享备份基础架构用于还原任何备份，而不管在哪个主机上创建了备份。</block>
  <block id="511a3a3dfd265b06ef79626d79c520e7" category="paragraph">本文档其余部分将重点介绍将 SAP 系统复制配置为高可用性解决方案时的备份操作。</block>
  <block id="24d82a388e886346237cd51fe934aa03" category="section-title">远距离灾难恢复</block>
  <block id="118abb1eac5a98e2067a4403636320af" category="paragraph">系统复制可以配置为使用异步复制，而不会在二级主机的内存中预加载任何表。此解决方案用于解决数据中心故障，故障转移操作通常是手动执行的。</block>
  <block id="6daa00da4eeb35d26853e03f23ef0546" category="paragraph">关于备份要求，您必须能够在数据中心 1 的正常运行期间以及数据中心 2 的灾难恢复期间创建备份。数据中心 1 和 2 中提供了一个单独的备份基础架构，备份操作会在灾难故障转移过程中激活。备份基础架构通常不会共享，无法对在另一数据中心创建的备份执行还原操作。</block>
  <block id="0844bd2427e754de1d07ca91d15284a5" category="cell">文档版本历史记录</block>
  <block id="77fce67ff1ced73f063cdd19c439b627" category="cell">2018 年 10 月</block>
  <block id="b9365bb9132d1eb8770275a763fc5d69" category="cell">2022 年 1 月</block>
  <block id="bc86535b64f45ec20770222ebaa5ca21" category="cell">更新以涵盖 SnapCenter 4.6 HANA 系统复制支持</block>
  <block id="02fa3d38f575ae1d4c7d0f5663a0d3ed" category="sidebar">使用 SnapCenter 备份和恢复 SAP HANA 系统复制</block>
  <block id="4bb12dc6461f1d5fa4e11ed67fdeef9e" category="sidebar">SAP HANA 系统复制概述</block>
  <block id="152277675a8ef46c12f1dc91f2f53ede" category="paragraph">有关适用于 SAP HANA 的 NetApp 认证存储解决方案的完整列表，请参见<block ref="a3976abaebe3520fd66c465c4d7747d7" category="inline-link-rx"></block>。</block>
  <block id="18cab9085e2115741cf08f1964299a5a" category="paragraph">本文档介绍了 NFS 协议版本 3 （ NFSv3 ）或 NFS 协议版本 4 （ NFSv4.1 ）的 ONTAP 配置要求。</block>
  <block id="c16b7b6c06ec01825313e31feb82c6d2" category="cell">rsize=1048576 ， wsize=262144</block>
  <block id="5f99a6ad54bfd8d0c68c8cc9f709365b" category="inline-link">SAP 备注： 1900823</block>
  <block id="8e473bb8179de06c9675fded85db8531" category="paragraph">有关 SAP HANA 容量要求的详细问题描述，请参见<block ref="7c7e574e6ad6c7603298dd899482269f" category="inline-link-rx"></block> 白皮书。</block>
  <block id="0b65064648e048922c198e4d6e2cafc1" category="admonition">使用不同的存储虚拟接口连接每个数据卷，以确保每个卷使用不同的 TCP 会话，或者使用 nconnect 挂载选项（如果适用于您的操作系统）。</block>
  <block id="4a09ae73b23148acb0508b47589e3623" category="cell">rsize=1048576 ， wsize=262144 ，</block>
  <block id="f9d7623ba6cc83509340e737618f63c2" category="paragraph">以下示例显示了一个主机 SAP HANA 数据库，其中 SID=NF2 使用 NFSv3 ， NFS 传输大小为 1 MB 用于读取， 256 k 用于写入。</block>
  <block id="b6002aa673859c29cc8fc6915c01cf54" category="paragraph">下一个示例显示了一个多主机 SAP HANA 数据库，其中 SID=NF2 对数据和日志文件系统使用 NFSv4.1 ，而对 ` ， HA/Shared` 和 ` ， USR/SAP/NF2` 文件系统使用 NFSv3 。使用 1 MB 的 NFS 传输大小进行读取，使用 256 k 的 NFS 传输大小进行写入。</block>
  <block id="4ba3e1c058ef7fff97064b76f2483b24" category="paragraph">有关 SAP HANA 容量要求的详细问题描述，请参见<block ref="7c7e574e6ad6c7603298dd899482269f" category="inline-link-rx"></block> 随附白皮书。</block>
  <block id="45bb1f13b573370e5659e113eaa6e2a7" category="paragraph">本文档介绍了 NFS 版本 3 （ NFSv3 ）协议或 NFS 版本 4 （ NFSv4.1 ）协议的 ONTAP 配置要求。</block>
  <block id="bc3bbc9b5df10cfc4c9d9747e9b15e4f" category="paragraph">有关适用于 SAP HANA 的 NetApp 认证存储解决方案的完整列表，请参见<block ref="2585df8f0f74fb3d91dc9a930fa3213b" category="inline-link-rx"></block>。</block>
  <block id="97bfb54320c9268725cfbb374a5168fb" category="paragraph">有关适用于 SAP HANA 的 NetApp 认证存储解决方案的完整列表，请参见<block ref="a3976abaebe3520fd66c465c4d7747d7" category="inline-link-rx"></block>。</block>
  <block id="71eda0c30c9b341a4814ddd0954d1862" category="summary">本节介绍初始 SnapCenter 配置，包括存储系统，凭据，主机， hdbsql. 客户端和策略。</block>
  <block id="4386d3e7902f293404d64c4abe1e295d" category="doc">初始 SnapCenter 配置</block>
  <block id="a68a95b40735fd6822c60b05c35bb544" category="paragraph">初始配置包括以下步骤：</block>
  <block id="2139fe384d5ae165545994dff01961d9" category="list-text">存储系统配置：</block>
  <block id="a3d3f6c9fdb623aaaa9ab78bf4af2a18" category="list-text">插件安装的凭据配置</block>
  <block id="9a6b88f68b9503b8b8210d2f30184988" category="list-text">对于中央 HANA 插件主机：</block>
  <block id="d1f6ddc617c4c51ad270c9463ed06d40" category="list-text">主机配置和 SAP HANA 插件部署</block>
  <block id="2911ecfc915016f253bcd0e0c564fe74" category="list-text">SAP HANA hdbsql. 客户端软件安装和配置</block>
  <block id="912ee21b90ba32aba0daa8f0d8e4e314" category="list-text">策略配置</block>
  <block id="d8243d84dff5ee3bd86e7f3bae3587b5" category="paragraph">以下各节介绍了初始配置步骤。</block>
  <block id="24f5e840a11590fca0575cc142d6ef35" category="list-text">登录到 SnapCenter 服务器图形用户界面。</block>
  <block id="29ca4e3da48110ba26ba87b3d9a90f16" category="list-text">选择存储系统。</block>
  <block id="29e64158d13453d65dbd12eb9c6f1d75" category="admonition">在屏幕中，您可以选择存储系统类型，可以是 ONTAP SVM 或 ONTAP 集群。如果在 SVM 级别配置存储系统，则需要为每个 SVM 配置一个管理 LIF 。或者，您也可以在集群级别使用 SnapCenter 管理访问。以下示例将使用 SVM 管理。</block>
  <block id="70e5fd718721e814176b70aa732f9153" category="list-text">单击 New 以添加存储系统并提供所需的主机名和凭据。</block>
  <block id="3f20bb8d817b9e6936e5c249b6c113be" category="inline-link">《 SnapCenter 安装指南》</block>
  <block id="b8bc58e2f5a80c623945771af4f0a8b2" category="admonition">SVM 用户不需要是 vsadmin 用户，如屏幕截图所示。通常，在 SVM 上配置用户并为其分配执行备份和还原操作所需的权限。有关所需权限的详细信息，请参见<block ref="7b715dbc2fecfcb275c5209e8e720c86" category="inline-link-rx"></block> 在标题为 " 所需的最小 ONTAP 权限 " 一节中。</block>
  <block id="99e1f8e6cfae3062c90ba4e3fe852eee" category="list-text">单击更多选项以配置存储平台。</block>
  <block id="bf28bc3620d2e85e431236bc6ef90022" category="paragraph">存储平台可以是 FAS ， AFF ， ONTAP Select 或 Cloud Volumes ONTAP 。</block>
  <block id="22563a02dd4dab831f4bae0ae56cf40e" category="admonition">对于用作 SnapVault 或 SnapMirror 目标的系统，选择二级图标。</block>
  <block id="7a09a8e6339e45c4ca4a38a196028cb4" category="list-text">根据需要添加其他存储系统。在我们的示例中，添加了一个额外的异地备份存储和一个灾难恢复存储。</block>
  <block id="9a54594daffa2c01e5e883a01cf1f6f5" category="section-title">凭据配置</block>
  <block id="6ebb04d93cddc56ead5028b5dc46876e" category="list-text">转到 " 设置 " ，选择 " 凭据 " ，然后单击 " 新建 " 。</block>
  <block id="0f3e3833c619c41b3967f317840dbd8d" category="list-text">提供用于在 Linux 系统上安装插件的用户凭据。</block>
  <block id="a848ef1fa53d291c03c4cf559f500322" category="list-text">提供用于在 Windows 系统上安装插件的用户凭据。</block>
  <block id="47f3c6b42d0334c31137562aca2a0b88" category="paragraph">下图显示了已配置的凭据。</block>
  <block id="13755548f18d3df287a2229ebd3d97dc" category="section-title">在中央插件主机上安装 SAP HANA 插件</block>
  <block id="8d4bd2a661b6281b4d82cc00590252be" category="paragraph">在实验室设置中， SnapCenter 服务器也用作中央 HANA 插件主机。运行 SnapCenter 服务器的 Windows 主机将作为主机添加，而 SAP HANA 插件将安装在 Windows 主机上。</block>
  <block id="be95026bc00e897261477d1bef0c1058" category="admonition">SAP HANA 插件需要 Java 64 位版本 1.8 。在部署 SAP HANA 插件之前，需要在主机上安装 Java 。</block>
  <block id="bf0373d0d66d725186d3e84024b089fd" category="list-text">转到主机，然后单击添加。</block>
  <block id="fb8a6d76e5ad5c489027a82c42ccd333" category="list-text">提供所需的主机信息。单击提交。</block>
  <block id="3da08ec555eef13b285f865100858ba8" category="paragraph">下图显示了部署 HANA 插件后配置的所有主机。</block>
  <block id="ff1e6c37ad8f4f2e8e74ab59aea74c3f" category="inline-link">SAP 支持门户</block>
  <block id="c057c768d3ac32304fd365c3084c8fa9" category="paragraph">SAP HANA hdbsql 客户端软件必须安装在安装了 SAP HANA 插件的同一主机上。可从下载此软件<block ref="fbd74ee0e1039f20414be5f6472224aa" category="inline-link-rx"></block>。</block>
  <block id="4b9d3e971ab2f9958c9a94799f2fe172" category="paragraph">在资源配置期间配置的 HDBSQL 操作系统用户必须能够运行 hdbsql. 可执行文件。必须在 `hana.properties` 文件中配置 hdbsql. 可执行文件的路径。</block>
  <block id="140710a8dd48496a1ea3b09f2799c408" category="list-text">Windows</block>
  <block id="82c6ab7bfe1f9fbf789b4f7f57b56c24" category="list-text">Linux ：</block>
  <block id="60ed9fa3660d9d3970b9500659efd5cd" category="section-title">策略配置</block>
  <block id="4750513b209adc2889d7e8846336ec09" category="paragraph">如本节所述 <block ref="632aac3b144bda24e7e889a956825abd" category="inline-link-macro-rx"></block> 策略通常独立于资源进行配置，可供多个 SAP HANA 数据库使用。</block>
  <block id="701ae19153f59cf5b064428875e644e2" category="list-text">无复制的每小时备份策略： `LocalSnap`</block>
  <block id="c6120c0384590236fdec4fc6ebd300ae" category="list-text">使用 SnapVault 复制执行每日备份的策略： `LocalSnapAndSnapVault`</block>
  <block id="ec5a8f62de274a4de661b7a6c7a31f7b" category="list-text">使用基于文件的备份执行每周块完整性检查的策略： `BlockIntegrityCheck`</block>
  <block id="a160185a60557a18fe2878ba31857c3b" category="paragraph">以下各节将介绍这三个策略的配置。</block>
  <block id="b923bc9dd59677ab62e9184acf6a8a1d" category="list-text">转到 " 设置 "&gt;" 策略 " ，然后单击 " 新建 " 。</block>
  <block id="202b5482b689d83a7038543a22d23566" category="list-text">输入策略名称和问题描述。单击下一步。</block>
  <block id="03fcbdc3a76525840c5cd7acfcf003e1" category="list-text">选择基于 Snapshot 的备份类型，并选择每小时作为计划频率。</block>
  <block id="9c04035bf698696ac176d8f27a3b6cbb" category="list-text">配置按需备份的保留设置。</block>
  <block id="56b7270384a3729bb3f980591bc67da4" category="list-text">配置计划备份的保留设置。</block>
  <block id="cf97995427598a8ba429f96a4a274f02" category="list-text">配置复制选项。在这种情况下，不会选择 SnapVault 或 SnapMirror 更新。</block>
  <block id="e1147a04a00490e6c50fca223d7f0bbc" category="list-text">在摘要页面上，单击完成。</block>
  <block id="bf16ce3407c41ba06c774661a3399961" category="section-title">使用 SnapVault 复制执行每日 Snapshot 备份的策略</block>
  <block id="b312ca1a1b34e03353fb8562c080bf37" category="list-text">将备份类型设置为基于 Snapshot ，并将计划频率设置为每日。</block>
  <block id="5f4da9066e44ef7d68263c60abc054d7" category="list-text">创建本地 Snapshot 副本后，选择 Update SnapVault 。</block>
  <block id="84d0ea6dd0c20f51d709dc5137c2df23" category="inline-link-macro">" 将数据保护配置为异地备份存储。 "</block>
  <block id="a51c0cc379a2cff62750a2cee8f4ac4c" category="admonition">二级策略标签必须与存储层上数据保护配置中的 SnapMirror 标签相同。请参见一节 <block ref="7a50846cc5cffdc4cbf392fe0aab93a4" category="inline-link-macro-rx"></block></block>
  <block id="85a1074fe49bf71488c2afb543c5d5e9" category="section-title">每周块完整性检查策略</block>
  <block id="9f96a4a39e01d723f3c140a0ce4c763e" category="list-text">将备份类型设置为基于文件，并将计划频率设置为每周。</block>
  <block id="48b018e173131b38947be1f4747f02fd" category="summary">SnapCenter 是一个统一的可扩展平台，可实现应用程序一致的数据保护。SnapCenter 提供集中控制和监管，同时委派用户管理应用程序专用的备份，还原和克隆作业。</block>
  <block id="26e2418d177df1dddb008e455ce28752" category="doc">SnapCenter 架构</block>
  <block id="4a8478781fce30dd0844fa495323657c" category="section-title">SnapCenter 组件</block>
  <block id="6b6680d81f3584fb2812532f734ed372" category="paragraph">SnapCenter 包括 SnapCenter 服务器，适用于 Windows 的 SnapCenter 插件软件包和适用于 Linux 的 SnapCenter 插件软件包。每个软件包都包含适用于各种应用程序和基础架构组件的 SnapCenter 插件。</block>
  <block id="dd891a45b8606deb4a6fa0a063179e5f" category="paragraph">通过 SnapCenter 自定义插件，您可以创建自己的插件，并使用同一个 SnapCenter 界面保护应用程序。</block>
  <block id="85c9db69d08b28f5cf1e67e13162f818" category="paragraph">下图显示了 SnapCenter 组件。</block>
  <block id="69e46b0218eefa9aa82983c5ee743ae3" category="list-text">SnapCenter 资源页面</block>
  <block id="1911e0ada44759ee3994a93b354b6e23" category="inline-link"><block ref="1911e0ada44759ee3994a93b354b6e23" category="inline-link-rx"></block></block>
  <block id="d127c7070231e882bd97e8f2760d0a4f" category="list-text">SnapCenter 软件文档</block>
  <block id="532841fbf704673d5f6dc65db8d8cf66" category="inline-link"><block ref="532841fbf704673d5f6dc65db8d8cf66" category="inline-link-rx"></block></block>
  <block id="5d78d056a947fb2b364bf2803792ba96" category="paragraph"><block ref="5d78d056a947fb2b364bf2803792ba96" category="inline-link-rx"></block></block>
  <block id="5a27c7287063d118cc647ae4518ed81a" category="list-text">TR-4667 ：使用 SnapCenter 自动执行 SAP 系统副本</block>
  <block id="61c3f6db217e13c29f8daabd6bb7f3a9" category="inline-link"><block ref="61c3f6db217e13c29f8daabd6bb7f3a9" category="inline-link-rx"></block></block>
  <block id="eb8c30701a35524ff1074154b73fe327" category="paragraph"><block ref="eb8c30701a35524ff1074154b73fe327" category="inline-link-rx"></block></block>
  <block id="70135b5e9cdadcbec80ac7a6b41e1166" category="list-text">TR-4719 ：《使用 SnapCenter 进行 SAP HANA 系统复制，备份和恢复》</block>
  <block id="0787319c76fa7dd713c7b5350ce28ab5" category="paragraph"><block ref="0787319c76fa7dd713c7b5350ce28ab5" category="inline-link-rx"></block></block>
  <block id="98d29b74b4819c66a9b3a065f317875a" category="list-text">TR-4018 ：《将 NetApp ONTAP 系统与 SAP Landscape Management 集成》</block>
  <block id="0efddc6f7a1abd249b378561d3fc08dd" category="inline-link"><block ref="0efddc6f7a1abd249b378561d3fc08dd" category="inline-link-rx"></block></block>
  <block id="d7b3b01598dae86f75591cb7f2b59ec3" category="paragraph"><block ref="d7b3b01598dae86f75591cb7f2b59ec3" category="inline-link-rx"></block></block>
  <block id="a71c27bab5cf27201389a84025d42bb9" category="paragraph"><block ref="a71c27bab5cf27201389a84025d42bb9" category="inline-link-rx"></block></block>
  <block id="7b41e76f621bf4b9f9ea9bbe09c2d06e" category="summary">SnapCenter 配置可以分为两个主要方面：初始配置和特定于资源的配置。</block>
  <block id="b1edd4b10b97c3eac95b42952c1bf03d" category="paragraph">SnapCenter 配置可以分为两个主要方面：</block>
  <block id="306f5b2709c954bcbf7b6bdf2cd70705" category="list-text">* 初始配置。 * 包括通用配置，与单个 SAP HANA 数据库无关。执行资源专用配置时选择的配置，例如存储系统，中央 HANA 插件主机和策略。</block>
  <block id="2df9975b7ffe963062b41c54fd531806" category="list-text">* 资源专用配置。 * 包括 SAP HANA 系统专用配置，必须对每个 SAP HANA 数据库执行此操作。</block>
  <block id="cded40649c715307baec2ad81edb422d" category="paragraph">下图概述了配置组件及其依赖关系。绿色框显示了必须在 SnapCenter 之外完成的配置步骤；蓝色框显示了使用 SnapCenter 图形用户界面完成的步骤。</block>
  <block id="9de05392c0c4ce6f18c64aaa8a01e16e" category="paragraph">在初始配置中，将安装和配置以下组件：</block>
  <block id="740b5ebffd57168ed255badf5f5e2302" category="list-text">* 存储系统。 * SAP HANA 系统所使用的所有 SVM 的凭据配置：通常为主存储，异地备份和灾难恢复存储。</block>
  <block id="149b90296b82f49dfb4a9ebabe53de1e" category="admonition">也可以配置存储集群凭据，而不是配置单个 SVM 凭据。</block>
  <block id="1e76e4d9af64a701de837e47ddaed309" category="list-text">* 凭据。 * 用于在主机上部署 SAP HANA 插件的凭据配置。</block>
  <block id="4d2bc301f9097bb554e8b38a8ddc129a" category="list-text">* 主机（用于中央 HANA 插件主机）。 * 部署 SAP HANA 插件。在主机上安装 SAP HANA hdbclient 软件。必须手动安装 SAP hdbclient 软件。</block>
  <block id="abc6b9384a85ef20a84780c190dcfc2f" category="list-text">* 策略。 * 备份类型，保留和复制的配置。通常，至少需要一个策略用于本地 Snapshot 副本，一个策略用于 SnapVault 复制，一个策略用于基于文件的备份。</block>
  <block id="18234143eef999d6f137e5d529702d66" category="paragraph">必须对每个 SAP HANA 数据库执行资源专用配置，其中包括以下配置：</block>
  <block id="974a71553a5ba330017cecb3d2984ece" category="list-text">SAP HANA 非数据卷资源配置：</block>
  <block id="62d13dde5f364cd839a8269393c2ee10" category="list-text">存储系统和卷</block>
  <block id="8787522e74280daf3e68d9c8596f8ffa" category="list-text">SAP hdbuserstore 密钥配置：</block>
  <block id="670a53ee9043448b355010ddd1300a1b" category="list-text">必须在中央插件主机或 HANA 数据库主机上为特定 SAP HANA 数据库执行 SAP hdbuserstore 密钥配置，具体取决于 HANA 插件的部署位置。</block>
  <block id="4c78668de8219a6a279bac0459f8ed7b" category="list-text">自动发现的 SAP HANA 数据库资源：</block>
  <block id="58022f952ea9031246441a94db279c4a" category="list-text">在数据库主机上部署 SAP HANA 插件</block>
  <block id="9902d1ebd70cb48fb95a10d3f3599577" category="list-text">提供 hdbuserstore 密钥</block>
  <block id="7c504e357529e86f997175b76982b26c" category="list-text">手动配置 SAP HANA 数据库资源：</block>
  <block id="2e4ff7286ed5779f8bf068a582fa75c7" category="list-text">SAP HANA 数据库 SID ，插件主机， hdbuserstore 密钥，存储系统和卷</block>
  <block id="b0df6141ec744a7e465d26f70a8b3925" category="list-text">资源保护配置：</block>
  <block id="3c9c3596532fc9e82b7dd3cb345f2e2d" category="list-text">选择所需策略</block>
  <block id="fea5a24c8c428edda2fdbda8affc1e25" category="list-text">为每个策略定义计划</block>
  <block id="18e4ec50bcd303126f2fa3c20d92e85d" category="list-text">ONTAP 数据保护配置：</block>
  <block id="751e9e7f28f705474333bcddb9460e70" category="list-text">仅当应将备份复制到异地备份存储时才需要。</block>
  <block id="37dce88dd05881d1ac0110266b4dab43" category="list-text">关系和保留的定义。</block>
  <block id="be52be2434eedb68a3850faec724281a" category="summary">以下各节介绍了三种不同场景和示例配置的还原和恢复工作流。</block>
  <block id="f44580ef6b3e3cb10e325c33bde13b2b" category="list-text">自动还原和恢复：</block>
  <block id="fbc1e70493253a34b3d5c45f838561ef" category="list-text">自动发现的 HANA 系统 SS1</block>
  <block id="a516d8aebd78bc70b89cee03366a17b5" category="list-text">SAP HANA 单主机，使用 NFS 的 MDC 单租户系统</block>
  <block id="5e1ac231a5151a48d4cc9dbf052b0add" category="list-text">单租户还原和恢复：</block>
  <block id="3e9f1da5bf97da92f4e351c171d7c843" category="list-text">自动发现的 HANA 系统 SM1</block>
  <block id="4a3981ff09c013c89b6f575d709cc80f" category="list-text">SAP HANA 单主机，使用 NFS 的 MDC 多租户系统</block>
  <block id="eb5cbe641700ce67df71d411b7e4ad10" category="list-text">使用手动恢复进行还原：</block>
  <block id="27ffcd98e45c55fb51621ebffaa5dd59" category="list-text">手动配置的 HANA 系统 SS2</block>
  <block id="9e522ea8faccb528a5f4b05e6f2fdea9" category="paragraph">在以下各节中，重点介绍了 SAP HANA 单主机和多台主机以及光纤通道 SAN 连接的 HANA 系统之间的差异。</block>
  <block id="43e64ba823bc1d86bfae102cfdbccfac" category="paragraph">这些示例显示 SAP HANA Studio 是一种执行手动恢复的工具。您也可以使用 SAP HANA Cockpit 或 HANA SQL 语句。</block>
  <block id="ea97f578f1fa3dc5c59fcebd659118ba" category="section-title">自动还原和恢复</block>
  <block id="d911b25c0cda59930d125abfb2bd7cd5" category="paragraph">在 SnapCenter 4.3 中， SnapCenter 自动发现的 HANA 单个容器或 MDC 单租户系统支持自动还原和恢复操作。</block>
  <block id="4344ed84200b3882e693332ce520922b" category="paragraph">您可以通过以下步骤执行自动还原和恢复操作：</block>
  <block id="d16a7b3211c17242dd4dbf5f68703753" category="list-text">选择要用于还原操作的备份。可以从以下存储选项中选择备份：</block>
  <block id="86b11f41cdd4202ed814b1453f2dd058" category="list-text">主存储</block>
  <block id="e56982c0553019ef1a653c1403027b7a" category="list-text">异地备份存储（ SnapVault 目标）</block>
  <block id="23d538532237d8a8aad1ec8328b20a9c" category="list-text">选择还原类型。选择 Complete Restore with Volume Revert 或 without Volume Revert 。</block>
  <block id="57d518b01238d5893661711dce71f42a" category="admonition">只有当 HANA 数据库使用 NFS 作为存储协议时，卷还原选项才可用于从主存储执行还原操作。</block>
  <block id="d1cb9744f6bb099dfa460ee7e6fd6f3f" category="list-text">从以下选项中选择恢复类型：</block>
  <block id="0dea40bb05391c5e1484336ca1b9d2f8" category="list-text">到最新状态</block>
  <block id="d85bd207dd9f51505e34db7d28499176" category="list-text">时间点</block>
  <block id="e16159b7e258bed62fe7e3f6170ae607" category="list-text">特定数据备份</block>
  <block id="17f8b49df414bfdc7181fe5fa83d6253" category="list-text">无法恢复</block>
  <block id="ff7164c1629743c045a5b37e453d7a0c" category="admonition">选定恢复类型用于恢复系统和租户数据库。</block>
  <block id="ef0f611cbdf3d8898ab0d52d76536b96" category="paragraph">接下来， SnapCenter 将执行以下操作：</block>
  <block id="84a899d6360c249dd29e2cbfe8043ad5" category="list-text">它会停止 HANA 数据库。</block>
  <block id="102e0250e0792ade0641ba7dbb6bde8b" category="list-text">它会还原数据库。</block>
  <block id="dbe89fd565f0d4bcf122bb64b452eb89" category="paragraph">根据选定还原类型和使用的存储协议，将执行不同的操作。</block>
  <block id="271593abf4b17da42855c88c0b5260cd" category="list-text">如果选择了 NFS 和卷还原，则 SnapCenter 将卸载此卷，使用存储层上基于卷的 SnapRestore 还原此卷，然后挂载此卷。</block>
  <block id="0d115dbcb53c942ef1a2c278e8b04a83" category="list-text">如果选择了 NFS 而未选择卷还原，则 SnapCenter 将在存储层上使用单文件 SnapRestore 操作还原所有文件。</block>
  <block id="b2b23725cc4472e5d3d9f090a0128d9c" category="list-text">如果选择光纤通道 SAN ，则 SnapCenter 将卸载 LUN ，在存储层上使用单个文件 SnapRestore 操作还原 LUN ，并发现和挂载 LUN 。</block>
  <block id="1bb7372248fe80609e0de816e9614f0a" category="list-text">它将恢复数据库：</block>
  <block id="7d3d3cd4a0187d7ec48c9b25fb2a67d3" category="list-text">它会恢复系统数据库。</block>
  <block id="9b2e306e1a7eea21bcbcc42bb480fd06" category="list-text">它会恢复租户数据库。</block>
  <block id="c7be0866b1c5a3a9a9cff3b5c3857636" category="paragraph">或者，对于 HANA 单个容器系统，只需一步即可执行恢复：</block>
  <block id="8a1c1220be0aeb46be469fc6f2c7238c" category="list-text">它将启动 HANA 数据库。</block>
  <block id="f70441c1cb725407f3487c3ec6cd8c4b" category="admonition">如果选择 " 无恢复 " ，则 SnapCenter 将退出，并且必须手动执行系统和租户数据库的恢复操作。</block>
  <block id="c92ee67cd936173cf9044234db581919" category="paragraph">本节介绍自动发现的 HANA 系统 SS1 （使用 NFS 的 SAP HANA 单主机， MDC 单租户系统）的自动还原和恢复操作步骤。</block>
  <block id="74a4551b3bbd8432ec1407907102cc63" category="list-text">在 SnapCenter 中选择要用于还原操作的备份。</block>
  <block id="dbfa37eb1460f2612056e50c424882fd" category="admonition">您可以选择从主备份存储或从异地备份存储还原。</block>
  <block id="ede6a2ebef849cace69b6ddea050eebb" category="list-text">选择还原范围和类型。</block>
  <block id="f4b7bc700da692e66bce6ad4f37490ac" category="paragraph">以下三个屏幕截图显示了使用 NFS 从主卷还原，使用 NFS 从二级卷还原以及使用光纤通道 SAN 从主卷还原的还原选项。</block>
  <block id="04d4b6f0308c909f19dd66790d3bf5cb" category="paragraph">用于从主存储还原的还原类型选项。</block>
  <block id="3f37e843bef6062d9f6d21340311b067" category="admonition">卷还原选项仅适用于使用 NFS 从主站点执行的还原操作。</block>
  <block id="d71f7098f62d47b862323fdd9a79c20d" category="paragraph">用于从异地备份存储还原的还原类型选项。</block>
  <block id="2a531455e829eab1b5c413bdf3a9c09b" category="paragraph">使用光纤通道 SAN 从主存储进行还原的还原类型选项。</block>
  <block id="998316bca47edd7199d19f50f506130b" category="list-text">选择恢复范围并提供日志备份和目录备份的位置。</block>
  <block id="d062aba8fc1c88e1e40c5273b2f25f70" category="admonition">SnapCenter 使用 HANA global.ini 文件中的默认路径或更改后的路径来预填充日志和目录备份位置。</block>
  <block id="664739985774f32e8e69169261c44cb1" category="list-text">输入可选的 prerestore 命令。</block>
  <block id="32d6abea376025ea0f7ec8c6f9308b3c" category="list-text">输入可选的还原后命令。</block>
  <block id="d5580d32ca7142b15df13d2e13ce81e9" category="list-text">输入可选的电子邮件设置。</block>
  <block id="52ffc18711958ea3b01ea643a536b477" category="list-text">要启动还原操作，请单击完成。</block>
  <block id="6ee1a75c79c794a6fb3f72e16da944d2" category="list-text">SnapCenter 执行还原和恢复操作。此示例显示了还原和恢复作业的作业详细信息。</block>
  <block id="3a1aea2881bec87b5ce8e401ee0520bd" category="section-title">单租户还原和恢复操作</block>
  <block id="3b15f0bc9024903dec7c4695e3155bf1" category="paragraph">在 SnapCenter 4.3 中，对于包含单个租户或 SnapCenter 自动发现的多个租户的 HANA MDC 系统，支持单租户还原操作。</block>
  <block id="0fee49305acef3632abbf848b903631b" category="paragraph">您可以通过以下步骤执行单租户还原和恢复操作：</block>
  <block id="67aa61a4ec3511ee190ecad019aeb30b" category="list-text">停止要还原和恢复的租户。</block>
  <block id="81f028cbdbdc320fd192a487cbd1318f" category="list-text">使用 SnapCenter 还原租户。</block>
  <block id="c178ce48989ea0af333fc54437d692aa" category="list-text">要从主存储进行还原， SnapCenter 将执行以下操作：</block>
  <block id="29b2230e330fe45145e4b681e0046505" category="list-text">对租户数据库的所有文件执行 * 存储单文件 SnapRestore 操作。</block>
  <block id="3eb4d46bdff6451fbb6f87bb525d3990" category="list-text">* 。 * 克隆 LUN 并将其连接到数据库主机，然后复制租户数据库的所有文件。</block>
  <block id="22e20de0bb4a90e80400ce852271e09d" category="list-text">要从二级存储进行还原， SnapCenter 将执行以下操作：</block>
  <block id="4b31581f309cafd79125e4e1b91cace2" category="list-text">对租户数据库的所有文件执行 * 。 * 存储 SnapVault 还原操作</block>
  <block id="a521a7d1f76af7e97146a07a31abc8cb" category="list-text">* 。 * 克隆 LUN 并将其连接到数据库主机，然后复制租户数据库的所有文件</block>
  <block id="50d522157f7a37b456e3d91c1c819dd9" category="list-text">使用 HANA Studio ， Cockpit 或 SQL 语句恢复租户。</block>
  <block id="3005119988432d4e45739c1d44b4b034" category="paragraph">本节介绍了从自动发现的 HANA 系统 SM1 （使用 NFS 的 SAP HANA 单主机， MDC 多租户系统）的主存储执行还原和恢复操作的步骤。从用户输入角度来看，在光纤通道 SAN 设置中从二级还原或还原的工作流是相同的。</block>
  <block id="aed89660dbd87e3983762091fef0d51a" category="list-text">停止租户数据库。</block>
  <block id="2fcbdfe66c07526cffaebe5176545c9c" category="list-text">选择要还原的租户。</block>
  <block id="19f018bc36fc350470a0498d5854069c" category="admonition">SnapCenter 将显示选定备份中包含的所有租户的列表。</block>
  <block id="e1a46d5de522291f70c781fccedfcc60" category="paragraph">SnapCenter 4.3 不支持单租户恢复。未预先选择任何恢复，无法更改。</block>
  <block id="720dfcaa32518593ec523932ae9faea2" category="list-text">输入可选的还原后命令。</block>
  <block id="6a6e8b779757b9f75738fb3b86a61fcc" category="paragraph">还原操作由 SnapCenter 执行。此示例显示了还原作业的作业详细信息。</block>
  <block id="40db8443209e5d3afbdca4a942d06143" category="admonition">租户还原操作完成后，只会还原租户相关数据。在 HANA 数据库主机的文件系统上，可以使用租户的已还原数据文件和 Snapshot 备份 ID 文件。</block>
  <block id="68bfc883e6b2855ddff9fdf06b94ce9b" category="list-text">使用 HANA Studio 开始恢复。</block>
  <block id="b6845cbdd15d7a33174052df7502cf32" category="list-text">选择租户。</block>
  <block id="cd8d493931d8670a43b07123d359a209" category="list-text">选择恢复类型。</block>
  <block id="d37bdebf1b32778793a7b4b9e33bd5ec" category="list-text">提供备份目录位置。</block>
  <block id="f4510f249d028c44410fdab09af35950" category="paragraph">在备份目录中，还原的备份会以绿色图标突出显示。外部备份 ID 显示先前在 SnapCenter 中选择的备份名称。</block>
  <block id="65a02326980287a87e65dd25667b806c" category="list-text">选择带有绿色图标的条目，然后单击下一步。</block>
  <block id="eadda446e15d20ede6c5e18fd7d399ea" category="list-text">提供日志备份位置。</block>
  <block id="89f845c54b2f3c2aa34761748971067c" category="list-text">根据需要选择其他设置。</block>
  <block id="aed1891a9c84b2d526253a84689579ac" category="list-text">启动租户恢复操作。</block>
  <block id="f084a541788261dbb4ec0e6e892dadd4" category="section-title">使用手动恢复进行还原</block>
  <block id="d308f035c60fda2ed0568cf9debd2c56" category="paragraph">要使用 SAP HANA Studio 和 SnapCenter 还原和恢复 SAP HANA MDC 单租户系统，请完成以下步骤：</block>
  <block id="618a329b4db7b150870ca98e5ed89642" category="list-text">选择恢复系统数据库并确认关闭 SAP HANA 系统。</block>
  <block id="d435bb1a0709a5ac7a8cec5e0ef65067" category="list-text">此时将显示数据备份列表。选择备份以查看外部备份 ID 。</block>
  <block id="7d5036f83c8d6e0bca40d1ddb23b8cd9" category="list-text">使用 SnapCenter 执行还原过程：</block>
  <block id="109cf94e2e1d899c5cbe0ba9432f3db7" category="list-text">在资源的拓扑视图中，如果要从异地备份存储还原，请选择要从主存储还原的本地副本或存储副本。</block>
  <block id="66c736ed388a6ff23e9e306d983030d0" category="list-text">从 SAP HANA Studio 中选择与外部备份 ID 或注释字段匹配的 SnapCenter 备份。</block>
  <block id="eaea15be3b6bcfaa466a7e8c5adb9432" category="list-text">启动还原过程。</block>
  <block id="0b851616fd46128f20c0da790ae82f05" category="admonition">如果选择从主存储执行基于卷的还原，则必须先从所有 SAP HANA 数据库主机卸载数据卷，然后再还原，并在还原过程完成后重新挂载这些数据卷。</block>
  <block id="0f47974782affac68b494486493475f1" category="admonition">在使用 FC 的 SAP HANA 多主机设置中，卸载和挂载操作由 SAP HANA 名称服务器在关闭和启动数据库过程中执行。</block>
  <block id="f8a1017f1d573176e0c09b77e9411ef5" category="list-text">启动恢复过程。恢复过程完成后，系统数据库将启动。</block>
  <block id="c300d3adad469f758c239ac69abd59c2" category="paragraph">此时将显示数据备份列表。由于数据卷已还原，租户备份将显示为可用（绿色）。</block>
  <block id="1b0bc5dfa3c59bd3282488a100771bec" category="list-text">选择此备份并启动恢复过程。恢复过程完成后，租户数据库将自动启动。</block>
  <block id="655fdebc6400cdd5b7b6039edcc5ef91" category="paragraph">下一节介绍了手动配置的 HANA 系统 SS2 （使用 NFS 的 SAP HANA 单主机， MDC 多租户系统）的还原和恢复操作步骤。</block>
  <block id="6e07aa49ce0f008266e457437bf58618" category="list-text">在 SAP HANA Studio 中，选择恢复系统数据库选项以启动系统数据库的恢复。</block>
  <block id="da60453971d7812f926c6d4dd8faedfc" category="list-text">单击确定关闭 SAP HANA 数据库。</block>
  <block id="7ad42396d12d80544d9b21a4a3f94969" category="paragraph">SAP HANA 系统将关闭并启动恢复向导。</block>
  <block id="539b55bfbf4e9a12b0b79e9c7f2264a2" category="list-text">此时将根据备份目录的内容显示可用备份列表。选择所需的备份并记下外部备份 ID ：在我们的示例中，是最新的备份。</block>
  <block id="7f22d467d3abf924a1d98481cc16a84c" category="admonition">对于采用 NFS 的 SAP HANA 多主机系统，必须卸载每个主机上的所有数据卷。</block>
  <block id="0a979fbdc691405e2ecf3f21f214f1d5" category="admonition">在使用 FC 的 SAP HANA 多主机设置中，卸载操作由 SAP HANA 名称服务器在关闭过程中执行。</block>
  <block id="0c0d64691714ab24aa54c51efccdbaf9" category="list-text">从 SnapCenter 图形用户界面中，选择资源拓扑视图并选择应还原的备份；在本示例中为最新的主备份。单击还原图标以启动还原。</block>
  <block id="2504fb5831fc57db27b887bf63f0887a" category="paragraph">此时将启动 SnapCenter 还原向导。</block>
  <block id="ad1e706a026bae5fa0e49279c3661115" category="list-text">选择还原类型 Complete Resource 或 File Level 。</block>
  <block id="2b846cc0556dd02047bdbfb3e0f57de1" category="paragraph">选择 Complete Resource 以使用基于卷的还原。</block>
  <block id="d14d0f2038e3d915b3534446ed6e080f" category="list-text">选择文件级别和全部以对所有文件使用单文件 SnapRestore 操作。</block>
  <block id="14e6373421e10742a1dd56374e1ba0fa" category="admonition">要对 SAP HANA 多主机系统进行文件级还原，请选择所有卷。</block>
  <block id="7da7c0b60e307362a8634d684b76af4f" category="list-text">（可选）指定应从中央 HANA 插件主机上运行的 SAP HANA 插件执行的命令。单击下一步。</block>
  <block id="5330486ca6a97bf88a80230a772af6d0" category="list-text">指定可选命令，然后单击下一步。</block>
  <block id="fed1b6603cc6dfe60b19cf287b1aa459" category="list-text">指定通知设置，以便 SnapCenter 可以发送状态电子邮件和作业日志。单击下一步。</block>
  <block id="c261785ed15600658e731fc1cec9fdba" category="list-text">查看摘要，然后单击完成以开始还原。</block>
  <block id="d63984aae331b3071efc01231ee47359" category="list-text">还原作业将启动，双击活动窗格中的日志行可显示作业日志。</block>
  <block id="bac336278522062d883ec24dccefbb40" category="list-text">请等待还原过程完成。在每个数据库主机上，挂载所有数据卷。在我们的示例中，只需在数据库主机上重新挂载一个卷。</block>
  <block id="3e0dee0ba4ab61927ece723410ce2c21" category="list-text">转到 SAP HANA Studio 并单击刷新以更新可用备份列表。使用 SnapCenter 还原的备份会在备份列表中显示一个绿色图标。选择备份，然后单击下一步。</block>
  <block id="54b5a6f76ec5eeef36ab37e5bc55ae5f" category="list-text">在 SAP HANA Studio 中，选择系统数据库条目，然后启动备份恢复 - 恢复租户数据库。</block>
  <block id="9c98b915d8b8e49f33ff3f40cace1a90" category="list-text">由于在恢复系统数据库之前已还原数据卷，因此租户备份将立即可用。选择以绿色突出显示的备份，然后单击下一步。</block>
  <block id="96520d7a480e70c8e9a8a478e649b690" category="admonition">对于包含多个租户的 SAP HANA MDC 系统，必须对每个租户重复步骤 20 – 29 。</block>
  <block id="42f56db89b1fd3446a0dc17a48ffcd56" category="summary">此页面介绍了完成配置和调整所需的各种操作。</block>
  <block id="74555398f6732868f7098c16987eaf1d" category="doc">高级配置和调整</block>
  <block id="ebd54efb13a29a91ee18444b4b588e62" category="paragraph">本节介绍客户可用于根据其特定需求调整 SnapCenter 设置的配置和调整选项。并非所有设置都适用于所有客户情形。</block>
  <block id="b36025dbf19c7d418acc927e3eff5726" category="section-title">启用与 HANA 数据库的安全通信</block>
  <block id="2c26782380d64762dbb9ff64ff38f98d" category="paragraph">如果为 HANA 数据库配置了安全通信，则由 SnapCenter 执行的 `hdbsql` 命令必须使用其他命令行选项。要实现此目的，可以使用 wrapper 脚本，该脚本使用所需的选项调用 `hdbsql` 。</block>
  <block id="87a9192bcd59daed56e382d8005bcc6b" category="admonition">可通过多种选项配置 SSL 通信。在以下示例中，使用命令行选项描述了最简单的客户端配置，其中不会执行服务器证书验证。如果需要在服务器端和 / 或客户端上验证证书，则需要使用不同的 hdbsql" 命令行选项，并且必须按照 SAP HANA 安全指南中所述相应地配置 PSE 环境。</block>
  <block id="1c9ce72e23307b41eeb8bb0dcd7098af" category="paragraph">此时将添加 wrapper 脚本，而不是在 `hana.properties` 文件中配置 `hdbsql` 可执行文件。</block>
  <block id="018c7398ef29574d14d403bf93e4fed2" category="paragraph">对于 SnapCenter Windows 服务器上的中央 HANA 插件主机，必须在 `C ： \Program Files\NetApp\SnapCenter\SnapCenter Plug-in Creator\etc\hana.properties` 中添加以下内容。</block>
  <block id="15cea5f6ffeca8d29ba6f7f5fc724f97" category="paragraph">wrapper script `hdbsql-ssl.cmd` 使用所需的命令行选项调用 `hdbsql.exe` 。</block>
  <block id="46113eeca61d4e4139d8d0796e2e1b04" category="admonition">` -e - ssltrustcert` hdbsqll 命令行选项也适用于未启用 SSL 的 HANA 系统。因此，此选项也可用于中央 HANA 插件主机，其中并非所有 HANA 系统都启用或禁用了 SSL 。</block>
  <block id="6de64d0d2282b0e94a128ee5bf587633" category="paragraph">如果 HANA 插件部署在单个 HANA 数据库主机上，则必须相应地在每个 Linux 主机上进行配置。</block>
  <block id="29cfdb64fd85feafbf4960346572109a" category="paragraph">wrapper script `hdbsqls` calls `hdbsqll` with the required command-line options.</block>
  <block id="76a5f251ab6965b0373df9022a38f5b0" category="section-title">在 HANA 插件主机上禁用自动发现</block>
  <block id="4ba643eff563a3bd70a8c2792ade9cc9" category="paragraph">要在 HANA 插件主机上禁用自动发现，请完成以下步骤：</block>
  <block id="3ed13fae46d0e665d580e7feffb0d68f" category="list-text">在 SnapCenter 服务器上，打开 PowerShell 。运行 `Open- SmConnection` 命令连接到 SnapCenter 服务器，并在打开的登录窗口中指定用户名和密码。</block>
  <block id="62b41927ef5b42e34a666d7e1082c90c" category="list-text">要禁用自动发现，请运行 `SET- SmConfigSettings` 命令。</block>
  <block id="51c124ef9e356b1262d5226b5c08f378" category="paragraph">对于 HANA 主机 `HANA -2` ，命令如下所示：</block>
  <block id="e9caa0a68efba627b98862415aa3c29c" category="list-text">运行 `Get- SmConfigSettings` 命令验证配置。</block>
  <block id="a2fb1fe6f4b2f8a92a01bd85ef7d2568" category="paragraph">此配置将写入主机上的代理配置文件，在使用 SnapCenter 进行插件升级后，此配置仍可用。</block>
  <block id="9e6eeb9d8e52bff7eee430478f3139b2" category="section-title">停用自动日志备份管理</block>
  <block id="406b242a0620f29e2f7ecdc0b3c49c48" category="paragraph">默认情况下，日志备份管理处于启用状态，可以在 HANA 插件主机级别禁用。可以通过两种方法更改这些设置。</block>
  <block id="c0685bfe05c38d580ee61881c0233cfc" category="section-title">编辑 hana.property 文件</block>
  <block id="f3c9376d1332a956f0c0ed748ea89162" category="paragraph">将参数 `log_cleanup_disable = Y` 包含在 `hana.property` 配置文件中，将此 SAP HANA 插件主机用作通信主机的所有资源禁用日志备份整理：</block>
  <block id="68caa1c9492156e7687e551e3e2392b8" category="list-text">对于 Windows 上的 Hdbsql 通信主机， `hana.property` 文件位于 `C ： \Program Files\NetApp\SnapCenter\SnapCenter Plug-in Creator\etc` 。</block>
  <block id="0c1bf009e7852817f75c886fb2271ab4" category="list-text">对于 Linux 上的 Hdbsqll 通信主机， `hana.property` 文件位于 ` /opt/netapp/snapcenter/SCC/etc` 。</block>
  <block id="ec202ab85e35217db2f5aefeee86d896" category="section-title">使用 PowerShell 命令</block>
  <block id="7465bc608b7ba8996b13823af509a13b" category="paragraph">配置这些设置的第二个选项是使用 SnapCenter powershell 命令。</block>
  <block id="a0045b25b946141fdf79a4f4be908511" category="list-text">在 SnapCenter 服务器上，打开 PowerShell 。使用命令 `Open- SmConnection` 连接到 SnapCenter 服务器，并在打开的登录窗口中指定用户名和密码。</block>
  <block id="3763f544e62c64c495333749f419f9c7" category="list-text">使用命令 `Set- SmConfigSettings -Plugin - hostname &lt;pluginhostname&gt; - PluginCode HANA - configSettings @ ｛ "log_cleanup_disable" = "Y" ｝` ，可以为 IP 或主机名指定的 SAP HANA 插件主机 ` &lt;pluginhostname&gt;` 配置更改（请参见下图）。</block>
  <block id="f81644ea080b8fea97ed792373fba735" category="section-title">在虚拟环境中运行 SAP HANA 插件时禁用警告</block>
  <block id="fd16e3a17c275b721a8f1bca54a6e738" category="paragraph">SnapCenter 会检测 SAP HANA 插件是否安装在虚拟化环境中。这可以是 VMware 环境，也可以是公有 云提供商的 SnapCenter 安装。在这种情况下， SnapCenter 会显示一条警告来配置虚拟机管理程序，如下图所示。</block>
  <block id="dbc51e54d901bd82b0ada5450fb2532f" category="paragraph">可以全局禁止此警告。在这种情况下， SnapCenter 无法识别虚拟化环境，因此不会显示这些警告。</block>
  <block id="4f12b39de0379b54307e19e7b392caf6" category="paragraph">要配置 SnapCenter 以禁止此警告，必须应用以下配置：</block>
  <block id="e8677b2957270cfbd602c7fcd2b1a0b3" category="list-text">从设置选项卡中，选择全局设置。</block>
  <block id="3e9cb21d308ff815d97bb64f89c45e89" category="list-text">对于虚拟机管理程序设置，请为所有主机选择虚拟机具有 iSCSI 直连磁盘或 NFS 并更新设置。</block>
  <block id="c5326c28a7f793eb7b9177f94a4a22f3" category="section-title">更改与异地备份存储同步备份的计划频率</block>
  <block id="898a36ba79f0029f3604d6260d953a97" category="inline-link-macro">" 二级存储备份的保留管理 " ，</block>
  <block id="ecaf1a318fab8eee654c5023aeac5d85" category="paragraph">如一节所述 <block ref="91b9cafba11ac3466c041781f72e25d3" category="inline-link-macro-rx"></block> ONTAP 负责对异地备份存储的数据备份进行保留管理。SnapCenter 会定期检查 ONTAP 是否已删除异地备份存储上的备份，方法是使用每周默认计划运行清理作业。</block>
  <block id="1a397f708626e53066445f8b0a45ae95" category="paragraph">如果发现异地备份存储中任何已删除的备份， SnapCenter 清理作业将删除 SnapCenter 存储库以及 SAP HANA 备份目录中的备份。</block>
  <block id="b6256d5acf0a237a2bfb99c200a47e59" category="paragraph">清理作业还会对 SAP HANA 日志备份执行后台管理。</block>
  <block id="c5b91a93b82ebe45816f5f5af37f3c7a" category="paragraph">在完成此计划清理之前， SAP HANA 和 SnapCenter 可能仍会显示已从异地备份存储中删除的备份。</block>
  <block id="b796643f0612d9fabdcee75233e699f9" category="admonition">这样可能会保留更多日志备份，即使异地备份存储上相应的基于存储的 Snapshot 备份已被删除也是如此。</block>
  <block id="2971e00ac834523ed205d9baba4a1ec9" category="paragraph">以下各节介绍了避免这种临时差异的两种方法。</block>
  <block id="3441a12e5d3e26f5680c6227809710fa" category="section-title">在资源级别手动刷新</block>
  <block id="26b8c598da47c7623949a9b89a388603" category="paragraph">在资源的拓扑视图中，选择二级备份时， SnapCenter 会显示异地备份存储上的备份，如以下屏幕截图所示。SnapCenter 使用刷新图标执行清理操作，以同步此资源的备份。</block>
  <block id="fcca844280c97b2c08b17bca95637969" category="section-title">更改 SnapCenter 清理作业的频率</block>
  <block id="2811d2a8313b7bec58816678a8b1bcc5" category="paragraph">默认情况下， SnapCenter 会使用 Windows 任务计划机制每周对所有资源执行清理作业 `SnapCenter_RemoveSecondaryBackup` 。可以使用 SnapCenter PowerShell cmdlet 更改此设置。</block>
  <block id="3f13831740463d1bd3841266c795f77f" category="list-text">在 SnapCenter 服务器上启动 PowerShell 命令窗口。</block>
  <block id="bf8c868a75dd9be9a0b1995f9695010e" category="list-text">打开与 SnapCenter 服务器的连接，并在登录窗口中输入 SnapCenter 管理员凭据。</block>
  <block id="ed0087c23be9dead570ee81bfe67fc40" category="list-text">要将计划从每周更改为每天，请使用 cmdlet `SET- SmSchedule` 。</block>
  <block id="e83c1ad6099cb59a650eabeabfcc6675" category="list-text">您可以在 Windows 任务计划程序中检查作业属性。</block>
  <block id="fcef096381705d4bcfa467d40d0b387f" category="summary">本节介绍 SS2 和 SS1 这两种示例配置的配置步骤。</block>
  <block id="70301bf4b26989d57e0885606679e051" category="doc">用于 SAP HANA 数据库备份的 SnapCenter 资源专用配置</block>
  <block id="f4e81e10f3cb525298be194aea42006f" category="paragraph">本节介绍两个示例配置的配置步骤。</block>
  <block id="fa965a3de49a71b6a12a753401775293" category="list-text">* SS2.*</block>
  <block id="51c290b5b5c894a2107decea434365ad" category="list-text">使用 NFS 进行存储访问的单主机 SAP HANA MDC 单租户系统</block>
  <block id="e88fef62277e0a1c147f21e0c953ba8b" category="list-text">资源在 SnapCenter 中手动配置。</block>
  <block id="60b65c3fbea29f8def663cc21aafc582" category="list-text">该资源配置为使用每周基于文件的备份创建本地 Snapshot 备份并对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="255aad876f85e1c18a9907724b93daaa" category="list-text">*</block>
  <block id="8bc72a7150e59210f0b5463bb10e30a3" category="list-text">系统会使用 SnapCenter 自动发现此资源。</block>
  <block id="fc1ac30a53328dfb93dca9f7139b843b" category="list-text">该资源配置为创建本地 Snapshot 备份，使用 SnapVault 复制到异地备份存储，以及使用每周基于文件的备份对 SAP HANA 数据库执行块完整性检查。</block>
  <block id="66fe6c9b122286cf99f5f0138b0fa347" category="paragraph">SAN 连接的系统，单个容器系统或多主机系统的差异反映在相应的配置或工作流步骤中。</block>
  <block id="bdb4ca864f28f4d4427e31fe3874148a" category="section-title">SAP HANA 备份用户和 hdbuserstore 配置</block>
  <block id="51f52a019fed97257139db81ad9f7174" category="paragraph">NetApp 建议在 HANA 数据库中配置一个专用数据库用户，以便使用 SnapCenter 运行备份操作。在第二步中，为此备份用户配置了 SAP HANA 用户存储密钥，并在配置 SnapCenter SAP HANA 插件时使用此用户存储密钥。</block>
  <block id="fe6f69e0a2ecafbdaceb1719bf9a1a88" category="paragraph">下图显示了可用于创建备份用户的 SAP HANA Studio 。</block>
  <block id="d485cbfafcf67fe0af5fc6229e56b0f4" category="admonition">HANA 2.0 SPS5 版本更改了所需权限：备份管理员，目录读取，数据库备份管理员和数据库恢复操作员。对于早期版本，备份管理员和目录读取已足够。</block>
  <block id="9d52a4754b65c174f47d3aa970f06493" category="admonition">对于 SAP HANA MDC 系统，必须在系统数据库中创建用户，因为系统和租户数据库的所有备份命令都使用系统数据库执行。</block>
  <block id="840539751269be4e3753202d7662d8cb" category="paragraph">在安装了 SAP HANA 插件和 SAP hdbsql. 客户端的 HANA 插件主机上，必须配置用户存储密钥。</block>
  <block id="38cb77d0df57e3dda9aa8b654ad92b4f" category="section-title">用作中央 HANA 插件主机的 SnapCenter 服务器上的用户存储配置</block>
  <block id="bbdc83bcbc051a80322ec102a572ecdc" category="paragraph">如果 SAP HANA 插件和 SAP hdbsql. 客户端安装在 Windows 上，则本地系统用户将执行 hdbsql. 命令，并在资源配置中默认进行配置。由于系统用户不是登录用户，因此必须使用其他用户和 ` -u &lt;User&gt;` 选项来配置用户存储。</block>
  <block id="b8da6948ade523d68e8ab7b8ed12826c" category="admonition">必须先在 Windows 主机上安装 SAP HANA hdbclient 软件。</block>
  <block id="a17a29a466ce49e9669ffdefbae9c596" category="section-title">用户存储配置位于用作 Central HANA 插件主机的单独 Linux 主机上</block>
  <block id="8aa0bd3330a87f410cbc39982f1764fc" category="paragraph">如果 SAP HANA 插件和 SAP hdbsql 客户端安装在单独的 Linux 主机上，则对于用户在资源配置中定义的用户存储配置，将使用以下命令：</block>
  <block id="2d952d2344e9646adbf709d2cf78e6e7" category="admonition">必须先在 Linux 主机上安装 SAP HANA hdbclient 软件。</block>
  <block id="fa5bf57daa02a0d0988c9193381f807d" category="section-title">HANA 数据库主机上的用户存储配置</block>
  <block id="5f01f23853abc5e513d49be8a5cdd096" category="paragraph">如果 SAP HANA 插件部署在 HANA 数据库主机上，则对于使用 ` &lt;sid&gt;adm` user 的用户存储配置，将使用以下命令：</block>
  <block id="5b7ab301f58dc658ec70494a737f828e" category="admonition">SnapCenter 使用 ` &lt;sid&gt;adm` 用户与 HANA 数据库进行通信。因此，必须在数据库主机上使用 `sid&gt;adm` 用户配置用户存储密钥。</block>
  <block id="cd4a470aff3703c885ad99676d16055d" category="admonition">通常， SAP HANA hdbsql 客户端软件会与数据库服务器安装一起安装。否则，必须先安装 hdbclient 。</block>
  <block id="0e9fced583a2d6b1c7784b81ef75e850" category="section-title">用户存储配置取决于 HANA 系统架构</block>
  <block id="3a5b6e126b997f5aebdba1d196187326" category="paragraph">在 SAP HANA MDC 单租户设置中，端口 `3&lt;instanceNo&gt;13` 是用于对系统数据库进行 SQL 访问的标准端口，必须在 hdbuserstore 配置中使用。</block>
  <block id="db9b1da043cd3d841d9c5c69e5a38292" category="paragraph">对于 SAP HANA 单容器设置，端口 `3&lt;instanceNo&gt;15` 是用于通过 SQL 访问索引服务器的标准端口，必须在 hdbuserstore 配置中使用。</block>
  <block id="a2e6b5aefaa377838317f8be8742bb37" category="paragraph">对于 SAP HANA 多主机设置，必须为所有主机配置用户存储密钥。SnapCenter 会尝试使用提供的每个密钥连接到数据库，因此可以独立于将 SAP HANA 服务故障转移到其他主机运行。</block>
  <block id="28de3e05c0a85df55248daad4cd4bac6" category="section-title">用户存储配置示例</block>
  <block id="5c9181ed7362f81e962093c13840fab8" category="paragraph">在实验室设置中，使用混合 SAP HANA 插件部署。对于某些 HANA 系统， HANA 插件安装在 SnapCenter 服务器上，而对于其他系统，则部署在各个 HANA 数据库服务器上。</block>
  <block id="1404381c698e4c5d564feda96aaa1c22" category="paragraph">* SAP HANA 系统 SS1 ， MDC 单租户，实例 00*</block>
  <block id="42579371c7eda99c5889fb9933e8ba4b" category="paragraph">HANA 插件已部署在数据库主机上。因此，必须在数据库主机上使用用户 ss1adm 配置密钥。</block>
  <block id="18d71d1612c2658ba5936d6ca062329e" category="paragraph">* SAP HANA 系统 MS1 ，多主机 MDC 单租户，实例 00*</block>
  <block id="c35984d6886a6387baba752af82f564d" category="paragraph">对于 HANA 多主机系统，需要一个中央插件主机，在我们的设置中，我们使用了 SnapCenter 服务器。因此，用户存储配置必须在 SnapCenter 服务器上完成。</block>
  <block id="2abcd488c56140fe10bb20da77ecf642" category="section-title">配置异地备份存储的数据保护</block>
  <block id="f262b6604cf3acf9374dd1fc6e754740" category="paragraph">必须先配置数据保护关系以及执行初始数据传输，然后 SnapCenter 才能管理复制更新。</block>
  <block id="402aeb49864ee4345ff4480e7ff2588a" category="paragraph">下图显示了为 SAP HANA 系统 SS1 配置的保护关系。在我们的示例中， SVM `han-primary` 上的源卷 `SS1_data_mnt00001` 会复制到 SVM `han-backup` 和目标卷 `SS1_data_mnt00001_dest` 。</block>
  <block id="149e2b8a1b2b977e7d1afa6ea1f37c8c" category="admonition">此关系的计划必须设置为无，因为 SnapCenter 会触发 SnapVault 更新。</block>
  <block id="16ded84606c10f7da418b0555b25ceee" category="paragraph">下图显示了保护策略。用于保护关系的保护策略用于定义 SnapMirror 标签以及在二级存储上保留备份。在我们的示例中，已用标签为 `Daily` ，保留设置为 5 。</block>
  <block id="5c5eeb863cdfc0db3f197c826e6c7455" category="admonition">异地备份存储上的备份保留在策略中定义，并由 ONTAP 控制。</block>
  <block id="b75893c9952bb9cfc6ec0d811541b0a6" category="section-title">手动配置 HANA 资源</block>
  <block id="d744af4332930eba6c682765a5680759" category="paragraph">本节介绍 SAP HANA 资源 SS2 和 MS1 的手动配置。</block>
  <block id="15c0aa9b657f3649ebe64bd584af2c69" category="list-text">SS2 是一个单主机 MDC 单租户系统</block>
  <block id="68490ecb86f21230a0b2e95a70f95144" category="list-text">MS1 是一个多主机 MDC 单租户系统。</block>
  <block id="64ba1f95653f9f05b4225cee464cf6e6" category="list-text">从资源选项卡中，选择 SAP HANA ，然后单击添加 SAP HANA 数据库。</block>
  <block id="34606acaa040a93c19b426a780cd6775" category="list-text">输入用于配置 SAP HANA 数据库的信息，然后单击下一步。</block>
  <block id="e81504623a071c0fa17c66d26729447f" category="paragraph">在示例 " 多租户数据库容器 " 中选择资源类型。</block>
  <block id="89d52188e7a1934360194af072002b49" category="admonition">对于 HANA 单个容器系统，必须选择资源类型单个容器。所有其他配置步骤均相同。</block>
  <block id="f0037094a0c5f8dbbf5c217dc5a1e743" category="paragraph">对于我们的 SAP HANA 系统， SID 为 SS2 。</block>
  <block id="6985d624e8d700a19d4bf7d44d1d4b93" category="paragraph">我们的示例中的 HANA 插件主机是 SnapCenter 服务器。</block>
  <block id="4106a2fb2792b3f4515ec73bbc9eaf56" category="paragraph">hdbuserstore 密钥必须与为 HANA 数据库 SS2 配置的密钥匹配。在我们的示例中，它是 SS2KEY 。</block>
  <block id="b2079b5692480841bc273b4cd0072a29" category="admonition">对于 SAP HANA 多主机系统，必须包括所有主机的 hdbuserstore 密钥，如下图所示。SnapCenter 将尝试使用列表中的第一个密钥进行连接，如果第一个密钥不起作用，则继续使用另一个密钥。要在具有辅助主机和备用主机的多主机系统中支持 HANA 故障转移，需要执行此操作。</block>
  <block id="3a52386058c5416573960cfc63cd4aa9" category="list-text">为存储系统（ SVM ）和卷名称选择所需的数据。</block>
  <block id="7202458df8d18d28c523bc7d656460e1" category="admonition">对于光纤通道 SAN 配置，还需要选择 LUN 。</block>
  <block id="8983e0678721acf19955d152bb5e2447" category="admonition">对于 SAP HANA 多主机系统，必须选择 SAP HANA 系统的所有数据卷，如下图所示。</block>
  <block id="a537d2b57b2da86f3595e0d4736c64bc" category="paragraph">此时将显示资源配置的摘要屏幕。</block>
  <block id="74d979d66ea08432b6a8bf4dec81a84f" category="list-text">单击完成以添加 SAP HANA 数据库。</block>
  <block id="9c4a783c592f95ccc4cecc5dd4717224" category="section-title">自动发现 HANA 数据库</block>
  <block id="e8ab1d33eb19b325a31fa06080fd52e7" category="paragraph">本节介绍如何自动发现 SAP HANA 资源 SS1 （采用 NFS 的单主机 MDC 单租户系统）。对于 HANA 单个容器， HANA MDC 多租户系统以及使用光纤通道 SAN 的 HANA 系统，所述的所有步骤都是相同的。</block>
  <block id="a7f41558e051c56ded21f272fe49e225" category="admonition">SAP HANA 插件需要 Java 64 位版本 1.8 。在部署 SAP HANA 插件之前，必须在主机上安装 Java 。</block>
  <block id="6fff1abc903305209c87f7b90f7e1b1a" category="list-text">在主机选项卡中，单击添加。</block>
  <block id="8970de3a2a41c242eb60c8fc5e3b607c" category="list-text">提供主机信息并选择要安装的 SAP HANA 插件。单击提交。</block>
  <block id="fa9fc54000c6f4ea50c6fde5d70c4e23" category="list-text">确认指纹。</block>
  <block id="ce979c8e3f61c1ca2b3e50d9c5a0cfe1" category="paragraph">HANA 插件和 Linux 插件的安装会自动启动。安装完成后，主机的状态列将显示正在运行。此屏幕还会显示 Linux 插件与 HANA 插件一起安装。</block>
  <block id="cd010989717ddfd5f977bb9b51a73a35" category="paragraph">安装此插件后， HANA 资源的自动发现过程将自动启动。在资源屏幕中，将创建一个新资源，该资源将标记为已锁定，并带有红色挂锁图标。</block>
  <block id="35f8f8811e136557a57edc7704ee5b22" category="list-text">选择并单击资源以继续配置。</block>
  <block id="f50eb8052b36abc4f9b3cad6d960fd7f" category="admonition">您也可以通过单击刷新资源在资源屏幕中手动触发自动发现过程。</block>
  <block id="fe618178f7c10f4f968b1e55e6e3d9e2" category="list-text">提供 HANA 数据库的用户存储密钥。</block>
  <block id="402cddec6e638b8f8c1c569ced4f1a90" category="paragraph">第二级自动发现过程从发现租户数据和存储占用空间信息开始。</block>
  <block id="77cbb735a690f450f24356e2a1deed79" category="list-text">单击详细信息以查看资源拓扑视图中的 HANA 资源配置信息。</block>
  <block id="76e03c71835140195f3451e1d5443d5e" category="paragraph">资源配置完成后，必须按照下一节所述执行资源保护配置。</block>
  <block id="12951e02508b48eb46e315f8d0562ff6" category="section-title">资源保护配置</block>
  <block id="12aaca285ac0310e6d68d828172364e9" category="paragraph">本节介绍资源保护配置。无论自动发现资源还是手动配置资源，资源保护配置都是相同的。对于所有 HANA 架构，单个或多个主机，单个容器或 MDC 系统，此功能也是相同的。</block>
  <block id="055d374e381cdcb3c869f3d9a80b4502" category="list-text">在资源选项卡中，双击资源。</block>
  <block id="5ef30ac91b203045749e324a7c953330" category="list-text">为 Snapshot 副本配置自定义名称格式。</block>
  <block id="e403c3e829dba2bfdb738b52d2d59f83" category="admonition">NetApp 建议使用自定义 Snapshot 副本名称来轻松确定使用哪个策略和计划类型创建了哪些备份。通过在 Snapshot 副本名称中添加计划类型，您可以区分计划备份和按需备份。按需备份的 `schedule name` 字符串为空，而计划备份包括字符串 `hourly` ， `Daily` ， `或 Weekly` 。</block>
  <block id="b0425f359f0a3d6106d6138fde093c4a" category="paragraph">在下图所示的配置中，备份和 Snapshot 副本名称采用以下格式：</block>
  <block id="6a9d47e7eeb50363e1b7a1dbe388e0ba" category="list-text">计划的每小时备份： `snapCenter_LocalSnap_hourly_&lt;time_stamp&gt;`</block>
  <block id="3355314ce177f72a1b8e8407de977cca" category="list-text">计划的每日备份： `snapCenter_LocalSnapAndSnapVault_daily _ &lt;time_stamp&gt;`</block>
  <block id="6420569a9c32dd8b96c8d44895321def" category="list-text">按需每小时备份： `snapCenter_LocalSnap_&lt;time_stamp&gt;`</block>
  <block id="1ea93710515eeb13cfbf2e235737b75a" category="list-text">按需每日备份： `snapCenter_LocalSnapAndSnapVault_&lt;time_stamp&gt;`</block>
  <block id="b76f8c2a7cb1e101f995e83095d6178a" category="admonition">即使在策略配置中为按需备份定义了保留，但只有在执行另一个按需备份时，才会执行内务管理。因此，通常必须在 SnapCenter 中手动删除按需备份，以确保这些备份也会在 SAP HANA 备份目录中删除，并且日志备份整理不会基于旧的按需备份。</block>
  <block id="b003a1018f70b1f4d3c1a5616cab19d4" category="list-text">无需在 " 应用程序设置 " 页面上进行任何特定设置。单击下一步。</block>
  <block id="894e5b025b3245607edb9f8a43f02429" category="list-text">选择要添加到资源中的策略。</block>
  <block id="43104f81893a1fc2c62fc00994e63831" category="list-text">定义 LocalSnap 策略的计划（在此示例中，每四小时一次）。</block>
  <block id="1544a621c5ea50f94ae17918bc04e3e5" category="list-text">定义 LocalSnapAndSnapVault 策略的计划（在此示例中，每天一次）。</block>
  <block id="0b4337a47e9b930f09a9cd9baec4b896" category="list-text">定义块完整性检查策略的计划（在此示例中，每周一次）。</block>
  <block id="11b2dcbc196b4932ce3fc87795a4c761" category="list-text">提供有关电子邮件通知的信息。</block>
  <block id="1f073d3f1fa31a7943b90fab6d63038c" category="list-text">现在，可以在拓扑页面上创建按需备份。计划的备份会根据配置设置执行。</block>
  <block id="70cc601fa82e577c081c400b88d57ee0" category="section-title">适用于光纤通道 SAN 环境的其他配置步骤</block>
  <block id="9ed28ce680ba733c2fe37c75373d98df" category="paragraph">根据 HANA 版本和 HANA 插件部署， SAP HANA 系统使用光纤通道和 XFS 文件系统的环境需要执行其他配置步骤。</block>
  <block id="8ff318fc76f9b3a3de0488ffd2d04c8e" category="admonition">只有在 SnapCenter 中手动配置的 HANA 资源才需要执行这些额外的配置步骤。此外，仅 HANA 1.0 版和截至 SPS2 的 HANA 2.0 版也需要此功能。</block>
  <block id="c2fce189d8eec37410d2f593810352a1" category="paragraph">当 HANA 备份保存点由 SAP HANA 中的 SnapCenter 触发时， SAP HANA 会最后为每个租户和数据库服务写入 Snapshot ID 文件（例如， ` /ha/data/SID/mnt00001/hdb00001/snapshot_databackup_0_1` ）。这些文件属于存储上的数据卷，因此属于存储 Snapshot 副本。在还原备份的情况下执行恢复时，必须提供此文件。由于在 Linux 主机上使用 XFS 文件系统缓存元数据，因此该文件在存储层不会立即可见。元数据缓存的标准 XFS 配置为 30 秒。</block>
  <block id="f4e76c9471978aaeb772485f58e7a395" category="admonition">借助 HANA 2.0 SPS3 ， SAP 将这些 Snapshot ID 文件的写入操作更改为同步，这样元数据缓存就不会成为问题。</block>
  <block id="4cc50bec1942773fad9ded9d3cd842a8" category="admonition">对于 SnapCenter 4.3 ，如果 HANA 插件部署在数据库主机上，则 Linux 插件会在触发存储 Snapshot 之前在主机上执行文件系统刷新操作。在这种情况下，元数据缓存不是问题。</block>
  <block id="1f7de7fc4ca98e15318923ea006f4d57" category="paragraph">在 SnapCenter 中，您必须配置 `postquiesce` 命令，该命令会等待 XFS 元数据缓存转储到磁盘层。</block>
  <block id="2410e6cec8fb08d6ad20dfb5799dd6c7" category="paragraph">可以使用以下命令检查元数据缓存的实际配置：</block>
  <block id="ecf49e35456f017989d424036038da90" category="paragraph">NetApp 建议使用的等待时间是 `fs.xfs.xfssyncd_centis` 参数值的两倍。由于默认值为 30 秒，因此请将休眠命令设置为 60 秒。</block>
  <block id="29884ea371b02c8bba08943ed42ee409" category="paragraph">如果将 SnapCenter 服务器用作中央 HANA 插件主机，则可以使用批处理文件。批处理文件必须包含以下内容：</block>
  <block id="c08fa9b50927a629fa005c6dca42b302" category="paragraph">此批处理文件可以保存为 `C ： \Program Files\NetApp\Wait60Sec.bat` 。在资源保护配置中，必须将批处理文件添加为后暂停命令。</block>
  <block id="5a9ee55acf58f2d318f768581181f902" category="paragraph">如果使用单独的 Linux 主机作为中央 HANA 插件主机，则必须在 SnapCenter UI 中将命令 ` /bin/休眠 60` 配置为后暂停命令。</block>
  <block id="8aa8a84f4f37f29ea89f20e3a69b300d" category="paragraph">下图显示了资源保护配置屏幕中的 POST Quiesce 命令。</block>
  <block id="5f41ebd846d632bd2b1a2264c1132da4" category="list-text">* 数据快速增长。 * 数据快速增长和备份时间不断缩短需要对备份基础架构进行持续投资。也就是说，您必须购买更多的磁带驱动器，更多的备份磁盘空间和更快的备份网络。您还必须支付存储和管理这些磁带资产的持续费用。增量备份或差异备份可以解决这些问题，但这种安排会导致还原过程非常缓慢，繁琐且复杂，难以验证。此类系统通常会以业务无法接受的方式增加恢复时间目标（ RTO ）和恢复点目标（ RPO ）时间。</block>
  <block id="1651b50e0d1cf61dd130c805642637d7" category="paragraph">NetApp Snapshot 技术可用于在几分钟内创建数据库备份。创建 Snapshot 副本所需的时间与数据库大小无关，因为 Snapshot 副本不会移动存储平台上的任何物理数据块。此外，使用 Snapshot 技术不会对实时 SAP 系统产生性能影响，因为在创建 Snapshot 副本或更改活动文件系统中的数据时， NetApp Snapshot 技术不会移动或复制数据块。因此，可以计划创建 Snapshot 副本，而无需考虑对话峰值或批处理活动期间。SAP 和 NetApp 客户通常会在一天内计划多个联机 Snapshot 备份；例如，每四小时备份一次很常见。这些 Snapshot 备份通常会在主存储系统上保留三到五天，然后再被删除。</block>
  <block id="133a887f3b7a331b1bb97c917ab238b8" category="paragraph">Snapshot 副本还为还原和恢复操作提供了主要优势。通过 NetApp SnapRestore 数据恢复软件，可以根据可用的 Snapshot 副本将整个数据库或数据库的一部分还原到任意时间点。无论数据库大小如何，此类还原过程都只需几分钟即可完成。由于在一天中会创建多个联机 Snapshot 备份，因此与传统备份方法相比，恢复过程所需的时间显著减少。由于可以使用仅使用几小时（而不是长达 24 小时）的 Snapshot 副本执行还原，因此必须应用较少的事务日志。因此， RTO 减少到几分钟，而不是传统单周期磁带备份所需的几小时。</block>
  <block id="6888872d812bb849b73e336be754410e" category="paragraph">Snapshot 副本备份与活动联机数据存储在同一磁盘系统上。因此， NetApp 建议使用 Snapshot 副本备份作为对备份到二级位置的补充，而不是替代。大多数还原和恢复操作都通过在主存储系统上使用 SnapRestore 来处理。只有当包含 Snapshot 副本的主存储系统损坏时，才需要从二级位置进行还原。如果需要还原 Snapshot 副本不再提供的备份，也可以使用二级位置：例如，月末备份。</block>
  <block id="e608654d33837deefa07ba1970e5e003" category="paragraph">到二级位置的备份基于在主存储上创建的 Snapshot 副本。因此，直接从主存储系统读取数据，而不会在 SAP 数据库服务器上生成负载。主存储直接与二级存储通信，并使用 NetApp SnapVault 磁盘到磁盘备份将备份数据发送到目标。</block>
  <block id="5a83d4498ee4c3a831980e216c538942" category="paragraph">与传统备份相比， SnapVault 具有显著优势。在初始数据传输（所有数据均已从源传输到目标）之后，所有后续备份仅会将更改过的块复制到二级存储。因此，主存储系统上的负载以及完整备份所需的时间会显著减少。由于 SnapVault 仅在目标上存储更改过的块，因此完整的数据库备份所需的磁盘空间更少。</block>
  <block id="8357feb9601e96769166a4c960d3aca0" category="paragraph">解决方案 还可以无缝扩展到混合云操作模式。可以从内部 NetApp ONTAP 系统到云中运行的 Cloud Volumes ONTAP 实例进行数据复制，以实现灾难恢复或异地备份。无论 SAP HANA 系统是在内部还是在云中运行，您都可以使用 SnapCenter 作为一个中央工具来管理数据保护和数据复制。下图显示了备份解决方案 的概述。</block>
  <block id="c8c0c4fd6276899657fcf55f879b0bbb" category="paragraph">下面的屏幕截图显示了客户在 NetApp 存储上运行 SAP HANA 的 HANA Studio 。客户正在使用 Snapshot 副本备份 HANA 数据库。此图显示，使用 Snapshot 备份技术， HANA 数据库（大小约为 2.3 TB ）将在 2 分 11 秒内备份完毕。</block>
  <block id="1019082efe6d65534f457340d1be279a" category="admonition">整个备份工作流运行时间的最大一部分是执行 HANA 备份保存点操作所需的时间，此步骤取决于 HANA 数据库上的负载。存储 Snapshot 备份本身始终会在几秒钟内完成。</block>
  <block id="81206476869ff48ddb7258539ced5bcc" category="section-title">恢复时间目标比较</block>
  <block id="37aa1a462c93cfc77a8aa63e2f8ffd5a" category="paragraph">对于基于文件的备份，还原时间取决于数据库和备份基础架构的大小，该大小定义了还原速度，以 MB/ 秒为单位。例如，如果基础架构支持以 250 MBps 的速度执行还原操作，则还原大小为 1 TB 的数据库大约需要 1 小时 10 分钟。</block>
  <block id="852a28121e38cfc60cc3c1fa243f4eff" category="paragraph">使用存储 Snapshot 副本备份时，还原时间与数据库大小无关，并且可以从主存储执行还原时，还原时间在几秒的范围内。只有在主存储不再可用时发生灾难时，才需要从二级存储进行还原。</block>
  <block id="1173d8912da48858e849bb3fccbf7171" category="paragraph">数据库开始时间取决于行和列存储的大小。对于列存储，开始时间还取决于数据库启动期间预加载的数据量。在以下示例中，我们假定开始时间为 30 分钟。基于文件的还原和恢复以及基于 Snapshot 的还原和恢复的开始时间相同。</block>
  <block id="5556b5c6ecf3f033b4ffde8d3c45eac4" category="paragraph">对于基于文件的数据备份，备份计划通常每天执行一次。通常不能使用较高的备份频率，因为备份会降低生产性能。因此，在最坏的情况下，在该日写入的所有日志都必须在正向恢复期间应用。</block>
  <block id="e1740ff2f0b2a56fc2f953f3d1be5ecb" category="paragraph">通常， Storage Snapshot 副本数据备份的计划频率较高，因为它们不会影响 SAP HANA 数据库的性能。例如，如果每六小时计划一次 Snapshot 副本备份，则在最坏的情况下，恢复时间将是基于文件的备份恢复时间的四分之一（ 6 小时 /24 小时 = ¼ ）。</block>
  <block id="32378a49bfefae9d51083bafc161e544" category="paragraph">下图显示了使用 Snapshot 备份时 1 TB 数据库的 RTO 示例。对于基于存储的 Snapshot 备份， RTO 仅取决于数据库开始时间和正向恢复时间，因为还原操作会在几秒钟内完成，而与数据库大小无关。根据还原和恢复的完成时间，正向恢复时间也会增加，但由于备份频率较高（在此示例中为每六小时一次），正向恢复时间最多为 43 分钟。在此示例中，最大 RTO 为 1 小时 13 分钟。</block>
  <block id="a931b15763a0d7c48777aa949bbb60e7" category="paragraph">与基于文件的数据备份相比，每天只需备份一个 Snapshot 副本数据， RTO 便可减少 40% 。如果每天执行四个 Snapshot 备份，则减少量将增加到 70% 。此图还显示，如果将 Snapshot 备份频率提高到每天四到六个以上的 Snapshot 备份，则此曲线将保持平稳。因此，我们的客户通常每天配置四到六个 Snapshot 备份。</block>
  <block id="09c2f8b288eb278a7e0b050639b8fb12" category="admonition">此图显示了 HANA 服务器 RAM 大小。计算内存中的数据库大小等于服务器 RAM 大小的一半。</block>
  <block id="cc7384b3c84a0bffa3195fb822301a4a" category="admonition">还原和恢复时间根据以下假设进行计算。数据库可以以 250 MBps 的速度进行还原。每天的日志文件数是数据库大小的 50% 。例如， 1 TB 数据库每天创建 500 MB 的日志文件。可以在 100 Mbps 的速度下执行恢复。</block>
  <block id="c1665b6df297e7a2e1db92f10416b879" category="summary">SAP 建议将基于存储的 Snapshot 备份与每周基于文件的备份相结合，以执行块完整性检查。SnapCenter 支持使用选择基于文件的备份作为备份类型的策略来执行块完整性检查。</block>
  <block id="dccc440b322ed1d3d09bf6576f0a4793" category="doc">块完整性检查</block>
  <block id="676cfd91b13790927d9992a7d08c8828" category="paragraph">使用此策略计划备份时， SnapCenter 会为系统和租户数据库创建标准 SAP HANA 文件备份。</block>
  <block id="e31898da9c6e6dc3b7af9f990b041c59" category="paragraph">SnapCenter 显示块完整性检查的方式与基于 Snapshot 副本的备份不同。而是在摘要卡中显示基于文件的备份数以及上一个备份的状态。</block>
  <block id="3fd5edce432881c2683af2b35468c624" category="paragraph">无法使用 SnapCenter UI 删除块完整性检查备份，但可以使用 PowerShell 命令将其删除。</block>
  <block id="06a4abfaf0e161e7e3e07f7943ecd9a8" category="paragraph">SAP HANA 备份目录会显示系统数据库和租户数据库的条目。下图显示了系统数据库备份目录中的 SnapCenter 块完整性检查。</block>
  <block id="b2a42e5ff741a7da520a61fe7e9287fc" category="paragraph">成功的块完整性检查可创建标准 SAP HANA 数据备份文件。SnapCenter 使用 HANA 数据库中配置的备份路径执行基于文件的数据备份操作。</block>
  <block id="b7f33e6f09f01af6baa6ea548172f22f" category="summary">在 SnapCenter 中，数据库备份通常使用在每个 HANA 数据库的资源保护配置中定义的计划来执行。可以使用 SnapCenter 图形用户界面， PowerShell 命令行或 REST API 执行按需数据库备份。</block>
  <block id="89f8bb80ca1403422295c6ad48f8cac7" category="doc">数据库备份</block>
  <block id="db84dde0c00214d066c28c0fa6b20a78" category="paragraph">在 SnapCenter 中，数据库备份通常使用在每个 HANA 数据库的资源保护配置中定义的计划来执行。</block>
  <block id="c87782e3691915e9f853696cf50b790c" category="paragraph">可以使用 SnapCenter 图形用户界面， PowerShell 命令行或 REST API 执行按需数据库备份。</block>
  <block id="d8827f346e1ca85b7ec57393df66f099" category="section-title">在 SAP HANA Studio 中确定 SnapCenter 备份</block>
  <block id="44ba2e7ca4f9ce6053a12b79d760defb" category="paragraph">SnapCenter 资源拓扑显示了使用 SnapCenter 创建的备份列表。下图显示了主存储上的可用备份，并突出显示了最新的备份。</block>
  <block id="8e6a036c1dbfbcdd51099ba8e159a0f5" category="paragraph">在对 SAP HANA MDC 系统使用存储 Snapshot 副本执行备份时，系统会为数据卷创建 Snapshot 副本。此数据卷包含系统数据库的数据以及所有租户数据库的数据。为了反映此物理架构，每当 SnapCenter 触发 Snapshot 备份时， SAP HANA 都会在内部对系统数据库以及所有租户数据库执行组合备份。这会导致 SAP HANA 备份目录中有多个单独的备份条目：一个用于系统数据库，一个用于每个租户数据库。</block>
  <block id="d9e26498378f71d1e41de1f3066a6505" category="admonition">对于 SAP HANA 单容器系统，数据库卷仅包含单个数据库， SAP HANA 备份目录中只有一个条目。</block>
  <block id="c78ea61a0643b5d1741ee698d73c8126" category="paragraph">在 SAP HANA 备份目录中， SnapCenter 备份名称存储为 `Comment` 字段以及 `外部备份 ID （ EBID ）` 。此信息显示在系统数据库的以下屏幕截图中，之后显示在租户数据库 SS1 的屏幕截图中。这两个图都突出显示了备注字段和 EBID 中存储的 SnapCenter 备份名称。</block>
  <block id="763aeabe1237091e11c223fcdb6e514b" category="inline-link"><block ref="763aeabe1237091e11c223fcdb6e514b" category="inline-link-rx"></block></block>
  <block id="017ad38ce328eda5e6b4e873a97fec93" category="admonition">对于基于 Snapshot 的备份， HANA 2.0 SPS4 （修订版 40 和 41 ）版本始终显示备份大小为零。修订版 42 已修复此问题。有关详细信息，请参见 SAP 注释<block ref="0ede2af82d168becfa8e8e328919c93f" category="inline-link-rx"></block>。</block>
  <block id="f22d323a2a4ca6a837dc9be2a7ef9849" category="admonition">SnapCenter 只能识别自己的备份。例如，使用 SAP HANA Studio 创建的其他备份会显示在 SAP HANA 目录中，但不会显示在 SnapCenter 中。</block>
  <block id="d97f26fcfcf75422cef96edd3166fe81" category="section-title">确定存储系统上的 SnapCenter 备份</block>
  <block id="0b1c6a89ad613ff0c9a5e72c1a7cb7f6" category="paragraph">要查看存储层上的备份，请使用 NetApp OnCommand 系统管理器并在 SVM —卷视图中选择数据库卷。下部 Snapshot 副本选项卡将显示卷的 Snapshot 副本。以下屏幕截图显示了主存储上数据库卷 `SS1_data_mnt00001` 的可用备份。突出显示的备份是之前映像中 SnapCenter 和 SAP HANA Studio 中显示的备份，其命名约定相同。</block>
  <block id="a31d79c67df8a2b4b434b686c3882bf6" category="paragraph">以下屏幕截图显示了二级存储系统上复制目标卷 `hana SA1_data_mnt00001_dest` 的可用备份。</block>
  <block id="4cbe8448ed645bcd05c25b0ed05a2ffc" category="section-title">主存储上的按需数据库备份</block>
  <block id="9a18d22e51d061ba9e29d3fea1cbb740" category="list-text">在资源视图中，选择资源并双击相应行以切换到拓扑视图。</block>
  <block id="162a41f8614e6637ad948db15ee7bbd1" category="paragraph">资源拓扑视图概述了使用 SnapCenter 创建的所有可用备份。此视图的顶部区域显示备份拓扑，其中显示了主存储（本地副本）上以及异地备份存储（存储副本）上的备份（如果可用）。</block>
  <block id="e12fe165bcaa4995a69a0109bbcbfa29" category="list-text">在顶部行中，选择立即备份图标以启动按需备份。从下拉列表中，选择备份策略 `LocalSnap` ，然后单击备份启动按需备份。</block>
  <block id="442b3eee32be51815a4de7d8303b7341" category="inline-link-macro">" 资源保护配置 " 。</block>
  <block id="c88c7279bb6dbd2ece99c6b6b75a95f7" category="admonition">您必须关闭并重新打开拓扑视图才能查看更新后的备份列表。</block>
  <block id="495ca2710421cfca56ba2e36c09339ad" category="list-text">单击活动区域中作业的活动行时，将显示作业详细信息。您可以单击查看日志来打开详细的作业日志。</block>
  <block id="121b846ed404f10227b94111cb571489" category="list-text">在 SAP HANA Studio 中，新备份会显示在备份目录中。备份目录中的注释和 EBID 字段也会使用 SnapCenter 中的相同备份名称。</block>
  <block id="703c46332afd81e1946cb2ad4ce00c93" category="section-title">通过 SnapVault 复制实现按需数据库备份</block>
  <block id="dae832cbcba7d155d4c6451f7ae9587c" category="list-text">在顶部行中，选择立即备份图标以启动按需备份。从下拉列表中，选择备份策略 `LocalSnapAndSnapVault` ，然后单击备份启动按需备份。</block>
  <block id="8d17cf93c266a000706498696e3f4769" category="list-text">单击活动区域中作业的活动行时，将显示作业详细信息。</block>
  <block id="1bdd9de63a778c886f72fc6c55b69544" category="list-text">通过选择存储副本，将显示二级存储上的备份。复制的备份名称与主存储上的备份名称相同。</block>
  <block id="894658d23e64b14d31e2add33d4d053b" category="summary">非数据卷的备份是 SAP HANA 插件的集成部分。保护数据库数据卷足以将 SAP HANA 数据库还原和恢复到给定时间点，前提是数据库安装资源和所需日志仍然可用。</block>
  <block id="9c0fde1c8553ad85618db06581560bad" category="doc">用于非数据卷备份的 SnapCenter 资源专用配置</block>
  <block id="0226c147f6eac3c1fdb31ee7abb85e96" category="paragraph">要从必须还原其他非数据文件的情况中恢复， NetApp 建议为非数据卷开发一个额外的备份策略，以增加 SAP HANA 数据库备份的容量。根据您的特定要求，非数据卷的备份可能会因计划频率和保留设置而异，您应考虑非数据文件的更改频率。例如， HANA 卷 ` ha/shared` 包含可执行文件，但也包含 SAP HANA 跟踪文件。虽然可执行文件仅在升级 SAP HANA 数据库时发生更改，但 SAP HANA 跟踪文件可能需要更高的备份频率，以支持分析 SAP HANA 的问题情况。</block>
  <block id="701304aa41af17415df3aa7320be043b" category="paragraph">通过 SnapCenter 非数据卷备份，可以在几秒钟内创建所有相关卷的 Snapshot 副本，并且空间效率与 SAP HANA 数据库备份相同。不同之处在于，不需要与 SAP HANA 数据库进行 SQL 通信。</block>
  <block id="e3e1681bd8a3d45858ea0fdcd572f8e5" category="section-title">配置非数据卷资源</block>
  <block id="e45b47ec2fca633e83f5c4385ac898c6" category="paragraph">在此示例中，我们希望保护 SAP HANA 数据库 SS1 的非数据卷。</block>
  <block id="d042be8219183ec4120acc5277a44865" category="list-text">从资源选项卡中，选择非数据卷，然后单击添加 SAP HANA 数据库。</block>
  <block id="538fffc9423ae34761ac6ba6b5841ad7" category="list-text">在添加 SAP HANA 数据库对话框的第 1 步中的资源类型列表中，选择非数据卷。指定资源的名称以及要用于该资源的关联 SID 和 SAP HANA 插件主机，然后单击下一步。</block>
  <block id="dc6781ad4f01aa22d21a245f1e236533" category="list-text">将 SVM 和存储卷添加为存储占用空间，然后单击下一步。</block>
  <block id="d0ff85892412dd4108d91789963c7dbd" category="list-text">在摘要步骤中，单击完成以保存设置。</block>
  <block id="38a80b556382ff0e9195ad3f4496627e" category="list-text">对所有所需的非数据卷重复上述步骤。</block>
  <block id="2decee12cecb2bc677055dacd4cdfa2f" category="list-text">继续配置新资源的保护。</block>
  <block id="ce9bd5c4898fb736dd8369e2b8af8944" category="admonition">非数据卷资源的数据保护与 SAP HANA 数据库资源的工作流相同，可以在单个资源级别定义。</block>
  <block id="8804d3973c80da008d6c4cfb33ee6f3a" category="paragraph">下图显示了已配置的非数据卷资源的列表。</block>
  <block id="769b718779fbe38c65b122b69e0271a3" category="section-title">资源组</block>
  <block id="850f14cc800444f77599dc97d2941041" category="paragraph">资源组是定义对需要相同保护策略和计划的多个资源的保护的一种便捷方式。属于某个资源组的单个资源仍可在单个级别受到保护。</block>
  <block id="dbd494d169ca51a674da2e3537496d92" category="paragraph">资源组提供以下功能：</block>
  <block id="6110a61d0bf8e9160700218a475a6763" category="list-text">您可以向资源组添加一个或多个资源。所有资源都必须属于同一个 SnapCenter 插件。</block>
  <block id="2583a6cfabdb6e8659c1e0889ef7d32a" category="list-text">可以在资源组级别定义保护。受保护时，资源组中的所有资源都使用相同的策略和计划。</block>
  <block id="c412b4321d55f6a6a2d2d6f807892920" category="list-text">SnapCenter 存储库和存储 Snapshot 副本中的所有备份都具有在资源保护中定义的相同名称。</block>
  <block id="249a5378bf40f0180cd729e65e99b9c3" category="list-text">还原操作在单个资源级别上应用，而不是在资源组中应用。</block>
  <block id="e990b5c5b90ded5db7b3ca93365a81e5" category="list-text">使用 SnapCenter 删除在资源组级别创建的资源的备份时，该资源组中所有资源的此备份都将被删除。删除备份包括从 SnapCenter 存储库中删除备份以及删除存储 Snapshot 副本。</block>
  <block id="b565830d52dbf51243943462fb70fe59" category="list-text">资源组的主要使用情形是，客户希望使用通过 SnapCenter 创建的备份与 SAP Landscape Management 进行系统克隆。下一节将对此进行介绍。</block>
  <block id="ba5da7a68f8cd5eca48e3df6086a98c0" category="section-title">将 SnapCenter 与 SAP 环境管理结合使用</block>
  <block id="35e271fbf0a1d067faf29bb2e12cf833" category="paragraph">NetApp SSC 和 SAP Lama 可以直接使用 NetApp SSC 创建按需 Snapshot 副本，但也可以利用使用 SnapCenter 创建的 Snapshot 副本。要使用 SnapCenter 备份作为 SAP LaMa 执行系统克隆和复制操作的基础，必须满足以下前提条件：</block>
  <block id="55fb179ba0dbaef14f4ae67701ba967c" category="list-text">SAP Lama 要求备份中包含所有卷；这包括 SAP HANA 数据，日志和共享卷。</block>
  <block id="a45b79d50cacf7594adf94e98d02fe12" category="list-text">所有存储 Snapshot 名称必须相同。</block>
  <block id="af1c8995ec23e1bd0ae4ec3ca3543a2d" category="list-text">存储 Snapshot 名称必须以 VCM 开头。</block>
  <block id="090e02de1070460f7847450e0bfd801a" category="admonition">在正常备份操作中， NetApp 不建议包含日志卷。如果从备份还原日志卷，则它会覆盖上次活动的重做日志，并阻止将数据库恢复到最近的状态。</block>
  <block id="650ee54724b128d5e2bf7913c16163cd" category="paragraph">SnapCenter 资源组可满足所有这些要求。在 SnapCenter 中配置了三个资源：每个资源用于数据卷，日志卷和共享卷。这些资源将放入资源组中，然后在资源组级别定义保护。在资源组保护中，自定义 Snapshot 名称必须在开头使用 VCM 进行定义。</block>
  <block id="be212c956204f2d074911d5f5278a925" category="summary">本技术报告使用的实验室设置包括五种不同的 SAP HANA 配置。</block>
  <block id="ab37b0897f2b28bb348c68a2d7ab5a5e" category="paragraph">本技术报告使用的实验室设置包括五种不同的 SAP HANA 配置：</block>
  <block id="0e03eebb552b07ee65c7abe3b9c7d6f7" category="list-text">* MS1.*</block>
  <block id="4d7bb2ec16ebf6c53a55efea4d621a37" category="list-text">SAP HANA 多主机 MDC 单租户系统</block>
  <block id="0afd06c83e04fc2747bb37f58375e710" category="list-text">使用中央插件主机（ SnapCenter 服务器）进行管理</block>
  <block id="0d93b800c7f4d39ad9b81b7892689db5" category="list-text">使用 NFS 作为存储协议</block>
  <block id="0f439d9c9ee319da448b6e5a32327941" category="list-text">SAP HANA 单主机 MDC 单租户系统</block>
  <block id="e0bb5e1697d1c4f5d7ae6d3feadaf0a3" category="list-text">自动发现，在 HANA 数据库主机上安装了 HANA 插件</block>
  <block id="611216ecfb30bfebaa14ef82ab1dd0ec" category="list-text">*</block>
  <block id="ae25c66c27863e282312520ba5251cd5" category="list-text">SAP HANA 单主机 MDC 多租户系统</block>
  <block id="9ba0be3ffab3d754569badf1804f8d3b" category="list-text">使用中央插件主机（ SnapCenter 服务器）进行管理</block>
  <block id="abccdef464fcfbc9a938fd63247cb6bb" category="list-text">* 。 ss3*</block>
  <block id="92047fcc565cab594e47ad89009764bd" category="list-text">使用光纤通道 SAN 作为存储协议</block>
  <block id="f87a3ba7778533e03af98316f9d823a4" category="paragraph">以下各节将介绍完整的配置以及备份，还原和恢复工作流。问题描述 包括本地 Snapshot 备份以及使用 SnapVault 复制到备份存储。存储虚拟机（ SVM ）对于主存储为 `HANA 主存储` ，对于异地备份存储为 `HANA 备份` 。</block>
  <block id="cc70c3f1cc797c2261fb179e7b87cbb2" category="paragraph">SnapCenter 服务器用作 HANA 系统 MS1 和 SS2 的中央 HANA 插件主机。</block>
  <block id="a7bf2acab613e56927ca1ba4e586af30" category="paragraph">下图显示了实验室设置。</block>
  <block id="94ff220590f3f56bf66ac697c81fc4cb" category="summary">本节列出了此解决方案 中使用的组件，支持的 SAP HANA 版本和配置以及 SnapCenter 4.6 增强功能。</block>
  <block id="44f0406e0b65477e22abb0af2670c920" category="doc">SnapCenter SAP HANA 备份解决方案</block>
  <block id="8dfec560491833edefc6c6f71aba9fdc" category="paragraph">适用于 SAP HANA 的 SnapCenter 备份解决方案 涵盖以下方面：</block>
  <block id="0173cafa1c2bd31312469cc22b2ee819" category="list-text">使用基于存储的 Snapshot 副本执行非数据卷（例如， ` /hana / 共享` ）备份：</block>
  <block id="eabcd15fb0326cf97b04fef8a19fb538" category="list-text">复制到异地备份或灾难恢复位置：</block>
  <block id="3e736a1d51f4a0ea0f4ad47be7bd944d" category="list-text">SAP HANA 数据 Snapshot 备份</block>
  <block id="9c6c79a2246055e9fdb39ae657f0f886" category="list-text">非数据卷</block>
  <block id="a9a8799b9193796c46f7880c75fd190c" category="list-text">在异地备份存储上配置保留管理</block>
  <block id="074c5a464474e4351975c84a84ba967c" category="list-text">使用基于文件的备份检查数据库块完整性：</block>
  <block id="7191f8de9290c359fb8c544612f38cc8" category="list-text">使用 SAP HANA 多租户数据库容器（ MDG ）系统执行单租户还原操作</block>
  <block id="e4f5593c4f95fe01e9bb1e5a603a2e02" category="paragraph">数据库数据文件备份由 SnapCenter 与适用于 SAP HANA 的插件一起执行。此插件将触发 SAP HANA 数据库备份保存点，以便在主存储系统上创建的 Snapshot 副本基于 SAP HANA 数据库的一致映像。</block>
  <block id="caf2cabe6654a975ccb9710e8a344950" category="paragraph">通过 SnapCenter ，可以使用 SnapVault 或 NetApp SnapMirror 将一致的数据库映像复制到异地备份或灾难恢复位置。功能。通常，为主备份和异地备份存储上的备份定义不同的保留策略。SnapCenter 处理主存储上的保留，而 ONTAP 处理异地备份存储上的保留。</block>
  <block id="6469c7a56441c8b63be2ea158e884a33" category="paragraph">为了能够对所有 SAP HANA 相关资源进行完整备份， SnapCenter 您还可以使用 SAP HANA 插件和基于存储的 Snapshot 副本备份所有非数据卷。非数据卷可以独立于数据库数据备份进行计划，以启用单个保留和保护策略。</block>
  <block id="e78eed5ba72730da9f47adc11f3c54db" category="paragraph">SAP HANA 数据库会自动执行日志备份。根据恢复点目标，日志备份的存储位置有多个选项：</block>
  <block id="0604ebbb1e2ad7e740154a7c284f4b0c" category="list-text">日志备份会写入存储系统，该存储系统会使用 NetApp MetroCluster 高可用性（ HA ）和灾难恢复存储软件将数据同步镜像到另一个位置。</block>
  <block id="d5f00838bababddfb43beb4465ebc0cd" category="list-text">可以在同一主存储系统上配置日志备份目标，然后使用 SnapMirror 将其同步或异步复制到二级存储。</block>
  <block id="c65f36922e2aff940a69761d8f5472f5" category="list-text">可以在同一个异地备份存储上配置日志备份目标，在该存储中使用 SnapVault 复制数据库备份。在此配置中，异地备份存储具有与主存储相同的可用性要求，以便可以将日志备份写入异地备份存储。</block>
  <block id="4a3326877edcb379877fb00b3c8e2c5c" category="paragraph">SAP 建议将基于存储的 Snapshot 备份与每周基于文件的备份相结合，以执行块完整性检查。可以从 SnapCenter 中执行块完整性检查。SnapCenter 会根据您可配置的保留策略管理主存储，日志文件备份和 SAP HANA 备份目录中的数据文件备份管理。</block>
  <block id="56ed3e5a0893311ac5bc95fbcc59accd" category="admonition">SnapCenter 负责主存储上的保留，而 ONTAP 负责管理二级备份保留。</block>
  <block id="20a208d0c21644982025cf3c8b139920" category="paragraph">下图简要显示了数据库和日志备份配置，其中，日志备份会写入异地备份存储的 NFS 挂载。</block>
  <block id="1176d7039f3984c8be34b0ca0d74a052" category="paragraph">在对非数据卷执行基于存储的 Snapshot 备份时， SnapCenter 将执行以下任务：</block>
  <block id="5c724f929ca6d43af26f240326be9c07" category="list-text">为非数据卷创建存储 Snapshot 副本。</block>
  <block id="17b1e1416624c8733a1c56a9f6e2bddf" category="list-text">对数据卷执行 SnapVault 或 SnapMirror 更新（如果已配置）。</block>
  <block id="63243cdf5e6c964519f840e76038b854" category="list-text">根据定义的保留策略删除主存储上的存储 Snapshot 副本。</block>
  <block id="3855d2073477072ba2b2abf3881501de" category="paragraph">在对 SAP HANA 数据库执行基于存储的 Snapshot 备份时， SnapCenter 将执行以下任务：</block>
  <block id="d2e57dc1dee012c030a253e5b13686c5" category="list-text">创建 SAP HANA 备份保存点，以便在持久性层上创建一致的映像。</block>
  <block id="d4878186e7d0a0eaebd235c358b6ea67" category="list-text">创建数据卷的存储 Snapshot 副本。</block>
  <block id="9c7d518082c6163c486cb2ca4ae3715a" category="list-text">在 SAP HANA 备份目录中注册存储 Snapshot 备份。</block>
  <block id="1a8bab70f16abac5fec44eb4a5970da7" category="list-text">发布 SAP HANA 备份保存点。</block>
  <block id="907c11e1227f2e092d437101f5d24b18" category="list-text">如果备份不再存在于主备份存储或异地备份存储中，则删除 SAP HANA 备份目录条目。</block>
  <block id="f81fa7e47b429a74f3c326ccbe7d623c" category="list-text">无论何时根据保留策略删除备份或手动删除备份， SnapCenter 都会删除早于最旧数据备份的所有日志备份。日志备份会在文件系统和 SAP HANA 备份目录中删除。</block>
  <block id="02ec85da7a34534916a8902ad64c7b67" category="paragraph">SnapCenter 支持使用 NFS 或 FC 连接的 NetApp 存储系统（ AFF ONTAP 和 FAS ）的 SAP HANA 单主机和多主机配置，以及使用 NFS 在 Cloud Volumes ONTAP 上运行的 SAP HANA 系统。</block>
  <block id="d6ce387b294b25dfab0c447868f0594a" category="paragraph">SnapCenter 支持以下 SAP HANA 架构和版本：</block>
  <block id="c4f41244d46b23a479a0201aa120364f" category="list-text">SAP HANA 单个容器： SAP HANA 1.0 SPS12</block>
  <block id="52759939d5c34ced894a8edb15e47c21" category="list-text">SAP HANA 多租户数据库容器（ MDC-Database Container ， MDC ）单租户： SAP HANA 2.0 SPS3 及更高版本</block>
  <block id="5b969ece692bee20925041517740d2fc" category="list-text">SAP HANA 多租户数据库容器（ MDc ）多租户： SAP HANA 2.0 SPS4 及更高版本</block>
  <block id="6c176e9f73681cb91e72213cd5479748" category="section-title">SnapCenter 4.6 增强功能</block>
  <block id="04c675594bfdb975329fb2cae491292b" category="inline-link">TR-4719 采用 SnapCenter 的 SAP HANA 系统复制，备份和恢复</block>
  <block id="72180d0307c0939e956b5a3f8f96bbcb" category="summary">本节介绍与 SAP HANA 资源配置和部署相关的 SnapCenter 概念和最佳实践。</block>
  <block id="50414ea6d37e50fb2a4f48ddf4085157" category="doc">SnapCenter 概念和最佳实践</block>
  <block id="d14a18b64c59033d7b1fea72542be464" category="section-title">SAP HANA 资源配置选项和概念</block>
  <block id="2ae9740860217e61f2af98868b88c403" category="paragraph">使用 SnapCenter ，可以使用两种不同的方法来配置 SAP HANA 数据库资源。</block>
  <block id="3783f6b09890c5b4eb00a25d23136015" category="list-text">* 手动资源配置。 * 必须手动提供 HANA 资源和存储占用空间信息。</block>
  <block id="98230b8b5c2c209c0d5176357f522161" category="list-text">* 自动发现 HANA 资源。 * 自动发现可简化 SnapCenter 中 HANA 数据库的配置，并实现自动还原和恢复。</block>
  <block id="4019aefaa340ef7fe5c0a93f7b12da28" category="paragraph">请务必了解，只有 SnapCenter 中自动发现的 HANA 数据库资源才支持自动还原和恢复。在 SnapCenter 中手动配置的 HANA 数据库资源必须在 SnapCenter 中执行还原操作后手动恢复。</block>
  <block id="da161102bc2d2a20a78e55971ee5f20b" category="paragraph">另一方面，并非所有 HANA 架构和基础架构配置都支持使用 SnapCenter 进行自动发现。因此， HANA 环境可能需要采用混合方法，其中某些 HANA 系统（ HANA 多主机系统）需要手动配置资源，而其他所有系统都可以使用自动发现进行配置。</block>
  <block id="60e1cc0fa5d2d1b50385b6799389520a" category="paragraph">自动发现以及自动还原和恢复取决于是否能够在数据库主机上执行操作系统命令。例如，文件系统和存储占用空间发现以及卸载，挂载或 LUN 发现操作。这些操作将使用 SnapCenter Linux 插件执行，该插件会与 HANA 插件一起自动部署。因此，在数据库主机上部署 HANA 插件以启用自动发现以及自动还原和恢复是前提条件。在数据库主机上部署 HANA 插件后，也可以禁用自动发现。在这种情况下，资源将是手动配置的资源。</block>
  <block id="9d2c3ff1f6040a4a4183ab744b9bef22" category="paragraph">下图总结了这些依赖关系。有关 HANA 部署选项的详细信息，请参见 " SAP HANA 插件的部署选项 " 一节。</block>
  <block id="a368b07ff59cd175b67a373e61562ea4" category="admonition">HANA 和 Linux 插件当前仅适用于基于 Intel 的系统。如果 HANA 数据库运行在 IBM Power Systems 上，则必须使用中央 HANA 插件主机。</block>
  <block id="f1de58e649fb073c26f220815a243372" category="section-title">支持自动发现和自动恢复的 HANA 架构</block>
  <block id="18719832c6436a8c008c212810bf15af" category="paragraph">借助 SnapCenter ，大多数 HANA 配置都支持自动发现以及自动还原和恢复，但 HANA 多主机系统需要手动配置除外。</block>
  <block id="a63dac7fa35a6351b0737c3a29e304aa" category="paragraph">下表显示了支持自动发现的 HANA 配置。</block>
  <block id="c8661b037a46b69bbf45a2280dec701a" category="cell">HANA 插件安装在：</block>
  <block id="c192c3996f72271e911ec99b804d7ab5" category="cell">HANA 架构</block>
  <block id="e15f9fd62bf7801afcf46240c3232b3b" category="cell">HANA 系统配置</block>
  <block id="cba4f4cee5c6a3e6d8be8da68fa1234e" category="cell">基础架构</block>
  <block id="a7042aff750c8ec91be377f3b217096b" category="cell">HANA 数据库主机</block>
  <block id="df426d2e22dc5f5b5ec6c042d5e2ab75" category="cell">单个主机</block>
  <block id="b9ece6356946c2ba01def7109c68c98c" category="list-text">HANA 单个容器</block>
  <block id="52860ed3c38e42893b21ee81457714b9" category="list-text">具有单个或多个租户的 SAP HANA 多租户数据库容器（ MDC ）</block>
  <block id="b215ac6a1d54500ab9c42b936b0d6472" category="list-text">HANA 系统复制</block>
  <block id="1bde3a6d97a53256ffdc32c2e60b19e4" category="list-text">采用 NFS 的裸机</block>
  <block id="bf846a752539e263277cce3a01b0ef3f" category="list-text">使用 XFS 和 FC 的裸机，无论是否使用 Linux 逻辑卷管理器（ LVM ）</block>
  <block id="fa52887bff899f429be7e34ba0aca30e" category="list-text">具有直接操作系统 NFS 挂载的 VMware</block>
  <block id="31d688c2c278ac8c6f2de5552c62c217" category="admonition">包含多个租户的 HANA MDC 系统支持自动发现，但在当前 SnapCenter 版本中不支持自动还原和恢复。</block>
  <block id="0fdb80dd2021599e02f364aec1ce87e4" category="section-title">支持手动配置 HANA 资源的 HANA 架构</block>
  <block id="df07af8094b3ee56eff56119390494b0" category="paragraph">所有 HANA 架构均支持手动配置 HANA 资源；但是，它需要一个中央 HANA 插件主机。中央插件主机可以是 SnapCenter 服务器本身，也可以是单独的 Linux 或 Windows 主机。</block>
  <block id="f3324258b431b338f35b941a24e2a31d" category="inline-link-macro">" 在 HANA 插件主机上禁用自动发现。 "</block>
  <block id="10b043404a82561d5bb6534bc181007e" category="paragraph">下表显示了手动 HANA 资源配置支持的 HANA 配置。</block>
  <block id="74827600dad7156e5af8dc96abb8b6a3" category="cell">HANA 插件安装在：</block>
  <block id="b801de73bc166ed48262745796be6285" category="cell">中央插件主机（ SnapCenter 服务器或单独的 Linux 主机）</block>
  <block id="d9bdea226bac10381a1614e5013be7f0" category="cell">一台或多台主机</block>
  <block id="2dca46890aff26d950c7fbab0d4585ee" category="list-text">包含一个或多个租户的 HANA MDC</block>
  <block id="34a4c443d5ac7ef4a84362a477d590cf" category="list-text">使用 XFS 和 FC 的裸机，无论是否使用 Linux LVM</block>
  <block id="a0889af6f554ac5c1d81e82642a71c33" category="section-title">SAP HANA 插件的部署选项</block>
  <block id="44f6084a7d2f87d42ce54d7be3882603" category="paragraph">下图显示了逻辑视图以及 SnapCenter 服务器与 SAP HANA 数据库之间的通信。</block>
  <block id="71ff2461408968609609ecb43a245384" category="paragraph">SnapCenter 服务器通过 SAP HANA 插件与 SAP HANA 数据库进行通信。SAP HANA 插件使用 SAP HANA hdbsql 客户端软件对 SAP HANA 数据库执行 SQL 命令。SAP HANA hdbuserstore 用于提供用户凭据，主机名和端口信息以访问 SAP HANA 数据库。</block>
  <block id="51756ae7050f110da1d8b09a97d32f4b" category="admonition">SAP HANA 插件和 SAP hdbsql. 客户端软件（包括 hdbuserstore 配置工具）必须安装在同一主机上。</block>
  <block id="d2a1ba656d3714dbdff0ddf861b3b8db" category="paragraph">主机可以是 SnapCenter 服务器本身，单独的中央插件主机或各个 SAP HANA 数据库主机。</block>
  <block id="05bc1a07fb1a47dcf559561811b1659e" category="section-title">SnapCenter 服务器高可用性</block>
  <block id="8246a42ad0b2b0b8e76f40dfeb35457e" category="paragraph">可以在双节点 HA 配置中设置 SnapCenter 。在这种配置中，负载平衡器（例如 F5 ）使用指向活动 SnapCenter 主机的虚拟 IP 地址在主动 / 被动模式下使用。SnapCenter 会在两台主机之间复制 SnapCenter 存储库（ MySQL 数据库），以便 SnapCenter 数据始终保持同步。</block>
  <block id="54adf17a2b80b8860e6e1a390f90fede" category="inline-link">NetApp 知识库页面</block>
  <block id="2eef76e2dc4ca626269410901e4bc5b0" category="paragraph">如果在 SnapCenter 服务器上安装了 HANA 插件，则不支持 SnapCenter 服务器 HA 。如果您计划在 HA 配置中设置 SnapCenter ，请勿在 SnapCenter 服务器上安装 HANA 插件。有关 SnapCenter HA 的更多详细信息，请参见此处<block ref="7f1dbdda8b67a128ec90d71e0b35b828" category="inline-link-rx"></block>。</block>
  <block id="a1ade406b963f3d6ec1b4f643a4cfcae" category="section-title">SnapCenter 服务器作为中央 HANA 插件主机</block>
  <block id="9b2126abefe85b2533ee827e80b78fab" category="paragraph">下图显示了使用 SnapCenter 服务器作为中央插件主机的配置。SAP HANA 插件和 SAP hdbsql. 客户端软件安装在 SnapCenter 服务器上。</block>
  <block id="9c56d8a5ff7d27ff338da44c24238927" category="paragraph">由于 HANA 插件可以通过网络使用 hdbclient 与受管 HANA 数据库进行通信，因此您无需在各个 HANA 数据库主机上安装任何 SnapCenter 组件。SnapCenter 可以使用中央 HANA 插件主机来保护 HANA 数据库，在该主机上为受管数据库配置所有用户存储密钥。</block>
  <block id="1bdf62e1b5487a7dd7db72eb38852420" category="paragraph">另一方面，要实现自动发现，还原和恢复自动化以及 SAP 系统刷新操作的增强工作流自动化，需要在数据库主机上安装 SnapCenter 组件。使用中央 HANA 插件主机时，这些功能不可用。</block>
  <block id="ae1e55a6af8942f681e076e6b04696a0" category="paragraph">此外，如果在 SnapCenter 服务器上安装了 HANA 插件，则无法使用内部构建 HA 功能来实现 SnapCenter 服务器的高可用性。如果 SnapCenter 服务器正在 VMware 集群中的虚拟机中运行，则可以使用 VMware HA 实现高可用性。</block>
  <block id="d9dafc00f08c99f6393297b3d1b983ca" category="section-title">将主机作为中央 HANA 插件主机分离</block>
  <block id="e9dbb0d4fc4947f637931ad9410ef98d" category="paragraph">下图显示了一种配置，其中使用一个单独的 Linux 主机作为中央插件主机。在这种情况下， SAP HANA 插件和 SAP hdbsql. 客户端软件安装在 Linux 主机上。</block>
  <block id="c5507abd0c0561490ba4a8e034538a25" category="admonition">单独的中央插件主机也可以是 Windows 主机。</block>
  <block id="a8c9df7032e6000ae2f56966f3b52ce3" category="paragraph">上一节所述的功能可用性限制也适用于单独的中央插件主机。</block>
  <block id="b9e255186906a3f1053b2bc79578cec3" category="paragraph">但是，使用此部署选项，可以为 SnapCenter 服务器配置内部 HA 功能。中央插件主机也必须为 HA ，例如，使用 Linux 集群解决方案 。</block>
  <block id="0852f3b4e2c4f30c1da041b7a6cbb8e9" category="section-title">部署在单个 HANA 数据库主机上的 HANA 插件</block>
  <block id="9df69c7673fc042e431370931c5527f4" category="paragraph">下图显示了在每个 SAP HANA 数据库主机上安装 SAP HANA 插件的配置。</block>
  <block id="a46c7fbab71d45b271c59c0623549af4" category="paragraph">当 HANA 插件安装在每个 HANA 数据库主机上时，所有功能都可用，例如自动发现以及自动还原和恢复。此外，还可以在 HA 配置中设置 SnapCenter 服务器。</block>
  <block id="3bab1e1695b59a134fd6c85c6900b00c" category="section-title">混合 HANA 插件部署</block>
  <block id="43dd12e51388565e1a7e3256290d13f0" category="paragraph">如本节开头所述，某些 HANA 系统配置（例如多主机系统）需要一个中央插件主机。因此，大多数 SnapCenter 配置都需要混合部署 HANA 插件。</block>
  <block id="31c391cfa19f4e529aad8e9d4304322f" category="paragraph">NetApp 建议您在 HANA 数据库主机上为支持自动发现的所有 HANA 系统配置部署 HANA 插件。其他 HANA 系统，例如多主机配置，应使用中央 HANA 插件主机进行管理。</block>
  <block id="ebfc18223a0e2c918bcdaaee89afe3bf" category="paragraph">以下两个图显示了混合插件部署，其中 SnapCenter 服务器或单独的 Linux 主机作为中央插件主机。这两种部署之间的唯一区别是可选的 HA 配置。</block>
  <block id="e0975370dd4a6ada2fcb1cbc16ba5346" category="section-title">摘要和建议</block>
  <block id="8c0f51e6e3ddaf2d16c747d639bf6fb7" category="paragraph">通常， NetApp 建议您在每个 SAP HANA 主机上部署 HANA 插件，以启用所有可用的 SnapCenter HANA 功能并增强工作流自动化。</block>
  <block id="ea49e9eedab2cd5fc40ad3a270f323db" category="admonition">HANA 和 Linux 插件当前仅适用于基于 Intel 的系统。如果 HANA 数据库运行在 IBM Power Systems 上，则必须使用中央 HANA 插件主机。</block>
  <block id="c93f3a94956cde8bfff88029a06934b7" category="paragraph">对于不支持自动发现的 HANA 配置，例如 HANA 多主机配置，必须另外配置一个中央 HANA 插件主机。如果可以将 VMware HA 用于 SnapCenter HA ，则中央插件主机可以是 SnapCenter 服务器。如果您计划使用 SnapCenter 内部构建 HA 功能，请使用单独的 Linux 插件主机。</block>
  <block id="cafaa0fef59b4334c5f9e83b6a6ec3fb" category="paragraph">下表总结了不同的部署选项。</block>
  <block id="338113d1d9bb30138663dfbe65b5a954" category="cell">部署选项</block>
  <block id="896f4eaa4f12972b56ed9cdd9a90b949" category="cell">依赖关系</block>
  <block id="158ab554bd198cf5eb6712352227ee0d" category="cell">SnapCenter 服务器上安装了中央 HANA 插件主机插件</block>
  <block id="1e25b3e432a986250c9e36b20847a657" category="cell">优点： * 单个 HANA 插件，中央 HDB 用户存储配置 * 单个 HANA 数据库主机不需要 SnapCenter 软件组件 * 支持所有 HANA 架构缺点： * 手动资源配置 * 手动恢复 * 不支持单租户还原 * 在中央插件主机上执行任何脚本前和脚本后步骤 * 不支持内部版本 SnapCenter 高可用性 * SID 和租户名称的组合必须在所有受管 HANA 数据库 * 日志中是唯一的 已为所有受管 HANA 数据库启用 / 禁用备份保留管理</block>
  <block id="e467947c25a4c0cfa9c7160a5e4ea52b" category="cell">中央 HANA 插件主机插件安装在单独的 Linux 或 Windows 服务器上</block>
  <block id="6c913ab6553fe3bff0293d92d17dc0d7" category="cell">优点： * 单个 HANA 插件，中央 HDB 用户存储配置 * 单个 HANA 数据库主机上不需要 SnapCenter 软件组件 * 支持所有 HANA 架构 * 支持内部构建的 SnapCenter 高可用性缺点： * 手动资源配置 * 手动恢复 * 不支持单租户还原 * 在中央插件主机上执行任何脚本前和脚本后步骤 * SID 和租户名称的组合必须在所有受管 HANA 数据库中是唯一的 * 已为所有受管的所有受管系统启用 / 禁用日志备份保留管理 HANA 数据库</block>
  <block id="ad06c241b2be44672e9861be7573e369" category="cell">在 HANA 数据库服务器上安装单个 HANA 插件主机插件</block>
  <block id="fb0c19e084fab4e216faf2a038f47a4f" category="cell">优点： * 自动发现 HANA 资源 * 自动还原和恢复 * 单租户还原 * 用于 SAP 系统刷新的脚本前后自动化 * 支持内置 SnapCenter 高可用性 * 可以为每个 HANA 数据库启用 / 禁用日志备份保留管理缺点： * 并非所有 HANA 架构都支持。需要额外的中央插件主机，用于 HANA 多主机系统。* 必须在每个 HANA 数据库主机上部署 HANA 插件</block>
  <block id="5fc8b5e93f497b93c0162f3924292d57" category="paragraph">在配置 SnapCenter 和 SAP HANA 插件之前，必须根据各种 SAP 系统的 RTO 和 RPO 要求定义数据保护策略。</block>
  <block id="bb58cd0ced0eb681e1b03e006fcf14a7" category="paragraph">必须定义的参数包括：</block>
  <block id="20c4f7e2184f40e0c70515cc13e74929" category="list-text">Snapshot 备份应多久执行一次？</block>
  <block id="a9790aa832bdfe05ae357e9742498021" category="list-text">Snapshot 副本备份应在主存储系统上保留多长时间？</block>
  <block id="d27abbb31946413047160ed17a49cef6" category="list-text">应多久执行一次块完整性检查？</block>
  <block id="fb5978d888365df302c5a4d4ab45a6d0" category="list-text">是否应将主备份复制到异地备份站点？</block>
  <block id="15bb013c8042cd30e50b101536a819ac" category="list-text">备份应保留在异地备份存储上多长时间？</block>
  <block id="a76fbe238755f54f2cc8ad0ef1e50790" category="paragraph">下表显示了系统类型的生产，开发和测试的数据保护参数示例。对于生产系统，已定义了高备份频率，并且备份每天复制到异地备份站点一次。测试系统的要求较低，并且不会复制备份。</block>
  <block id="4e92547e997fe98c132fd1cfb873bc65" category="cell">备份频率</block>
  <block id="336d382a0ace20046f30116decc1a58b" category="cell">主保留</block>
  <block id="0359f5661845e7cea5b46bee1591ba1f" category="cell">2 天</block>
  <block id="859dfafd0d5f98d972cbef18f555a178" category="cell">复制到异地备份站点</block>
  <block id="28187cfc0c9b8d99a69446b85d6836f9" category="cell">每天一次</block>
  <block id="9f671a43519ba35ba07e5cc7fd68ea1e" category="cell">异地备份保留</block>
  <block id="a9adf02fea7b0107b5a712a45e51076a" category="cell">2 周</block>
  <block id="e681a3b45989b468533c4b90ee960bf9" category="cell">不适用</block>
  <block id="d40d1bfa53df32e86debc960673d124c" category="paragraph">下表显示了必须为数据保护参数配置的策略。</block>
  <block id="23b66e99cd6ba31940d72ec834e12a16" category="cell">PolicyLocalSnap</block>
  <block id="57d76f4b223551090681c2d3d087b612" category="cell">策略本地 SnapAndSnapVault</block>
  <block id="8086e83684ef6d0154834ccea000d123" category="cell">PolicyBlockIntegrityCheck</block>
  <block id="eb5e64a6ddbc74a072fcf0bbf2472273" category="cell">基于 Snapshot</block>
  <block id="f65710a865ee85dd3e4b8394da061f2a" category="cell">计划频率</block>
  <block id="e23d3690726ce7e0baec7f3e456f2d11" category="paragraph">生产，开发和测试系统可使用策略 `LocalSnapshot` 来涵盖本地 Snapshot 备份，保留两天。</block>
  <block id="aacaec8f3c328fa76a33359dd411858a" category="paragraph">在资源保护配置中，系统类型的计划定义有所不同：</block>
  <block id="e443afc7dea88a72ac5d95deb950a430" category="list-text">* 生产 * 计划每 4 小时执行一次。</block>
  <block id="258d77a49c4d5819dfead3dccee318a9" category="list-text">* 开发 * 计划每 4 小时执行一次。</block>
  <block id="2e743186e90f3e121e96136221ff58f5" category="list-text">* 测试 * 计划每 4 小时执行一次。</block>
  <block id="511f903aab4f11abd60bb71f0cb0a9c5" category="paragraph">生产和开发系统可使用策略 `LocalSnapAndSnapVault` 来执行每日复制到异地备份存储的操作。</block>
  <block id="30eeb20f202457a8361e6337268b5d10" category="paragraph">在资源保护配置中，计划是为生产和开发定义的：</block>
  <block id="b8aa0eddba68c4b5a67e4b59d7c54dc1" category="list-text">* 生产 * 计划每天。</block>
  <block id="f20f3a1d7e3572bd81183a3c1f9633d5" category="list-text">* 开发。 * 每天计划。</block>
  <block id="6b012e8cfab09dc8484b04ce2f914df2" category="paragraph">生产和开发系统可使用策略 `BlockIntegrityCheck` 来执行基于文件的备份的每周块完整性检查。</block>
  <block id="e8530a36631f0403c3fcc21b5cd70abc" category="list-text">* 生产 * 每周计划一次。</block>
  <block id="2169c09d81c725a1f3131276107d3db2" category="list-text">* 开发 * 每周计划一次。</block>
  <block id="8fef54544250744aa553b98687de9f40" category="paragraph">对于使用异地备份策略的每个 SAP HANA 数据库，必须在存储层上配置一个保护关系。此保护关系定义了要复制的卷以及在异地备份存储上保留备份的情况。</block>
  <block id="8870e02513ebfc93b4625271f6e5eede" category="paragraph">在我们的示例中，对于每个生产和开发系统，异地备份存储的保留期限定义为两周。</block>
  <block id="a858d77b86373ca0b7cdae460153a0e8" category="admonition">在我们的示例中， SAP HANA 数据库资源和非数据卷资源的保护策略和保留期限没有区别。</block>
  <block id="51a5bb1295ec95e66a60bbb918690373" category="paragraph">SAP 引入了对采用 HANA 2.0 SPS4 的 MDC 多租户系统的 Snapshot 备份的支持。SnapCenter 支持对多个租户的 HANA MDC 系统执行 Snapshot 备份操作。SnapCenter 还支持对 HANA MDC 系统执行两种不同的还原操作。您可以还原整个系统，系统数据库和所有租户，也可以只还原一个租户。要使 SnapCenter 能够执行这些操作，需要满足一些前提条件。</block>
  <block id="4698c998854cf1f3f7f0982109f67d65" category="paragraph">在 MDC 系统中，租户配置不一定是静态的。可以添加租户或删除租户。SnapCenter 不能依赖在将 HANA 数据库添加到 SnapCenter 时发现的配置。SnapCenter 必须知道在执行备份操作时哪些租户可用。</block>
  <block id="491c6a51dcb7a300a2eeff899d3420f0" category="paragraph">要启用单租户还原操作， SnapCenter 必须知道每个 Snapshot 备份中包含哪些租户。此外， IT 还必须知道哪些文件和目录属于 Snapshot 备份中包含的每个租户。</block>
  <block id="e8ab2d6ac8e55a17560a37dec1e4938f" category="paragraph">因此，对于每个备份操作，工作流的第一步是获取租户信息。其中包括租户名称以及相应的文件和目录信息。此数据必须存储在 Snapshot 备份元数据中，才能支持单个租户还原操作。下一步是执行 Snapshot 备份操作本身。此步骤包括用于触发 HANA 备份保存点的 SQL 命令，用于存储 Snapshot 备份的 SQL 命令以及用于关闭 Snapshot 操作的 SQL 命令。通过使用 close 命令， HANA 数据库将更新系统数据库和每个租户的备份目录。</block>
  <block id="53f017ef2e2913c1affe326e6d58147d" category="paragraph">要对数据备份进行保留管理和 HANA 备份目录管理， SnapCenter 必须对系统数据库以及第一步中确定的所有租户数据库执行目录删除操作。与日志备份相同， SnapCenter 工作流必须在备份操作中的每个租户上运行。</block>
  <block id="87d2bd3ffe470713cfe8f85f66872001" category="paragraph">SnapCenter 按以下顺序备份 SAP HANA 数据库：</block>
  <block id="c431a2b730735975215b43173bf6d91e" category="list-text">SnapCenter 从 HANA 数据库读取租户列表。</block>
  <block id="bbaec7daa0b136f892a8e18b3c38d0f0" category="list-text">SnapCenter 从 HANA 数据库读取每个租户的文件和目录。</block>
  <block id="fd4f9437bcf770e6f4b4b5b2c53ed88c" category="list-text">租户信息存储在此备份操作的 SnapCenter 元数据中。</block>
  <block id="388052672cabc52a6671bee667609de4" category="list-text">SnapCenter 会触发 SAP HANA 全局同步备份保存点，以便在永久性层上创建一致的数据库映像。</block>
  <block id="79cf1027a83c90d2e6216fec04575789" category="admonition">对于 SAP HANA MDC 单租户或多租户系统，系统数据库和每个租户数据库都会创建一个同步的全局备份保存点。</block>
  <block id="a61afd60d46e728ee82e2e6d96469475" category="list-text">SnapCenter 会为为为资源配置的所有数据卷创建存储 Snapshot 副本。在我们的单主机 HANA 数据库示例中，只有一个数据卷。使用 SAP HANA 多主机数据库时，有多个数据卷。</block>
  <block id="177edc528df877c70e8b0192fbc99b54" category="list-text">SnapCenter 会在 SAP HANA 备份目录中注册存储 Snapshot 备份。</block>
  <block id="1f6807835340f29ecafd981b7a0921ab" category="list-text">SnapCenter 会删除 SAP HANA 备份保存点。</block>
  <block id="04f1db44df5ec237cae0e9c588ac120b" category="list-text">SnapCenter 将为资源中所有已配置的数据卷启动 SnapVault 或 SnapMirror 更新。</block>
  <block id="2066b7a8e7b635126a83d5d0b7e1ef31" category="admonition">只有在选定策略包含 SnapVault 或 SnapMirror 复制时，才会执行此步骤。</block>
  <block id="f3a7fa0f01c591ef532e61f9aa267de5" category="list-text">SnapCenter 会根据为主存储上的备份定义的保留策略，删除其数据库以及 SAP HANA 备份目录中的存储 Snapshot 副本和备份条目。系统数据库和所有租户均执行 HANA 备份目录操作。</block>
  <block id="bbd0b34cf66469256e79a07516383b10" category="admonition">如果备份在二级存储上仍然可用，则不会删除 SAP HANA 目录条目。</block>
  <block id="30f926688a4ab105b79243923a23e688" category="list-text">SnapCenter 会删除文件系统和 SAP HANA 备份目录中早于 SAP HANA 备份目录中标识的最旧数据备份的所有日志备份。这些操作是针对系统数据库和所有租户执行的。</block>
  <block id="d7b12b1b6c96a142344e59506ea8eb16" category="admonition">只有在未禁用日志备份管理的情况下，才会执行此步骤。</block>
  <block id="12dc7f50145a958b80895e61e0dc9d4e" category="paragraph">SnapCenter 按以下顺序执行块完整性检查：</block>
  <block id="6499fcfd02abec50ac59cc0e7da2ac2b" category="list-text">SnapCenter 会为系统数据库和每个租户触发基于文件的备份操作。</block>
  <block id="ac0e3469b6536d2a3f561f868db15f69" category="list-text">SnapCenter 会根据为块完整性检查操作定义的保留策略，删除其数据库，文件系统和 SAP HANA 备份目录中基于文件的备份。文件系统上的备份删除以及系统数据库和所有租户的 HANA 备份目录操作均已完成。</block>
  <block id="ca5d71be6f3f63979efa5c8e27395b80" category="paragraph">数据备份保留管理和日志备份管理可分为五个主要方面，包括以下保留管理：</block>
  <block id="90cb263080fdc60abfd71e3449e03aa2" category="list-text">主存储上的本地备份</block>
  <block id="d130f8b5cd745779ae15b9fb88645075" category="list-text">在二级存储上进行备份</block>
  <block id="96716c544304319656c23d4bd613d02a" category="section-title">主存储本地备份的保留管理</block>
  <block id="8ad39493f65893bc4270bde100245f14" category="paragraph">SnapCenter 通过根据 SnapCenter 备份策略中定义的保留删除主存储和 SnapCenter 存储库中的 Snapshot 副本来处理 SAP HANA 数据库备份和非数据卷备份的后台管理。</block>
  <block id="edd5176847fe9cdca52d5020294a02ad" category="admonition">请注意， SnapCenter 会分别处理计划备份和按需备份的保留管理。</block>
  <block id="6e3969ad88d0fc23326c45dbf0aaa083" category="paragraph">也可以在 SnapCenter 中手动删除主存储上的本地备份。</block>
  <block id="0ca384dce310ffb08f5955561d1f27cf" category="paragraph">SnapCenter 通过根据 SnapCenter 备份策略中定义的保留删除文件系统上的备份来处理基于文件的备份的管理。</block>
  <block id="344a187b4604a60989c916b3113d9f35" category="admonition">请注意， SnapCenter 会分别为计划备份或按需备份处理保留管理。</block>
  <block id="4ccde41240784b8793e1a64b542f9ac3" category="section-title">对二级存储上的备份进行保留管理</block>
  <block id="1efb946fa11931ea4d152ed87661fa40" category="paragraph">二级存储备份的保留管理由 ONTAP 根据 ONTAP 保护关系中定义的保留进行处理。</block>
  <block id="79b3fea1775e45a010e1441bb92a4a7f" category="paragraph">要在 SnapCenter 存储库中的二级存储上同步这些更改， SnapCenter 将使用计划的清理作业。此清理作业会将所有 SnapCenter 插件和所有资源的所有二级存储备份与 SnapCenter 存储库同步。</block>
  <block id="98fdd1840e4c60a7aea08cc51e60e00c" category="paragraph">默认情况下，清理作业每周计划一次。与二级存储中已删除的备份相比，此每周计划会导致在 SnapCenter 和 SAP HANA Studio 中删除备份的延迟。为了避免这种不一致，客户可以将计划更改为更高的频率，例如每天更改一次。</block>
  <block id="6650411a4183dbf558fd1208e2c9841c" category="admonition">也可以通过单击资源拓扑视图中的刷新按钮手动触发单个资源的清理作业。</block>
  <block id="24bcff4ae11dafd8b12386259a025073" category="inline-link-macro">" 更改与异地备份存储同步备份的计划频率。 "</block>
  <block id="40d811c159a7ac26c3d925c44e5f1b3b" category="paragraph">如果 SnapCenter 删除了任何备份，本地 Snapshot 或基于文件的备份，或者在二级存储上确定了备份删除，则此数据备份也会在 SAP HANA 备份目录中删除。</block>
  <block id="480e97c8fce55ceacfe516da2b28e4b0" category="paragraph">在删除主存储上本地 Snapshot 备份的 SAP HANA 目录条目之前， SnapCenter 会检查此备份是否仍存在于二级存储上。</block>
  <block id="6c7719cbfa68d680a5f8e9eaf41834c0" category="paragraph">要进行正向恢复，不再需要早于最新数据备份的日志备份，因此可以删除这些备份。</block>
  <block id="0f8ca98038ea7609903b53ed9775429b" category="paragraph">SnapCenter 通过执行以下步骤在文件系统级别以及 SAP HANA 备份目录中处理日志文件备份的管理工作：</block>
  <block id="b74aa809ad4d4bf579ac16558af9e82c" category="list-text">SnapCenter 读取 SAP HANA 备份目录以获取成功的最旧文件备份或 Snapshot 备份的备份 ID 。</block>
  <block id="77bca62e752a7e53551ce5ca4c0cc56e" category="list-text">SnapCenter 会删除 SAP HANA 目录和早于此备份 ID 的文件系统中的所有日志备份。</block>
  <block id="4fd7cb34c055677c7845e0e0eddb1866" category="admonition">SnapCenter 仅处理由 SnapCenter 创建的备份的管理工作。如果在 SnapCenter 之外创建了其他基于文件的备份，则必须确保从备份目录中删除基于文件的备份。如果不从备份目录中手动删除此类数据备份，则它可能会成为最旧的数据备份，而较早的日志备份则不会删除，直到删除此基于文件的备份为止。</block>
  <block id="b95762f66ee55056931b793e886c1e3b" category="admonition">即使在策略配置中为按需备份定义了保留，但只有在执行另一个按需备份时，才会执行内务管理。因此，通常必须在 SnapCenter 中手动删除按需备份，以确保这些备份也会在 SAP HANA 备份目录中删除，并且日志备份整理不会基于旧的按需备份。</block>
  <block id="197793c26e17cc5efd62568eaffb6624" category="paragraph">您必须考虑存储层上的块更改率高于传统数据库的更改率。由于列存储的 HANA 表合并过程，整个表将写入磁盘，而不仅仅是已更改的块。</block>
  <block id="af3abf38f2c084a1935b333f9ba155b9" category="paragraph">如果在一天内执行多个 Snapshot 备份，我们客户群的数据显示，每天的变更率介于 20% 到 50% 之间。在 SnapVault 目标上，如果每天仅执行一次复制，则每日更改率通常会较小。</block>
  <block id="a9c5176056bc688c2b5d249e742fdf00" category="section-title">还原和恢复操作</block>
  <block id="ff1aa6965291c159da72f82aca64bc82" category="section-title">使用 SnapCenter 执行还原操作</block>
  <block id="9c9e0fed6239589a5da391c8e31d6e68" category="paragraph">从 HANA 数据库角度来看， SnapCenter 支持两种不同的还原操作。</block>
  <block id="45f0626024dd5af174d07f4f74d4aa7b" category="list-text">* 还原整个资源。 * HANA 系统的所有数据均已还原。如果 HANA 系统包含一个或多个租户，则系统数据库的数据以及所有租户的数据都会还原。</block>
  <block id="9dd9f3619476df5c4a0c5a56c9bedbcb" category="list-text">* 还原单个租户。 * 仅还原选定租户的数据。</block>
  <block id="a5e7df954560d21487e5fa2e03adaf43" category="paragraph">从存储角度来看，上述还原操作的执行方式必须有所不同，具体取决于所使用的存储协议（ NFS 或光纤通道 SAN ），已配置的数据保护（具有或不具有异地备份存储的主存储）， 以及用于还原操作的选定备份（从主备份存储或异地备份存储还原）。</block>
  <block id="903b0347fbc98572431542d78c9c5054" category="section-title">从主存储还原完整资源</block>
  <block id="7aea2eb041f9eff72ead2cd294f80186" category="paragraph">从主存储还原整个资源时， SnapCenter 支持两种不同的 ONTAP 功能来执行还原操作。您可以在以下两个功能之间进行选择：</block>
  <block id="1cd3a846077636ddc693f619ce7088f0" category="list-text">* 基于卷的 SnapRestore 。 * 基于卷的 SnapRestore 会将存储卷的内容还原为选定 Snapshot 备份的状态。</block>
  <block id="be41c2cd74a9f110ff20720143d3bf81" category="list-text">卷还原复选框可用于使用 NFS 自动发现的资源。</block>
  <block id="e3ebff15becb67ef4948427fc7491f81" category="list-text">手动配置的资源的 "Complete Resource" 单选按钮。</block>
  <block id="534800278e6bf7ba0bef69f2122dfba8" category="list-text">* 基于文件的 SnapRestore 。 * 基于文件的 SnapRestore （也称为单文件 SnapRestore ）可还原所有单个文件（ NFS ）或所有 LUN （ SAN ）。</block>
  <block id="dfaf64eeed2495c2699fc12771706533" category="list-text">自动发现的资源的默认还原方法。可以使用 NFS 的卷还原复选框进行更改。</block>
  <block id="90e702706a64d8e3634ef3f8e3aaa1ac" category="list-text">手动配置的资源的文件级单选按钮。</block>
  <block id="85a98b4a30ff802cd7b2a3ba93cc0821" category="paragraph">下表对不同的还原方法进行了比较。</block>
  <block id="3f20050e38321d186cb4ef82c159cd57" category="cell">基于卷的 SnapRestore</block>
  <block id="d739125500200d5a4441aaac492be125" category="cell">基于文件的 SnapRestore</block>
  <block id="2e04633adac71ae9581b86c49821647c" category="cell">还原操作的速度</block>
  <block id="a48a9c2e0ec922b419ab2b2d9f9da767" category="cell">速度非常快，与卷大小无关</block>
  <block id="396bb30537b6cf03c5e8eb139b15ecc6" category="cell">还原操作速度非常快，但会在存储系统上使用后台复制作业，从而阻止创建新的 Snapshot 备份</block>
  <block id="56b5076d3adb0c7e2bc3d51a22eb96d7" category="cell">Snapshot 备份历史记录</block>
  <block id="ce671637bb895c1d526f778b09f0658d" category="cell">还原到较早的 Snapshot 备份，删除所有较新的 Snapshot 备份。</block>
  <block id="a053bc35a63576c7a170f33ff67297f2" category="cell">无影响</block>
  <block id="a054e062f75a92a1754c560097c4fae7" category="cell">还原目录结构</block>
  <block id="a9d00c75e7901626b56ba90d58b35a50" category="cell">还会还原目录结构</block>
  <block id="35bae59ed941fa0c4d38db0eb565658f" category="cell">NFS ：仅还原单个文件，而不还原目录结构。如果目录结构也丢失，则必须在执行还原操作 SAN ：同时还原目录结构之前手动创建它</block>
  <block id="49d21bd8b9bbd6ecf06a49b6bb034d75" category="cell">配置了复制到异地备份存储的资源</block>
  <block id="426c45e16d0b6c2ccc80cd5f47659d55" category="cell">无法对早于用于 SnapVault 同步的 Snapshot 副本的 Snapshot 副本备份执行基于卷的还原</block>
  <block id="877b742de992b43acf10192ba5e8f616" category="cell">可以选择任何 Snapshot 备份</block>
  <block id="d8f15654a7ecfd80ce41d20cf09409ad" category="section-title">从异地备份存储还原完整资源</block>
  <block id="cc813ee1ea3959cc775bcd6ae8201cfe" category="paragraph">从异地备份存储执行还原时，始终会使用 SnapVault 还原操作，其中存储卷的所有文件或所有 LUN 都会被 Snapshot 备份的内容覆盖。</block>
  <block id="c65cfccc27dad897a6ee52d7f025e91d" category="section-title">还原单个租户</block>
  <block id="29dcd697b97e7e87cd810ff0c0274566" category="paragraph">还原单个租户需要执行基于文件的还原操作。根据使用的存储协议， SnapCenter 会执行不同的还原工作流。</block>
  <block id="7369fcede1216c5a449bffa4016f597a" category="list-text">NFS ：</block>
  <block id="91954bd3c94d4f4f72e4c3007d6d4c09" category="list-text">主存储。系统会对租户数据库的所有文件执行基于文件的 SnapRestore 操作。</block>
  <block id="341fc1f6fde1c01ceb9c0e121cb8aaee" category="list-text">异地备份存储：对租户数据库的所有文件执行 SnapVault 还原操作。</block>
  <block id="85e9e72057a18b950343000578489311" category="list-text">SAN ：</block>
  <block id="b3c57720ef183814a9674313373c9377" category="list-text">主存储。克隆 LUN 并将其连接到数据库主机，然后复制租户数据库的所有文件。</block>
  <block id="52e32a19625ab4545a5954161ac46893" category="list-text">异地备份存储。克隆 LUN 并将其连接到数据库主机，然后复制租户数据库的所有文件。</block>
  <block id="43b75ec27fb52d4870e6f47cad818a7f" category="section-title">还原和恢复自动发现的 HANA 单个容器和 MDC 单租户系统</block>
  <block id="27ae2d5fdcf3c08eb8f123d6c1b7eed0" category="paragraph">自动发现的 HANA 单个容器和 HANA MDC 单租户系统可通过 SnapCenter 实现自动还原和恢复。对于这些 HANA 系统， SnapCenter 支持三种不同的还原和恢复工作流，如下图所示：</block>
  <block id="a512c46a13eca7d22567426830119dbb" category="list-text">* 具有手动恢复功能的单个租户。 * 如果选择单个租户还原操作，则 SnapCenter 将列出选定 Snapshot 备份中包含的所有租户。您必须手动停止并恢复租户数据库。使用 SnapCenter 执行还原操作时，可以对 NFS 执行单个文件 SnapRestore 操作，或者对 SAN 环境执行克隆，挂载和复制操作。</block>
  <block id="cfae0f5adb05d26e7f81eb470db45103" category="list-text">* 具有自动恢复功能的完整资源。 * 如果选择完整的资源还原操作和自动恢复，则整个工作流将通过 SnapCenter 实现自动化。SnapCenter 支持最新状态，时间点或特定备份恢复操作。选定的恢复操作将用于系统和租户数据库。</block>
  <block id="203194d065313487cfd7ffa63c9ba2c0" category="list-text">* 使用手动恢复完成资源。 * 如果选择 " 无恢复 " ， SnapCenter 将停止 HANA 数据库并执行所需的文件系统（卸载，挂载）和还原操作。您必须手动恢复系统和租户数据库。</block>
  <block id="c162464cff3cb9771674cd84e513d789" category="section-title">还原和恢复自动发现的 HANA MDC 多租户系统</block>
  <block id="05ec573421455228e9a6f35c31cc4d8b" category="paragraph">即使可以自动发现具有多个租户的 HANA MDC 系统，当前 SnapCenter 版本也不支持自动还原和恢复。对于具有多个租户的 MDC 系统， SnapCenter 支持两种不同的还原和恢复工作流，如下图所示：</block>
  <block id="ce9f584a687168c594173020f153bccb" category="list-text">单个租户，可手动恢复</block>
  <block id="da2e94d85e230dc9ba2a260a5dab3781" category="list-text">手动恢复的完整资源</block>
  <block id="66c227f4c6b143b23ab683bee1e2aa88" category="paragraph">这些工作流与上一节所述相同。</block>
  <block id="a648c0c28f1f9e0a64434fefbcc6a68f" category="section-title">还原和恢复手动配置的 HANA 资源</block>
  <block id="72758f6f86b5537b8bd7bd5417cd9bb2" category="paragraph">未启用手动配置的 HANA 资源以实现自动还原和恢复。此外，对于具有单个或多个租户的 MDC 系统，不支持单个租户还原操作。</block>
  <block id="8d2b5d00efaa377631e838bf988ca953" category="paragraph">对于手动配置的 HANA 资源， SnapCenter 仅支持手动恢复，如下图所示。手动恢复的工作流与前面几节所述的工作流相同。</block>
  <block id="3cf5b4d5940056fb37b1db43a2f24a02" category="section-title">摘要还原和恢复操作</block>
  <block id="9a363bf2d0172f00374a64753398a456" category="paragraph">下表根据 SnapCenter 中的 HANA 资源配置总结了还原和恢复操作。</block>
  <block id="eafac937ca579dd3ce0b4dd532e2c8e3" category="cell">SnapCenter 资源配置</block>
  <block id="9abf603644887736e44b05da99235ce3" category="cell">还原和恢复选项</block>
  <block id="a743a25fccef3ac17ddcd779c402fdbd" category="cell">停止 HANA 数据库</block>
  <block id="874c3404431451fc560e43c2af62ff91" category="cell">卸载前，还原后挂载</block>
  <block id="9ca7026f0c05a889d43d668c61a8a1eb" category="cell">自动发现单个容器 MDC 单租户</block>
  <block id="7e8db99e35f3a54c8dfa0a30be5f006b" category="list-text">使用任一项完成资源</block>
  <block id="fa1b1897eea412c9728e599e116e7c1c" category="list-text">默认（所有文件）</block>
  <block id="44127b3908ec00df1f97444914d5bce5" category="list-text">卷还原（仅限主存储中的 NFS ）</block>
  <block id="a54c3b8a5e1c3a02d1b445d0e6a72b1b" category="list-text">已选择自动恢复</block>
  <block id="4e6fc046b6021c44b0bc83312f59b2d4" category="cell">借助 SnapCenter 实现自动化</block>
  <block id="cf458e0c5f16417e392686a3c916a31b" category="list-text">未选择恢复</block>
  <block id="e1ba155a9f2e8c3be94020eef32a0301" category="cell">手动</block>
  <block id="908b61fb2167f81e0a639da67ff266b5" category="list-text">租户还原</block>
  <block id="25a8d668beb192aabdbff9bfeafd2ee7" category="cell">自动发现多个租户的 MDC</block>
  <block id="7a2c38503258c11c1a26b160c05baf30" category="list-text">不支持自动恢复</block>
  <block id="f3b7e79bd9c82eafaec1c6c93745bc65" category="cell">所有手动配置的资源</block>
  <block id="329b6d7a4d53380c2598ad10c6779f08" category="list-text">完整资源（ = 卷还原，仅可从主存储用于 NFS 和 SAN ）</block>
  <block id="c6487658bd5c74c99c6b1ad10eda7e67" category="list-text">文件级别（所有文件）</block>
  <block id="0a3b81cd04b7ee3bbb79ae9a19dc8656" category="sidebar">使用 SnapCenter 进行 SAP HANA 备份和恢复</block>
  <block id="d7ca353f8f69588ea48c2bafac41c0d7" category="sidebar">SnapCenter 初始配置</block>
  <block id="c50aa3f02a43d1792d7198bd3766142c" category="summary">本节介绍如何为ONTAP 文件系统的FSX建立对等关系、如何为SVM建立对等关系、如何创建目标卷、如何创建SnapMirror策略、如何创建SnapMirror关系以及如何初始化SnapMirror。</block>
  <block id="dbf9d2787d072a4fd34082b47aacfe77" category="doc">在ONTAP 文件系统的FSX上配置复制关系</block>
  <block id="98651d7cc1c378d485ba8f375d4d7dbd" category="inline-link">SnapMirror复制工作流(netapp.com)</block>
  <block id="b5beb3cfb3b1b16081425e9d6e52d915" category="paragraph">有关SnapMirror配置选项的追加信息 、请参见ONTAP 文档、网址为<block ref="a679b656ad5513b2e5948e853501b769" category="inline-link-rx"></block>。</block>
  <block id="35271451318f12e2f5cc52cc3a8a6d22" category="list-text">ONTAP 文件系统的源FSx：`FSxId00fa9e3c784b6abbb`</block>
  <block id="5936d785731bc7c4b4fb1addddd3c4ae" category="list-text">源SVM：`sAPCC—HANA—SVM`</block>
  <block id="83473822e15b41d9976df9e62816bf1e" category="list-text">ONTAP 文件系统的目标FSX：`FSxId05f7f00af49dc7a3e`</block>
  <block id="184d9d97bac5976851f8d3d29c6eb7b3" category="list-text">目标SVM：`sAPCP-backup-target-zone5`</block>
  <block id="13a408d84a52802ccb7fc9d194ec03a6" category="section-title">适用于ONTAP 文件系统的对等FSX</block>
  <block id="0b06a3f79e2e9507c1505d7e5ecbd420" category="admonition">`peer-addrs`是目标集群的集群IP。</block>
  <block id="bce6381c4cea64c81cbc9ed883116e79" category="section-title">对等SVM</block>
  <block id="eb9a4a5509950dc1c19cc313a888ad57" category="section-title">创建目标卷</block>
  <block id="78ba09c1e6974a1fb593d751fc2ae60f" category="paragraph">您必须创建类型为`DP`的目标卷、以将其标记为复制目标。</block>
  <block id="55d42bd9ef30094c89253387e26ced80" category="section-title">创建 SnapMirror 策略</block>
  <block id="d26ad042aedd077c7d434fe094c98f8d" category="paragraph">SnapMirror策略和添加的规则用于定义保留和SnapMirror标签、以确定应复制的快照。稍后创建SnapCenter 策略时、必须使用相同的标签。</block>
  <block id="4e9cf532300b4450e6f840b010b2f183" category="section-title">创建SnapMirror关系</block>
  <block id="07cfc8eda6d55b5eb0fb5db40ea9fa3c" category="paragraph">现在、源卷和目标卷之间的关系已定义、XDP类型以及我们先前创建的策略也已定义。</block>
  <block id="c5d142fafd8837228c0357960c716915" category="section-title">初始化SnapMirror</block>
  <block id="3a30d9da07e9c53ea40e049da7fc7fdc" category="paragraph">使用此命令将开始初始复制。这是从源卷到目标卷的所有数据的完整传输。</block>
  <block id="86a1f7ab04e42924fc2f5709b4b53d19" category="paragraph">您可以使用`snapmirror show`命令检查复制的状态。</block>
  <block id="ab5c6d77e6be89dfafd62072722d1f8d" category="summary">本节介绍如何将备份SVM添加到SnapCenter。</block>
  <block id="3e3ce5c2a6c9e71dd944b379b54040fc" category="doc">将备份SVM添加到SnapCenter</block>
  <block id="be7788774fa38e42c5b2c6ad478f7e0d" category="paragraph">要将备份SVM添加到SnapCenter 、请执行以下步骤：</block>
  <block id="69a827a353f1759f83d4d29038339b5e" category="list-text">在SnapCenter 中配置SnapVault 目标卷所在的SVM。</block>
  <block id="7ff3bfb984e16ba0e9ddeea3a9675aba" category="list-text">在更多选项窗口中、选择全闪存FAS 作为平台、然后选择二级。</block>
  <block id="17a507a9ef1c4ff633b35e3f95052658" category="paragraph">SVM现在可在SnapCenter 中使用。</block>
  <block id="594405c63145846b5ef5da75637c651c" category="summary">本节介绍如何创建按需Snapshot备份和按需块完整性检查操作。</block>
  <block id="ecc57313124902e4c42227ae61bb9bf1" category="doc">SnapCenter 备份操作</block>
  <block id="fd2e55c1e41efe9b784a15be371759b1" category="section-title">创建按需Snapshot备份</block>
  <block id="7657283c697ca0582f3be9790868181b" category="paragraph">按照以下步骤创建按需Snapshot备份。</block>
  <block id="056e429fcb2f6a7c1a53fbbc544c6426" category="list-text">在资源视图中、选择资源并双击相应行以切换到拓扑视图。</block>
  <block id="2ac85cad7240f8f0669e69bab5c0fddc" category="paragraph">"资源拓扑"视图概述了使用SnapCenter 创建的所有可用备份。此视图的顶部区域显示了备份拓扑、其中显示了主存储(本地副本)上的备份、如果可用、还显示了异地备份存储(存储副本)上的备份。</block>
  <block id="80ccdc0d27069c1ff7eda00fad9ce630" category="list-text">在顶部行中，选择立即备份图标以启动按需备份。</block>
  <block id="fd5d1357b318fbf4e649f0de7314c3f9" category="list-text">从下拉列表中、选择备份策略`LocalSnap`、然后单击备份以启动按需备份。</block>
  <block id="25f3c4b4983c7aeeea861e3dbda6f2e4" category="paragraph">拓扑视图底部的活动区域将显示前五个作业的日志。</block>
  <block id="8748d7533b9ff0f8de956dca869cf164" category="list-text">单击活动区域中作业的活动行时，将显示作业详细信息。您可以单击查看日志来打开详细的作业日志</block>
  <block id="0ba847d81f910709c3c09aa75fa0ad47" category="inline-link-macro">"配置和保护HANA资源"。</block>
  <block id="5517e803e46e8dd4074b86328ea2116e" category="paragraph">备份完成后，拓扑视图中将显示一个新条目。备份名称遵循与一节中定义的 Snapshot 名称相同的命名约定 <block ref="21266aca09e91497bf9e47ec98f61bc4" category="inline-link-macro-rx"></block></block>
  <block id="886f063ff3cbce042bd5354957ab45fe" category="paragraph">在 SAP HANA 备份目录中， SnapCenter 备份名称存储为 `Comment` 字段以及 `外部备份 ID （ EBID ）` 。下图显示了系统数据库和租户数据库PFX。</block>
  <block id="b0fea066e4357286d1022c0f348cda79" category="paragraph">在适用于ONTAP 的FSX文件系统上、您可以通过连接到SVM的控制台来列出Snapshot备份。</block>
  <block id="a8b02af2d15bda403394c0199a693bf0" category="section-title">创建按需块完整性检查操作</block>
  <block id="32b5fe8164d6968ffd17b6d1728e1103" category="paragraph">通过选择策略BlockIntegrityCheck、可以按与Snapshot备份作业相同的方式执行按需块完整性检查操作。使用此策略计划备份时， SnapCenter 会为系统和租户数据库创建标准 SAP HANA 文件备份。</block>
  <block id="ba7aeca897359e25127ed4621d0fedba" category="paragraph">SAP HANA 备份目录会显示系统数据库和租户数据库的条目。下图显示了系统和租户数据库的备份目录中的SnapCenter 块完整性检查。</block>
  <block id="3453b83e04ff7c4b2293244874e7dd53" category="paragraph">成功的块完整性检查可创建标准 SAP HANA 数据备份文件。SnapCenter 使用已为HANA数据库配置的备份路径执行基于文件的数据备份操作。</block>
  <block id="fa8e9c099eedc452a4d7a73d21130c08" category="summary">本节介绍如何将策略添加到资源保护中。</block>
  <block id="f6e2ee2d6349e048bf2c27a62ae4e46c" category="doc">将策略添加到资源保护中</block>
  <block id="1da64551d06b94d7b482063dbb2e35e1" category="paragraph">您必须将新策略添加到HANA资源保护配置中、如下图所示。</block>
  <block id="8d6efb0dba912228a4f9680328b7569b" category="paragraph">我们在设置中定义了每日计划。</block>
  <block id="8d672d6879c8db3a9c37e06acd4d7571" category="summary">本技术报告介绍了在适用于NetApp ONTAP 和NetApp SnapCenter 的Amazon FSX上保护SAP HANA数据的最佳实践。本文档介绍 SnapCenter 概念，配置建议和操作工作流，包括配置，备份操作， 以及还原和恢复操作。</block>
  <block id="042f7a2c227ce333d4132cb3d2f72c1a" category="doc">TR-4926：《基于Amazon FSX的SAP HANA for NetApp ONTAP —使用SnapCenter 进行备份和恢复》</block>
  <block id="945a22530e2c0bc909fe7bd733744001" category="paragraph">如今，企业需要为其 SAP 应用程序提供持续，无中断的可用性。面对不断增加的数据量和对系统备份等日常维护任务的需求、他们希望获得一致的性能。执行SAP数据库备份是一项关键任务、可能会对生产SAP系统的性能产生重大影响。</block>
  <block id="22eb5cd58a9c358396971f25290eeb1e" category="paragraph">备份窗口在缩减、而要备份的数据量在增加。因此、很难找到对业务流程影响最小的备份时间。恢复和恢复SAP系统所需的时间值得关注、因为SAP生产系统和非生产系统的停机时间必须尽可能地减少、以降低业务成本。</block>
  <block id="a93f4cc43678f9ab3b805d2bb40079f2" category="summary">您必须对基本SnapCenter 配置和HANA资源保护执行本节中的步骤。</block>
  <block id="359afa6593b15e77c26003b8273f9004" category="section-title">概述配置步骤</block>
  <block id="0960b23dd4a17a6020075c6227b9232f" category="paragraph">您必须对基本SnapCenter 配置和HANA资源保护执行以下步骤。以下各章将详细介绍每个步骤。</block>
  <block id="caa4a49314502e7c0e18c5dab680cc2b" category="list-text">配置SAP HANA备份用户和hdbuserstore密钥。用于使用hdbsql.客户端访问HANA数据库。</block>
  <block id="feba79381e14c9bc7a08ea5d266dc327" category="list-text">在SnapCenter 中配置存储。用于从SnapCenter 访问适用于ONTAP SVM的FSX的凭据</block>
  <block id="709b936bce2a1736edd0f031dc27af83" category="list-text">配置插件部署的凭据。用于在HANA数据库主机上自动部署和安装所需的SnapCenter 插件。</block>
  <block id="21df4d6c65c5d1b22f73da36d70707b2" category="list-text">将HANA主机添加到SnapCenter。部署和安装所需的SnapCenter 插件。</block>
  <block id="224a7e7662399b8780f32fdc84c2ae1b" category="list-text">配置策略。定义备份操作类型(Snapshot、文件)、保留以及可选的Snapshot备份复制。</block>
  <block id="215c8d01e52220d94bfc06b2ff7c04f6" category="list-text">配置HANA资源保护。提供hdbuserstore密钥并将策略和计划附加到HANA资源。</block>
  <block id="e55ff41af170b5ea45b9f0f5d18c388e" category="paragraph">下图显示了可用于创建备份用户的SAP HANA Studio</block>
  <block id="81301f8e5191357519759b3297ce2d44" category="paragraph">所需权限随HANA 2.0 SPS5版本一起更改：备份管理员、目录读取、数据库备份管理员和数据库恢复操作员。对于早期版本，备份管理员和目录读取已足够。</block>
  <block id="0fc753b520c4227f940435dc5b8f402a" category="paragraph">对于SAP HANA MDC系统、您必须在系统数据库中创建用户、因为系统和租户数据库的所有备份命令均使用系统数据库执行。</block>
  <block id="75cb7cd589bf636cc5ca574de687f7b2" category="paragraph">以下命令用于使用`&lt;sid&gt;adm` user的用户存储配置：</block>
  <block id="1d18928f61e38eb05e7e01ba72ddd5e3" category="paragraph">SnapCenter 使用 ` &lt;sid&gt;adm` 用户与 HANA 数据库进行通信。因此、您必须在数据库主机上使用`sid&gt;adm`用户来配置用户存储密钥。通常， SAP HANA hdbsql 客户端软件会与数据库服务器安装一起安装。否则、必须先安装hdbclient。</block>
  <block id="47359db53576b27891d283bf529b35d5" category="paragraph">在SAP HANA MDC设置中、端口`3&lt;instanceNo&gt;13`是用于通过SQL访问系统数据库的标准端口、必须在hdbuserstore配置中使用。</block>
  <block id="d73493837316727c01ae9815d9355939" category="paragraph">对于 SAP HANA 多主机设置，您必须为所有主机配置用户存储密钥。SnapCenter 会尝试使用提供的每个密钥连接到数据库、因此可以独立于将SAP HANA服务故障转移到其他主机运行。在我们的实验室设置中、我们为系统PFX的用户`pfxadm`配置了用户存储密钥、PFX是一个具有单个租户的主机HANA MDC系统。</block>
  <block id="92b9d3db3fdb1957b4c4d34e73939c5d" category="paragraph">您可以使用`hdbsql`命令检查对使用密钥的HANA系统数据库的访问权限。</block>
  <block id="fcc101f2c66262c23387819df7a461c8" category="paragraph">按照以下步骤在SnapCenter 中配置存储。</block>
  <block id="578d00099c13466294fdf336b017f275" category="list-text">在SnapCenter UI中、选择存储系统。</block>
  <block id="72ff7091ffb09be1df45aed0830b1c03" category="paragraph">您可以选择存储系统类型、可以是ONTAP SVM或ONTAP 集群。在以下示例中、选择了SVM管理。</block>
  <block id="8604e4985adf9ff19cf645c562016a2c" category="list-text">要添加存储系统并提供所需的主机名和凭据、请单击新建。</block>
  <block id="21de7574224c54d506a9f9f69185f1bd" category="paragraph">SVM用户不需要是vsadmin用户、如下图所示。通常，在 SVM 上配置用户并为其分配执行备份和还原操作所需的权限。有关所需权限的信息、请参见<block ref="7b715dbc2fecfcb275c5209e8e720c86" category="inline-link-rx"></block> 在标题为 " 所需的最小 ONTAP 权限 " 一节中。</block>
  <block id="ac0a876fac34b08db6fd053849b9a61c" category="list-text">要配置存储平台、请单击更多选项。</block>
  <block id="eb29cb32fb88ca7c229236d5f25dce2a" category="list-text">选择全闪存FAS 作为存储系统、以确保SnapCenter 可以使用作为适用于ONTAP 的FSX一部分的许可证。</block>
  <block id="299439100d029701f59616597606d753" category="paragraph">SVM `sAPCP-HANA—SVM`现在已在SnapCenter 中配置。</block>
  <block id="0572ed1f74a831bbe0d08a962826f1d9" category="section-title">为插件部署创建凭据</block>
  <block id="cfc5ece26f0c93a92ccccb43983e85df" category="paragraph">要使SnapCenter 能够在HANA主机上部署所需插件、您必须配置用户凭据。</block>
  <block id="200a5ea310bf58e32ff8608924910f7f" category="list-text">在实验室设置中、我们在用于插件部署的HANA主机上配置了一个新用户`SnapCenter`。您必须启用sudo prvileges、如下图所示。</block>
  <block id="1517d504e38dc374c8f101f4e81ef219" category="section-title">添加SAP HANA主机</block>
  <block id="c6c86914a12d68144f1f2b237b771ca3" category="paragraph">添加SAP HANA主机时、SnapCenter 会在数据库主机上部署所需的插件并执行自动发现操作。</block>
  <block id="db0309ae0b66c918b50e10cf960adac6" category="paragraph">SAP HANA 插件需要 Java 64 位版本 1.8 。在将主机添加到SnapCenter 之前、必须在主机上安装Java。</block>
  <block id="51a98b038742fddf88a6bf0cac86fe16" category="paragraph">SnapCenter 支持OpenJDK或Oracle Java。</block>
  <block id="f92f162575ca24726f81e3984b27fd2c" category="paragraph">要添加SAP HANA主机、请执行以下步骤：</block>
  <block id="e56209b057aa06956c0e0556d62be7c1" category="paragraph">HANA和Linux插件的安装会自动启动。安装完成后、主机的状态列将显示配置VMware插件。SnapCenter 会检测 SAP HANA 插件是否安装在虚拟化环境中。这可能是VMware环境、也可能是公有 云提供商的环境。在这种情况下、SnapCenter 会显示一条警告来配置虚拟机管理程序。</block>
  <block id="01c8adc0940fc944d6bceb0a58335832" category="paragraph">您可以使用以下步骤删除此警告消息。</block>
  <block id="43511a4b3774fe4d02144fe4b86b3dd8" category="paragraph">此时、屏幕将显示状态为"running"的Linux插件和HANA插件。</block>
  <block id="ac4361253d885faaf895a0d0cd05c3d8" category="section-title">配置策略</block>
  <block id="3988ca38d0149c3c196796f887611cb5" category="paragraph">策略通常独立于资源进行配置、可供多个SAP HANA数据库使用。</block>
  <block id="f3583ef14178cc77a72623a9cd8acb5d" category="list-text">无复制的每小时备份策略：`LocalSnap`。</block>
  <block id="2235861b5bc201f918f6b8a7947301ba" category="list-text">使用基于文件的备份执行每周块完整性检查的策略：`BlockIntegrityCheck`。</block>
  <block id="2b07d6a7b5422b0cd9352398b1459ccc" category="paragraph">以下各节将介绍这些策略的配置。</block>
  <block id="e7e20c907bb0cf2de077b4f92cc87879" category="section-title">Snapshot备份策略</block>
  <block id="270658685f14f40df5a97dcb443d187d" category="paragraph">请按照以下步骤配置Snapshot备份策略。</block>
  <block id="4e25858bd60001cd50bf9600bc16960f" category="paragraph">计划本身稍后会配置HANA资源保护配置。</block>
  <block id="aa785cec21110ee3100d934df3f27610" category="paragraph">此时将配置新策略。</block>
  <block id="2cb5b15e3797f553ddf112b4b3cd651d" category="section-title">用于块完整性检查的策略</block>
  <block id="1e4b633df036aab42607fbc95a2850e6" category="paragraph">按照以下步骤配置块完整性检查策略。</block>
  <block id="882e8132f9d8c5b34f622bd048180933" category="list-text">将备份类型设置为基于文件，并将计划频率设置为每周。计划本身稍后会配置HANA资源保护配置。</block>
  <block id="587169b2c69633c66fc254ec91d39015" category="section-title">配置和保护HANA资源</block>
  <block id="36413444bdd59e22d0fe3054f9903db8" category="paragraph">安装此插件后， HANA 资源的自动发现过程将自动启动。在资源屏幕中，将创建一个新资源，该资源将标记为已锁定，并带有红色挂锁图标。要配置和保护新的HANA资源、请执行以下步骤：</block>
  <block id="ba685f1a08fe226c2c3c7e97f7fd46c4" category="list-text">选择并单击资源以继续配置。</block>
  <block id="2455bdad114eb0bbce54e418891ecb1c" category="paragraph">您也可以通过单击刷新资源在资源屏幕中手动触发自动发现过程。</block>
  <block id="4e68ac8b42a88c9359693badb698d1d5" category="list-text">在资源选项卡中、双击资源以配置资源保护。</block>
  <block id="f3f2fb3a8df9cea2f8322063989dc4cf" category="paragraph">NetApp 建议使用自定义 Snapshot 副本名称来轻松确定使用哪个策略和计划类型创建了哪些备份。通过在 Snapshot 副本名称中添加计划类型，您可以区分计划备份和按需备份。按需备份的 `schedule name` 字符串为空，而计划备份包括字符串 `hourly` ， `Daily` ， `或 Weekly` 。</block>
  <block id="0ac613f5fa2d93f0cbc1cd158f2eaf95" category="list-text">选择要添加到资源中的策略。</block>
  <block id="27329ed143fb9e6ad1bec7a9798ec09a" category="list-text">定义块完整性检查策略的计划。</block>
  <block id="bb679512107983b315a700d36f774e12" category="paragraph">在此示例中、此值设置为每周一次。</block>
  <block id="f6f370ad34b914bb9b3188cab95579f6" category="list-text">定义本地Snapshot策略的计划。</block>
  <block id="01d64140a5b79b3220671ec24e5355a7" category="paragraph">在此示例中、此值设置为每6小时一次。</block>
  <block id="91f8b9395cad8e2a4e4239c12d3319b4" category="paragraph">HANA资源配置现已完成、您可以执行备份。</block>
  <block id="de6dd6d03f10c361d7fa2eaeb8b1332b" category="summary">非数据卷的备份是SnapCenter 和SAP HANA插件的集成部分。保护数据库数据卷足以将SAP HANA数据库还原和恢复到给定时间点、前提是数据库安装资源和所需日志仍然可用。</block>
  <block id="93f9c08757a13da54247af8b021689ae" category="doc">备份非数据卷</block>
  <block id="63b3090ea38e707b917b2d7c7901b50f" category="section-title">配置非数据卷资源</block>
  <block id="0c7ab37fcc2da596254c60c409d69fb1" category="paragraph">按照以下步骤配置非数据卷资源：</block>
  <block id="cb13e36dbad0de46510e77982a0357c5" category="list-text">从资源选项卡中、选择非数据卷、然后单击添加SAP HANA数据库。</block>
  <block id="fd24b11ffe2f4e6437e44b159cc48068" category="list-text">在添加SAP HANA数据库对话框的第1步中的资源类型列表中、选择非数据卷。指定要用于资源的资源以及关联SID和SAP HANA插件主机的名称、然后单击下一步。</block>
  <block id="d4a9e6880ccfcdaaffcc00b27a10adbc" category="list-text">要保存设置、请在摘要步骤中单击完成。</block>
  <block id="4e92aeb0662fdfc2cddbde8f13e067b2" category="paragraph">此时、新的非数据卷将添加到SnapCenter 中。双击新资源以执行资源保护。</block>
  <block id="56be9f03e68466dab79c0aec2f1a21f7" category="paragraph">资源保护与以前使用HANA数据库资源时所述的方式相同。</block>
  <block id="fac7e42fec45827c4ca846b9834a929d" category="list-text">现在、您可以单击立即备份来执行备份。</block>
  <block id="a4035f853527d3ecaeb2ba0b5da4093d" category="list-text">选择策略并启动备份操作。</block>
  <block id="fbda5ff558f836b18d5d4e20f084fd07" category="paragraph">SnapCenter 作业日志显示了各个工作流步骤。</block>
  <block id="cd424c5779cf104249372c575c7dfa1d" category="paragraph">此时、新备份将显示在非数据卷资源的资源视图中。</block>
  <block id="2ed820e22ac1859d1d70e21fb5f5db6d" category="section-title">还原和恢复</block>
  <block id="309955e6ebf3cb366a5302796b9cf4aa" category="paragraph">借助SnapCenter 、具有单个租户的HANA单主机MDC系统支持自动还原和恢复操作。对于具有多个租户的多主机系统或MDC系统、SnapCenter 仅执行还原操作、您必须手动执行恢复。</block>
  <block id="1ddfdb636c7165392bd902ed21e074b0" category="list-text">选择要用于还原操作的备份。</block>
  <block id="0e24c2d90fa54d4601108fb362e0b7c0" category="list-text">它会还原数据库。根据选定的还原类型、将执行不同的操作。</block>
  <block id="9898ecb46e5451d2bf61de3e6a37843c" category="list-text">如果选择了卷还原、则SnapCenter 将卸载此卷、并在存储层使用基于卷的SnapRestore 还原此卷、然后挂载此卷。</block>
  <block id="175b25afe5701244ebfd4e3aef8a4a89" category="list-text">如果未选择卷还原、则SnapCenter 将通过在存储层上执行单个文件SnapRestore 操作来还原所有文件。</block>
  <block id="8305b5f7e8f850be2950a98f0074e981" category="list-text">通过恢复系统数据库</block>
  <block id="6932a35ded8eb84abf9b46e82e789050" category="list-text">恢复租户数据库</block>
  <block id="cb63172a234cdd6be152a658ab722417" category="list-text">启动HANA数据库</block>
  <block id="656b4cf8c72df02c9118b8b812768e29" category="paragraph">如果选择"无恢复"、则SnapCenter 将退出、您必须手动对系统和租户数据库执行还原操作。</block>
  <block id="95e2f3ab294570e9b8011f00cff5422a" category="paragraph">要执行手动还原操作、请执行以下步骤：</block>
  <block id="813110ab7918deb5018070a177f6acea" category="inline-link">还原和恢复(netapp.com)</block>
  <block id="dcc2b41889853e2270c3727afc5c80fe" category="paragraph">HANA MDC单租户系统的标准方案是、在卷还原中使用完整资源。对于包含多个租户的HANA MDC系统、您可能只需要还原一个租户。有关单租户还原的详细信息、请参见<block ref="47d580635c2571be2d4bc74d513a0e35" category="inline-link-rx"></block>。</block>
  <block id="0b216691a52e4b2a672849ba2af7a819" category="paragraph">SnapCenter 使用HANA global.ini文件中的默认路径或更改后的路径来预填充日志和目录备份位置。</block>
  <block id="1cfdcd6cdad2d50d440ba1078e2b38c2" category="list-text">输入可选的还原前命令。</block>
  <block id="311b39381cb4c4ef0d982f67ce82c886" category="list-text">要启动还原和恢复操作、请单击完成。</block>
  <block id="354f6659b1577f8f6917db07330c0738" category="doc">使用SnapVault 进行备份复制</block>
  <block id="bbde47426fa7874d15811aa09d0a9ca3" category="summary">本节介绍如何从二级存储进行还原和恢复。</block>
  <block id="2d4a8328bc7032e3e3d3f8b982312d2d" category="doc">从二级存储还原和恢复</block>
  <block id="addd18eb81f4ef4def30d433ebedffac" category="paragraph">要从二级存储还原和恢复、请执行以下步骤：</block>
  <block id="ad39bf07e2f0970a49e91b6d7bc08b73" category="paragraph">要检索二级存储上所有备份的列表、请在SnapCenter 拓扑视图中单击存储副本、然后选择一个备份并单击还原。</block>
  <block id="c320657b7f9ae00d117b826103a60570" category="paragraph">还原对话框将显示二级位置。</block>
  <block id="d66def06f615a91837537eafad25ce09" category="paragraph">进一步的还原和恢复步骤与先前在主存储上对Snapshot备份所述的步骤相同。</block>
  <block id="9b7e589c27568a1ba1e20a07bd4bf384" category="summary">SnapCenter 是一个统一的可扩展平台，可实现应用程序一致的数据保护。SnapCenter 提供集中控制和监管，同时委派用户管理应用程序专用的备份，还原和克隆作业。借助 SnapCenter ，数据库和存储管理员可以通过一种工具来管理各种应用程序和数据库的备份，还原和克隆操作。SnapCenter 负责管理由 NetApp 提供支持的 Data Fabric 中各个端点的数据。</block>
  <block id="a3e2fc88c7b51a05fbb9c57347e8b0e7" category="paragraph">SnapCenter 包括SnapCenter 服务器、适用于Windows的SnapCenter 插件软件包和适用于Linux的SnapCenter 插件软件包。每个软件包都包含适用于各种应用程序和基础架构组件的 SnapCenter 插件。</block>
  <block id="b48d82447a4abda007d79854b3f6646a" category="list-text">备份操作、计划和保留管理</block>
  <block id="fbb95408c5973fc141dcf2b7b46bd0ec" category="list-text">使用基于存储的Snapshot副本进行SAP HANA数据备份</block>
  <block id="3d270926656ce5648382eaa1719bf92d" category="list-text">使用基于存储的Snapshot副本进行非数据卷备份(例如、`/ha/shared`)</block>
  <block id="ce7f855add0a7ede117b2101e9828d12" category="list-text">使用基于文件的备份检查数据库块完整性</block>
  <block id="b576b60679bf39b7899eedc0ff5dafd1" category="list-text">复制到异地备份或灾难恢复位置</block>
  <block id="e44df3eb7c1e201337b8ee7ea6f5aafd" category="list-text">HANA数据备份(Snapshot和基于文件)</block>
  <block id="ae56dd7000a0b955a430ea3ff10dd48d" category="list-text">用于HANA日志备份</block>
  <block id="6f359fd609acebab5d18f381e4c19f39" category="list-text">SAP HANA (MDC)系统的单租户还原操作</block>
  <block id="bea1b4e87998a4b25b42721d198aacd7" category="paragraph">数据库数据文件备份由 SnapCenter 与适用于 SAP HANA 的插件一起执行。此插件将触发SAP HANA数据库备份保存点、以便在主存储系统上创建的Snapshot副本基于SAP HANA数据库的一致映像。</block>
  <block id="20a189b6aeebb9db007cacab85408f24" category="paragraph">通过SnapCenter 、可以使用SnapVault 或SnapMirror功能将一致的数据库映像复制到异地备份或灾难恢复位置。通常，为主备份和异地备份存储上的备份定义不同的保留策略。SnapCenter 处理主存储上的保留，而 ONTAP 处理异地备份存储上的保留。</block>
  <block id="bf9380471a3b02146d5e51719d0940b1" category="paragraph">为了能够对所有SAP HANA相关资源进行完整备份、SnapCenter 您还可以使用SAP HANA插件和基于存储的Snapshot副本来备份所有非数据卷。您可以独立于数据库数据备份计划非数据卷，以启用单个保留和保护策略。</block>
  <block id="0541043f71b51f3409fd5ad4a1cbec95" category="paragraph">SAP 建议将基于存储的 Snapshot 备份与每周基于文件的备份相结合，以执行块完整性检查。您可以从 SnapCenter 中执行块完整性检查。根据您配置的保留策略、SnapCenter 负责管理主存储、日志文件备份和SAP HANA备份目录中的数据文件备份管理。</block>
  <block id="44492b7c8fce340f84cc4ee3e74208ea" category="paragraph">SnapCenter 负责主存储上的保留、而FSX for ONTAP 负责管理二级备份保留。</block>
  <block id="866f9a05b82b0824f1a0e87ecde3fb71" category="paragraph">下图显示了SnapCenter 备份和保留管理操作的概述。</block>
  <block id="bebd9be6fafde148cc61bd43c11e27e9" category="list-text">创建SAP HANA备份保存点、以便在持久性层上创建一致的映像。</block>
  <block id="a745daee4619d54f16ae0f1c2d0962f8" category="list-text">为数据卷创建基于存储的Snapshot副本。</block>
  <block id="527348cba8a7343779b6f59ba4c06ce9" category="list-text">在SAP HANA备份目录中注册基于存储的Snapshot备份。</block>
  <block id="f6357d7d7209510612ac9d41b805083f" category="list-text">释放SAP HANA备份保存点。</block>
  <block id="53d1d7d25d4bf41a740607083db85f90" category="list-text">对数据卷执行SnapVault 或SnapMirror更新(如果已配置)。</block>
  <block id="f26d0e3da2e083562d626efdb0a80db1" category="list-text">根据定义的保留策略删除主存储上的存储Snapshot副本。</block>
  <block id="297347c174657fe437156fe1d919b49d" category="list-text">如果备份不再位于主备份存储或异地备份存储中、则删除SAP HANA备份目录条目。</block>
  <block id="5d63204692887e644e79ad4f6fa6c268" category="list-text">无论何时根据保留策略删除备份或手动删除备份、SnapCenter 都将删除早于最旧数据备份的所有日志备份。日志备份会在文件系统和 SAP HANA 备份目录中删除。</block>
  <block id="76cc02267bf656e283d3a17bcd99260e" category="section-title">本文档的范围</block>
  <block id="434c79c7fab66fb3f1020892b6f3be08" category="inline-link">SnapCenter 概念和最佳实践(netapp.com)</block>
  <block id="59a5fb4fb61646bb0b75bc11415a63cd" category="paragraph">本文档介绍了在适用于ONTAP 的FSx上使用单个租户的SAP HANA MDC单主机系统的最常见SnapCenter 配置选项。其他配置选项也是可行的、在某些情况下、对于特定SAP HANA系统也是必需的、例如、对于多主机系统。有关其他配置选项的详细问题描述 、请参见<block ref="cff4a980adbb6cc05ec53083e0ffe5b6" category="inline-link-rx"></block>。</block>
  <block id="625979e29cea5b42dff162a508041627" category="inline-link">了解适用于ONTAP 的Amazon FSx (netapp.com)</block>
  <block id="befc1f68b82fd5acedbe7594e276b75a" category="paragraph">在本文档中、我们使用Amazon Web Services (AWS)控制台和适用于ONTAP 的FSX命令行界面在存储层上执行所需的配置步骤。您也可以使用NetApp Cloud Manager管理适用于ONTAP 的FSX、但本文档不会讨论此问题。有关使用适用于ONTAP 的NetApp Cloud Manager for FSX的信息、请参见<block ref="d44e3137c0d20662e292194c800b788f" category="inline-link-rx"></block>。</block>
  <block id="352f3d46cad062540fff3f31dc5869fb" category="paragraph">下图显示了基于适用于ONTAP 的FSX的SAP HANA的典型备份架构。HANA系统位于AWS可用性区域1中、并在同一可用性区域中使用适用于ONTAP 文件系统的FSX。对HANA数据库的数据和共享卷执行Snapshot备份操作。除了保留3-5天的本地Snapshot备份之外、还会将备份复制到异地存储以供长期保留。异地备份存储是位于不同AWS可用性区域的第二个ONTAP 文件系统FSX。HANA数据和共享卷的备份通过SnapVault 复制到第二个FSX for ONTAP 文件系统、并保留2-3周。</block>
  <block id="d9a905f2855845662704261034b8e519" category="paragraph">在配置SnapCenter 之前、必须根据各种SAP系统的RTO和RPO要求定义数据保护策略。</block>
  <block id="c96aeaa3bbed44a4eb6e491bd825b114" category="paragraph">必须定义以下参数：</block>
  <block id="add54c6c694f1dea873fa725229c4ff6" category="paragraph">下表显示了以下系统类型的数据保护参数示例：生产、开发和测试。对于生产系统，已定义了高备份频率，并且备份每天复制到异地备份站点一次。测试系统的要求较低，并且不会复制备份。</block>
  <block id="d784a4ef3efe213e4ffce2a3b8aab638" category="cell">策略LocalSnap</block>
  <block id="cf95b8ba53e47289df481c76a0fc1e7c" category="cell">策略LocalSnapAndSnapVault</block>
  <block id="b651fe1ef6a54eadfe7ec046c5fb3610" category="cell">策略块集成检查</block>
  <block id="4470d7231c03ea61b48270dd4e89c7c2" category="list-text">生产：每4小时计划一次。</block>
  <block id="8756cc378f32be7606a311cc58e42116" category="list-text">开发：每4小时计划一次。</block>
  <block id="3f16a4dae07b31412bf1f7d6fd53fb55" category="list-text">测试：计划每4小时执行一次。</block>
  <block id="1d3a5ab2affa87cd97d667df12d08f19" category="list-text">生产：每天计划。</block>
  <block id="cc77ff8683600a5f70dc5c80c8a4112c" category="list-text">开发：每天计划。策略`BlockIntegrityCheck`用于生产和开发系统、以使用基于文件的备份完成每周块完整性检查。</block>
  <block id="22356469ac5ca8aeafb4a4cd5aaa2346" category="list-text">生产：每周计划一次。</block>
  <block id="68b554bfef8312da6a9ba9bba23937d5" category="list-text">开发：每周计划一次。</block>
  <block id="cb6a15450e2fa9cea2ea31aa4a510c0d" category="paragraph">对于使用异地备份策略的每个SAP HANA数据库、您必须在存储层上配置一个保护关系。此保护关系定义了要复制的卷以及在异地备份存储上保留备份的情况。</block>
  <block id="9d0b24c01af3a2a587574b46fceb72d3" category="paragraph">在以下示例中、对于每个生产和开发系统、异地备份存储的保留期限定义为两周。</block>
  <block id="0197c9098f672a502b8fb0ea4af8c88a" category="paragraph">在此示例中、SAP HANA数据库资源和非数据卷资源的保护策略和保留期限没有区别。</block>
  <block id="38a5161bfaecb6377c969b8c970a6677" category="section-title">示例实验室设置</block>
  <block id="4acdc8775ab5d93ca83720de28826682" category="paragraph">以下实验室设置用作本文档其余部分的配置示例。</block>
  <block id="2edcc43e604ebe03c9e589e03ad59509" category="paragraph">HANA系统PFX：</block>
  <block id="e246c6ca2a43b0011a7139e737f72e94" category="list-text">具有单个租户的单主机MDC系统</block>
  <block id="11da4dfde153724b26d00bd0b8eef4c1" category="list-text">HANA 2.0 sps 6修订版60</block>
  <block id="c07320955ae27fabbb4794368ec16c12" category="list-text">适用于SAP 15SP3的SLES</block>
  <block id="18d457f56413972c18dd88f5456dedd9" category="paragraph">SnapCenter ：</block>
  <block id="50c86c9536ac5a750f7b41adb4073361" category="list-text">版本4.6</block>
  <block id="906753eafa96e59604253afc13b16762" category="list-text">HANA和Linux插件部署在HANA数据库主机上</block>
  <block id="27dd1f0ad2cb3dde55ff3aaa438b942f" category="paragraph">适用于ONTAP 文件系统的FSX：</block>
  <block id="f656ee2a8422f6074720c983ae791ddb" category="list-text">两个FSX、用于具有单个Storage Virtual Machine (SVM)的ONTAP 文件系统</block>
  <block id="a1ac29fe64b1ca0654c85b2f60b211a1" category="list-text">位于不同AWS可用性区域中的每个ONTAP 系统FSX</block>
  <block id="48eba9fd649acf4be2ae35cea201d48a" category="list-text">已将HANA数据卷复制到第二个FSX for ONTAP 文件系统</block>
  <block id="b7868c33a653d5e8748fca10e512fdc7" category="summary">在我们的实验室设置中、我们会在第二个AWS可用性区域中使用第二个FSX for ONTAP 文件系统来展示HANA数据卷的备份复制。</block>
  <block id="95ea3387767393eddc1336a2154175d9" category="doc">概述—使用SnapVault 备份复制</block>
  <block id="86aba40e8759c5f3a79b7b6b23617ed9" category="inline-link-macro">"数据保护策略"</block>
  <block id="532b5caf6d2f2df226e8b398d9b30a66" category="paragraph">如第章所述 <block ref="be68466d3e3fcc946680f447c790913d" category="inline-link-macro-rx"></block>、复制目标必须是另一个可用性区域中ONTAP 文件系统的第二个FSx、才能防止ONTAP 文件系统的主FSx发生故障。此外、应将HANA共享卷复制到二级FSX for ONTAP 文件系统。</block>
  <block id="8913ab6041dfb8e85d12eddd1acaa5ca" category="section-title">配置步骤概述</block>
  <block id="07f30226d3c2baca5e7519c8b103a270" category="paragraph">必须在适用于ONTAP 的FSX层上执行几个配置步骤。您可以使用NetApp Cloud Manager或FSX for ONTAP 命令行执行此操作。</block>
  <block id="81641f60f8074d2777e22d31d1d5477e" category="list-text">适用于ONTAP 文件系统的对等FSX。必须为适用于ONTAP 文件系统的FSX建立对等关系、才能在彼此之间进行复制。</block>
  <block id="04f9fb453a5b3f03dcfa9eb4b47daca4" category="list-text">对等SVM。SVM必须建立对等关系、才能在彼此之间进行复制。</block>
  <block id="62318a8b11e534add7ef07b26c1ace60" category="list-text">创建目标卷。在目标SVM上创建卷、卷类型为`DP`。要用作复制目标卷、必须键入`DP`。</block>
  <block id="f3db679e572cae36c0e32cb0946bc5b9" category="list-text">创建SnapMirror策略。此选项用于创建类型为`vault`的复制策略。</block>
  <block id="001de0baa772b4eb02137ea1838ecbad" category="list-text">向策略添加规则。此规则包含SnapMirror标签以及二级站点备份的保留。您必须稍后在SnapCenter 策略中配置相同的SnapMirror标签、以便SnapCenter 在包含此标签的源卷上创建Snapshot备份。</block>
  <block id="dd1b188f97236bc65d266b713b0a2c3c" category="list-text">创建SnapMirror关系。定义源卷和目标卷之间的复制关系并附加策略。</block>
  <block id="33ff9e19a0a8c2a53edafdfe10646c3d" category="list-text">初始化SnapMirror。此时将开始初始复制、在此复制中、完整的源数据将传输到目标卷。</block>
  <block id="caed6b5eec6c8a3a2d223a3896adeebc" category="paragraph">卷复制配置完成后、您必须按如下所示在SnapCenter 中配置备份复制：</block>
  <block id="12ed731fe0ebb2ea71878d5e9c029f69" category="list-text">将目标SVM添加到SnapCenter。</block>
  <block id="02b70400ae992d29c68f4e654dee405e" category="list-text">为Snapshot备份和SnapVault 复制创建新的SnapCenter 策略。</block>
  <block id="650e26d413499d7020a3e2e477999428" category="list-text">将此策略添加到HANA资源保护中。</block>
  <block id="9505d7775b4aa534ceeeb23744ed09e7" category="list-text">现在、您可以使用新策略执行备份。</block>
  <block id="4b7d520e2b58478a0dd3736b31c461d8" category="paragraph">以下各章将更详细地介绍各个步骤。</block>
  <block id="af6c6acd72965555d34e33c0b507962b" category="summary">本节介绍如何使用复制创建备份。</block>
  <block id="1975e970c6735fe42f83f63430773bce" category="doc">使用复制创建备份</block>
  <block id="fe963cc53fa6ca91332135a0fdf394ce" category="paragraph">创建备份的方式与创建本地Snapshot副本的方式相同。</block>
  <block id="220f06985b74a5091aad99541552d38f" category="paragraph">要使用复制创建备份、请选择包含备份复制的策略、然后单击备份。</block>
  <block id="873a3b33f12dee6fcd571bc7c855da4e" category="paragraph">在SnapCenter 作业日志中、您可以看到二级更新步骤、该步骤将启动SnapVault 更新操作。将更改的块从源卷复制到目标卷。</block>
  <block id="bd72bb66cc1f6c0274f2b9a01b88f988" category="paragraph">在适用于ONTAP 的FSX文件系统上、使用SnapCenter 策略中配置的SnapMirror标签`SnapCenter`在源卷上创建Snapshot。</block>
  <block id="ca557f776bfcc035900f10add0a5a68f" category="paragraph">在目标卷上、将创建一个同名Snapshot副本。</block>
  <block id="913ca500d383f0ef7e31451f47e06ba9" category="paragraph">新的Snapshot备份也会列在HANA备份目录中。</block>
  <block id="536d39b1788aafe77a33dea12db6f000" category="paragraph">在SnapCenter 中、您可以通过单击拓扑视图中的存储副本来列出复制的备份。</block>
  <block id="46f7f3d3c0b3afe7e5a1e026b2079c7d" category="summary">本节介绍如何配置备份复制策略。</block>
  <block id="b950bdfd30a0ab3d80a5aba7d93af29e" category="doc">为备份复制创建新的SnapCenter 策略</block>
  <block id="3025c1bc51ebfd7060cc53e320af06b3" category="paragraph">您必须按如下所示配置备份复制策略：</block>
  <block id="8b8b965fb7ffc307bea22e16dc282653" category="list-text">请为此策略提供一个名称。</block>
  <block id="255926c246407f59e63874cdf162bfe1" category="list-text">选择Snapshot备份和计划频率。每天通常用于备份复制。</block>
  <block id="a509d11a422413094074cecbf0366aca" category="list-text">选择Snapshot备份的保留。</block>
  <block id="d8d1327fe7287b0a0153e98b18253c34" category="paragraph">这是在主存储上创建的每日Snapshot备份的保留期限。先前已在SnapVault 目标上使用add rule命令在ONTAP 级别配置二级备份的保留。请参见《在适用于ONTAP 文件系统的FSX上配置复制关系》(xref)。</block>
  <block id="0f3c758f3ba480dbff88c44bceab01e8" category="list-text">选择Update SnapVault 字段并提供自定义标签。</block>
  <block id="8f610812cd49bd366c9638bef3fce744" category="paragraph">此标签必须与ONTAP 级别的`add rule`命令中提供的SnapMirror标签匹配。</block>
  <block id="ec5c19062711162507c65806ea542ac5" category="paragraph">此时将配置新的SnapCenter 策略。</block>
  <block id="2c0b1092a288f5d67050f3fbf404d5f8" category="list-text">适用于NetApp ONTAP 的FSx用户指南—什么是适用于NetApp ONTAP 的Amazon FSx？</block>
  <block id="d82c21a48349085e4fd93fb6712e3789" category="paragraph"><block ref="d82c21a48349085e4fd93fb6712e3789" category="inline-link-rx"></block></block>
  <block id="3306e00cec668497714eaadcd7aa6ac8" category="list-text">SnapCenter 资源页面</block>
  <block id="7608e75619cff3eeb4e8bce40481b456" category="list-text">SnapCenter 软件文档</block>
  <block id="7a3492bffc26e95ce3669b39a1f14422" category="list-text">TR-4667：使用SnapCenter 自动执行SAP HANA系统复制和克隆操作</block>
  <block id="57ba5a9f523a8e4c04a3d8c97ceb0512" category="paragraph"><block ref="57ba5a9f523a8e4c04a3d8c97ceb0512" category="inline-link-rx"></block></block>
  <block id="3c191542e46a4ce9d7eb2f662380cb07" category="list-text">TR-4719：SAP HANA系统复制—使用SnapCenter 进行备份和恢复</block>
  <block id="fdb11e662eb4102170cd8c688e5f636e" category="inline-link"><block ref="fdb11e662eb4102170cd8c688e5f636e" category="inline-link-rx"></block></block>
  <block id="1abbabb28000113cac5f8ec1cb3265ee" category="paragraph"><block ref="1abbabb28000113cac5f8ec1cb3265ee" category="inline-link-rx"></block></block>
  <block id="baaebabde318c3efac57f4b4eaf80541" category="summary">您可以使用NetApp Snapshot技术在几分钟内创建数据库备份。创建 Snapshot 副本所需的时间与数据库大小无关，因为 Snapshot 副本不会移动存储平台上的任何物理数据块。</block>
  <block id="a72020b2f4b19541a1ec28f5c06dd28d" category="doc">使用适用于ONTAP 的Amazon FSX进行备份和恢复</block>
  <block id="2025d4d57c2a7727e45b8c27669d1766" category="paragraph">Snapshot 副本还为还原和恢复操作提供了主要优势。通过NetApp SnapRestore 技术、可以根据当前可用的Snapshot副本将整个数据库或数据库的一部分还原到任意时间点。无论数据库大小如何，此类还原过程都只需几秒钟即可完成。由于在一天中可以创建多个联机Snapshot备份、因此与传统的每天一次备份方法相比、恢复过程所需的时间显著减少。由于您可以使用最长只有几小时(而不是长达24小时)的Snapshot副本执行还原、因此在正向恢复期间必须应用的事务日志更少。因此、RTO会减少到几分钟、而不是传统流式备份所需的几小时。</block>
  <block id="a2a3e9da861c9ea2a98377b12083c9dd" category="paragraph">Snapshot 副本备份与活动联机数据存储在同一磁盘系统上。因此， NetApp 建议使用 Snapshot 副本备份作为对备份到二级位置的补充，而不是替代。大多数还原和恢复操作都通过在主存储系统上使用SnapRestore 进行管理。只有当包含 Snapshot 副本的主存储系统损坏时，才需要从二级位置进行还原。如果需要还原主位置上不再可用的备份、也可以使用二级位置。</block>
  <block id="8dcd926cbf875d3253a284078f4d4d97" category="paragraph">到二级位置的备份基于在主存储上创建的 Snapshot 副本。因此，直接从主存储系统读取数据，而不会在 SAP 数据库服务器上生成负载。主存储直接与二级存储通信、并使用NetApp SnapVault 功能将备份数据复制到目标。</block>
  <block id="5b20f618fc45fa395c10c6521e4740bb" category="paragraph">与传统备份相比， SnapVault 具有显著优势。在初始数据传输之后、所有数据都已从源传输到目标、所有后续备份副本只会将更改后的块移动到二级存储。因此，主存储系统上的负载以及完整备份所需的时间会显著减少。由于SnapVault 仅在目标上存储更改过的块、因此任何额外的完整数据库备份所占用的磁盘空间都会显著减少。</block>
  <block id="cba657bc8a28e8aa3d4ccf36fee09f3d" category="section-title">Snapshot备份和还原操作的运行时</block>
  <block id="f2d966c4c76183b95a2dd4aab1cc183f" category="paragraph">下图显示了客户使用Snapshot备份操作的HANA Studio。此图显示、使用Snapshot备份技术、HANA数据库(大小约为4 TB)可在1分20秒内完成备份、而使用基于文件的备份操作则可在4小时以上完成备份。</block>
  <block id="c7e7d45d7e845928548b3e543ca10436" category="paragraph">整个备份工作流运行时间的最大一部分是执行HANA备份保存点操作所需的时间、此步骤取决于HANA数据库上的负载。存储 Snapshot 备份本身始终会在几秒钟内完成。</block>
  <block id="193fec5a460def18c358af628c0b33be" category="paragraph">本节将对基于文件的Snapshot备份和基于存储的Snapshot备份进行恢复时间目标(RTO)比较。RTO由还原、恢复然后启动数据库所需的时间之和定义。</block>
  <block id="7beb9f884b7fd71d5e5a785cdeb855ae" category="paragraph">对于基于文件的备份，还原时间取决于数据库和备份基础架构的大小，该大小定义了还原速度，以 MB/ 秒为单位。例如、如果基础架构支持以250 MBps的速度执行还原操作、则需要大约4.5小时才能在永久性的情况下还原大小为4 TB的数据库。</block>
  <block id="a743491c215755ced1d249728d4c59cf" category="paragraph">对于存储Snapshot副本备份、还原时间与数据库大小无关、并且始终在几秒的范围内。</block>
  <block id="beb19f37eae3085fec5f4641f0033384" category="paragraph">数据库开始时间取决于数据库大小以及将数据加载到内存所需的时间。在以下示例中、假设数据可以加载1000 Mbps。将4 TB的容量加载到内存大约需要1小时10分钟。基于文件和基于Snapshot的还原和恢复操作的开始时间相同。</block>
  <block id="2c68d79a149075de78266c5882a42d2d" category="paragraph">快照备份的计划频率通常较高、因为它们不会影响SAP HANA数据库的性能。例如、如果每六小时计划一次Snapshot备份、则在最坏的情况下、恢复时间将是基于文件的备份恢复时间的四分之一(6小时/24小时=.25)。</block>
  <block id="43f14ff1b246267a64206adbdba0de5d" category="paragraph">下图显示了还原和恢复操作与基于文件的每日备份和具有不同计划的Snapshot备份的比较。</block>
  <block id="30073284d63b6f33c78286326400021c" category="paragraph">前两个条形显示、即使每天只备份一个Snapshot、由于Snapshot备份的还原操作速度较快、还原和恢复也会减少到43%。如果每天创建多个Snapshot备份、则可以进一步减少运行时间、因为在正向恢复期间需要应用的日志更少。</block>
  <block id="0d381e697a62c19da0662e14a0677b91" category="paragraph">下图还显示、每天有四到六个Snapshot备份最有意义、因为更高的频率不再对整体运行时间产生重大影响。</block>
  <block id="f098f2578c0983f1b7aa54ffbce45c14" category="section-title">加速备份和克隆操作的用例和值</block>
  <block id="e7a11550e1b499ff6585bb500fe016d4" category="paragraph">执行备份是任何数据保护策略的关键部分。系统会定期计划备份、以确保您可以从系统故障中恢复。这是最明显的使用情形、但也有其他SAP生命周期管理任务、在这些任务中、加快备份和恢复操作至关重要。</block>
  <block id="d7b2a02b60c22dabdbb3d85e7896c825" category="paragraph">SAP HANA系统升级就是一个示例、其中、升级前的按需备份以及升级失败后可能执行的还原操作会对整体计划内停机造成重大影响。以4TB数据库为例、您可以使用基于Snapshot的备份和还原操作将计划内停机时间减少8小时。</block>
  <block id="3771b614a6d8a93c16146fea5ac011a7" category="paragraph">另一个用例示例是典型的测试周期、在此周期中、必须使用不同的数据集或参数通过多个迭代执行测试。在利用快速备份和还原操作时、您可以轻松地在测试周期内创建保存点、并在测试失败或需要重复时将系统重置为上述任一保存点。这样可以提前完成测试、也可以同时完成更多测试、并提高测试结果。</block>
  <block id="9b0edbbb4b880bc3149ad74e530b34e3" category="paragraph">实施Snapshot备份后、可以使用这些备份来解决其他多种使用情形、这些使用情形需要一个HANA数据库的副本。使用适用于ONTAP 的FSX、您可以根据任何可用Snapshot备份的内容创建新卷。此操作的运行时间为几秒、与卷大小无关。</block>
  <block id="664899847ba43249fa67d3faf26a8593" category="paragraph">最常见的使用情形是SAP系统更新、其中需要将生产系统中的数据复制到测试或QA系统。通过利用适用于ONTAP 克隆的FSX功能、您可以在几秒钟内从生产系统的任何Snapshot副本为测试系统配置卷。然后、必须将新卷连接到测试系统并恢复HANA数据库。</block>
  <block id="b87a6bb157820948a8a8c214af4e0062" category="paragraph">第二种使用情形是创建修复系统、用于解决生产系统中的逻辑损坏问题。在这种情况下、使用生产系统的旧Snapshot备份来启动修复系统、该修复系统是生产系统的一个克隆、与发生损坏之前的数据完全相同。然后、使用修复系统分析问题并在所需数据损坏之前导出这些数据。</block>
  <block id="c7b35ad7f0a4691a80ff05970187ddeb" category="paragraph">最后一个使用情形是、能够在不停止复制的情况下运行灾难恢复故障转移测试、从而不影响灾难恢复设置的RTO和恢复点目标(RPO)。当使用适用于ONTAP 的FSX NetApp SnapMirror复制将数据复制到灾难恢复站点时、生产Snapshot备份也可在灾难恢复站点上使用、然后可用于创建新卷以进行灾难恢复测试。</block>
  <block id="0a6bfe5423e343fa9ae1504fcfa72370" category="sidebar">基于Amazon FSX的SAP HANA for NetApp ONTAP —使用SnapCenter 进行备份和恢复</block>
  <block id="4918362f7575b370dea00cbbd262d325" category="doc">使用SnapCenter 的SAP系统克隆工作流概述</block>
  <block id="093ee2daaf21be64a5bb2ed4343fb467" category="list-text">启动SAP HANA服务。</block>
  <block id="369cc9284a0690b16f7e5e6fc7eedd89" category="paragraph">如果不再需要该系统、则执行清理过程时需执行以下步骤。</block>
  <block id="d220a66485a5f2da02d8844477577f2d" category="list-text">停止SAP HANA服务。</block>
  <block id="babe89dd8942b06138b66c6f4c3f3fff" category="inline-link-macro">"使用SnapCenter 克隆SAP系统"</block>
  <block id="6e9193241d90d638068ce0f269752a62" category="paragraph">部分 <block ref="a4506d7466a9fbf36dd3c26b9a984ae5" category="inline-link-macro-rx"></block> 提供系统克隆工作流的详细分步问题描述。</block>
  <block id="5567a4429aece8d2bfac765da9d65e55" category="doc">使用SnapCenter 的SAP系统刷新工作流概述</block>
  <block id="2398bee7e215208312bd1fd15c402a64" category="list-text">一次性初始安装和准备目标系统。</block>
  <block id="0056927d09a94ad9d99ae19f1ae65777" category="admonition">拆分FlexClone卷时、SnapCenter 会删除在目标系统上创建的所有备份。</block>
  <block id="8aebb15edb2abfa5d96c34de17486875" category="list-text">SnapCenter 克隆创建工作流。</block>
  <block id="2f02093c9e2d7667a513ad0bebeed79c" category="admonition">必须在存储系统上手动删除先前拆分的旧数据卷。</block>
  <block id="bf2ace2832642b55dc83b6716197376d" category="inline-link-macro">《使用SnapCenter 更新SAP HANA系统》</block>
  <block id="83f3645d9ca2a90e24d8292c68c44ee9" category="paragraph">部分 <block ref="03ef541d09405ce284f5845fef8fc171" category="inline-link-macro-rx"></block> 提供两个系统刷新工作流的详细分步问题描述。</block>
  <block id="dc5972f4834e498bc24fcfa79ab4832e" category="summary">本节提供了SAP系统克隆操作的分步问题描述 、可用于设置修复系统以解决逻辑损坏问题。</block>
  <block id="91e262c7cc6612696dc2e8b343ccd3fa" category="doc">使用SnapCenter 克隆SAP系统</block>
  <block id="52f78b138165376783e782c4e6583ca9" category="section-title">前提条件和限制</block>
  <block id="3722e4213a96d42e9f9a969b7f28bf9c" category="paragraph">使用的软件版本如下：</block>
  <block id="629a677a12d5ce146953ce7f089d9494" category="inline-link">采用NFS的NetApp AFF 系统上的SAP HANA</block>
  <block id="311d495fe9e684d64927a5a6c5ea754b" category="section-title">目标主机准备</block>
  <block id="45bdd686062a6e366f360ed4be35e2d6" category="paragraph">本节介绍用作系统克隆目标的服务器所需的准备步骤。</block>
  <block id="b69071a45ad28f853ea645b7bdce7c78" category="admonition">必须正确隔离目标服务器，使其无法与其他系统通信。如果未设置适当的隔离、则克隆的生产系统可能会与其他生产系统交换数据。</block>
  <block id="d47c82608e9c54c2177ab011e592cd3a" category="admonition">在实验室设置中、我们仅从目标系统的角度在内部更改了目标系统的主机名。在外部、仍可使用主机名ha-7访问此主机。登录到主机时、主机本身为HANA 1。</block>
  <block id="11ba9045ace190d52590b95322ebbe99" category="section-title">准备日志和日志备份卷</block>
  <block id="c3dc73ef5b64395a593922e549e1489c" category="paragraph">由于您不需要从源系统克隆日志卷、并且使用Clear log选项执行任何恢复、因此必须在目标主机上准备一个空的日志卷。</block>
  <block id="3480283b2df2bb5abbf5fc8dc0d3334c" category="paragraph">由于源系统已配置一个单独的日志备份卷、因此必须准备一个空的日志备份卷并将其挂载到源系统上的相同挂载点。</block>
  <block id="f589ee4577bcd9213118347f1cc22d38" category="paragraph">在日志卷hdb*中、必须按照与源系统相同的方式创建子目录。</block>
  <block id="83706c0c7217c1bc161fae80897bb12f" category="paragraph">在日志备份卷中、必须为系统和租户数据库创建子目录。</block>
  <block id="b0801fc20ca88c457d0193f04f91045f" category="paragraph">您必须为数据和共享卷准备挂载点。</block>
  <block id="7a509a4c06e4915ff64b195bf2803fb5" category="section-title">克隆HANA共享卷</block>
  <block id="8ae991813efd55da49ac68bbc88f63ba" category="list-text">使用所需的命令行选项输入挂载脚本。</block>
  <block id="cc896021fb024f9f0a119749d16f42c6" category="list-text">SnapCenter 中的作业详细信息屏幕将显示操作进度。</block>
  <block id="fb14d9cdc6b29f21dde7c843415b0e30" category="list-text">在SnapCenter 中、可以看到克隆卷的新资源。</block>
  <block id="e75e233d1a0d5dfc08414007ca9b4ddb" category="section-title">克隆其他SAP应用程序服务</block>
  <block id="2184a1291c65d3b3b536d54f7d596a25" category="section-title">克隆数据卷并恢复HANA数据库</block>
  <block id="bc4fe2352063642d68529f2aa0ca7ca3" category="list-text">NetApp 产品文档</block>
  <block id="fa4af55c3fdbce23e96d2cf73261fa5b" category="inline-link"><block ref="fa4af55c3fdbce23e96d2cf73261fa5b" category="inline-link-rx"></block></block>
  <block id="2e85fc867cab94d246e0bf6043b361cd" category="paragraph"><block ref="2e85fc867cab94d246e0bf6043b361cd" category="inline-link-rx"></block></block>
  <block id="14eeebfaf0a3f6c3f31d03561a918d1d" category="doc">SAP系统复制、刷新和克隆情形</block>
  <block id="63d77ab1313f4f81998ac664534d61f8" category="paragraph">术语SAP系统副本通常用作三个不同流程的同义词：SAP系统刷新、SAP系统副本或SAP系统克隆操作。请务必区分不同的操作、因为每个操作的工作流和用例都不同。</block>
  <block id="2524d9452b0a981704b4a6ee5d325ae9" category="list-text">* SAP系统刷新。* SAP系统刷新是使用源SAP系统中的数据刷新现有目标SAP系统。目标系统通常是SAP传输环境的一部分、例如质量保证系统、该系统会使用生产系统中的数据进行更新。源系统和目标系统的主机名、实例编号和SID不同。</block>
  <block id="70163042bd4905ce5700fc7a0ebfb1ab" category="list-text">* SAP系统副本。* SAP系统副本是使用源SAP系统中的数据设置的新目标SAP系统。例如、新的目标系统可以是一个包含生产系统数据的附加测试系统。源系统和目标系统的主机名、实例编号和SID不同。</block>
  <block id="9d987abf3f9fb4867efa110ffee16b77" category="list-text">* SAP系统克隆。* SAP系统克隆是源SAP系统的相同克隆。SAP系统克隆通常用于解决逻辑损坏或测试灾难恢复场景。在执行系统克隆操作时、主机名、实例编号和SID保持不变。因此、必须为目标系统建立适当的网络隔离、以确保与生产环境之间不存在通信。</block>
  <block id="bf71c2f30ce593737e5676b615d679b7" category="summary">本节介绍如何将LSC与NetApp SnapCenter 集成。LSC和SnapCenter 之间的集成支持所有SAP支持的数据库。但是、我们必须区分SAP AnyDB和SAP HANA、因为SAP HANA提供了一个无法用于SAP AnyDB的中央通信主机。</block>
  <block id="1a69541a93d21817ebaad2102f643fb1" category="doc">使用LSC和SnapCenter 更新SAP HANA系统</block>
  <block id="d6a68c1e93d6606c28c5465a88d436c9" category="paragraph">本节介绍如何将LSC与NetApp SnapCenter 集成。LSC和SnapCenter 之间的集成支持所有SAP支持的数据库。但是、我们必须区分SAP AnyDB和SAP HANA、因为SAP HANA提供了一个无法用于SAP AnyDB的中央通信主机。</block>
  <block id="deb112a96121fb1b1188979dcbf067d3" category="paragraph">SAP AnyDB的默认SnapCenter 代理和数据库插件安装是SnapCenter 代理的本地安装、以及数据库服务器的相应数据库插件。</block>
  <block id="a6013c0e984d4c44e03b3e7a74e5aeb0" category="paragraph">在本节中、我们将以SAP HANA数据库为例介绍LSC与SnapCenter 之间的集成。如前文所述、对于SAP HANA、安装SnapCenter 代理和SAP HANA数据库插件有两种不同的选项：</block>
  <block id="bcbedc871164d34fd83bbf2db3afbfbe" category="list-text">*标准SnapCenter 代理和SAP HANA插件安装。*在标准安装中、SnapCenter 代理和SAP HANA插件在本地安装在SAP HANA数据库服务器上。</block>
  <block id="c4e5652d7c6756098b7fa87e73bd054c" category="list-text">*使用中央通信主机的SnapCenter 安装。*中央通信主机随SnapCenter 代理、SAP HANA插件和HANA数据库客户端一起安装、负责处理为环境中的多个SAP HANA系统备份和还原SAP HANA数据库所需的所有数据库相关操作。因此、中央通信主机无需安装完整的SAP HANA数据库系统。</block>
  <block id="b4414ea38c77a0a3ee9e47059486f3e2" category="paragraph">有关这些不同的SnapCenter 代理和SAP HANA数据库插件安装选项的详细信息、请参见技术报告<block ref="dcc70b4da54279e83b2675b3331c54b4" category="inline-link-rx"></block>。</block>
  <block id="a0e8a8955d20c8fc657e47b2296ed8c1" category="paragraph">以下各节重点介绍了使用标准安装或中央通信主机将LSC与SnapCenter 集成的区别。值得注意的是、无论使用何种安装选项和数据库、未突出显示的所有配置步骤都是相同的。</block>
  <block id="2859fee4a02ffd846470095dc466260c" category="paragraph">下图显示了在不使用LSC的情况下使用SnapCenter 的SAP系统刷新生命周期中的典型高级工作流：</block>
  <block id="052eec788d8241d56e540b703047914e" category="list-text">手动预处理(导出许可证、用户、打印机等)。</block>
  <block id="7e1b2dbe7aeb5bb0dae54646fc7b068f" category="list-text">如有必要、删除目标系统上已有的克隆。</block>
  <block id="1ec54762821f370d94ab59973a242731" category="list-text">由SnapCenter 执行的将源系统的现有Snapshot副本克隆到目标系统的操作。</block>
  <block id="a2f01cea3186adcc7a8299f963129bef" category="list-text">手动执行SAP后处理操作(导入许可证、用户、打印机、禁用批处理作业等)。</block>
  <block id="15ede771c76a381ce180a8a5b016a9e5" category="list-text">然后、该系统可用作测试或QA系统。</block>
  <block id="0b1431f9973ec538c4929da23ef2df09" category="list-text">请求新系统刷新时、工作流将在步骤2重新启动。</block>
  <block id="dad719ad8230b28731f943672a4d5160" category="paragraph">SAP客户知道、下图中以绿色显示的手动步骤非常耗时且容易出错。在使用LSC和SnapCenter 集成时、这些手动步骤会与LSC以可靠且可重复的方式执行、并提供进行内部和外部审核所需的所有日志。</block>
  <block id="a1ac4d20408e8685f13f991ede187151" category="paragraph">下图概述了基于SnapCenter的常规SAP系统更新操作步骤。</block>
  <block id="dfafb60fecb9c84a71b2f57e43572aa4" category="paragraph">必须满足以下前提条件：</block>
  <block id="e6dc24f83de456eb68d52ebe06229756" category="list-text">必须安装SnapCenter。源系统和目标系统必须在SnapCenter 中进行配置、可以采用标准安装、也可以使用中央通信主机进行配置。可以在源系统上创建Snapshot副本。</block>
  <block id="4030bd38003569b0aa03679aacb58d03" category="list-text">必须在SnapCenter 中正确配置存储后端、如下图所示。</block>
  <block id="783367908b6fad41041132e4e731f814" category="paragraph">接下来的两个映像涵盖了标准安装、其中SnapCenter 代理和SAP HANA插件安装在每个数据库服务器的本地。</block>
  <block id="716491e046b3f9f90b117da16c013072" category="paragraph">必须在源数据库上安装SnapCenter 代理和相应的数据库插件。</block>
  <block id="f57e5828892c745a8a32aaeda8baade2" category="paragraph">必须在目标数据库上安装SnapCenter 代理和相应的数据库插件。</block>
  <block id="6263b2edbc1c1dcb7a51621051498083" category="paragraph">下图介绍了中央通信主机部署、其中、SnapCenter 代理、SAP HANA插件和SAP HANA数据库客户端安装在一个集中式服务器(如SnapCenter 服务器)上、用于管理环境中的多个SAP HANA系统。</block>
  <block id="cb782b8498178806c8212caf20778a66" category="paragraph">SnapCenter 代理、SAP HANA数据库插件和HANA数据库客户端必须安装在中央通信主机上。</block>
  <block id="eef8c7a6c890ac29bbfadeef31ec706a" category="paragraph">必须在SnapCenter 中正确配置源数据库的备份、才能成功创建Snapshot副本。</block>
  <block id="370b67a38ee79201ffeff4eeef17db78" category="paragraph">LSC主服务器和LSC员工必须安装在SAP环境中。在此部署中、我们还在SnapCenter 服务器上安装了LSC主服务器、并在目标SAP数据库服务器上安装了LSC工作程序、此操作应进行刷新。有关更多详细信息、请参见下一节"<block ref="c48fa9372da5e679296fa19c382bd1c1" category="inline-xref-macro-rx"></block>。 "</block>
  <block id="de1921a90d14a58282dcb74904bfbc87" category="paragraph">文档资源：</block>
  <block id="c804e38e267ab7e08a61f3e791e5a99a" category="inline-link">SnapCenter 文档中心</block>
  <block id="5f238be6282547752bdf3926f1af44c2" category="list-text"><block ref="5f238be6282547752bdf3926f1af44c2" category="inline-link-rx"></block></block>
  <block id="550ff411af842971b5bef45c5d9d1a59" category="inline-link">TR-4700 ：适用于 Oracle 数据库的 SnapCenter 插件</block>
  <block id="2c7b4a7cfd7910e959b3899cdd539867" category="list-text"><block ref="2c7b4a7cfd7910e959b3899cdd539867" category="inline-link-rx"></block></block>
  <block id="4d0488fb3017f2f14273ce8765843a99" category="list-text"><block ref="4d0488fb3017f2f14273ce8765843a99" category="inline-link-rx"></block></block>
  <block id="56f5eeda3975435c8530355bc5441429" category="inline-link">TR-4769—SnapCenter 最佳实践和规模估算准则</block>
  <block id="025547de09dae9dc145b97701e1b973f" category="list-text"><block ref="025547de09dae9dc145b97701e1b973f" category="inline-link-rx"></block></block>
  <block id="6be1ed7d0e35cab2dd490a58f13d3761" category="inline-link">《SnapCenter 4.6 cmdlet参考指南》</block>
  <block id="76f3b0f8b6a51710bcff71e212056376" category="list-text"><block ref="76f3b0f8b6a51710bcff71e212056376" category="inline-link-rx"></block></block>
  <block id="6273877c694f4875c4ab83bf5ef28e30" category="paragraph">本节介绍在演示数据中心中设置的示例架构。此设置分为标准安装和使用中央通信主机的安装。</block>
  <block id="e0090e5eeb1da23a2924e8a8913a9bf8" category="section-title">标准安装</block>
  <block id="18500288570633595d57fbe40cf00d2d" category="paragraph">下图显示了一个标准安装、其中SnapCenter 代理以及数据库插件安装在源和目标数据库服务器的本地。在实验室设置中、我们安装了SAP HANA插件。此外、目标服务器上也安装了LSC员工。为了简化并减少虚拟服务器的数量、我们在SnapCenter 服务器上安装了LSC主服务器。下图显示了不同组件之间的通信。</block>
  <block id="007661ea1b3047cae7c25cb610ab167c" category="section-title">中央通信主机</block>
  <block id="404683c0fc052e1bb3f98c2e3b837701" category="paragraph">下图显示了使用中央通信主机进行的设置。在此配置中、SnapCenter 代理以及SAP HANA插件和HANA数据库客户端安装在一个专用服务器上。在此设置中、我们使用SnapCenter 服务器安装中央通信主机。此外、LSC工作程序再次安装在目标服务器上。为了简化并减少虚拟服务器的数量、我们还决定在SnapCenter 服务器上安装LSC主服务器。下图显示了不同组件之间的通信。</block>
  <block id="37e133ea70387ff2d153dfd4610277a9" category="section-title">Libelle SystemCopy的初始一次性准备步骤</block>
  <block id="e2a4a6c5862a5dd11da8456a71cb4213" category="paragraph">LSC安装包含三个主要组件：</block>
  <block id="239ee2a2c55f17e70845f88c9c4b5dcc" category="list-text">* LSC主系统。*顾名思义、这是一个主组件、用于控制基于Lible的系统副本的自动工作流。在演示环境中、LSC主服务器安装在SnapCenter 服务器上。</block>
  <block id="4126f3ecfcea5aa9990a2aa8cd1332ef" category="list-text">* LSC员工。* LSC员工是Lbelle软件的一部分、该软件通常在目标SAP系统上运行、并执行自动系统副本所需的脚本。在演示环境中、LSC员工安装在目标SAP HANA应用程序服务器上。</block>
  <block id="5e6c40f175398bcd638cb9750798878a" category="list-text">* LSC Satellite。* LSC Satellite是Libelle软件的一部分、该软件运行在第三方系统上、必须在该系统上执行其他脚本。LSC主节点还可以同时充当LSC卫星系统的角色。</block>
  <block id="fc732f49b72c2472c6b8643d5353f2ec" category="list-text">*。172.30.15.35* SAP源系统和SAP HANA源系统的IP地址。</block>
  <block id="9179a1ee6a75d729452f54f714900f9d" category="list-text">172.30.15.3.*此配置中LSC主系统和LSC卫星系统的IP地址。由于我们在SnapCenter 服务器上安装了LSC主服务器、因此SnapCenter 4.x PowerShell Cmdlet已在此Windows主机上可用、因为它们是在SnapCenter 服务器安装期间安装的。因此、我们决定为此系统启用LSC从属角色、并在此主机上执行所有SnapCenter PowerShell Cmdlet。如果您使用的是其他系统、请确保根据SnapCenter 文档在此主机上安装SnapCenter PowerShell Cmdlet。</block>
  <block id="f2e8e2175c9da79f9518268cae7290b7" category="list-text">*。172.30.15.36* SAP目标系统、SAP HANA目标系统和LSC工作程序的IP地址。</block>
  <block id="9dbe0511fc1dcc2f05099fa37692c272" category="paragraph">也可以使用主机名或完全限定域名、而不是IP地址。</block>
  <block id="f6ec8e3f7e5bd6f3e424a8845be503ac" category="paragraph">下图显示了主节点、员工节点、卫星节点、SAP源节点、SAP目标节点、 源数据库和目标数据库。</block>
  <block id="b79cd6f4ffb52ea19abfc129a1113b1f" category="paragraph">对于主要集成、我们必须再次将配置步骤与标准安装和使用中央通信主机的安装分开。</block>
  <block id="f79c000ff76c1c3fcccfde48d40ae022" category="paragraph">本节介绍在源系统和目标系统上安装了SnapCenter 代理和所需数据库插件的情况下使用标准安装时所需的配置步骤。使用标准安装时、挂载克隆卷以及还原和恢复目标系统所需的所有任务都将从服务器本身的目标数据库系统上运行的SnapCenter 代理执行。这样、可以访问通过SnapCenter 代理的环境变量提供的所有克隆相关详细信息。因此、您只需要在LSC复制阶段创建一个额外的任务。此任务会在源数据库系统上执行Snapshot副本过程、并在目标数据库系统上执行克隆和还原与恢复过程。所有与SnapCenter 相关的任务均使用在LSC任务`NTAP_SYSTEM_clone`中输入的PowerShell脚本触发。</block>
  <block id="ffdc08e8ba0dbaa69cfc632f5ee35d2d" category="paragraph">下图显示了复制阶段的LSC任务配置。</block>
  <block id="7247a3044be0984304dbbf83efd3d439" category="paragraph">下图突出显示了`NTAP_SYSTEM_clone`进程的配置。由于您正在执行PowerShell脚本、因此此Windows PowerShell脚本将在卫星系统上执行。在这种情况下、这是安装了LSC主服务器的SnapCenter 服务器、该服务器也充当卫星系统。</block>
  <block id="d290af93396c45593291e7d4ffdddab8" category="paragraph">由于LSC必须了解Snapshot副本、克隆和恢复操作是否成功、因此您必须至少定义两种返回代码类型。一个代码用于成功执行脚本、另一个代码用于脚本执行失败、如下图所示。</block>
  <block id="14dfdadc5a95fdee64c51fc0968f9aa3" category="list-text">`LSC：OK`如果执行成功、则必须从脚本写入标准输出。</block>
  <block id="cf6b0a784c583f2e4731ee8103199cbf" category="list-text">`LSC：如果执行失败、则必须将error`从脚本写入标准输出。</block>
  <block id="2d7a6e0aa948c67c2dfbc5d04b2f328d" category="paragraph">下图显示了PowerShell脚本的一部分、必须运行该脚本才能在源数据库系统上执行基于Snapshot的备份、并在目标数据库系统上执行克隆。此脚本不应完整。相反、该脚本显示了LSC与SnapCenter 之间的集成的外观以及设置起来的简便性。</block>
  <block id="54895eed2981e39cc9de40355230f8a2" category="paragraph">由于脚本是在LSC主系统(也是一个卫星系统)上执行的、因此SnapCenter 服务器上的LSC主系统必须以具有在SnapCenter 中执行备份和克隆操作的适当权限的Windows用户身份运行。要验证用户是否具有适当的权限、用户应能够在SnapCenter UI中执行Snapshot副本和克隆。</block>
  <block id="d99842a2f1f1c478453bfb614fad5f06" category="paragraph">无需在SnapCenter 服务器本身上运行LSC主节点和LSC分身扩展。LSC主节点和LSC分身扩展可以在任何Windows计算机上运行。在LSC子系统上运行PowerShell脚本的前提条件是、已在Windows服务器上安装SnapCenter PowerShell cmdlet。</block>
  <block id="473556daf85d0d3ed30051948502a319" category="paragraph">要使用中央通信主机在LSC和SnapCenter 之间进行集成、只需在复制阶段进行调整。Snapshot副本和克隆是使用中央通信主机上的SnapCenter 代理创建的。因此、有关新创建卷的所有详细信息仅在中央通信主机上可用、而在目标数据库服务器上不可用。但是、要挂载克隆卷并执行恢复、需要在目标数据库服务器上提供这些详细信息。因此、在复制阶段需要执行两项额外任务。在中央通信主机上执行一个任务、在目标数据库服务器上执行一个任务。下图显示了这两项任务。</block>
  <block id="6a89e29d4743cfea15787c6664a35855" category="list-text">* NTAP_SYSTEM_clone_cp.*此任务使用PowerShell脚本创建Snapshot副本和克隆、该脚本可在中央通信主机上执行必要的SnapCenter 功能。因此、此任务会在LSC子系统上运行、而在我们的实例中、LSC主节点是在Windows上运行的。此脚本会收集有关克隆和新创建卷的所有详细信息、并将其移交给第二个任务`NTAP_MNT_RECOVER`、该任务在目标数据库服务器上运行的LSC员工上运行。</block>
  <block id="943cadb1083368f2707a68ed586e7923" category="list-text">* ntap_mnt_recovery_cp.*此任务将停止目标SAP系统和SAP HANA数据库、卸载旧卷、然后根据上一任务传递的参数挂载新创建的存储克隆卷`ntap_system_clone_cp`。然后还原和恢复目标SAP HANA数据库。</block>
  <block id="cf6d8bd1cac77f539772c0247b9b04d9" category="paragraph">下图突出显示了任务`NTAP_SYSTEM_clone_cp`的配置。这是在子系统上执行的Windows PowerShell脚本。在这种情况下、卫星系统是安装了LSC主服务器的SnapCenter 服务器。</block>
  <block id="22285bc33a6c217be29249f174091652" category="paragraph">由于LSC必须了解Snapshot副本和克隆操作是否成功、因此您必须至少定义两种返回代码类型：一种返回代码用于成功执行脚本、另一种返回代码用于失败执行脚本、如下图所示。</block>
  <block id="62ebeb472f2a01a7c37858ef5040ad0e" category="list-text">`LSC：如果执行失败、则必须将error`从脚本写入标准输出。</block>
  <block id="1fc5d3b1a8e8ad8e070bac1db2755b14" category="paragraph">下图显示了在中央通信主机上使用SnapCenter 代理执行Snapshot副本和克隆时必须运行的部分PowerShell脚本。此脚本并不完整。相反、该脚本用于显示LSC与SnapCenter 之间的集成的外观以及设置起来的简便性。</block>
  <block id="82a941dabf24a9e7993a0dfd0b019266" category="paragraph">如前所述、您必须将克隆卷的名称移交给下一个任务`NTAP_MNT_RECOATE_CP`以在目标服务器上挂载克隆卷。克隆卷的名称也称为接合路径、存储在变量`$JunctionPath`中。将任务移交给后续的LSC任务是通过自定义LSC变量实现的。</block>
  <block id="49e000ffe321ceb1a70d82ea78d0c6bd" category="paragraph">由于脚本是在LSC主系统(也是一个卫星系统)上执行的、因此SnapCenter 服务器上的LSC主系统必须以具有在SnapCenter 中执行备份和克隆操作的适当权限的Windows用户身份运行。要验证它是否具有适当的权限、用户应能够在SnapCenter 图形用户界面中执行Snapshot副本和克隆。</block>
  <block id="ea8d68751393b58709f3ea40ba70acb6" category="paragraph">下图突出显示了任务`NTAP_MNT_RECOATE_CP`的配置。由于我们要执行Linux Shell脚本、因此这是在目标数据库系统上执行的一个命令脚本。</block>
  <block id="c4b5d16f882636f7442e3048f2324b72" category="paragraph">由于LSC必须了解如何挂载克隆卷以及是否已成功还原和恢复目标数据库、因此我们必须至少定义两种返回代码类型。一个代码用于成功执行脚本、一个代码用于失败执行脚本、如下图所示。</block>
  <block id="2e3f585a020dfdc63a988e48a87104dd" category="paragraph">下图显示了用于停止目标数据库、卸载旧卷、挂载克隆卷以及还原和恢复目标数据库的部分Linux Shell脚本。在上一任务中、接合路径已写入LSC变量。以下命令将读取此LSC变量并将其值存储在Linux Shell脚本的`$JunctionPath`变量中。</block>
  <block id="732504ea297afd88dd03368c58912f84" category="paragraph">目标系统上的LSC工作程序以`&lt;sidaadm&gt;`的形式运行、但mount命令必须以root用户身份运行。因此、您必须创建`central_plugin_host_wrapper_script.sh`。使用`sudo`命令从任务`NTAP_MNT_recovery_cp`调用了脚本`central_plugin_host_wrapper_script.sh`。使用`sudo`命令、该脚本将使用UID 0运行、我们可以执行所有后续步骤、例如卸载旧卷、挂载克隆卷以及还原和恢复目标数据库。要使用`sUdo`启用脚本执行、必须在`/etc/sudoers`中添加以下行：</block>
  <block id="8194823b374a03595ee2ee92861dfa5c" category="section-title">SAP HANA系统刷新操作</block>
  <block id="fd4570f5dbab54ff8215f97356cef84a" category="paragraph">既然已经在LSC和NetApp SnapCenter 之间执行了所有必要的集成任务、那么启动完全自动化的SAP系统刷新就只需单击一下即可。</block>
  <block id="cc5747bb54ae81e815234f4894e61642" category="paragraph">下图显示了标准安装中的任务`NTAP`系统`_`克隆`S`。如您所见、创建Snapshot副本和克隆、在目标数据库服务器上挂载克隆卷以及还原和恢复目标数据库大约需要14分钟。值得注意的是、借助Snapshot和NetApp FlexClone技术、此任务的持续时间几乎保持不变、与源数据库的大小无关。</block>
  <block id="7ae2a6447550be2b8594e4607e4a7453" category="paragraph">下图显示了使用中央通信主机时的两个任务`NTAP_SYSTEM_clone_cp`和`NTAP_MNT_recovery_cp`。如您所见、创建Snapshot副本、克隆、在目标数据库服务器上挂载克隆卷以及还原和恢复目标数据库大约需要12分钟。使用标准安装时、执行这些步骤所需的时间大致相同。同样、无论源数据库的大小如何、Snapshot和NetApp FlexClone技术都能确保这些任务的一致、快速完成。</block>
  <block id="3f50f7ed267e090adcfbab165f2e5c47" category="list-text">TR-4436：《基于采用光纤通道协议的NetApp全闪存FAS 系统的SAP HANA》</block>
  <block id="abb522bb2ca57b2c5746580a64109029" category="list-text">TR-4435：《基于采用NFS的NetApp全闪存FAS 系统的SAP HANA》</block>
  <block id="856228be68913d2211ee02f22a38e8e9" category="paragraph">在当今瞬息万变的业务环境中、企业必须不断创新、并对不断变化的市场做出快速响应。在这种竞争环境下、在工作流程中实施更大灵活性的公司可以更有效地适应市场需求。</block>
  <block id="3f764a0345ec7999f352204a5b3fdddd" category="paragraph">配置这些系统的传统SAP生命周期管理方法主要基于手动流程。这些手动流程往往容易出错且耗时、会延迟创新和业务需求响应。</block>
  <block id="a401037b1fd939681f3b1d35a4cf1871" category="section-title">异地备份和/或灾难恢复数据复制</block>
  <block id="081ba012afe11bcd1b8a6bd63696006b" category="paragraph">通过NetApp技术和软件集成、您可以使用源系统的任何Snapshot备份执行SAP系统复制或克隆操作。可以从SAP生产系统使用的同一存储、用于异地备份的存储或灾难恢复站点上的存储中选择此Snapshot备份。这种灵活性使您可以根据需要将开发和测试系统与生产系统分开、并涵盖其他情形、例如在灾难恢复站点测试灾难恢复。</block>
  <block id="9a44f200391ceb970e5a7d2117387553" category="section-title">通过集成实现自动化</block>
  <block id="56d0fbc6603d3792bb6ace3eeba4640c" category="paragraph">配置SAP测试系统的场景和用例多种多样、您对自动化级别的要求可能也不同。适用于SAP的NetApp软件产品集成到SAP的数据库和生命周期管理产品中、以支持不同的场景和自动化级别。</block>
  <block id="9faeb8f5b5338bf989de461d80bdda01" category="paragraph">带有适用于SAP HANA插件的NetApp SnapCenter 用于根据应用程序一致的Snapshot备份配置所需的存储卷、并执行所有所需的主机和数据库操作、直到SAP HANA数据库已启动。根据使用情形、可能需要SAP系统副本、系统克隆、系统刷新或其他手动步骤、例如SAP后处理。下一节将介绍更多详细信息。</block>
  <block id="51804259bd2554b5e3aed937261760cc" category="summary">在本文档中、使用了两个脚本进一步自动执行SnapCenter 克隆创建和克隆删除操作。</block>
  <block id="d648af91bd5d8a9bfbf67955f22a64fc" category="doc">自动化示例脚本</block>
  <block id="1895adf39b38ef18443a63aa503d8314" category="section-title">脚本sc-system-refresh.sh</block>
  <block id="9f44c7e376181d4ca0921e1d3a50fda8" category="section-title">支持的租户恢复操作</block>
  <block id="8d56fe5a88639964171b4bbd96f2e00a" category="paragraph">如果目标系统需要使用其他租户名称、则必须在执行恢复操作后手动重命名此租户。</block>
  <block id="004c7f829dcf842443fd006747d3de9f" category="cell">MDC单租户</block>
  <block id="c71db1f0ff2bac482804f98b63405342" category="cell">源租户名称等于源SID</block>
  <block id="d929ba5e22f3284a57126c2edcb90be7" category="cell">目标租户名称等于目标SID</block>
  <block id="fa8fc5ef8247db89b09a5feb3ba454cd" category="cell">源租户名称不等于源SID</block>
  <block id="7f0af4df67950a3197c9553be6bc7ba8" category="cell">目标租户名称等于源租户名称</block>
  <block id="78872edb0be427b181e6e8e7190de742" category="cell">MDC多租户</block>
  <block id="82a6e1233b922d8cab83fc7d0256ab6a" category="cell">任何租户名称</block>
  <block id="9ba220b8314947bfb807aaa20db482fa" category="section-title">SnapCenter 环境变量</block>
  <block id="c05a52fae37942af7adad0d02ba87fee" category="paragraph">SnapCenter 提供了一组环境变量、这些变量可在目标主机上执行的脚本中使用。该脚本使用这些变量来确定相关的配置设置。</block>
  <block id="3e88016e64c25f9d19a24a1f021ac09a" category="section-title">脚本sc-mount-volume.sh</block>
  <block id="29e2dd6e9c1ba11d2dd4b2729177f644" category="list-text">派生自`clored_volumes_mount_path`环境变量。</block>
  <block id="14d04d54afbe1cbf1d1c652d03b4ab5b" category="section-title">用于获取SnapCenter 环境变量的脚本</block>
  <block id="f849fc808040266d8c8e8176608047f5" category="paragraph">如果不应使用自动化脚本、而应手动执行这些步骤、则需要了解FlexClone卷的存储系统接合路径。接合路径在SnapCenter 中不可见、因此您需要直接在存储系统上查找接合路径、或者可以使用一个简单的脚本在目标主机上提供SnapCenter 环境变量。需要在SnapCenter 克隆创建操作中将此脚本作为挂载操作脚本添加。</block>
  <block id="19cc491dd4ab0c0c23981caff6da1749" category="paragraph">在`env-from-sc.txt`文件中、查找变量`clone-volumes_mount_path`以获取FlexClone卷的存储系统IP地址和接合路径。</block>
  <block id="d1d283ed469f9cbb4c4f40ee4c2c78d0" category="summary">用于优化SAP生命周期管理的NetApp解决方案已集成到SAP AnyDB和SAP HANA数据库中。此外、NetApp还集成到SAP生命周期管理工具中、将高效的应用程序集成数据保护与灵活的SAP测试系统配置相结合。</block>
  <block id="8133b664c0921de8f7cfeb9e67c3402e" category="doc">TR-4929：使用Libelle SystemCopy自动执行SAP系统复制操作</block>
  <block id="6581ea45f3bd063045396c433f8b8673" category="paragraph">Holger Zecha、Tobias BRANDL、NetApp Franz Dieggruber、Libelle</block>
  <block id="dd2d3355ce822b7021e69bb9d84e81f9" category="paragraph">不断变化的市场需求还会影响公司的SAP环境、因此需要定期集成、更改和更新。IT部门必须以更少的资源和更短的时间实施这些变更。要在部署这些变更时最大程度地降低风险、需要进行全面的测试和培训、这就需要使用生产中的实际数据创建更多的SAP系统。</block>
  <block id="512e1d819a2e72bd976007357739c04d" category="paragraph">用于优化SAP生命周期管理的NetApp解决方案已集成到SAP AnyDB和SAP HANA数据库中。此外、NetApp还集成到SAP生命周期管理工具中、将高效的应用程序集成数据保护与灵活的SAP测试系统配置相结合。</block>
  <block id="85843ef1a579ba31f7d2d08eee1f3767" category="inline-link">SAP同构系统副本指南</block>
  <block id="2ff1b2a382b2aaf88d7989c339b64c0c" category="inline-link">Libelle</block>
  <block id="5ef992ffc6cb882658d3affca1d6a660" category="inline-link">Libelle系统副本(LSC)</block>
  <block id="577e0778dbb772e991e1ef7491d4a63d" category="inline-link">在创纪录的时间内完成完整的端到端自动化系统副本</block>
  <block id="cb542b2dfbc4144e32b4ad8589d73ce9" category="paragraph">虽然这些NetApp解决方案可以解决问题描述 高效管理大量数据的问题、即使对于最大的数据库也是如此、但是完整的端到端SAP系统复制和刷新操作必须包括复制前和复制后活动、才能将源SAP系统的身份完全更改为目标系统。SAP在中介绍了所需的活动<block ref="0de971f1438283e76a91316d0d3300a0" category="inline-link-rx"></block>。为了进一步减少手动流程的数量并提高SAP系统复制流程的质量和稳定性、我们的合作伙伴表示<block ref="afdd381059116a8c46ab98bfde7cbd99" category="inline-link-rx"></block> 开发了<block ref="733635162e915754a49ad8c2e771a2c5" category="inline-link-rx"></block> 工具。我们已与Libelle合作、将适用于SAP系统副本的NetApp解决方案集成到LSC中以提供<block ref="08c74391aa9b631b71159d2b8e7655b7" category="inline-link-rx"></block>。</block>
  <block id="d9693233c8bb371afd0a7faaa0c944bb" category="section-title">应用程序集成的Snapshot副本操作</block>
  <block id="df1fdb1abc84b3d20f88397c73bba7ce" category="inline-link">Microsoft Azure应用程序一致的Snapshot工具</block>
  <block id="2550d042e773faa90e9c72382941e7ca" category="paragraph">在存储层上创建应用程序一致的NetApp Snapshot副本是本文档所述系统副本和系统克隆操作的基础。基于存储的Snapshot副本可使用适用于SAP HANA或SAP的NetApp SnapCenter 插件在原生 NetApp ONTAP 系统上或通过使用创建<block ref="c71ed82ea3bb1854004aa6a0fd6774ad" category="inline-link-rx"></block> (AzAcSnap)和由Microsoft Azure中运行的SAP HANA和Oracle数据库提供的接口。使用SAP HANA时、SnapCenter 和AzAcSnap会将Snapshot副本注册到SAP HANA备份目录中、以便这些备份可用于还原和恢复以及克隆操作。</block>
  <block id="c92c24a3b359481ce49bb324a8332db9" category="paragraph">应用程序一致的Snapshot副本可以在存储层复制到异地备份站点或由SnapCenter 内部控制的灾难恢复站点。复制基于块更改、因此可节省空间和带宽。通过使用跨区域复制(RCRR)功能在Azure区域之间高效复制Azure NetApp Files 卷、在采用Azure NetApp Files 的Azure中运行的SAP HANA和Oracle系统也可以使用相同的技术。</block>
  <block id="d92849d4de6a2769ac5847c9d79a1640" category="section-title">使用任何Snapshot副本执行SAP系统副本或克隆操作</block>
  <block id="789d2cc69d2afb78e02f72d73b164988" category="paragraph">通过NetApp技术和软件集成、您可以将源系统的任何Snapshot副本用于SAP系统副本或克隆操作。可以从SAP生产系统使用的同一存储、用于异地备份的存储(例如Azure中的Azure NetApp Files 备份)或灾难恢复站点上的存储(Azure NetApp Files CRR目标卷)中选择此Snapshot副本。这种灵活性使您可以根据需要将开发和测试系统与生产系统分开、并涵盖其他情形、例如在灾难恢复站点测试灾难恢复。</block>
  <block id="77b7177c9e95eb53f805c69f8b7a862d" category="paragraph">配置SAP测试系统的场景和用例多种多样、您对自动化级别的要求可能也不同。适用于SAP的NetApp软件产品集成到SAP和其他第三方供应商(例如Libelle)的数据库和生命周期管理产品中、以支持不同的场景和自动化级别。</block>
  <block id="bb8dcc59de9078f53fc58de9c2f7cee5" category="paragraph">带有适用于SAP HANA和SAP AnyDB或Azure上的AzAcSnap插件的NetApp SnapCenter 用于根据应用程序一致的Snapshot副本配置所需的存储卷克隆、并执行所有必要的主机和数据库操作、直到启动SAP数据库为止。根据使用情形、可能需要SAP系统副本、系统克隆、系统刷新或其他手动步骤、例如SAP后处理。下一节将介绍更多详细信息。</block>
  <block id="8851fd3c41521c43b8872d5844987d90" category="paragraph">可以使用Libelle SystemCopy (LSC)自动化功能对SAP测试系统执行完全自动化的端到端配置或更新。本文档将更详细地介绍SnapCenter 或AzAcSnap与LSC的集成。</block>
  <block id="31f2fe4efe97c6c07f6792cf857596b8" category="section-title">Libelle系统副本</block>
  <block id="3d3d7012f3fc84e162e820c211555de4" category="paragraph">Libelle SystemCopy是一款基于框架的软件解决方案 、用于创建完全自动化的系统和横向副本。只需简单地轻触一个按钮、即可使用全新的生产数据更新QA和测试系统。Libelle SystemCopy支持所有传统数据库和操作系统、并为所有平台提供了自己的复制机制、但同时集成了备份/还原过程或存储工具、例如NetApp Snapshot副本和NetApp FlexClone卷。系统副本期间所需的活动可从SAP ABAP堆栈外部进行控制。这样、SAP应用程序就不需要进行任何传输或其他更改。通常、成功完成系统副本操作步骤 所需的所有步骤可分为四个步骤：</block>
  <block id="1088566a14cfbaeba677e0abd83c10d5" category="list-text">*检查阶段。*检查涉及的系统环境。</block>
  <block id="56a32c0278a7c01b44ab4ea945a636a0" category="list-text">*阶段前。*准备目标系统以进行系统副本。</block>
  <block id="5b615fbc78e5d6145480840d167efffc" category="list-text">*复制阶段。*提供从源到目标系统的实际生产数据库副本。</block>
  <block id="7fa823cd52bf8b21a23eb54e78e7926b" category="list-text">*后阶段。*副本之后完成同构系统副本操作步骤 并提供更新后的目标系统的所有任务。</block>
  <block id="bd6d85bfbf8eed33fcd6d6195ba63e05" category="paragraph">在复制阶段、即使对于最大的数据库、也会使用NetApp Snapshot和FlexClone功能将所需时间降至最少几分钟。</block>
  <block id="b950f3bf7751b53e112aa6665a1e0e31" category="paragraph">对于检查、预处理和后处理阶段、LSC会提供450多个预配置任务、涵盖95%的典型刷新操作。因此、LSC采用了符合SAP标准的自动化。由于LSC的软件定义特性、可以轻松调整和增强系统更新流程、以满足客户SAP环境的特定需求。</block>
  <block id="d79a0116ae6180c79075dda925087409" category="section-title">SAP系统更新和克隆的用例</block>
  <block id="f1615122fe3ee987c5398359f2dca8a8" category="paragraph">在多种情况下、源系统中的数据必须可供目标系统使用：</block>
  <block id="b0b38c4cc3e591b6cdab5040cd71f242" category="list-text">定期更新质量保证以及测试和培训系统</block>
  <block id="d88297c655f3ff29d2a1ec937fdd33a7" category="list-text">创建中断修复或修复系统环境以解决逻辑损坏问题</block>
  <block id="a70c7e060a3886f8f55acde979d98f33" category="list-text">灾难恢复测试场景</block>
  <block id="0a2e09fa683bd368c81839911e03b708" category="paragraph">本文档其余部分分为两部分。第一部分介绍了NetApp SnapCenter 与适用于SAP HANA的Libelle SystemCopy以及在内部NetApp ONTAP 系统上运行的SAP AnyDB系统的集成。第二部分介绍了AzAcSnap与在Microsoft Azure中运行的适用于SAP HANA系统的LSC以及所提供的Azure NetApp Files 的集成。尽管底层ONTAP 技术是相同的、但与 原生 ONTAP 安装相比、Azure NetApp Files 提供不同的接口和工具集成(例如AzAcSnap)。</block>
  <block id="3af0a07313f24e03257baf4f77dca35c" category="summary">在多种情况下、必须将源系统中的数据提供给目标系统、以便用于测试或培训目的。必须定期使用源系统中的数据更新这些测试和培训系统、以确保使用当前数据集执行测试和培训。</block>
  <block id="8632014b0a82d2a229bc13ad57a2ac7e" category="doc">系统更新和克隆的用例</block>
  <block id="00b4ead5541ced0624c52fdc64a84c14" category="inline-link-macro">《使用SnapCenter 更新SAP HANA系统》。</block>
  <block id="42f2ef2ba52b6a85eaf58f1a330f7210" category="paragraph">一节介绍了系统刷新操作的工作流 <block ref="e55292fa4cf2ac9dc22d1926cd366aca" category="inline-link-macro-rx"></block></block>
  <block id="c93a3b395dcad6d7d4701c7ae95fc9d7" category="section-title">解决逻辑损坏问题</block>
  <block id="af5083b35bb63e06e5abf6eb41bc6a64" category="paragraph">逻辑损坏可能是由软件错误，人为错误或破坏引起的。遗憾的是，使用标准高可用性和灾难恢复解决方案往往无法解决逻辑损坏问题。因此、根据发生逻辑损坏的层、应用程序、文件系统或存储、有时可能无法满足最短停机时间和最大数据丢失要求。</block>
  <block id="a57853f44c435f203fab190cb2f37b09" category="paragraph">最糟糕的情况是SAP应用程序中的逻辑损坏。SAP 应用程序通常在不同应用程序相互通信并交换数据的环境中运行。因此，不建议使用还原和恢复发生逻辑损坏的 SAP 系统。将系统还原到损坏发生前的某个时间点会导致数据丢失。此外， SAP 环境将不再同步，需要额外的后处理。</block>
  <block id="40d7615d00f208b51b1e36048899ef14" category="paragraph">更好的方法是尝试通过在单独的修复系统中分析问题来修复系统中的逻辑错误、而不是还原SAP系统。根发生原因分析需要业务流程和应用程序所有者的参与。在这种情况下，您可以根据发生逻辑损坏之前存储的数据创建修复系统（生产系统的克隆）。在修复系统中，可以将所需数据导出并导入到生产系统中。通过这种方法、生产系统无需停止、在最佳情况下、不会丢失任何数据、也不会丢失一小部分数据。</block>
  <block id="3d7345edeeb5411d19faf37f4b0c3c2b" category="inline-link-macro">"使用SnapCenter 克隆SAP系统。"</block>
  <block id="cd54fd82fa6c906e20ebfd1a171d8845" category="paragraph">一节介绍了修复系统创建的工作流 <block ref="cfd6c85725a07b8a62d48c44cdaafa1a" category="inline-link-macro-rx"></block></block>
  <block id="5286abcb37bc2a905758c905666d0e5d" category="paragraph">有效的灾难恢复策略需要测试所需的工作流。测试可证明该策略是否有效、以及内部文档是否足以满足要求。此外、管理员还可以通过它对所需的过程进行培训。</block>
  <block id="f693601db2c33356395c1020a3b09d61" category="paragraph">使用SnapMirror进行存储复制可以执行灾难恢复测试、而不会使RTO和RPO面临风险。可以在不中断数据复制的情况下执行灾难恢复测试。</block>
  <block id="f4ee3b1ed515524d4ecf1ed0eb6009df" category="paragraph">异步和同步SnapMirror的灾难恢复测试会在灾难恢复目标上使用Snapshot备份和FlexClone卷。</block>
  <block id="ed6366424ce9a66f8fb6ed2d75c90f8a" category="doc">使用SnapCenter 更新SAP HANA系统</block>
  <block id="b28e3552f08f48399d98c4e3f2ebf170" category="paragraph">下一节将为SAP HANA数据库的不同系统刷新操作选项提供分步问题描述。</block>
  <block id="ca6901d32a1871c68df005c11893ef03" category="paragraph">本节将介绍以下情形。</block>
  <block id="2a995a569260d18dbea0c475b32b5070" category="list-text">无需执行克隆拆分操作即可刷新SAP HANA系统。</block>
  <block id="f5dda657758ce85749d3b1d78126301c" category="list-text">克隆删除操作</block>
  <block id="eec94e3f3d2ba5db3a1e72117c9ba511" category="list-text">通过克隆拆分操作刷新SAP HANA系统</block>
  <block id="25c0305dfdc1e02814116467a7b1157d" category="list-text">克隆拆分操作</block>
  <block id="bdb9d4569afec846fc12c6671235c013" category="list-text">ONTAP 9.7P7</block>
  <block id="f730f78b62e0154b1968bf5a9cfaa272" category="section-title">初始一次性准备步骤</block>
  <block id="c339e6217e1e3820b4e0049fdf784407" category="paragraph">初始安装后的首次SAP系统刷新操作将按以下步骤进行准备：</block>
  <block id="d15ae9c4b3386df38b1c8b39d279b83b" category="section-title">从租户名称等于SID的主存储克隆</block>
  <block id="bf53d2bd10de0b4d63b8b4e5961de63a" category="paragraph">此工作流包括以下步骤：</block>
  <block id="3341903edb9816045da3c0ee4d66d7c0" category="list-text">恢复系统数据库。</block>
  <block id="b60470565d8fe8651182cb2c066bac7d" category="list-text">恢复租户名称= QS1的租户数据库。</block>
  <block id="c5ba90ff83ae13b97d609a49e54c1ae6" category="paragraph">以下屏幕截图显示了所需的步骤。</block>
  <block id="2beea213cf9a65bc8a70c66c0f77391d" category="list-text">选择安装目标系统QS1的主机。输入QS1作为目标SID。NFS导出IP地址必须是目标主机的存储网络接口。</block>
  <block id="0b5d0b2bad6c93484f679ba8419a784f" category="list-text">SnapCenter 作业完成后、克隆将显示在源系统的拓扑视图中。</block>
  <block id="3a6409fe6b4d53ff3f6b240aac5341a9" category="paragraph">新的SAP HANA系统刷新操作可通过使用SnapCenter 克隆删除操作清理目标系统来启动。</block>
  <block id="fd3b9e0c6370bb8b1bc50684358716e2" category="list-text">使用所需的命令行选项输入克隆前和卸载脚本。</block>
  <block id="651c5cde8d72dbd0c53ab15e99678b9b" category="list-text">现在、可以使用SnapCenter 克隆创建操作重新启动SAP HANA刷新操作。</block>
  <block id="eefd7414dd589e4a4133686b9fc64373" category="section-title">执行克隆拆分操作的SAP HANA系统刷新</block>
  <block id="0760f364c123ffeb65230ca87dd8d091" category="paragraph">SnapCenter 中的克隆拆分工作流可通过选择克隆并单击克隆拆分在源系统的拓扑视图中启动。</block>
  <block id="0bb89be537550b86187cea5cf67ac2da" category="paragraph">下一屏幕将显示一个预览、其中提供了有关拆分卷所需容量的信息。</block>
  <block id="32da2ef1aadc17a0c37d725aa68059c6" category="paragraph">SnapCenter 作业日志显示克隆拆分操作的进度。</block>
  <block id="955fc654ce08874287363442ae3a05e7" category="list-text">SnapCenter 克隆操作。</block>
  <block id="76a5308fe89a8e782a72010d9a7ee852" category="section-title">使用PowerShell脚本实现SnapCenter 工作流自动化</block>
  <block id="c0ff26b620598b6000a1bcf255a128c6" category="paragraph">在前面几节中、使用SnapCenter UI执行了不同的工作流。所有工作流也可以使用PowerShell脚本或REST API调用执行、从而实现进一步的自动化。以下各节介绍了以下工作流的基本PowerShell脚本示例。</block>
  <block id="2021b3b77c933e0e9fc9d56a3a552caf" category="list-text">创建克隆</block>
  <block id="12ed4152d6bd08ebcd4e8d515069f7a5" category="list-text">删除克隆</block>
  <block id="37ba622841aed0dc2e49254702244420" category="admonition">示例脚本按原样提供、NetApp不支持。</block>
  <block id="2cbd77b31c264f22e56a266062e0b76e" category="paragraph">必须在PowerShell命令窗口中执行所有脚本。在运行这些脚本之前、必须使用`Open-SmConnection`命令与SnapCenter 服务器建立连接。</block>
  <block id="81040d6711353f30feae62b8255cac0a" category="paragraph">下面的简单脚本演示了如何使用PowerShell命令执行SnapCenter 克隆创建操作。SnapCenter `New-SmClone`命令可使用之前讨论的实验室环境和自动化脚本所需的命令行选项来执行。</block>
  <block id="f01358f0b3c6557b9a0d6ca899e3caeb" category="paragraph">屏幕输出显示了克隆create powershell脚本的执行情况。</block>
  <block id="60af87a36f879c4e11b6fe3ca1c7243f" category="paragraph">下面的简单脚本演示了如何使用PowerShell命令执行SnapCenter 克隆删除操作。使用之前讨论的实验室环境和自动化脚本所需的命令行选项执行SnapCenter `Remove-SmClone`命令。</block>
  <block id="1ac85619672d3775188dd5a646cde2e7" category="summary">在Azure上使用适用于SAP HANA、Oracle和DB2的Azure NetApp Files 为客户提供了NetApp ONTAP 的高级数据管理和数据保护功能以及原生 Microsoft Azure NetApp Files 服务。</block>
  <block id="7795765c3d2e54c77f3ddad7877f93e2" category="doc">使用LSC、AzAcSnap和Azure NetApp Files 更新SAP HANA系统</block>
  <block id="fa93527877c31a5c6e9ce20800f4865c" category="inline-link">适用于SAP HANA的Azure NetApp Files</block>
  <block id="e55759cd3f81e064f2a8f339a6c05115" category="inline-link">AzAcSnap</block>
  <block id="09f21139c961e6762596c00d8a70ff85" category="paragraph">使用<block ref="e44e132e965fcb8ded073c9571f6e761" category="inline-link-rx"></block>在Azure上运行的原生 、Oracle和DB2为客户提供了NetApp ONTAP 的高级数据管理和数据保护功能以及Microsoft Azure NetApp Files 服务。<block ref="5970ce2e45a53257e469b102e0b782c9" category="inline-link-rx"></block> 是快速执行SAP系统刷新操作以创建SAP HANA和Oracle系统的应用程序一致的NetApp Snapshot副本的基础(AzAcSnap目前不支持DB2)。</block>
  <block id="46218e7d3d10ced22363fc51163a8631" category="paragraph">Snapshot副本备份是在备份策略中按需或定期创建的、随后可以高效克隆到新卷、并用于快速刷新目标系统。AzAcSnap提供了创建备份并将其克隆到新卷所需的工作流、而Libelle SystemCopy则执行全面的端到端系统刷新所需的预处理和后处理步骤。</block>
  <block id="eaa4caa91e8a756ac88c72f7fa40f7ef" category="paragraph">在本章中、我们将介绍使用AzAcSnap和Libelle SystemCopy以及SAP HANA作为基础数据库的自动化SAP系统刷新。由于AzAcSnap也可用于Oracle、因此也可以使用适用于Oracle的AzAcSnap实施相同的操作步骤。AzAcSnap将来可能会支持其他数据库、然后会使用LSC和AzAcSnap为这些数据库启用系统复制操作。</block>
  <block id="f37683b4ee88357da8b8ff8d55aa1304" category="paragraph">下图显示了使用AzAcSnap和LSC的SAP系统刷新生命周期的典型高级工作流：</block>
  <block id="5802128cf27d5a7bd20d04ed131c4bb6" category="list-text">由LSC执行的SAP预处理操作。</block>
  <block id="134d7bd893793f6cd5c99330d7b3504d" category="list-text">将源系统的现有Snapshot副本还原(或克隆)到目标系统由AzAcSnap执行。</block>
  <block id="099f06a764be7ee4654b26209cb55657" category="list-text">由LSC执行的SAP后处理操作。</block>
  <block id="4b34b0d40dff8a07be6ef92392bacaea" category="paragraph">然后、该系统可用作测试或QA系统。请求新的系统刷新后、工作流将在步骤2中重新启动。必须手动删除所有剩余的克隆卷。</block>
  <block id="5d254ff3f488e6288f82f4fec056f63a" category="paragraph">必须满足以下前提条件。</block>
  <block id="f67cde57713136eea461365a6e071ca0" category="section-title">已为源数据库安装并配置AzAcSnap</block>
  <block id="a652e1055f4eb346a05a0a8ae89ccf80" category="paragraph">通常、AzAcSnap有两个部署选项、如下图所示。</block>
  <block id="ad0fea35a0ba8f00a3f79747ff581fe9" category="paragraph">可以在中央Linux VM上安装和运行AzAcSnap、所有数据库配置文件均集中存储在该VM上、AzAcSnap可通过hdbsql客户端访问所有数据库以及所有这些数据库的已配置HANA用户存储密钥。通过分散式部署、AzAcSnap会单独安装在通常仅存储本地数据库的数据库配置的每个数据库主机上。LSC集成支持这两种部署选项。但是、我们在本文档的实验室设置中采用了一种混合方法。AzAcSnap与所有数据库配置文件一起安装在一个中央NFS共享上。此中央安装共享已挂载到`/mnt/software/AZACSNAP/snapshot-tool`下的所有VM上。然后、在DB VM上本地执行该工具。</block>
  <block id="3473bf6ac226ea97187d11de4c036254" category="section-title">已为源SAP系统和目标SAP系统安装和配置Libelle SystemCopy</block>
  <block id="6d4c9a9ee647a3bb91c46c91c618bbd0" category="paragraph">Libelle SystemCopy部署包括以下组件：</block>
  <block id="569de98db8273c0914828fb03d807225" category="list-text">* LSC主系统。*顾名思义、这是一个主组件、用于控制基于Lible的系统副本的自动工作流。</block>
  <block id="13b1b9bc69152de535f089e6aa2557fa" category="list-text">* LSC Worker*。LSC员工通常在目标SAP系统上运行、并执行自动系统复制所需的脚本。</block>
  <block id="f827b8d117bc460f3b9c2612535f7e04" category="list-text">* LSC Satellite。* LSC Satellite运行在第三方系统上、必须在该系统上执行其他脚本。LSC主节点还可以充当LSC卫星系统的角色。</block>
  <block id="6ad330317942586b738ce4d07b4d04dd" category="paragraph">必须在合适的虚拟机上安装Libelle SystemCopy (LSC)图形用户界面。在此实验室设置中、LSC GUI安装在单独的Windows VM上、但也可以与LSC工作人员一起在DB主机上运行。LSC工作程序必须至少安装在目标数据库的VM上。根据您选择的AzAcSnap部署选项、可能需要安装其他LSC辅助设备。必须在执行AzAcSnap的虚拟机上安装LSC辅助程序。</block>
  <block id="6118b8c345b5bb01238a53ac29f93c35" category="paragraph">安装LSC后、必须根据LSC准则执行源数据库和目标数据库的基本配置。下图显示了本文档中实验室环境的配置。有关源SAP系统和目标SAP系统及数据库的详细信息、请参见下一节。</block>
  <block id="0f57aa4795f7dfe2ad4752c161b57833" category="paragraph">您还应为SAP系统配置合适的标准任务列表。有关LSC安装和配置的详细信息、请参见LSC安装包中的LSC用户手册。</block>
  <block id="482723983a4f2af954e36ff41e567451" category="section-title">已知限制</block>
  <block id="582de1e52b4b4b8c43afd9e2901bb386" category="paragraph">此处介绍的AzAcSnap和LSC集成仅适用于SAP HANA单主机数据库。也可以支持SAP HANA多主机(或横向扩展)部署、但此类部署需要在复制阶段对LSC自定义任务以及底层脚本进行一些调整或增强。本文档不会介绍此类增强功能。</block>
  <block id="d5fd1a217e57fc0be1c5b301de253791" category="paragraph">SAP系统刷新集成始终使用源系统的最新成功Snapshot副本执行目标系统刷新。如果您要使用其他较早的Snapshot副本、请使用中的相应逻辑 <block ref="2af3f1688ba1a6519fca5748b63691bc" category="inline-xref-macro-rx"></block> 必须调整自定义任务。本文档不会介绍此过程。</block>
  <block id="ef0b4c849c8032326f9a09dbcac2c1aa" category="paragraph">实验室设置由一个源SAP系统和一个目标SAP系统组成、这两个系统都运行在SAP HANA单主机数据库上。</block>
  <block id="ac070aa5e6a10e38f43a73ecc6d42841" category="paragraph">下图显示了实验室设置。</block>
  <block id="6b0375a968afca58417a6ccc5db74398" category="paragraph">它包含以下系统、软件版本和Azure NetApp Files 卷：</block>
  <block id="49777ec13a778673605c9e33fe4d84de" category="list-text">* P01.* SAP HANA 2.0 SP5数据库。源数据库、单主机、单用户租户。</block>
  <block id="8be862122af4c9837175fbad21e59c86" category="list-text">* PN1* SAP NetWeaver ABAP 7.51。源SAP系统。</block>
  <block id="6bda167dc65db3a371fbd8355cb7bc59" category="list-text">安装了具有AzAcSnap的* VM-P01.* SLES 15 SP2。托管P01和PN1的源VM。</block>
  <block id="63ed1d491719254b5f3c455a5f911ae5" category="list-text">* qL1.* SAP HANA 2.0 SP5数据库。系统刷新目标数据库、单主机、单用户租户。</block>
  <block id="32da3b0f0447a0ec3ab62e03e5eb84ee" category="list-text">* QN1* SAP NetWeaver ABAP 7.51。系统更新目标SAP系统。</block>
  <block id="c8ae9af9ad689cb19e7af7e97a1887ae" category="list-text">已安装具有LSC Worker的* VM-ql1.* SLES 15 SP2。托管QL1和QN1的目标VM。</block>
  <block id="9e018e4a68d1463bc5db2d746d1acb7f" category="list-text">LSC主版本9.0.0.052。</block>
  <block id="f25f13481e770cb30d45d52a5d67617c" category="list-text">*虚拟机- LSC-MASTER.* Windows Server 2016。托管LSC主界面和LSC图形用户界面。</block>
  <block id="067614b5d11d65ce10a3c3c952fea380" category="list-text">专用数据库主机上挂载的P01和QL1的数据、日志和共享Azure NetApp Files 卷。</block>
  <block id="4f53adf1b17bd4d8d6121ec5aba2a189" category="list-text">用于在所有VM上挂载脚本、AzAcSnap安装和配置文件的中央Azure NetApp Files 卷。</block>
  <block id="7586e39c6c4f8cbe63f3b66c1b9e3faa" category="paragraph">在执行首次SAP系统刷新之前、您必须集成由AzAcSnap执行的基于Azure NetApp Files Snapshot副本和克隆的存储操作。此外、还必须执行辅助脚本来启动和停止数据库以及挂载或卸载Azure NetApp Files 卷。在复制阶段、所有必需的任务都会在LSC中作为自定义任务执行。下图显示了LSC任务列表中的自定义任务。</block>
  <block id="46d4412b24c36c75d9f3d4767b465cdc" category="paragraph">此处将详细介绍所有五个复制任务。在其中某些任务中、使用示例脚本`sc-system-refresh.sh`进一步自动执行所需的SAP HANA数据库恢复操作以及数据卷的挂载和卸载。该脚本会在系统输出中使用`LSC：success`消息来指示已成功执行LSC。有关自定义任务和可用参数的详细信息、请参见LSC用户手册和LSC开发人员指南。此实验室环境中的所有任务都会在目标DB VM上执行。</block>
  <block id="3c3eb031881af72bbc2cd35d51f73ec5" category="admonition">示例脚本按原样提供、NetApp不支持。您可以通过电子邮件向以下地址请求此脚本：mailto：ng-sapcc@netapp.com^ ng-sapcc@netapp.com。</block>
  <block id="d5588a980e081e89a600221efeb98b75" category="section-title">Sc-system-refresh.sh配置文件</block>
  <block id="fb57465e538291ad6aa0cd830ca9bf3b" category="paragraph">如前所述、系统会使用辅助脚本启动和停止数据库、挂载和卸载Azure NetApp Files 卷以及从Snapshot副本恢复SAP HANA数据库。脚本`sc-system-refresh.sh`存储在中央NFS共享上。该脚本要求为每个目标数据库提供一个配置文件、该文件必须与该脚本本身存储在同一文件夹中。配置文件必须具有以下名称：`sc-system-refresh-&lt;target DB sid&gt;.cfg`(例如、在此实验室环境中为`sc-system-refresh-ql1.cfg`)。此处使用的配置文件使用固定/硬编码的源数据库SID。进行一些更改后、可以对脚本和配置文件进行增强、以将源数据库SID用作输入参数。</block>
  <block id="f6c6e1dc96f073e737f971bc3de9bf27" category="paragraph">必须根据特定环境调整以下参数：</block>
  <block id="c225d666b6830be01af89c21fb5b7663" category="section-title">ZSCCOPYSHUTDOWN</block>
  <block id="d2a4d4fa2135bbe64765a848486bf0e3" category="paragraph">此任务将停止目标SAP HANA数据库。此任务的代码部分包含以下文本：</block>
  <block id="66e8ad725021919d88a78f141636e9e9" category="paragraph">脚本`sc-system-refresh.sh`采用两个参数`shutdown`命令和DB SID、使用sapcontrol停止SAP HANA数据库。系统输出将重定向到标准LSC日志文件。如前所述、系统会使用`LSC：success`消息指示执行成功。</block>
  <block id="a0148c02de1fd7114f8aff04fbc1d77e" category="section-title">ZSCCOPYUMOUNT</block>
  <block id="a188fa865cb93fe9e4fe446df15457ab" category="paragraph">此任务将从目标数据库操作系统(OS)卸载旧的Azure NetApp Files 数据卷。此任务的代码部分包含以下文本：</block>
  <block id="b0f77d682c2a17e5fb5645acd2be9ad9" category="paragraph">使用与上一任务相同的脚本。传递的两个参数是`umount`命令和DB SID。</block>
  <block id="f1ffbb80b33a17caf09dab5d5759da18" category="section-title">ZAZACSNAPRESTORE</block>
  <block id="893ecde8f8b221085cc1f80173cf2a6f" category="paragraph">此任务将运行AzAcSnap、以便将源数据库的最新成功Snapshot副本克隆到目标数据库的新卷。此操作相当于在传统备份环境中重定向还原备份。但是、即使对于最大的数据库、Snapshot副本和克隆功能也可以在数秒内执行此任务、而对于传统备份、此任务可能需要几个小时的时间。此任务的代码部分包含以下文本：</block>
  <block id="d2d41dd98a152a7ea8b159ca20e4ab02" category="inline-link">使用Azure应用一致的Snapshot工具还原</block>
  <block id="62ee4a8664a0e46bebbe8a72cd8dbcab" category="paragraph">有关`restore`命令的AzAcSnap命令行选项的完整文档、请参见Azure文档：<block ref="c5fde8728491d75aa1afef4669aa2a0d" category="inline-link-rx"></block>。此调用假定可以在中央NFS共享上找到源数据库的json DB配置文件、命名约定如下：`azacsnap-&lt;source DB SID&gt;。JSON`、(例如、此实验室环境中的`azacsnap-P01.json`)。</block>
  <block id="82c163596353a5052a29181bedeaa772" category="admonition">由于无法更改AzAcSnap命令的输出、因此无法使用默认的`LSC：Success`消息执行此任务。因此、AzAcSnap输出中的字符串`示例挂载指令`用作成功的返回代码。在AzAcSnap 5.0 GA版本中、只有在克隆过程成功时、才会生成此输出。</block>
  <block id="ec16e54e6d69802cf5c8689992d032ca" category="paragraph">下图显示了AzAcSnap还原到新卷成功消息。</block>
  <block id="1c7e35fce098356ccba33d52f38b9ede" category="section-title">ZSCCOPYMOUNT</block>
  <block id="064b2926edf3b035dc0bcd3f7a1fc7bb" category="paragraph">此任务会将新的Azure NetApp Files 数据卷挂载到目标数据库的操作系统上。此任务的代码部分包含以下文本：</block>
  <block id="6a2a3f49299c67baa45c92224d7eff0e" category="paragraph">此时将再次使用sc-system-refresh.sh脚本、传递`mount`命令和目标数据库SID。</block>
  <block id="f64b75a1baf8c4281e01d865f1c874e5" category="section-title">ZSCCOPYRECOVER</block>
  <block id="730fe24ed3ef0ef3bd0be5dd1af0f3af" category="inline-link">动态增加或减少卷配额</block>
  <block id="f2f5edcd956f2ae9e108055b0188a470" category="paragraph">此任务将根据已还原(克隆)的Snapshot副本对系统数据库和租户数据库执行SAP HANA数据库恢复。此处使用的恢复选项适用于特定数据库备份、例如、不会为正向恢复应用任何其他日志。因此、恢复时间非常短(最多几分钟)。此操作的运行时间取决于SAP HANA数据库的启动情况、该数据库会在恢复过程后自动发生。为了加快启动速度、如果需要、可以临时增加Azure NetApp Files 数据卷的吞吐量、如本Azure文档所述：<block ref="e891566aaa8094b6e6bbfcb7652af128" category="inline-link-rx"></block>。此任务的代码部分包含以下文本：</block>
  <block id="b8d42515ee80a358d1c946f1ccf838dc" category="paragraph">此脚本将再次与`re封面`命令和目标数据库SID结合使用。</block>
  <block id="4bd56b391b93afbc4de82fc45017847a" category="paragraph">在本节中、实验室系统的刷新操作示例显示了此工作流的主要步骤。</block>
  <block id="b63b967fbfcc2b625ffd8c4e6d742f78" category="paragraph">已为备份目录中列出的P01源数据库创建常规和按需Snapshot副本。</block>
  <block id="44d822623a67b202b6fcd5653ee5c4f1" category="paragraph">在刷新操作中、使用了3月12日起的最新备份。在备份详细信息部分中、列出了此备份的外部备份ID (EBID)。这是Azure NetApp Files 数据卷上相应Snapshot副本备份的Snapshot副本名称、如下图所示。</block>
  <block id="01d15505073ca5412063edc35cf07b35" category="paragraph">要启动刷新操作、请在LSC图形用户界面中选择正确的配置、然后单击开始执行。</block>
  <block id="62021ea8e70f699321bf7b3de6ecce87" category="paragraph">LSC将开始执行检查阶段的任务、然后执行预阶段的已配置任务。</block>
  <block id="adafee97abc781243b6b647f8ffc7ddd" category="paragraph">作为预阶段的最后一步、目标SAP系统将停止。在以下复制阶段、将执行上一节中所述的步骤。首先、目标SAP HANA数据库将停止、而旧的Azure NetApp Files 卷将从操作系统中卸载。</block>
  <block id="4778404c5c2a6cb13b27028a13e6ec62" category="paragraph">然后、ZAZACSNAPRESTORE任务将从P01系统的现有Snapshot副本创建一个新卷作为克隆。以下两张图片显示了LSC图形用户界面中的任务日志以及Azure门户中克隆的Azure NetApp Files 卷。</block>
  <block id="ac8d5bfc0cf9544d6cc1869d7061a604" category="paragraph">然后、此新卷将挂载到目标数据库主机上、系统数据库和租户数据库将使用包含的Snapshot副本进行恢复。成功恢复后、SAP HANA数据库将自动启动。SAP HANA数据库的启动占用复制阶段的大部分时间。无论数据库大小如何、其余步骤通常只需几秒到几分钟即可完成。下图显示了如何使用SAP提供的python恢复脚本恢复系统数据库。</block>
  <block id="bb19e82722621ce22f94d846c584a966" category="paragraph">复制阶段结束后、LSC将继续执行后阶段中定义的所有步骤。系统刷新过程完全完成后、目标系统将重新启动并运行并完全可用。使用此实验室系统时、SAP系统刷新的总运行时间约为25分钟、其中复制阶段占用的时间仅不到5分钟。</block>
  <block id="aed4be0abac71ea3a4ee20b172e42949" category="sidebar">利用Libelle SystemCopy自动执行SAP系统副本操作</block>
  <block id="bc2cda4f2510d2d58906aedd61e82e50" category="inline-link"><block ref="bc2cda4f2510d2d58906aedd61e82e50" category="inline-link-rx"></block></block>
  <block id="acae3e0452c3127b0c142245461a61ae" category="paragraph"><block ref="acae3e0452c3127b0c142245461a61ae" category="inline-link-rx"></block></block>
  <block id="845479810e43d8fc64263c1a762de016" category="paragraph">要从源数据库执行基于Snapshot副本的自动备份并为新目标数据库创建克隆、所述的LSC与SnapCenter 集成使用中所述的配置选项和脚本 <block ref="6cb270d5a2712c948be937faf1cb1d50" category="inline-link-macro-rx"></block>。</block>
  <block id="66988e72fd271cabc6a7489ab70e1a4f" category="list-text"><block ref="66988e72fd271cabc6a7489ab70e1a4f" category="inline-link-rx"></block></block>
  <block id="5c427e461906a4b90dc3d5777ec58bfa" category="paragraph">虽然修复系统和灾难恢复测试系统通常使用SAP系统克隆(不需要执行大量后处理操作)来更新测试和培训系统、但要与源系统共存、必须应用这些后处理步骤。因此、本文档重点介绍SAP系统更新场景。有关不同使用情形的更多详细信息、请参见技术报告<block ref="d89e94a6aaf703375bdbc4104c3e8227" category="inline-link-rx"></block>。</block>
  <block id="8293eb8037b07e6a99273e0e69a21b6f" category="paragraph">从 SUSE Linux Enterprise Server 12 SP1 开始，必须在 ` /etc/sysctl.d` 目录的配置文件中设置内核参数。例如，您必须创建一个名为 `91-netapp-hana` 的配置文件。</block>
  <block id="6ed4f46c3f6437e250cb69f8684772f4" category="list-text"><block ref="6ed4f46c3f6437e250cb69f8684772f4" category="inline-link-rx"></block></block>
  <block id="24d3ef74df0d2ceedb42c4a4c33104d4" category="list-text"><block ref="24d3ef74df0d2ceedb42c4a4c33104d4" category="inline-link-rx"></block></block>
  <block id="a52e74dbfc20d705ac349fdd5b3d0188" category="list-text"><block ref="a52e74dbfc20d705ac349fdd5b3d0188" category="inline-link-rx"></block></block>
  <block id="aeb3b72555ced42ccaba566af6824c8b" category="paragraph">有关高效SAP HANA系统的前提条件和建议的详细信息、请参见以下资源：</block>
  <block id="bee7a17172474fbff8f082af26c835d8" category="list-text"><block ref="bee7a17172474fbff8f082af26c835d8" category="inline-link-rx"></block></block>
  <block id="1b0cf038717d1ac5c71d63e939cce293" category="list-text"><block ref="1b0cf038717d1ac5c71d63e939cce293" category="inline-link-rx"></block></block>
  <block id="e7f295e915bb11e75ddb24aa294f7351" category="paragraph">有关生产SAP HANA系统的前提条件和建议的详细信息、请参见以下SAP资源：</block>
  <block id="1ad4402d015b30446fdee11f5a31f55b" category="paragraph">有关producti SAP HANA系统的前提条件和建议的详细信息、请参见以下资源：</block>
  <block id="537754f62b9e3072d7b143e82ea96f51" category="admonition">可以使用适用于 SAP 操作系统的 SLES 版本中的 Saptune 设置这些值。有关详细信息，请参见<block ref="c8345b27d24ece14a320acdc31cc02d7" category="inline-link-rx"></block> （需要 SAP 登录）。</block>
  <block id="64de99f49b55f96ef81b9f1d7d3ef301" category="admonition">自RedHat Enterprise Linux 8.6版起、还可以使用适用于SAP的RHEL系统角色(Ansible)应用这些设置。请参见<block ref="c8345b27d24ece14a320acdc31cc02d7" category="inline-link-rx"></block> （需要 SAP 登录）。</block>
  <block id="a02f77a47cb5c9004f19c8c78d662cd5" category="admonition">可以使用适用于 SAP 操作系统的 SLES 版本中的 Saptune 设置这些值。请参见<block ref="c8345b27d24ece14a320acdc31cc02d7" category="inline-link-rx"></block> （需要 SAP 登录）。</block>
  <block id="b35bcba907dc97a5b6020488961f3307" category="admonition">从ONTAP 9.8和SUSE SLES15SP2或RedHat RHEL 8.4或更高版本开始、NetApp也支持NFSv4.1的nconnect选项。对于追加信息，请查看 Linux 供应商文档。</block>
  <block id="dbe18498a47f8eb26e80012f0c049b0d" category="paragraph">以下示例显示了一个主机 SAP HANA 数据库，其中 SID=NF2 使用 NFSv3 ， NFS 传输大小为 1 MB 用于读取， 256 k 用于写入。要在系统启动期间使用 ` /etc/fstab` 配置文件挂载文件系统，请完成以下步骤：</block>
  <block id="afd4f67ca3483f6b519e8ebc2a53dcea" category="admonition">自RedHat Enterprise Linux 8.6版以来、还可以使用适用于SAP的RHEL系统角色(Ansible)应用这些设置。请参见<block ref="c8345b27d24ece14a320acdc31cc02d7" category="inline-link-rx"></block> （需要 SAP 登录）。</block>
  <block id="e7a66fb065da642109c3abf1481bfcd0" category="paragraph">根据NFS版本和ONTAP 版本、使用不同的挂载选项。必须将以下文件系统挂载到主机：</block>
  <block id="6f7cbdc39f9acbcde843e913e06a5bd8" category="summary">要停用克隆的系统、必须事先停止并准备好该系统。之后、可以启动系统销毁工作流。</block>
  <block id="7c4bf45739108965dce4dca9b396f39d" category="doc">SAP Lama取消配置工作流—系统销毁</block>
  <block id="ce5e3f676f90c441971cc56d6dffe08e" category="paragraph">下图突出显示了使用系统销毁工作流执行的主要步骤。</block>
  <block id="fa37114811e0a6c252384710fd555989" category="inline-image-macro">此图简要展示了系统销毁工作流。其中包含以下步骤：停止系统、取消准备系统、删除存储克隆和删除系统配置。</block>
  <block id="326db1dde007554a6fc6a7f35a558d15" category="inline-image-macro">此图包含一个架构图、其中结合了上述工作流步骤在系统中的运行位置。</block>
  <block id="cd1551a21e8c953f9daec26871057a76" category="list-text">在此示例中、我们将为之前创建的系统运行系统销毁工作流。我们在*系统视图*屏幕中选择系统、然后在*销毁进程*下启动系统销毁工作流。</block>
  <block id="d34819d82542a5e53e6821ec5e4db0e4" category="list-text">此处显示了配置阶段维护的所有挂载点、并在系统销毁工作流过程中删除这些挂载点。</block>
  <block id="b6d7ae1d25c1ed56190634cbcb9f9b20" category="inline-image-macro">此屏幕截图显示了销毁存储卷选项卡下的销毁系统屏幕、其中列出了所有挂载点。</block>
  <block id="c55590507c7a5987bf4a4f7b1d810243" category="paragraph">不会删除任何虚拟主机名、因为这些主机名通过DNS维护并已自动分配。</block>
  <block id="47667892836644d0cd83d17b4917dc35" category="inline-image-macro">此屏幕截图显示了"Delete Host Names"选项卡下的"Destroy System"屏幕。未列出任何主机名。</block>
  <block id="bbd7a36bba667209844b03f241994057" category="list-text">单击执行按钮可启动此操作。</block>
  <block id="99ed6ae4a60e41a6306ef4ca90f88b38" category="inline-image-macro">此屏幕截图显示了销毁存储卷摘要页面。</block>
  <block id="4ccc4170b3fa1543f818c336ac8fe5f3" category="paragraph">现在、SAP Lama会删除卷克隆并删除克隆系统的配置。</block>
  <block id="3c4c4cc2b32a212b8dfdcb531f7833dc" category="list-text">您可以在*监控*菜单下监控克隆工作流的进度。</block>
  <block id="048eec815017fa246a747d2da0febba7" category="inline-image-macro">此屏幕截图实时显示系统销毁工作流的进度。</block>
  <block id="2f0172893615db7f6217f8aea9f5d77c" category="list-text">通过选择*删除NetAppClone*任务、将显示该步骤的详细日志。此处显示了Ansible攻略手册的执行情况。如您所见、《Ansible攻略手册》<block ref="02f575c9a42953c46d6832e43305b6fd" prefix=" " category="inline-code"></block> 对每个HANA数据库卷、数据、日志和共享执行。</block>
  <block id="4354252a68eb4bbcfdd68b6514d4c26f" category="inline-image-macro">此屏幕截图显示了系统销毁工作流的日志页面。</block>
  <block id="b9b81059c0673276efc1c1e439881f55" category="summary">通过将Ansible等现代自动化框架集成到SAP Lama配置工作流中、客户可以灵活地使用解决方案 来满足标准或更复杂的基础架构要求。</block>
  <block id="6f8b794f3246b0c1e1780bb4d4d5dc53" category="doc">结论</block>
  <block id="261f5cfcc4c662ad4bdb40d9718a5735" category="list-text">NetApp命名空间中的集合</block>
  <block id="95b860ff1d3414d84c1d0dd66c71beb5" category="inline-link"><block ref="95b860ff1d3414d84c1d0dd66c71beb5" category="inline-link-rx"></block></block>
  <block id="c7d87c9780b4892d37181cf021e638e2" category="paragraph"><block ref="c7d87c9780b4892d37181cf021e638e2" category="inline-link-rx"></block></block>
  <block id="1371cf980b833fe3e01808264a214fa5" category="list-text">有关Ansible集成和示例Ansible攻略手册的文档</block>
  <block id="17d0c87f7f769c8ea7ac812812ebd6d5" category="inline-link"><block ref="17d0c87f7f769c8ea7ac812812ebd6d5" category="inline-link-rx"></block></block>
  <block id="854bcd8220ccda1e905303668e3793ab" category="paragraph"><block ref="854bcd8220ccda1e905303668e3793ab" category="inline-link-rx"></block></block>
  <block id="1bc1c7499928cd5f0942064dd37f54f2" category="list-text">Ansible与NetApp的全面集成</block>
  <block id="d7b64d94b2b9e3dbbe93b80934086220" category="inline-link"><block ref="d7b64d94b2b9e3dbbe93b80934086220" category="inline-link-rx"></block></block>
  <block id="a71e2ab189cc2e25539ceb7f9c4ced72" category="paragraph"><block ref="a71e2ab189cc2e25539ceb7f9c4ced72" category="inline-link-rx"></block></block>
  <block id="54ec5aa26742228ba1f9e4024c4d73ac" category="list-text">有关将SAP Lama与Ansible集成的博客</block>
  <block id="3da5f444c1b02ebe424e80c245333bf1" category="inline-link"><block ref="3da5f444c1b02ebe424e80c245333bf1" category="inline-link-rx"></block></block>
  <block id="b6a1e2104cef9312a7e1e31c53499350" category="paragraph"><block ref="b6a1e2104cef9312a7e1e31c53499350" category="inline-link-rx"></block></block>
  <block id="abf2ed748dab1316ba3962b6eacbe747" category="list-text">SAP Landscape Management 3.0企业版文档</block>
  <block id="137cdbd940ab5580ba6f97a90cdc49d7" category="inline-link"><block ref="137cdbd940ab5580ba6f97a90cdc49d7" category="inline-link-rx"></block></block>
  <block id="c9d90f3898ea1626d1c3a9a148fd4de1" category="paragraph"><block ref="c9d90f3898ea1626d1c3a9a148fd4de1" category="inline-link-rx"></block></block>
  <block id="2358274d65c1630d9cc77d20a679ca78" category="list-text">SAP Lama文档—提供商定义</block>
  <block id="aa594a5bd07b5bc43679c6743f5318cc" category="inline-link"><block ref="aa594a5bd07b5bc43679c6743f5318cc" category="inline-link-rx"></block></block>
  <block id="76ff1106df915feb26c63a2d10f8ed76" category="paragraph"><block ref="76ff1106df915feb26c63a2d10f8ed76" category="inline-link-rx"></block></block>
  <block id="cf584bec369b5b183362b23e3b48c171" category="list-text">SAP Lama文档—自定义挂钩</block>
  <block id="a449378b07182beacf1e06df0157fb1a" category="inline-link"><block ref="a449378b07182beacf1e06df0157fb1a" category="inline-link-rx"></block></block>
  <block id="29786d40f149d2b6bde83fc7b3b8d311" category="paragraph"><block ref="29786d40f149d2b6bde83fc7b3b8d311" category="inline-link-rx"></block></block>
  <block id="82f583fbca7e52c75cf724100fceeb87" category="list-text">SAP Lama文档—配置SAP Host Agent注册脚本</block>
  <block id="a42ebcc58d97420fee4c785861bdf4d3" category="inline-link"><block ref="a42ebcc58d97420fee4c785861bdf4d3" category="inline-link-rx"></block></block>
  <block id="b837152d68eb7f96b0f885c89e076a13" category="paragraph"><block ref="b837152d68eb7f96b0f885c89e076a13" category="inline-link-rx"></block></block>
  <block id="41bf842c374d0fd4ab82ce0e6079a372" category="list-text">SAP Lama文档—自定义操作和自定义挂钩的参数</block>
  <block id="ef2b3fe29f808573588186cae37d62c0" category="inline-link"><block ref="ef2b3fe29f808573588186cae37d62c0" category="inline-link-rx"></block></block>
  <block id="a8fc83992fa48ceb04a6dd0a40ec951e" category="paragraph"><block ref="a8fc83992fa48ceb04a6dd0a40ec951e" category="inline-link-rx"></block></block>
  <block id="ac28a244d6bbc68fc735b6d8e78c406f" category="list-text">SAP Lama文档—自适应设计</block>
  <block id="c3c9babca9a3c4755fc4fc97aab15698" category="inline-link"><block ref="c3c9babca9a3c4755fc4fc97aab15698" category="inline-link-rx"></block></block>
  <block id="062786b87b67b615196261414e684e55" category="paragraph"><block ref="062786b87b67b615196261414e684e55" category="inline-link-rx"></block></block>
  <block id="3cd8b5fe5ca94a9fdb5caaf96875ef7e" category="inline-link"><block ref="3cd8b5fe5ca94a9fdb5caaf96875ef7e" category="inline-link-rx"></block></block>
  <block id="6bfac05f3cc2c0adace9c385ef708fd9" category="paragraph"><block ref="6bfac05f3cc2c0adace9c385ef708fd9" category="inline-link-rx"></block></block>
  <block id="30216ab76baa66d9e857660c909822e7" category="summary">在本章中、我们将简要讨论系统克隆工作流和输入屏幕的不同之处。</block>
  <block id="50cca7f997c3211915cd57a3bb04b29c" category="doc">SAP Lama配置工作流—复制系统</block>
  <block id="072f81464e5d856a8d5a7f8883a36632" category="paragraph">下图突出显示了使用系统副本工作流执行的主要步骤。</block>
  <block id="01b76581a904a061a13aac9f12d95640" category="inline-image-macro">此图提供了系统副本工作流的时间表。其中包含存储克隆、准备系统、激活隔离、系统重命名、启动系统、导入配置、复制后自动化和停用系统。</block>
  <block id="266de5c670b51a2300bfff08eadf3f83" category="paragraph">在本章中、我们将简要讨论系统克隆工作流和输入屏幕的不同之处。如下图所示、存储工作流不会发生任何变化。</block>
  <block id="3f9896a740ccd028335e64982c037d5a" category="inline-image-macro">此图提供了一个架构图、其中包含多个叠加步骤、显示了工作流中每个步骤的执行位置。</block>
  <block id="c46bd11826f2315cf0610d409ffd537e" category="list-text">系统副本工作流可以在系统准备就绪后启动。这不是此配置的特定任务、我们也不会对此进行详细说明。如果您需要更多信息、请查看SAP Lama文档。</block>
  <block id="4233ffb48a1b0153e20c92c0f6c40e0c" category="inline-image-macro">此屏幕截图显示了"系统"选项卡下的"配置系统"视图。此时将列出两个系统、并且"Copy System"下拉列表已突出显示。</block>
  <block id="083716145cee33ff2046c406370b2405" category="list-text">在复制工作流期间、系统将根据第一个屏幕中的指定进行重命名。</block>
  <block id="bc347213ce1c3f1d2438267811473b15" category="inline-image-macro">此屏幕截图显示了复制系统页面、其中突出显示了系统ID和HANA SID框。</block>
  <block id="6c469dd99db5fe4f2cdd41a2240beab2" category="list-text">在工作流期间、您可以更改实例编号。</block>
  <block id="4deccc9f34577d008d9c3b2b0c99aec4" category="inline-image-macro">此屏幕截图显示了SAP实例编号选项卡、其中包含三个数据框。</block>
  <block id="7803f3d937daa0d08bcf01b401c1f147" category="admonition">更改实例编号尚未经过测试、可能需要在提供程序脚本中进行更改。</block>
  <block id="f5ad1b268b7a64d86910e1ae4182ef29" category="list-text">如上所述、*自定义克隆*屏幕与克隆工作流并无不同、如下所示。</block>
  <block id="d5dc66f7bd8c1011c81ddc3e66057ee0" category="inline-image-macro">此屏幕截图显示了复制系统页面、其中包含自定义克隆信息和操作参数。</block>
  <block id="54ca6a630ee4f94a5198fac13397bd58" category="list-text">如我们所述、其余输入掩码不会与标准有所偏差、我们不会在此处进一步介绍这些掩码。最后一个屏幕将显示摘要、现在可以开始执行。</block>
  <block id="e0543801e3151d1c0326270020101b9a" category="inline-image-macro">此屏幕截图显示了复制系统屏幕、其中包含基本信息和主机列表。右下角是"Execute"按钮。</block>
  <block id="e3ae308e52556fdb623ce663f313b439" category="paragraph">复制过程完成后、不会为自定义克隆过程启用目标实例。</block>
  <block id="f25336d3bf88cbd451a163c97ac17567" category="inline-image-macro">此屏幕截图显示了Lama Systems屏幕以及系统详细信息。</block>
  <block id="8da564d2ce3424e459494f5a0676b5fe" category="paragraph">在系统销毁过程中、必须手动采用预挂步骤、因为已设置限制并会阻止执行。</block>
  <block id="ccca928b2a7d8dd76d677eb328f1da6f" category="inline-image-macro">此屏幕截图显示了Lama Systems屏幕以及系统详细信息、并选中了Use Custom Processing Process复选框。</block>
  <block id="c4da05fb7cdd8766abc25fbafbea5a65" category="summary">在本文档中的示例部署和工作流执行期间、我们将使用以下提供程序配置文件、执行脚本和Ansible攻略手册。</block>
  <block id="d53d04a1ea080883183470ec02c16fdd" category="doc">提供程序脚本配置和Ansible攻略手册</block>
  <block id="f23e38be71134dd193343d810430ee13" category="admonition">示例脚本按原样提供、NetApp不支持。您可以通过电子邮件发送电子邮件至：mailto：ng-sapcc@netapp.com ng-sapcc@netapp.com^请求最新版本的脚本。</block>
  <block id="9feebf1712ffdf30142ff1038f2355ff" category="section-title">提供程序配置文件netapp_clone.conf</block>
  <block id="15d4f6de10e85918b52fcdf3fa78b2a5" category="paragraph">此时将按照中所述创建配置文件<block ref="840230e2b210400caa403b3aab40b668" category="inline-link-rx"></block>。此配置文件必须位于安装了SAP主机代理的Ansible控制节点上。</block>
  <block id="d0813c701ba6b269a96b838cf74abedc" category="paragraph">已配置的操作系统用户<block ref="24a29401ac4c9ae51f6da9510e56b6ab" prefix=" " category="inline-code"></block> 必须具有执行脚本和所调用的Ansible攻略手册的适当权限。您可以将脚本放置在通用脚本目录中。SAP Lama可以在调用脚本时提供多个参数。</block>
  <block id="a0104975cac3e4d943107b138472b95f" category="inline-link">SAP Lama文档</block>
  <block id="fe04f70c92d468b41a00ac721c2baa57" category="paragraph">除了自定义参数之外、<block ref="d4dd8a053b8921e0c97c9fad320ec6c2" prefix=" " category="inline-code"></block>，<block ref="5272e959f6dcee40a765dfc5b7c078e4" prefix=" " category="inline-code"></block>，<block ref="d4dd8a053b8921e0c97c9fad320ec6c2" prefix=" " category="inline-code"></block>，和<block ref="5272e959f6dcee40a765dfc5b7c078e4" prefix=" " category="inline-code"></block>、可以移交许多其他人、如中所示<block ref="7af1e5ad564c38fa8886e29ffc9fd522" category="inline-link-rx"></block>。</block>
  <block id="cf0f4d3b8cdc69ccc8949ccb49435a5a" category="section-title">提供程序脚本netapp_clone.sh</block>
  <block id="2ba17681023aebd89534577dad86560b" category="paragraph">提供程序脚本必须存储在中<block ref="7d2dc603b61f4a1874bc1ce662075b91" prefix=" " category="inline-code"></block> 在提供程序配置文件中进行配置。</block>
  <block id="03df896fc71cd516fdcf44aa699c4933" category="section-title">变量</block>
  <block id="bc01539c93d17a2b0f783e4f71b90e40" category="paragraph">以下变量在脚本中进行了硬编码、必须进行相应调整。</block>
  <block id="f6cd53bc6bdc52ffc68b4d7d70bd2983" category="list-text"><block ref="5c02ab368b8fc3928b534dac33254332" prefix="" category="inline-code"></block>&lt;hostname of netapp cluster&gt;</block>
  <block id="c2d8140083809cc5b28989c192c7583b" category="list-text"><block ref="e24726c77a4b5dec5edaf5bac725b89f" prefix="" category="inline-code"></block>&lt;SVM name where source system volumes are stored&gt;</block>
  <block id="05b0a54c6c43fd11d9f8332bcfff94aa" category="inline-link">NetApp Ansible模块—准备ONTAP</block>
  <block id="0438110aaa77dc44bccb1ddfe89b0d28" category="paragraph">证书文件<block ref="5697de2afb62d59b2877f2a7351ecff8" prefix=" " category="inline-code"></block> 和<block ref="03af5d39699563e8a0e5f65d820a4f9c" prefix=" " category="inline-code"></block> 必须按照中所述提供<block ref="3af2b6d20ca12a9d04bef18f3151e29e" category="inline-link-rx"></block>。</block>
  <block id="9ab689b3746aba13d2b0d80a43a23582" category="admonition">如果不同的SAP系统需要不同的集群或SVM、则可以在SAP Lama提供程序定义中将这些变量作为参数添加。</block>
  <block id="18d821c99fe3d5876a94747ea97ee786" category="section-title">功能：创建清单文件</block>
  <block id="8bd40edd8c06fc2cce652993a0e9b88e" category="paragraph">要使Ansible攻略手册的执行更具动态性、请使用<block ref="5041a4494e62ffcb13cfe23041ebc270" prefix=" " category="inline-code"></block> 文件会即时创建。在变量部分中配置了一些静态值、而在执行期间动态创建了一些静态值。</block>
  <block id="576eb476f089a96bcd4354951241757b" category="section-title">功能：运行Ansible攻略手册</block>
  <block id="ce8914401ecb3769fce4ddc4e1ced2e8" category="paragraph">此功能用于将Ansible攻略手册与动态创建的一起执行<block ref="d28e452e49fc926f32af1d87afcff3ce" prefix=" " category="inline-code"></block> 文件攻略手册的命名约定为<block ref="a6d1d971f71d0033c54dd886792835e2" prefix=" " category="inline-code"></block>。的值<block ref="11f852efb3bc8ae7dac506ad959a0820" prefix=" " category="inline-code"></block> 依赖于Lama操作、并由Lama作为命令行参数进行移交。</block>
  <block id="bd5cc661e59e91681d4af8d42f266b60" category="section-title">主部分</block>
  <block id="8008be4d646729fc2b2eacc341248378" category="paragraph">本节包含主要执行计划。变量<block ref="11f852efb3bc8ae7dac506ad959a0820" prefix=" " category="inline-code"></block> 包含Lama替换步骤的名称、由Lama在调用该脚本时提供。</block>
  <block id="ee18f05f19fdfaeb9188e25812655d93" category="list-text">系统克隆和系统副本配置工作流的值：</block>
  <block id="5bc5a2b2e92b316952f792fccde81bfc" category="list-text">克隆卷</block>
  <block id="fa4194159c5a4ad6ef8927aa7d748906" category="list-text">PostCloneVolumes</block>
  <block id="924718ea3d11b3fab6f774ae0dc5d993" category="list-text">系统销毁工作流的价值：</block>
  <block id="2b566d405e2ccbecac2cf005770047cb" category="list-text">ServiceConfigRemoval</block>
  <block id="65c7a43c3cc81a55199e705b073e6c04" category="list-text">系统刷新工作流的价值：</block>
  <block id="ddb34f7875ee414d57c52d7f6b1532c0" category="list-text">ClearMountConfig</block>
  <block id="b7a8d056647cd4547e218c04d0f035da" category="section-title">HookOperationName =克隆卷</block>
  <block id="d84f8c0ddcc3d73f02cf17eccbacb6e2" category="paragraph">执行此步骤后、将执行Ansible攻略手册、从而触发Snapshot副本和克隆操作。卷名称和挂载配置由SAP Lama通过变量中定义的XML文件传递<block ref="e0a24edf8af93d34591b84a3ba4c60ca" prefix=" " category="inline-code"></block>。此文件已保存、因为此文件将在步骤的稍后部分使用<block ref="de1ba36294d8c3bc57e5d9df81711f9e" prefix=" " category="inline-code"></block> 以创建新的挂载点配置。卷名称将从XML文件中提取、并对每个卷执行Ansible克隆攻略手册。</block>
  <block id="c80bb2258a3a0e1a34ad0ba8971ad5d7" category="admonition">在此示例中、作为实例和中央服务共享同一个卷。因此、只有在使用SAP实例编号时才会执行卷克隆 <block ref="14ba4a6ef0dc47790ff7704515344fff" prefix="(" category="inline-code"></block>)不是<block ref="96a3be3cf272e017046d1b2674a52bd3" prefix=" " category="inline-code"></block>。在其他环境中、这可能有所不同、必须相应地进行更改。</block>
  <block id="ef6e9f1dd886e5d5363a05e4d08cecc6" category="section-title">HookOperationName = PostCloneVolumes</block>
  <block id="223edcc0773a44e4b34959031a80f42f" category="paragraph">在此步骤中、将显示自定义属性<block ref="58df34e81d3ebd3108d3cd89e9ed8c5d" prefix=" " category="inline-code"></block> 和<block ref="8f2c6579709285c9a24c1233a19b7518" prefix=" " category="inline-code"></block> 并维护目标系统的挂载点配置。</block>
  <block id="7ade54baca7712e1446f7644e2b63881" category="paragraph">在期间停用系统时、自定义属性稍后会用作输入<block ref="2b566d405e2ccbecac2cf005770047cb" prefix=" " category="inline-code"></block> 或<block ref="ddb34f7875ee414d57c52d7f6b1532c0" prefix=" " category="inline-code"></block> 阶段。系统用于保留在系统配置工作流期间指定的自定义参数设置。</block>
  <block id="f6e52e9107b3ac6aa07d820f3587c7e7" category="paragraph">此示例中使用的值为<block ref="bdb47fed0d313262c9d3c7d41c894201" prefix=" " category="inline-code"></block> 和<block ref="85e7e9424d29538746c1b1b2cbb86003" prefix=" " category="inline-code"></block>。</block>
  <block id="7beba9ba634960c6d652b856b7fa9af7" category="paragraph">卷<block ref="feb928da308850091372edc73ab231a4" prefix=" " category="inline-code"></block>、动态创建的Ansible文件包括以下值：<block ref="74570c0ba8bed87fb108923b85e1c86e" prefix=" " category="inline-code"></block>：<block ref="feb928da308850091372edc73ab231a4" prefix=" " category="inline-code"></block>，<block ref="ab8c0f3f510441dfbf6832e5c66506cb" prefix=" " category="inline-code"></block>，和<block ref="404f3f40c3094f27edaf2e379e807d19" prefix=" " category="inline-code"></block>。</block>
  <block id="39637c1bfac2481530e7f976d2404f57" category="paragraph">这将导致卷HN9_SAP上的快照名称<block ref="a929b360dff8b79736d40929f007faec" prefix=" " category="inline-code"></block> 以及创建的卷克隆名称<block ref="2f11b298ad59bd8dfd88c2aadbbf81e8" prefix=" " category="inline-code"></block>。</block>
  <block id="b199cb39ab8949193c27458fe7923308" category="admonition">可以使用任何自定义属性来保留配置过程中使用的参数。</block>
  <block id="17b57d511dca01dac6e1f3d0eea8591e" category="inline-link">SAP注释1889590</block>
  <block id="37bfe2d6c630cd8dce994786cedb88f1" category="paragraph">挂载点配置将从中的Lama移交的XML文件中提取<block ref="c76dd551d0df4615489f4840c234db4e" prefix=" " category="inline-code"></block> 步骤。。<block ref="58df34e81d3ebd3108d3cd89e9ed8c5d" prefix=" " category="inline-code"></block> 添加到卷名称中、并通过默认脚本输出发送回Lama。中介绍了此功能<block ref="f917bd775336e1bab012a560d990f292" category="inline-link-rx"></block>。</block>
  <block id="96552086a9a139af05ca83c2b608b1f5" category="admonition">在此示例中、存储系统上的qtree是在单个卷上放置不同数据的常用方法。例如：<block ref="feb928da308850091372edc73ab231a4" prefix=" " category="inline-code"></block> 保存的挂载点<block ref="602440fe8fe65977e9574638f9a2c511" prefix=" " category="inline-code"></block>，<block ref="10fba32c279114a49cdfd03372e1e02e" prefix=" " category="inline-code"></block>，和<block ref="238092ea5275b74b281dd99d812a95eb" prefix=" " category="inline-code"></block>。子目录的工作方式相同。在其他环境中、这可能有所不同、必须相应地进行更改。</block>
  <block id="346a028f600790fffe377b01a2b9981c" category="section-title">HookOperationName = ServiceConfigRemoval</block>
  <block id="53a8b34c26f167a4b06e6eec25b55427" category="paragraph">在此步骤中、负责删除卷克隆的Ansible攻略手册正在运行。</block>
  <block id="5ac066717b22e8c02f8bffb6a8ddcd96" category="paragraph">卷名称由SAP Lama通过挂载配置文件和自定义属性进行传递<block ref="58df34e81d3ebd3108d3cd89e9ed8c5d" prefix=" " category="inline-code"></block> 和<block ref="8f2c6579709285c9a24c1233a19b7518" prefix=" " category="inline-code"></block> 用于传递系统配置工作流期间最初指定的参数值(请参见上的注释<block ref="ef6e9f1dd886e5d5363a05e4d08cecc6" prefix=" " category="inline-code"></block>）。</block>
  <block id="e8065accf11ce1a2b63e42eec427fd63" category="paragraph">卷名称将从xml文件中提取、并对每个卷执行Ansible克隆攻略手册。</block>
  <block id="81ad9d04ab6444acadad9192d00a12c0" category="admonition">在此示例中、作为实例和中央服务共享同一个卷。因此、只有在使用SAP实例编号时才会执行卷删除 <block ref="14ba4a6ef0dc47790ff7704515344fff" prefix="(" category="inline-code"></block>)不是<block ref="96a3be3cf272e017046d1b2674a52bd3" prefix=" " category="inline-code"></block>。在其他环境中、这可能有所不同、必须相应地进行更改。</block>
  <block id="92f6f8cba070fb9e27767dd5551e768b" category="section-title">HookOperationName = ClearMountConfig</block>
  <block id="4a4f44bf22d06f8fafafadd3fd090a90" category="paragraph">在此步骤中、负责在系统刷新工作流期间删除卷克隆的Ansible攻略手册正在运行。</block>
  <block id="d58b54d2e52ca8489cc7248ba854ae21" category="paragraph">卷名称由SAP Lama通过挂载配置文件和自定义属性进行传递<block ref="58df34e81d3ebd3108d3cd89e9ed8c5d" prefix=" " category="inline-code"></block> 和<block ref="8f2c6579709285c9a24c1233a19b7518" prefix=" " category="inline-code"></block> 用于传递系统配置工作流期间最初指定的参数值。</block>
  <block id="8886a6fe82aff5197d15c38da5b592fd" category="paragraph">卷名称将从XML文件中提取、并对每个卷执行Ansible克隆攻略手册。</block>
  <block id="8d58923ab8b9151914bc816648b0875d" category="admonition">在此示例中、作为实例和中央服务共享同一个卷。因此、只有在使用SAP实例编号时才会执行卷删除 <block ref="14ba4a6ef0dc47790ff7704515344fff" prefix="(" category="inline-code"></block>)不是<block ref="96a3be3cf272e017046d1b2674a52bd3" prefix=" " category="inline-code"></block>。在其他环境中、这可能有所不同、必须相应地进行更改。</block>
  <block id="1943d0253ccc5d45e36df0227dd4793e" category="section-title">Ansible攻略手册NetApp_Lam_CloneVolumes.yml</block>
  <block id="d370af02588316b01d589655a107cbbc" category="inline-link">NetApp Ansible模块—YAML文件</block>
  <block id="06a69040885f67ea75f8c71bd26cdfdf" category="paragraph">在Lama系统克隆工作流的CloneVolumes步骤中执行的攻略手册是的组合<block ref="3e3c61f048949537d0dfdcc5a1db6ce2" prefix=" " category="inline-code"></block> 和<block ref="bf70df0c372967b21792d4176664f064" prefix=" " category="inline-code"></block> (请参见<block ref="ae5d962151a417d9f49d9333a90e0f3c" category="inline-link-rx"></block>）。本攻略手册可轻松扩展、以涵盖从二级克隆操作和克隆拆分操作等其他使用情形。</block>
  <block id="455e5b157968d37a4203a9f3779b384a" category="section-title">Ansible攻略手册NetApp_Lam_ServiceConfigRemove.yml</block>
  <block id="ce2acc94df9bd91ff47fc72ecf404031" category="paragraph">在中执行的攻略手册<block ref="2b566d405e2ccbecac2cf005770047cb" prefix=" " category="inline-code"></block> Lama系统销毁工作流的阶段是的组合<block ref="35dd0b5421b741dfd4e373d5f4d1e4d1" prefix=" " category="inline-code"></block> 和<block ref="8e983ebe58c49099839bfd3bb1b83f41" prefix=" " category="inline-code"></block> (请参见<block ref="ae5d962151a417d9f49d9333a90e0f3c" category="inline-link-rx"></block>）。它必须与的执行步骤一致<block ref="1f06042fc02f2e855ea461c7817d81a4" prefix=" " category="inline-code"></block> 攻略手册。</block>
  <block id="bd68c303edefacbfbb91261b59a4e9ac" category="section-title">Ansible攻略手册NetApp_Lama _ClearMountConfig.yml</block>
  <block id="ff0f6a8ce2fcd64cebec6e1d9151cfce" category="paragraph">攻略手册、在中执行<block ref="219f5b01b91b2ed6147264d0df5f9c07" prefix=" " category="inline-code"></block> Lama系统刷新工作流的阶段是的组合<block ref="35dd0b5421b741dfd4e373d5f4d1e4d1" prefix=" " category="inline-code"></block> 和<block ref="8e983ebe58c49099839bfd3bb1b83f41" prefix=" " category="inline-code"></block> (请参见<block ref="ae5d962151a417d9f49d9333a90e0f3c" category="inline-link-rx"></block>）。它必须与的执行步骤一致<block ref="1f06042fc02f2e855ea461c7817d81a4" prefix=" " category="inline-code"></block> 攻略手册。</block>
  <block id="85e6de7723c608b48d8483e8f080d82e" category="section-title">Ansible inventory.yml示例</block>
  <block id="13618afb34e29ee98ce78d61d6dd1f2c" category="paragraph">此清单文件是在工作流执行期间动态构建的、此处仅显示用于说明。</block>
  <block id="b606dabc2c3e184086b564adb1940f56" category="doc">SAP系统克隆、复制和刷新场景</block>
  <block id="3e2c20ce79434cedb498fc7527d30dbe" category="paragraph">术语SAP系统副本通常用作三个不同流程的同义词：SAP系统克隆、SAP系统副本或SAP系统刷新。请务必区分不同的操作、因为每个操作的工作流和用例都不同。</block>
  <block id="43767cf21d4b8f31f9dcdee8e59adb69" category="paragraph">下图说明了在执行系统克隆、系统副本或系统刷新操作期间必须执行的主要步骤。紫色框表示可集成NetApp存储功能的步骤。所有这三项操作均可通过SAP Lama实现完全自动化。</block>
  <block id="596b75e644e7872d4337d48a315dd53d" category="inline-image-macro">此图分别描绘了系统克隆、系统副本和系统刷新的三个流程时间表。</block>
  <block id="10f22ce6f0d2560d2593dccd1c7a2cac" category="summary">SAP Landscape Management (Lama)支持SAP系统管理员自动执行SAP系统操作、包括端到端SAP系统克隆、复制和刷新操作。</block>
  <block id="f0e2318cd32c61c7c602d5745e21791b" category="doc">TR-4953：《使用Ansible实现NetApp SAP Landscape Management集成》</block>
  <block id="f130ce1e1c7d90310044ef7daf088f2e" category="paragraph">NetApp提供了一组丰富的Ansible模块、SAP Lama可以通过SAP Lama Automation Studio访问NetApp Snapshot和FlexClone等技术。这些技术有助于简化和加速SAP系统克隆、复制和刷新操作。</block>
  <block id="d2c4fa04492deec7383fc3a48fb61fcc" category="paragraph">在内部运行NetApp存储解决方案的客户或在Amazon Web Services、Microsoft Azure或Google Cloud Platform等公共云提供商中使用NetApp存储服务的客户均可使用此集成。</block>
  <block id="e95a257ceffab9c7ca49cb69ae38d9d7" category="paragraph">本文档介绍了如何为SAP Lama配置NetApp存储功能、以便使用Ansible自动化执行SAP系统复制、克隆和刷新操作。</block>
  <block id="1549d8a91814eafffd1bb350b7956ad9" category="summary">在刷新工作流期间、必须删除存储克隆。您可以使用与系统销毁工作流相同的Ansible攻略手册。但是、自定义挂锁的定义步骤与此不同、因此攻略手册的名称也相应。克隆的过程步骤也不会有所不同。</block>
  <block id="7949afbae2a9d5fd15f7b4c7f7a05fa4" category="doc">SAP Lama配置工作流—系统刷新</block>
  <block id="7f4f2ac27cfdf79058d0e50de2e9742d" category="paragraph">下图突出显示了使用系统刷新工作流执行的主要步骤。</block>
  <block id="481edeab724446585cba31c21c5c303b" category="inline-image-macro">此图显示了系统刷新工作流中各个步骤的时间线。它包含导出配置、停止系统、取消准备系统、删除存储克隆、存储克隆、准备系统、激活隔离、系统重命名、启动系统、导入配置、复制后自动化以及停用隔离。</block>
  <block id="271d28463c63d7fd4374acd04ad1d970" category="paragraph">在刷新工作流期间、必须删除存储克隆。您可以使用与系统销毁工作流相同的Ansible攻略手册。但是、自定义挂锁的定义步骤与此不同、因此攻略手册的名称也相应。克隆的n´t步骤与此不同。</block>
  <block id="9e5091c63ff2962a881841af91e2823c" category="inline-image-macro">此图显示了一个架构图、其中包括此工作流中包含的步骤。</block>
  <block id="d1a447a92da11b77de2544fbcfe43acf" category="paragraph">刷新工作流可以通过复制的系统的配置屏幕触发。</block>
  <block id="5d395370196d6d4e376fe46b17b57d79" category="inline-image-macro">此屏幕截图显示了配置系统视图、并突出显示了刷新系统下拉列表。</block>
  <block id="8cfad5ce51e7271ce19cce7c6b114c91" category="paragraph">同样、输入屏幕与标准屏幕没有任何不同、可以从摘要屏幕开始执行工作流。</block>
  <block id="29fc636c559035fd7df8a518d41d0ce2" category="inline-image-macro">此屏幕截图显示了刷新系统屏幕、包括要刷新的系统的基本数据以及目标系统的主机选择。</block>
  <block id="3174e9fa49f311c5e00e12e71a3b5b98" category="summary">由于系统和存储设置具有大量可用选项、因此应使用示例实施作为您的各个系统设置和配置要求的模板。</block>
  <block id="22b2b5c6aa3ef83ba384074fa4b1f70b" category="doc">实施示例</block>
  <block id="218856d6f0f5481bf616ccd68aa42cba" category="section-title">经验证的配置和限制</block>
  <block id="ead08ec5c8fd39a74fa185810bb7521e" category="paragraph">以下原则适用于示例实施、可能需要进行调整以满足客户需求：</block>
  <block id="da30655d4bed2647c2fec11ec1ee095a" category="list-text">受管SAP系统使用NFS访问NetApp存储卷、并根据自适应设计原则进行设置。</block>
  <block id="a606bd07766c70874c1247221e4b6920" category="list-text">您可以使用NetApp Ansible模块(ZAPI和REST API)支持的所有ONTAP 版本。</block>
  <block id="8a13407d32dabdb45cd5b99a37d3658d" category="list-text">单个NetApp集群和SVM的凭据在提供程序脚本中硬编码为变量。</block>
  <block id="62479efe2da12c69ae8fead43ad2a41c" category="list-text">存储克隆是在源SAP系统使用的同一存储系统上执行的。</block>
  <block id="2822fed36861cecbea9530e16c3dc549" category="list-text">目标SAP系统的存储卷与附录中的源卷名称相同。</block>
  <block id="45d18080d1d1501f967a6234b8e9c807" category="list-text">未在二级存储(SV/SM)上实施克隆。</block>
  <block id="a2c82d2d1a8c3fa26f5d24f153350b67" category="list-text">未实施FlexClone拆分。</block>
  <block id="295940074fec313c1941e256113f0e88" category="list-text">源SAP系统和目标SAP系统的实例编号相同。</block>
  <block id="92b9b9bba1ad0383940e73178d2d2b1f" category="inline-link">自适应设计</block>
  <block id="694793abedab052f0f8fe31c7ed5d468" category="inline-link">适用于NetApp ONTAP 的Ansible攻略手册</block>
  <block id="e3f6982f9a27e912e8c722adde3efd24" category="paragraph">下图显示了我们使用的实验室设置。用于系统克隆操作的源SAP系统HN9由数据库H09、SAP CS和SAP作为服务运行在安装了的同一主机(sap-lnx32)上<block ref="0f7e6b0bf7b6b1239b509159ab784efd" category="inline-link-rx"></block> 已启用。根据准备了一个Ansible控制节点<block ref="2b2330f758d35be084c542c192f2a4aa" category="inline-link-rx"></block> 文档。</block>
  <block id="440bd2077d1dc4268b805695e517765a" category="inline-link-macro">"附录：提供程序脚本配置。"</block>
  <block id="b66c6a3a7edc45e35e3ddf6c05273c2e" category="paragraph">主机<block ref="0e4bb0c252ec92e9686dfba6c8df0076" prefix=" " category="inline-code"></block> 用作SAP Lama克隆操作的目标、并在此配置了隔离就绪功能。</block>
  <block id="83b45fa496284bbb2f02b9bded901b86" category="paragraph">系统复制和刷新操作使用不同的SAP系统(HNA作为源、HN2作为目标)、因为在该系统上启用了后复制自动化(PCA)。</block>
  <block id="dfa47107ed64e58579a060d20cca230a" category="inline-image-macro">此图展示了各种SAP主机代理以及它们如何通过NFS挂载与NetApp存储进行交互。此外、还会显示SAP Lama实例。</block>
  <block id="9d50189ad22fa1f80dd4993b241fa520" category="paragraph">实验室设置中使用了以下软件版本：</block>
  <block id="b4cd99983baacefc54875fd2de6c03d4" category="list-text">SAP LaMa Enterprise Edition 3.00 SP23_2</block>
  <block id="7bdc9b8c3e894f5a2369e5c3b8a133e4" category="list-text">SAP HANA 2.00.052.00.1599235305</block>
  <block id="d550cc442fbc5ea03e42ba86d0cfeb03" category="list-text">SAP 7.77修补程序27 (S/4 HANA 1909)</block>
  <block id="f6297e2394a4dfe959fc0dace04882a1" category="list-text">SAP Host Agent 7.22修补程序56</block>
  <block id="780c1fbb148682140e46cccca790b4ff" category="list-text">SAPCACEXT 7.22修补程序69</block>
  <block id="bded4cce06ec88cd16a823fa44159118" category="list-text">Linux SLES 15 SP2</block>
  <block id="8271f798ae4ae5f28efaa3a9eaf06233" category="list-text">Ansible 2.13.7.</block>
  <block id="4b0373c99a4c85c6b0f82b56d8c42730" category="list-text">NetApp ONTAP 9.8P8</block>
  <block id="70cc2142e75ab6a0289b10c66ef4448a" category="section-title">SAP Lama配置</block>
  <block id="97604b3e0820bd1474b9e6fae5edb42d" category="section-title">SAP Lama提供程序定义</block>
  <block id="cdde8d4b44ba034030a4e67f7cd1355c" category="paragraph">提供程序定义在SAP LaMa的Automation Studio中执行、如以下屏幕截图所示。示例实施使用一个提供程序定义、该定义用于不同的自定义配置步骤和操作挂钩、如前面所述。</block>
  <block id="1746e76929a022aece9b6dfb14dae7f4" category="inline-image-macro">SAP Lama图形用户界面中的SAP提供程序定义的屏幕截图。</block>
  <block id="4f341f0e5eb3b1f46991cea35272fcf1" category="paragraph">提供程序<block ref="f66a8619ee48b9a9e3c50bb78492093d" prefix=" " category="inline-code"></block> 定义为脚本<block ref="e43ee3b6f349861a2a2c82d22b32d52e" prefix=" " category="inline-code"></block> 已在SAP主机代理上注册。SAP主机代理在中央主机上运行<block ref="b364ceeb78cb4529181c9ca2c288a0f4" prefix=" " category="inline-code"></block>、也充当Ansible控制节点。</block>
  <block id="64435bf2455f95dd405db3790145406d" category="inline-image-macro">常规选项卡下名为netapp_clone的单个提供程序定义的屏幕截图。显示了摘要部分、已用部分和选项部分。</block>
  <block id="0534b8ad7bf71ef8b710dad564e0cd7a" category="paragraph">*已用英寸*选项卡显示了此提供程序用于哪些自定义操作。以下章节将显示自定义配置* NetApp克隆*和自定义挂钩*删除NetApp克隆*和*删除NetApp克隆刷新*的配置。</block>
  <block id="a340f1bceb05f0cd1b147b9f672ba8d2" category="inline-image-macro">Used-In部分的屏幕截图、其中列出了使用此定义的自定义操作。在此示例中、我们将看到删除NetAppClone、删除NetAppClone刷新和NetApp克隆。</block>
  <block id="7a0ae7f1897ba065a4175f0a031d40ca" category="paragraph">在执行配置工作流期间会请求参数*克隆后修复*和* Snap后 修复*、这些参数用于Snapshot和FlexClone卷名称。</block>
  <block id="e9f68f9346bf37c4d5361a06a77f7922" category="inline-image-macro">"Parameters"部分的屏幕截图、其中列出了两个参数：CLonePostFix"和SnapPostFix"。</block>
  <block id="f75575994c2d652cc4c91f3475946ddd" category="section-title">SAP Lama自定义配置</block>
  <block id="71f3f2d0ca1eb7593b6ccbae27d47630" category="paragraph">在SAP Lama自定义配置中、使用前面所述的客户提供程序替换配置工作流步骤*克隆卷*和*后克隆卷*。</block>
  <block id="9f86a21de7693c92ea6e20ccf4b6bfed" category="inline-image-macro">自定义配置配置屏幕的屏幕截图。列出了进程CloneVolumes和FinalizeCloneVolumes。</block>
  <block id="9e1240b3666e6094668a9e44b93b1aaf" category="section-title">SAP Lama自定义挂钩</block>
  <block id="fc234b36f71d0a48d49f813690e499d5" category="paragraph">如果使用系统销毁工作流删除系统、则会使用hook *删除NetAppClone*调用提供程序定义<block ref="f66a8619ee48b9a9e3c50bb78492093d" prefix=" " category="inline-code"></block>。系统刷新工作流期间会使用*删除NetApp克隆刷新*挂钩、因为执行期间会保留此实例。</block>
  <block id="1214fb9ed85a47de9908cb172d861fb9" category="inline-image-macro">"Custom Hooks"屏幕的屏幕截图、其中包含自定义Hooks Delete NetAppClone Refresh和Delete NetAppClone。</block>
  <block id="0c3cf1c76c18bb4fefa6e023a411ffc4" category="paragraph">请务必为自定义挂钩配置*使用挂载数据XML*、以便SAP Lama向提供程序提供挂载点配置的信息。</block>
  <block id="98f4e317bbaa784645b3288ba01b74c6" category="paragraph">为了确保只有在使用自定义配置工作流创建系统时才使用和执行自定义挂钩、系统中会添加以下限制。</block>
  <block id="ec60f21e7cd865823a756b683438922a" category="inline-image-macro">"Delete NetAppClone Constrains"页面的屏幕截图。包含一个称为自定义克隆进程名称(静态)的限制。</block>
  <block id="251b0d3699e5721f1881283a4fca406a" category="paragraph">有关使用自定义挂钩的详细信息、请参见<block ref="cccebfd04b7323b5c9d595ca9e1a8202" category="inline-link-rx"></block>。</block>
  <block id="8e28a1dc58486d267cf25af39d6a11e6" category="section-title">为SAP源系统启用自定义配置工作流</block>
  <block id="113da349476dc9377bcc12b4a0257c93" category="paragraph">要为源系统启用自定义配置工作流、必须在配置中对其进行调整。必须选中具有相应自定义配置定义的*使用自定义配置过程*复选框。</block>
  <block id="9d9c41126d52bd5f1a379e53bd0752f3" category="summary">在本节中、我们将根据采用HANA数据库H09的源SAP系统HN9完成完整的SAP Lama系统克隆工作流。下图概述了工作流期间执行的步骤。</block>
  <block id="2080b046fbab316052bf3cd004fba2c1" category="doc">SAP Lama配置工作流—克隆系统</block>
  <block id="f928bd8b1ecd05387cc712d7a46bf18c" category="paragraph">下图突出显示了使用系统克隆工作流执行的主要步骤。</block>
  <block id="f796aa70006aac29ee5eb4b2ed23ba95" category="inline-image-macro">包含存储克隆、准备系统、激活隔离和启动系统步骤的工作流图。</block>
  <block id="fdf5d8e6fccfdfce632b92c3e93acaf7" category="inline-image-macro">此图显示了工作流期间执行的步骤、包括创建克隆系统配置、创建存储快照和克隆、创建挂载点配置、设置自定义属性以及准备和启动系统。</block>
  <block id="bcda724368fccf9bf6be920fc775e707" category="list-text">要启动克隆工作流、请打开菜单树中的*配置*、然后选择源系统(在我们的示例HN9中)。然后启动*克隆系统*向导。</block>
  <block id="320b2524f93a492ce1312bd5ae04746a" category="inline-image-macro">此屏幕截图显示了配置系统视图。它包含两个系统。</block>
  <block id="26f307d1b32126e9ef74d6d94d34593a" category="list-text">输入请求的值。向导的屏幕1会要求您输入克隆系统的池名称。此步骤指定要启动克隆系统的实例(虚拟或物理)。默认情况下、将系统克隆到与目标系统相同的池中。</block>
  <block id="28e2a407caa32a2e6d85a365fc6137ee" category="inline-image-macro">克隆系统向导屏幕1用于提供目标系统的基本数据。</block>
  <block id="93097e472af50d9306626ab3c2ad088c" category="list-text">此向导的屏幕2会询问启动新SAP实例的目标主机。可以从上一屏幕指定的主机池中选择此实例的目标主机。每个实例或服务都可以在不同的主机上启动。在我们的示例中、所有这三个服务都在同一主机上运行。</block>
  <block id="d45437922cbadac03e555f9396029c52" category="inline-image-macro">克隆系统向导屏幕2提供了目标系统的主机选择。</block>
  <block id="dbbb3c208933ad8e73912e8b71c8cfe9" category="list-text">在屏幕3中提供所需的信息、该屏幕要求提供虚拟主机名和网络。通常、主机名会保留在DNS中、因此IP地址会相应地预先填充。</block>
  <block id="1e0378f2db383a2474acde3e5f6c08c4" category="inline-image-macro">通过克隆系统向导屏幕3、您可以提供虚拟主机名和网络。</block>
  <block id="45f39a262ef1deb0ae56818de7b8012c" category="list-text">在屏幕4中、将列出自定义克隆操作。提供了克隆和* SnapPostfix*名称、这些名称将在FlexClone卷和Snapshot名称的存储克隆操作期间使用。如果将这些字段留空、则为在提供程序脚本的变量部分中配置的默认值<block ref="e43ee3b6f349861a2a2c82d22b32d52e" prefix=" " category="inline-code"></block> 已使用。</block>
  <block id="9dd8edfbceb76bf22d88c7fd9447943b" category="inline-image-macro">在克隆系统向导屏幕4中、自定义克隆选项与操作参数均列出。</block>
  <block id="0eca4f9874b4bf56a3688acd75704009" category="list-text">在屏幕5中、已选择数据库一致性选项。在本示例中、我们选择了*联机：克隆运行DB*。</block>
  <block id="31680669fa3034c6e5659a85a5154f00" category="inline-image-macro">在克隆系统向导屏幕5中、列出了数据库一致性选项、并选择了联机：克隆运行数据库。</block>
  <block id="625f6568780e6e1c8d04b941df9248ef" category="list-text">在屏幕6中、只有在执行租户克隆时才需要输入。</block>
  <block id="47abcfee5b22144e9b3b60e685c63dc6" category="inline-image-macro">在克隆系统向导屏幕6中、如果要执行租户克隆、您可以提供用户名和密码。</block>
  <block id="64606b6bd8cb0c32c15e338b0756702c" category="list-text">在屏幕7中、可以配置系统隔离。</block>
  <block id="31d6011ed5b7611543fb146a48f8b7ec" category="inline-image-macro">在克隆系统向导屏幕7中、您可以定义允许的传出连接以进行系统隔离。</block>
  <block id="d5be567f5a60baa8d0255d467375bfb9" category="list-text">在屏幕8中、摘要页面包含启动工作流之前进行最终确认的所有设置。单击*执行*以启动工作流。</block>
  <block id="632b59e47eba1c14746c6f4bb3c38289" category="inline-image-macro">克隆系统向导屏幕8提供了所输入信息的摘要。</block>
  <block id="93cefbf94e2762da32c6ca08f9ea4841" category="paragraph">现在、SAP Lama将执行配置中指示的所有操作。这些操作包括创建存储卷克隆和导出、将其挂载到目标主机、添加用于隔离的防火墙规则以及启动HANA数据库和SAP服务。</block>
  <block id="e214579b1ef23c2afaf6095e9e34f58f" category="inline-image-macro">此屏幕截图显示了系统克隆过程的"监控"屏幕。</block>
  <block id="c2cc1ea5bc6c9297f5c6cb7ff1096618" category="paragraph">在详细日志中、操作*克隆卷*和*修改挂载点并添加自定义属性*将在Ansible节点上执行<block ref="b364ceeb78cb4529181c9ca2c288a0f4" prefix=" " category="inline-code"></block> 主机。这些步骤会对每个服务、HANA数据库、SAP中央服务和SAP即服务执行。</block>
  <block id="3df6b54174cd2a42f59a8dbd7cbc813a" category="inline-image-macro">此屏幕截图显示了系统克隆屏幕、其中显示了详细日志中描述的各种操作。</block>
  <block id="f63912439c7fa06d095f53e9e3e4b864" category="list-text">通过选择*克隆卷*任务、将显示该步骤的详细日志、并显示Ansible攻略手册的执行情况。您可以看到、Ansible攻略手册<block ref="c9a20dd023079737355442f70666f77f" prefix=" " category="inline-code"></block> 对每个HANA数据库卷、数据、日志和共享执行。</block>
  <block id="ca31c500f57ebe381bd2273516bebe25" category="inline-image-macro">此屏幕显示了详细介绍卷克隆的日志。</block>
  <block id="857f308602f7ba1d17c9bcd529db65a0" category="list-text">在*修改挂载点并添加自定义属性*步骤的详细信息视图中、您可以找到有关挂载点以及执行脚本移交的自定义属性的信息。</block>
  <block id="b030ac3d8ad8890898d0e771a32c477b" category="inline-image-macro">更多日志信息</block>
  <block id="22bfd63c8b4d3df02dbc6b174c65b0f1" category="paragraph">工作流完成后、克隆的SAP系统即已准备就绪、已启动并可供使用。</block>
  <block id="ac8a75fedf05fbee71814a271251285f" category="summary">此集成方法将SAP Lama自定义配置和操作挂钩与Ansible攻略手册结合使用、用于NetApp存储管理。下图简要概述了Lama端的配置以及示例实施的相应组件。</block>
  <block id="3a05a4cf01114d4fe10b4485ddee4278" category="doc">使用Ansible实现NetApp SAP Lama集成</block>
  <block id="198b2bd9b00943bcedf9ecdd177e1c38" category="inline-image-macro">这是一个相当复杂的映像、其中包含三个框、分别标记为SAP Lama、Ansible控制节点和NetApp存储。每个方框包含在每个级别发生的相应流程步骤。</block>
  <block id="b9e659c463a2a678f0e611704e512f86" category="paragraph">充当Ansible控制节点的中央主机用于执行SAP Lama发出的请求、并使用Ansible攻略手册触发NetApp存储操作。必须在此主机上安装SAP主机代理组件、才能将此主机用作与SAP Lama的通信网关。</block>
  <block id="638982755cb7864b186283043849388f" category="paragraph">在Lama Automation Studio中、定义了一个在Ansible主机的SAP主机代理上注册的提供程序。主机代理配置文件指向一个Shell脚本、此脚本由SAP Lama使用一组命令行参数调用、具体取决于请求的操作。</block>
  <block id="68dcf0e282674b14fed37a5be8c28905" category="paragraph">在Lama Automation Studio中、定义了自定义配置和自定义连接、以便在配置期间以及在系统取消配置后的清理操作期间执行存储克隆操作。然后、Ansible控制节点上的shell脚本将执行相应的Ansible攻略手册、从而触发Snapshot和FlexClone操作、并通过取消配置工作流删除克隆。</block>
  <block id="dae3fc22ee8211dc76b1b10604d664bf" category="paragraph">有关NetApp Ansible模块和Lama提供程序定义的详细信息、请访问：</block>
  <block id="0041533e713a78228719d821d293dcd4" category="inline-link">NetApp Ansible模块</block>
  <block id="9f56dd7786268026308d6c101b3d76c4" category="list-text"><block ref="9f56dd7786268026308d6c101b3d76c4" category="inline-link-rx"></block></block>
  <block id="d57e5b07e6dad93c13ff5947c9e556e5" category="inline-link">SAP Lama文档—提供程序定义</block>
  <block id="b961383b57c9b01bb96a93facf9ff473" category="list-text"><block ref="b961383b57c9b01bb96a93facf9ff473" category="inline-link-rx"></block></block>
  <block id="4159d7c81405c1d9cd6ccf2d2dc39862" category="summary">在多种情况下、必须将源系统中的数据提供给目标系统、以便用于测试或培训目的。必须定期使用源系统中的数据更新这些测试和培训系统、以确保使用当前数据集执行测试和培训。这些系统刷新操作包括基础架构层、数据库层和应用程序层上的多个任务、它们可能需要数天时间、具体取决于自动化级别。</block>
  <block id="f57f410c06dab6a60fe8e6a28770509d" category="doc">系统刷新、复制和克隆的用例</block>
  <block id="56d5fedf8fc8bf63d4174389cb19f7ed" category="inline-image-macro">此图展示了从主要开发环境到临时项目拆分、修复系统、培训系统和SANbox系统的环境工作流。它显示了用于这些不同目的的系统刷新、系统副本和系统克隆的位置。</block>
  <block id="3e7487fffc42c7f8a2aeaa0819e630a4" category="paragraph">SAP Lama和NetApp克隆工作流可用于加速和自动化基础架构和数据库层的所需任务。SAP Lama不会将备份从源系统还原到目标系统、而是使用NetApp Snapshot副本和NetApp FlexClone技术、以便在几分钟内即可完成启动的HANA数据库所需的任务、而不是像下图所示的几小时内完成。克隆过程所需的时间与数据库大小无关；因此、即使是非常大的系统也只需几分钟即可创建完毕。通过自动执行操作系统和数据库层以及SAP后处理端的任务、可以进一步缩短运行时间。</block>
  <block id="5250c15aaf7bc535777e729ee215e00a" category="inline-image-macro">此图显示了使用和不使用NetApp Snapshot副本的克隆过程与NetApp FlexClone技术之间的比较、从而显著加快了该过程的运行速度。</block>
  <block id="f18de1d998f8c83fe7b43b1fe738c842" category="paragraph">逻辑损坏可能是由软件错误，人为错误或破坏引起的。遗憾的是，使用标准高可用性和灾难恢复解决方案往往无法解决逻辑损坏问题。因此、根据发生逻辑损坏的层、应用程序、文件系统或存储、有时可能无法满足最短停机时间和可接受的数据丢失要求。</block>
  <block id="fe74c6bc72a7cff471befb07d7218feb" category="paragraph">更好的方法是尝试通过在单独的修复系统中分析问题来修复系统中的逻辑错误、而不是还原SAP系统。根发生原因分析需要业务流程和应用程序所有者的参与。在这种情况下，您可以根据发生逻辑损坏之前存储的数据创建修复系统（生产系统的克隆）。在修复系统中、可以将所需数据导出并导入到生产系统中。通过这种方法、生产系统无需停止、在最佳情况下、不会丢失任何数据、也不会丢失一小部分数据。</block>
  <block id="ff74c5a8991cf91e9cf124b189bc2877" category="paragraph">设置修复系统时、灵活性和速度至关重要。借助基于NetApp存储的Snapshot备份、可以使用NetApp FlexClone技术使用多个一致的数据库映像来创建生产系统的克隆。如果使用基于文件的备份的重定向还原来设置修复系统、则只需几秒钟即可创建FlexClone卷、而不是多小时。</block>
  <block id="7b0ea79aabb35accd10a6389af9d0d3b" category="inline-image-macro">此图显示了使用FlexClone技术从克隆系统创建修复系统的分步过程。</block>
  <block id="7a11ff2d89142afadf2fbe0a94ecc400" category="paragraph">使用SnapMirror进行存储复制可以执行灾难恢复测试、而不会使RTO和RPO面临风险。可以在不中断数据复制的情况下执行灾难恢复测试。异步和同步SnapMirror的灾难恢复测试会在灾难恢复目标上使用Snapshot备份和FlexClone卷。</block>
  <block id="ecec150056053bbf2793c30155015e60" category="paragraph">SAP Lama可用于编排整个测试操作步骤 、还负责网络隔离、目标主机维护等。</block>
  <block id="cf485594ca520eaab221d7e9f1c35741" category="inline-image-macro">此图显示了主数据中心、本地灾难恢复数据中心和远程灾难恢复数据中心中的NetApp存储系统之间的关系。它们通过同步SnapMirror和异步SnapMirror关系进行连接。</block>
  <block id="2e979feafadb9bbdb7932ab43f8d549c" category="sidebar">使用Ansible实现NetApp SAP Landscape Management集成</block>
  <block id="e2aad9960e8d21643cd0c96d6d0231cc" category="cell">nfsvers=3、无锁定、</block>
  <block id="9bb4ef49da8c49be50e8756f6e99e5fa" category="cell">nfsvers=4.1、锁定</block>
  <block id="dae81ce43b95196ee53c797d1ddda090" category="cell">nfsvers=3、无锁定</block>
  <block id="75bdc4f45cfc79b09fa1f15e1cd83b33" category="admonition">请注意、禁用编号ID需要进行用户管理、如中所述 <block ref="7cbf1992917906c8f8c329ad679d4886" category="inline-link-macro-rx"></block></block>
  <block id="a548c9345f858c0926b5fa0db82b1d29" category="admonition">请注意、禁用数字ID需要用户管理、如一节所述 <block ref="19618adae76246007b68ca646cc14e2b" category="inline-link-macro-rx"></block></block>
  <block id="fcb7778cf38a196128c87d1b6e20281e" category="paragraph">NetApp AFF A系列和AFF C系列产品系列已通过认证、可在定制数据中心集成(TDI)项目中与SAP HANA结合使用。</block>
  <block id="326f77b6d7cda2b57e0f8e89a8f89959" category="admonition">NetApp AFF C系列需要使用NetApp ONTAP 9.13.1.或更高版本</block>
  <block id="f7d09d43174d21d3203d6472d2543dc2" category="section-title">NetApp卷和聚合加密</block>
  <block id="381cfdf4e70ff7173296a764c78e97ae" category="paragraph">SAP HANA支持使用NetApp卷加密(NVE)和NetApp聚合加密(NAE)。</block>
  <block id="5d10dd356a9d8604eaed291a9dfeb67e" category="section-title">NetApp卷和聚合加密</block>
  <block id="2976619a79e897d24427ec6796aa4a70" category="paragraph">如果使用具有主机自动故障转移功能的SAP HANA多主机系统、则需要在中调整故障转移参数<block ref="46649585ec21482ae2e5fcac30c7dcae" prefix=" " category="inline-code"></block> 如下表所示。
在这些部分中、保持默认重试间隔10秒。</block>
  <block id="73d4ace7e434b8709f5a930ad845d6d6" category="paragraph">如果使用具有主机自动故障转移功能的SAP HANA多主机系统、则需要在中调整故障转移参数<block ref="46649585ec21482ae2e5fcac30c7dcae" prefix=" " category="inline-code"></block> 如下表所示。请在这些部分中保留默认重试间隔 10 秒。</block>
  <block id="ba7dc8a883957fda819c429f468dc4d0" category="admonition">NetApp AFF和ASA C系列要求使用NetApp ONTAP 9.13.1.或更高版本</block>
  <block id="b5816060ccee493fc8a2946c9d33de20" category="paragraph">您可以使用NetApp Snapshot技术在几分钟内创建数据库备份。</block>
  <block id="5cd519503ff0d358e76b5be6e9b7d14e" category="paragraph">创建 Snapshot 副本所需的时间与数据库大小无关，因为 Snapshot 副本不会移动存储平台上的任何物理数据块。此外，使用 Snapshot 技术不会影响实时 SAP 系统的性能。因此，您可以计划创建 Snapshot 副本，而无需考虑对话峰值或批处理活动期间。SAP和NetApp客户通常会在一天内计划多个联机Snapshot备份；例如、每六小时备份一次很常见。这些Snapshot备份通常会在主存储系统上保留三到五天、然后再被删除或分层到更便宜的存储中以供长期保留。</block>
  <block id="30fb58b3c8613fe4e4ee034a17cad743" category="paragraph">您可以创建按需Snapshot备份和按需块完整性检查操作。</block>
  <block id="a3e7070d87d49d386e093fcdc7b5d5bd" category="paragraph">根据灾难恢复设置（包括或不包括日志备份复制），必须根据 Snapshot 备份创建两个或三个新卷。在这两种情况下，都必须为数据创建一个新卷，并为 HANA 共享卷创建一个新卷。</block>
  <block id="fcdcb3404b408a63e224eaddd9d4da66" category="paragraph">如果同时复制日志备份数据，则必须为日志备份卷创建一个新卷。在我们的示例中，数据和日志备份卷已复制到灾难恢复站点。以下步骤使用 Azure 门户。</block>
  <block id="5a6f556f9dd0e6d4a51b71e1c8e0c4c5" category="paragraph">SnapCenter 是一个统一的可扩展平台，可实现应用程序一致的数据保护。SnapCenter 提供集中控制和监管，同时委派用户管理应用程序专用的备份，还原和克隆作业。借助 SnapCenter ，数据库和存储管理员可以通过一种工具来管理各种应用程序和数据库的备份，还原和克隆操作。</block>
  <block id="7205bef5fdf399d26803842e613171b9" category="paragraph">SnapCenter 负责管理由 NetApp 提供支持的 Data Fabric 中各个端点的数据。您可以使用 SnapCenter 在内部环境之间，内部环境与云之间以及私有云，混合云或公有 云之间复制数据。</block>
  <block id="99aee71b2e977cb3ae318b3974922009" category="paragraph">非数据卷的备份是SnapCenter 和SAP HANA插件的集成部分。</block>
  <block id="b9ddafc817b66c2009ab0b655b47ffdb" category="paragraph">保护数据库数据卷足以将SAP HANA数据库还原和恢复到给定时间点、前提是数据库安装资源和所需日志仍然可用。</block>
  <block id="6f785e59ccbb0faf46940f1b40c97679" category="paragraph">SnapCenter 负责管理由 NetApp 提供支持的 Data Fabric 中各个端点的数据。您可以使用SnapCenter在内部环境之间、内部环境与云之间以及私有云、混合云或公共云之间复制数据。</block>
  <block id="e2922c15d6a12ab190ba48a18a884e5b" category="paragraph">只有具有故障转移功能的多主机环境才需要存储连接器。在多主机设置中， SAP HANA 可提供高可用性功能，以便 SAP HANA 数据库主机可以故障转移到备用主机。</block>
  <block id="e7e858cb5e5ec45f7483826c4922e4a2" category="paragraph">在这种情况下，备用主机将访问并使用故障主机的 LUN 。存储连接器用于确保一次只能由一个数据库主机主动访问存储分区。</block>
  <block id="db25c2a4ae3ce67c8d33eb9795cd39de" category="paragraph">从 SAP HANA 2.0 SPS4 开始，您可以配置其他数据卷分区，从而可以为 SAP HANA 租户数据库的数据卷配置两个或更多卷。您还可以扩展到超出单个卷的大小和性能限制的范围。</block>
  <block id="bc30fa07361c376b0079c00d85091f1e" category="paragraph">SAP HANA 主机通过使用冗余 10GbE 或速度更快的网络基础架构连接到存储控制器。SAP HANA 主机和存储控制器之间的数据通信基于 NFS 协议。</block>
  <block id="1ffe19554e4db8e2355d91449e77fa5a" category="paragraph">建议使用冗余交换基础架构，以便在交换机或网络接口卡（ Network Interface Card ， NIC ）发生故障时提供容错 SAP HANA 主机到存储连接。这些交换机可能会将各个端口的性能与端口通道进行聚合，以便在主机级别显示为一个逻辑实体。</block>
  <block id="93f305eb7fa597fc876f2e0744abf06b" category="paragraph">这些系统刷新操作包括基础架构层、数据库层和应用程序层上的多个任务、它们可能需要数天时间、具体取决于自动化级别。</block>
  <block id="b7de930c0dd2d22c43e147a8da62d970" category="admonition">性能测试表明了这一点<block ref="6ad27604f562c1a2600540bd7f1094d4" prefix=" " category="inline-code"></block> 可提供良好的读取结果、尤其是对数据卷。日志写入可能会因会话数较少而受益、例如<block ref="b3e16d81f1f84d087c55c1815a58a64c" prefix=" " category="inline-code"></block>。使用"nconnect"选项也可能有利于共享卷。请注意，从 NFS 服务器进行的首次挂载（ IP 地址）会定义所使用的会话量。即使nconnect使用不同的值、进一步挂载到同一IP地址也不会更改此设置。</block>
  <block id="d7d1e0b01aa98fdaaa388843234520d5" category="admonition">从ONTAP 9.8和SUSE SLES15SP2或RedHat RHEL 8.4或更高版本开始、NetApp也支持NFSv4.1的nconnect选项。</block>
  <block id="075d23786d3ed7499b8d563bd41298ef" category="admonition">。<block ref="68727786e22b015e3091f141273c8e9a" prefix=" " category="inline-code"></block> 每个数据库主机的文件系统都不同。以下示例显示了<block ref="7b5a8b70c72ff791a6c938600aa48468" prefix=" " category="inline-code"></block>。</block>
  <block id="61dc8147d5af95ff65e5beeeceb8d669" category="cell">更改NFSv4.x会话插槽的数量
  可选</block>
  <block id="3a61ec547beefb69b89d0843ea4c03bd" category="cell">设置高级
nf修改-vserver hana -v4.x-sSession-num-sports &lt;value&gt;
设置admin</block>
  <block id="7de8b31e6597c345c3a3966bd41f80a2" category="admonition">性能测试表明了这一点<block ref="6ad27604f562c1a2600540bd7f1094d4" prefix=" " category="inline-code"></block> 为数据卷提供良好的读取结果。日志写入可能会因会话数较少而受益、例如<block ref="b3e16d81f1f84d087c55c1815a58a64c" prefix=" " category="inline-code"></block>。使用"nconnect"选项也可能有利于共享卷。请注意，从 NFS 服务器进行的首次挂载（ IP 地址）会定义所使用的会话量。即使nconnect使用不同的值、进一步挂载到同一IP地址也不会更改此设置。</block>
  <block id="093a45d87b6b8692e6c9a73c1a04c137" category="doc">从何处查找追加信息和版本历史记录</block>
  <block id="e66b5a3c6799dcc5dd4039a58085fb38" category="cell">2017年9月</block>
  <block id="3258056add985fc8ba4192b41052b298" category="list-text">添加了 " 高级配置和调整 " 一节。</block>
  <block id="0974990f1aa38ac1b1e2c8f4400eccac" category="list-text">轻微更正。</block>
  <block id="74620215d33d2f9ad06a873cdf9e8acc" category="cell">2018年3月</block>
  <block id="1a2873a5ec0a90d66c68fa26956cbcbd" category="list-text">SnapCenter 4.0更新：
新的数据卷资源
改进了单文件SnapRestore操作</block>
  <block id="d835981d77534f5f20446d4648ad7e5b" category="cell">2020年1月</block>
  <block id="26d5841054625c4dbc06dd193b24fcb1" category="list-text">添加了 SnapCenter 概念和最佳实践一节。</block>
  <block id="bc72571f701d3a6cec52ab446894c3c2" category="list-text">SnapCenter 4.3更新：
自动发现
自动还原和恢复
支持HANA多个租户的多个被租户
单租户还原操作</block>
  <block id="ca82c7bf0a12e1bd7623c916688916ff" category="cell">2020 年 7 月</block>
  <block id="519da123e1e4d0cb2656dd6dc21b7cda" category="list-text">少量更新和更正：
SnapCenter 4.3.1支持NFSv4
配置SSL通信
在IBM Power上为Linux集中部署插件</block>
  <block id="0e347c50a0d60b8f46cb8c37cd3b5088" category="cell">2020年11月</block>
  <block id="1ec08d2f146139e95c0cb9a18141800f" category="list-text">已为 HANA 2.0 SPS5 添加所需的数据库用户权限。</block>
  <block id="0933d4dd2ad52707372be6b67b620890" category="cell">2021年5月</block>
  <block id="e43d99222de98514f5024501d09b7a47" category="list-text">已更新 SSL hdbsql" 配置 " 部分。</block>
  <block id="2e7bd301fd3aa711e492f5d75ba83f00" category="list-text">增加了对 Linux LVM 的支持。</block>
  <block id="248f830b158797f9c038ea35ea266b89" category="cell">2021年8月</block>
  <block id="0c8b3ad778d3f01ad1babbee4416272f" category="list-text">已添加禁用自动发现配置问题描述 。</block>
  <block id="9209b4ae424c71673a607557c64f7eb8" category="cell">2022年2月</block>
  <block id="4528f584aae52b626f3142db1586b578" category="list-text">对 SnapCenter 4.6 进行了少量更新，并支持对启用了 HANA 系统复制的 HANA 系统进行自动发现。</block>
  <block id="b56a5394775a9f077c12cb3e770d913c" category="cell">2022年5月</block>
  <block id="abb14d21829ba186172f6e1d0b64b55b" category="cell">2023年1月</block>
  <block id="dfd02aef9802f4824ead7c08b8f81f1f" category="cell">初始版本。</block>
  <block id="36098c0d1c3de71d8727b1543bace633" category="cell">2022年4月</block>
  <block id="95798f037b7bacec7599a19423a6bb64" category="cell">2018 年 2 月</block>
  <block id="8e070ffcf4d959eabcd3559b9bb17ec6" category="sidebar">从何处查找追加信息 和版本历史记录</block>
  <block id="2c7a6a1ad3b3855b3dd5766cc2c1b15c" category="summary">本节介绍如何使用BlueXP还原SAP HANA备份。</block>
  <block id="8513aa8ec75c0057744a444420581eac" category="doc">正在还原SAP HANA BlueXP备份</block>
  <block id="630146410475bf00902dbc3588f48b64" category="paragraph">只能从备份还原到云中基于NetApp ONTAP的内部存储系统或NetApp CVO。可以通过执行以下步骤来执行还原：</block>
  <block id="ae9c703fb18f8c682d52518823ea9112" category="list-text">在BlueXP用户界面中，单击  *保护*&gt; *备份和恢复  *&gt;*应用程序*，然后选择混合。</block>
  <block id="16365f9a8d0b7866f7271510a28d1db2" category="list-text">在 *Filter by * 字段中，选择过滤器 *Type* ，然后从下拉列表中选择 *HARA*。</block>
  <block id="47abe672471325a3aa63fcd85f6e3367" category="list-text">对于NAS环境、指定要将从对象存储还原的卷导出到的主机的FQDN或IP地址。</block>
  <block id="831b20d8b0ff4f1e50aecadcdcdc885d" category="list-text">对于SAN环境、指定从对象存储还原的卷的LUN要映射到的主机启动程序。</block>
  <block id="eee7cd91c87d431eb526192fb8d8f8fa" category="list-text">如果快照位于归档存储中、请选择从归档存储还原数据的优先级。</block>
  <block id="c309fef296cf37f3a835cb24529d8905" category="list-text">如果源存储上没有足够的空间或源存储已关闭，请选择 *更改存储位置*。</block>
  <block id="7d7bd9e2f6791a41e19d3f4c2cfbd112" category="list-text">如果选择 *更改存储位置*，则可以在目标卷上附加后缀。如果未选中此复选框、则默认情况下  会将*_restore *附加到目标卷。单击 *Next*。</block>
  <block id="09fbcde15932165bde251a10dbf240e4" category="list-text">如果选择了更改存储位置，请在存储映射页面中指定从对象存储还原的数据将存储在的备用存储位置详细信息，然后单击*Next*。</block>
  <block id="e5c7ac753b7a6121d9687b3fc4c66f25" category="summary">本节介绍如何设置工作环境、如何配置SnapCenter以及如何在BlueXP中配置和激活SAP HANA备份。</block>
  <block id="bba044fc5fd2c6b6b93f83b61a607e30" category="doc">为SAP HANA配置BlueXP备份和恢复</block>
  <block id="84e76e0953f8a5f72d754729d1eaf1ae" category="section-title">为BlueXP创建工作环境</block>
  <block id="210e8952dc88c73e56d56a168cfe0616" category="list-text">在左侧菜单中选择*存储*-&gt;*帆布*-&gt;*我的工作*环境。</block>
  <block id="6689e50f5e4a08328fa676a7ebb07f17" category="section-title">在内部存储系统和对象存储分段之间创建关系</block>
  <block id="eab79ca7fb49f80130fae7b1656f7ebc" category="inline-link">Amazon S3的网关端点- Amazon虚拟私有云</block>
  <block id="4513d4d932152177142c02ca2a383afc" category="paragraph">要创建第一个卷备份、请执行以下步骤：</block>
  <block id="690e7cac4bb20bc16d03d9e8c2976d36" category="section-title">在SnapCenter中配置SAP HANA系统资源</block>
  <block id="522c073cfbc968ed21bb5b8292358b24" category="section-title">将SnapCenter添加到BlueXP工作环境</block>
  <block id="63cebe46588c644def8c8d7ad33d7579" category="list-text">在左侧菜单中选择*保护*-&gt;*备份和恢复*-&gt;*应用程序*。</block>
  <block id="5a367c49e14aa13d1f3d9dbbc659e2ae" category="section-title">为应用程序备份创建备份策略</block>
  <block id="01f80398f488785a735c649b98cb461b" category="section-title">使用Cloud Backup for Applications保护SAP HANA数据库</block>
  <block id="a0e8aadf9440319ad134e14b8cd7944e" category="paragraph">在某些环境中、可能需要删除SnapMirror源的任何现有计划设置。为此，请在源ONTAP系统上执行以下命令：_SnapMirror修改-target-path &lt;hana-cloud-svm&gt;：napp_copy &lt;SID_data_mnt00001&gt;-Schedule ""_。</block>
  <block id="3b6e263c9f3e6b5ae82e2961e7499aa8" category="summary">本技术报告介绍了使用适用于应用程序的NetApp BlueXP备份和恢复来保护SAP HANA数据的最佳实践。本文档介绍了一些概念、配置建议和操作工作流、包括配置、备份操作、 和还原操作。</block>
  <block id="b9a6a76ee21e4b2e63f002e8171e92cb" category="doc">适用于SAP HANA的BlueXP备份和恢复—将Cloud Object存储用作备份目标</block>
  <block id="b5810ff76e2c858c26eb34fd554d4cd5" category="paragraph">本文档介绍如何使用NetApp BlueXP设置和配置SAP HANA、以实现从内部到基于云的对象存储的数据保护。其中包括解决方案的BlueXP备份和恢复部分。此解决方案是使用NetApp Snap Center对内部SAP HANA备份解决方案的增强功能、可提供一种经济高效的方式将SAP HANA备份长期归档到基于云的对象存储、并可选择将对象存储分层到归档存储、例如AWS Glacier/deep Glacier. Microsoft Azure Blob Archive和GCP Archive Storage。</block>
  <block id="efabc7b5ad8cc75eaf149a7744db8028" category="inline-link">TR-4614：《使用SnapCenter进行SAP HANA备份和恢复》(netapp.com)</block>
  <block id="c81a8bcb625915f9445bc27152702a6c" category="section-title">BlueXP备份和恢复架构</block>
  <block id="b2bf2bbf7e6b4629b50b4af1483af0ba" category="section-title">安装和配置步骤概述</block>
  <block id="f3cf1278a15cf0b578a48d8ef6a60523" category="inline-link">SnapCenter配置(netapp.com)</block>
  <block id="a63540c81089e8aba203a4ec3fca1e34" category="list-text">安装和配置NetApp BlueXP组件。</block>
  <block id="60cb8be07c4c55cabf60de71b7a9b4b2" category="paragraph">需要在初始设置数据保护解决方案期间执行一次。</block>
  <block id="d695b2f7d2eff56585ac33b59ae50cde" category="list-text">NetApp SnapCenter的准备步骤。</block>
  <block id="6d95f48ab62edee63c2cc9fda6615760" category="paragraph">需要对每个SAP HANA数据库执行此操作、这些数据库应受到保护。</block>
  <block id="c24f27d2fb45abb4ddc4c6dac6b3f9b9" category="list-text">BlueXP备份和恢复中的配置步骤。</block>
  <block id="0e7839906008338e5f608eca614e1cc7" category="section-title">安装和配置NetApp BlueXP混合应用程序备份</block>
  <block id="9293673edeb2321146de2dbe903787cc" category="inline-link">保护内部应用程序数据| NetApp文档</block>
  <block id="1b21781469d6b56757c78d09d90f83be" category="paragraph">中介绍了NetApp BlueXP组件的安装和配置<block ref="36b413e5ecd6dd30fe4575aa917373d9" category="inline-link-rx"></block>。</block>
  <block id="c3c6e6b1d05fc3c3c73b5ab9af3ea3ee" category="list-text">注册BlueXP并在设置NetApp帐户<block ref="7dd2072632295c5a9abd61523c46bd40" category="inline-link-rx"></block>。</block>
  <block id="44de63d2b4a3805e8a143a8425e912c6" category="inline-link">了解连接器| NetApp文档</block>
  <block id="bc9a4ad171b5071191568c8006c63dc6" category="list-text">在您的环境中部署BlueXP Connector。问题描述位于<block ref="a6131392110983029d1dff188cde678b" category="inline-link-rx"></block>。</block>
  <block id="6691a23f272bb7c1d702c8963a326dc0" category="list-text">在BlueXP中添加/购买Cloud Backup许可证：<block ref="57c4a53c7a746551566c6506aa924ffc" category="inline-link-rx"></block>。</block>
  <block id="d497834786aa54c08eaf2f867588d576" category="list-text">在SnapCenter中配置SAP HANA系统资源。</block>
  <block id="465f4a123cd3df663bb4b5d781e3755f" category="list-text">将Snap Center添加到您的工作环境中。</block>
  <block id="87a323c396d1f0b11c5c63017a081d0a" category="list-text">为您的环境创建策略。</block>
  <block id="a33d9e49823debc4eac9a3f6fed5ed4f" category="list-text">保护您的SAP HANA系统。</block>
  <block id="b1708148488f2ff73841c4df62f35be1" category="doc">追加信息和版本历史记录</block>
  <block id="5d2dace1bbb099eb2c0c668ec3e8c3b6" category="list-text">NetApp BlueXP备份和恢复产品文档+
<block ref="2337d886e4f2f876275339e16f80eafd" category="inline-link-rx"></block></block>
  <block id="b0e216a090ed7d12ab06af852f5fd176" category="list-text">使用SnapCenter +进行SAP HANA备份和恢复
<block ref="94fe6fb839269f177c2cb625768421d4" category="inline-link-rx"></block></block>
  <block id="d7a15f16d93378f9428254d47703abd2" category="cell">2024年3月</block>
  <block id="c9dd6bad4c7d561872f2e2d498a990bf" category="inline-link">互操作性表工具（ IMT ）</block>
  <block id="c5358f17fd6fd13a64169fc38a03495f" category="paragraph">请参见<block ref="2a186a9053db553d8a98e2d5f86d7002" category="inline-link-rx"></block> 在 NetApp 支持站点上，验证您的特定环境是否支持本文档中所述的确切产品和功能版本。NetApp IMT 定义了可用于构建 NetApp 支持的配置的产品组件和版本。具体结果取决于每个客户是否按照已发布的规格进行安装。</block>
  <block id="ca996b238b1f32bd7d6b941eb3464b17" category="sidebar">适用于SAP HANA的BlueXP备份和恢复—概述</block>
  <block id="deac54b4ceeb072a80124bd022d78294" category="sidebar">还原SAP HANA BlueXP备份</block>
  <block id="b6b16d136a508e7a2c84cb6653cb4095" category="paragraph">中介绍了内部SAP HANA备份和恢复解决方案的设置和配置<block ref="15efad3574df413724673ccbc14e9c64" category="inline-link-rx"></block>。</block>
  <block id="1605c9a8e838f67f2b16a4053e1e045d" category="paragraph">本技术报告仅介绍如何以AWS S3对象存储为例、通过适用于SAP HANA的BlueXP备份和恢复来增强基于SnapCenter的内部SAP HANA备份和恢复解决方案。使用Microsoft Azure和GCP对象存储而非AWS S3进行设置和配置的过程与此类似、但本文档不会对此进行介绍。</block>
  <block id="dce65a9e030d5dbde345a046d948f2bf" category="paragraph">BlueXP备份和恢复是一种SaaS解决方案、可为在NetApp内部存储上运行的应用程序提供数据保护功能、并将其迁移到云。它使用NetApp存储为SAP HANA提供基于策略的应用程序一致的高效保护。此外、BlueXP备份和恢复可提供集中控制和监管、同时委派用户管理应用程序特定的备份和还原操作的能力。</block>
  <block id="ef7bad3edebf99f3bb50f4d8bbaa37d6" category="paragraph">BlueXP备份和恢复在NetApp BlueXP中作为SaaS运行、并利用框架和UI。BlueXP工作环境框架用于配置和管理基于内部存储的NetApp ONTAP和NetApp SnapCenter服务器的凭据。</block>
  <block id="284528a6422c1ab87246e51dcb6b3ae5" category="paragraph">需要在客户虚拟网络中部署BlueXP连接器。内部环境和云环境之间需要连接、例如站点到站点VPN连接。NetApp SaaS组件与客户环境之间的通信只能通过连接器完成。此连接器正在使用ONTAP和SnapCenter管理API执行存储操作。</block>
  <block id="3df2c2f8f80654c02cea27e8354aee2a" category="paragraph">内部存储和云存储分段之间的数据传输通过AES 256位空闲加密、传输中的TLS/HTTPS加密和客户管理密钥(CMK)支持进行端到端保护。+
备份的数据可以存储在不可变和不可变的WORM状态。要从对象存储访问数据、唯一的方法是将其还原到基于NetApp ONTAP的存储(包括NetApp CVO)。</block>
  <block id="0c335c284481ec782d9a7b2a63462276" category="paragraph">所需的安装和配置步骤可分为三个方面。+
前提条件是已在NetApp Snap Center中配置SAP HANA备份配置。有关首先为SAP HANA设置Snap Center的信息、请参见<block ref="bc1347d79ab670cf5ad861e4a7cc0e9b" category="inline-link-rx"></block>。</block>
  <block id="6cb139093b769a68f6abbb55400df4d8" category="list-text">通过添加内部存储、在BlueXP中为NetApp内部环境和云目标创建工作环境。</block>
  <block id="49d37c51268190a8f072cf6f400be18f" category="list-text">为内部存储创建一个新的对象存储关系、并将其加入AWS S3存储分段。</block>
  <block id="6cf9c506a56175d20b049edfdc810cec" category="paragraph">将内部存储系统添加到您的工作环境中。</block>
  <block id="35fb81d7bc669beabd5887c5308a5374" category="paragraph">内部存储与S3存储分段之间的关系是通过为卷创建备份或激活应用程序备份来实现的。如果要使用现有的站点到站点VPN将数据从内部传输到S3、则需要使用卷备份在内部存储和S3存储分段之间创建关系、因为需要使用VPC端点。+
在创建本文档时、应用程序备份工作流不支持选择VPC端点来访问S3存储分段。+
请参见<block ref="7f3b31b88f0e42104578f538777bc3e6" category="inline-link-rx"></block> 如何在VPC中为S3设置VPC端点。</block>
  <block id="9c485d8d0a0f2d60633001b05d342eed" category="doc">《采用NFS的NetApp FAS系统上的SAP HANA配置指南》</block>
  <block id="b7bda169ccba06e8cbcf02ba0fab5928" category="doc">《采用光纤通道协议的NetApp FAS系统上的SAP HANA配置指南》</block>
  <block id="a56f5f8ccd94f38be4e8a0f1faf81823" category="doc">《采用NFS的NetApp AFF系统上的SAP HANA—配置指南》</block>
  <block id="ef6ac0da06e1bd8eabd965442ae5668d" category="paragraph">Marco schön、NetApp</block>
  <block id="a004afbb2c9ff596c570f05cacd1d651" category="section-title">NetApp FlexGroup卷</block>
  <block id="cfb6b0dd52bfc75b4646448807e41154" category="paragraph">SAP HANA不支持使用NetApp FlexGroup卷。由于SAP HANA的架构、使用FlexGroup卷不会带来任何优势、可能会导致性能问题。</block>
  <block id="0500aa4516d90775e7cd20e0b45fa4ad" category="sidebar">配置最佳实践</block>
  <block id="bb5dc731b06d417365e41cb2d0230213" category="sidebar">视频和演示</block>
  <block id="d6b9ea32b921a9f56de32062ba4b94f3" category="sidebar">博客</block>
  <block id="8625e1de7be14c39b1d14dc03d822497" category="sidebar">工具</block>
  <block id="1f934c6200615c74e6839ca55ae1e6cf" category="sidebar">备份，还原和灾难恢复</block>
  <block id="d57e0763c47c99218375572fbdd307a1" category="sidebar">所有 SAP 解决方案</block>
  <block id="91770f038cd944a1d3b9b347edeb2b10" category="sidebar">新增功能</block>
  <block id="db5a8e62a598aa08b2923f3210fec1a3" category="summary">本文档重点介绍如何将NetApp®Snapshot™和FlexClone®技术集成到羊驼自动化工作流中。</block>
  <block id="e7ffc6df7629952bee1f92657458fbac" category="doc">SB-4293：利用羊驼和NetApp SnapCenter自动执行SAP系统复制、刷新和克隆工作流</block>
  <block id="c0c4b60d27032c028c91440e9d3be949" category="section-title">解决方案概述</block>
  <block id="86418a2229dc17869377db8ccf58db56" category="paragraph">SAP系统和解决方案操作非常复杂。但是、对于使用SAP的公司、系统和服务是其业务流程的核心。通过自动执行重复的日常操作任务(如系统复制和刷新操作)、SAP系统管理员可以事半功倍地管理更多系统、生成可重复的结果并减少人为错误。</block>
  <block id="fbcecadd64701c98813e5bc5accb7a85" category="paragraph">主动自动化环境—云和任意位置(Alpaca)套件是一个全面的管理界面、可对SAP环境进行详细监督和监控。羊驼可以简化和加快SAP基础架构运营、确保最佳可用性和透明度。它提供了一套全面的工具来管理整个环境(包括基础架构)、并主动通知异常情况、例如服务中断、作业中断和拥塞。该套件可在内部环境、混合云和全云环境(包括多云环境)中无缝运行、确保适应任何基础架构。此基于模块的框架可自动执行标准和常规SAP管理任务、以及在中断期间进行故障转移等复杂情形。 管理员/专家、操作员和经理、羊驼为这些专业人员提供了高度的控制和自动化。</block>
  <block id="9d632cae336dd853f201c88c832e2cb7" category="inline-image-macro">羊驼平台示意图</block>
  <block id="7323cb77cd037c30e7a9a2a0dc1eacb9" category="paragraph">本文档介绍了羊驼如何与NetApp SnapCenter®集成、后者是一款用于编排基于Snapshot的备份、执行还原和创建FlexClone卷的工具。通过这种集成、SAP管理员可以显著加快SAP系统的日常运营任务。NetApp Snapshot、FlexClone和SnapRestore®技术可加快备份、还原和克隆操作的速度，因为NetApp的存储技术是基于指针的。这种方法速度很快、而且还可以降低克隆操作期间的存储开销、因为只需将新数据和更改过的数据(而不是现有数据)写入存储介质即可。无论它是内部NetApp存储系统还是三大云提供商之一的NetApp存储解决方案、都是如此。</block>
  <block id="bf8dd94f74c5878ba969abeeef0286d1" category="section-title">目标受众</block>
  <block id="a34a4fdc22dc4d566081e48a846fbf5a" category="paragraph">本文档面向已手动执行SAP系统副本并希望使用羊驼自动执行此活动的SAP系统管理员。将NetApp SnapCenter编排的NetApp Snapshot和FlexClone技术与羊驼工作流相结合的预期目标是、缩短完全自动化SAP系统副本的持续时间。</block>
  <block id="3d308ecb8420d2579b7d359b7ad94bb5" category="paragraph">术语SAP系统副本通常用作三个不同过程的同义词：SAP系统克隆、SAP系统副本和SAP系统刷新。区分这些操作非常重要、因为工作流和用例不同。</block>
  <block id="622b88e8f99c2f21460dccf5dc97f1d7" category="list-text">*SAP系统克隆*。SAP系统克隆是源SAP系统的相同克隆。SAP系统克隆通常用于解决逻辑损坏或测试灾难恢复场景。对于系统克隆操作、主机名、实例编号和安全标识符(SID)保持不变。因此、为目标系统建立适当的网络隔离非常重要、以确保该系统无法与生产环境进行通信。</block>
  <block id="da4f81a65278754f8234bd6f906c0e40" category="inline-image-macro">显示SAP系统克隆的图像</block>
  <block id="c363bfedad13dec17e913676bcbc4371" category="list-text">*SAP系统副本*。SAP系统副本是使用源SAP系统中的数据对新目标SAP系统进行的设置。例如、新的目标系统可以是一个额外的测试系统、其中包含来自生产系统的数据。源系统和目标系统的主机名、实例编号和SID不同。 新系统不会与源系统隔离。</block>
  <block id="0317fd7042e1a3bbd1897d5d7f7a2cc6" category="inline-image-macro">显示SAP系统副本的图像</block>
  <block id="0820369f4405acedd8305fd09350a9e9" category="list-text">*SAP系统更新*。SAP系统刷新是使用源SAP系统中的数据对现有目标SAP系统进行的刷新。目标系统通常是SAP传输环境(例如沙盒系统)的一部分、该系统会使用生产系统中的数据进行刷新。源系统和目标系统的主机名、实例编号和SID不同。</block>
  <block id="a5c1cb5f56a681e17c4285d9eccac7b1" category="inline-image-macro">显示SAP系统刷新的图像</block>
  <block id="444724efd6db7acaf8cd0d5c32fcfd71" category="paragraph">尽管有三种不同的使用情形、但数据管理流程保持不变。所有这三种使用情形都使用相同的底层数据管理技术—NetApp Snapshot和FlexClone。</block>
  <block id="8f4c7939e8a42e023939df947aba54f6" category="section-title">解决方案技术</block>
  <block id="e664b92ee975da28ca5e768b9a88dd26" category="paragraph">整个解决方案包括以下主要组件：</block>
  <block id="2a4c6f6c82937e9f31385452f76b0a8d" category="list-text">安装了SnapCenter代理和SnapCenter数据库插件的SAP源系统</block>
  <block id="eafc29f547c05517926b01ee4b438905" category="list-text">安装了SnapCenter代理和SnapCenter数据库插件的SAP目标系统</block>
  <block id="9ab707fdba87d81c6d7c3e949c63b277" category="list-text">已配置SAP源系统和SAP目标系统的羊驼系统</block>
  <block id="ee9a1ac4f9e7a6bec1deed8ff9c2f8fb" category="list-text">NetApp SnapCenter服务器</block>
  <block id="5d0a666f7f8f7d38d3fc377ab72d2ac5" category="list-text">NetApp存储系统：</block>
  <block id="55e0c6f2677f63db92df47ec0b324167" category="list-text">物理内部部署硬件：AF-A、AF-C、ASA-A、ASA-C或FAS系列</block>
  <block id="251aab5f02e944d9704621e71f85578b" category="list-text">内部软件定义的存储：ONTAP®Select</block>
  <block id="f01a2a485dbdb94ed94e78580907767c" category="list-text">NetApp云存储：</block>
  <block id="9a5b3a6c19cc79e8803fb4a381f09917" category="list-text">适用于AWS、Google Cloud或Azure的Cloud Volumes ONTAP</block>
  <block id="7450cfde7058dc5e1f7909d0280fd7ae" category="list-text">Azure NetApp Files</block>
  <block id="4d82a1ec1af02725042c8c785564ee7a" category="list-text">适用于 NetApp ONTAP 的 Amazon FSX</block>
  <block id="12237a5e9a92287b4283682895d22d2f" category="paragraph">下图显示了羊驼服务器、NetApp SnapCenter服务器、NetApp存储系统、SAP源系统和SAP目标系统、以及所有内容的集成方式。其目标是、通过使用SnapCenter REST API尽可能灵活地进行集成、以确保最大限度地重复使用现有组件中已完成的配置工作。</block>
  <block id="bf9bdab57c82171f2cc9bcebdc37b2c2" category="section-title">使用情形摘要</block>
  <block id="ae1c63d0fd8dbf1fb4e91fd0923187d9" category="paragraph">在多种情况下、必须将源系统中的数据提供给目标系统、以便进行测试或培训。必须使用源系统中的数据定期更新这些测试和训练系统、以确保使用当前数据集执行测试和训练。这些系统刷新操作包括基础架构层、数据库层和应用程序层上的多个任务、这些任务可能需要几天时间、具体取决于自动化级别。</block>
  <block id="18636c25be7e0e796a8ec39fe4f0c60e" category="paragraph">要加快运营速度、自动执行任务并消除基础架构、数据库和应用程序级别的人为错误、您可以使用羊驼工作流。此集成使用NetApp Snapshot和FlexClone技术、而不是将备份从源系统还原到目标系统(这不仅耗时、而且会占用大量资源)。启动数据库所需的所有任务只需几分钟而不是几小时即可完成。克隆过程所需的时间与数据库大小无关；因此、即使是非常大的系统、也只需几分钟即可创建完毕。羊驼通过自动执行操作系统和数据库级别以及SAP后处理端的任务、进一步缩短了运行时间。</block>
  <block id="8ca12d6eeda659345e54817d871b4153" category="paragraph">下图显示了使用自动化时可能会提高的运营效率。</block>
  <block id="19a6f9f39008e36ec42310a1697de210" category="inline-image-macro">此图显示了使用自动化时可能会提高的运营效率</block>
  <block id="5005b13528d942f6d5a5d831e88ad106" category="section-title">集成技术组件</block>
  <block id="3b6949e0ff3c710337d9cd603b9c2515" category="paragraph">SnapCenter在羊驼工作流中的实际集成包括使用shell脚本来访问NetApp SnapCenter REST API。这种基于REST API的集成可创建SAP源系统的Snapshot副本、创建FlexClone卷并将其挂载到SAP目标系统上。存储和SAP管理员知道如何开发由SnapCenter触发并由SnapCenter代理执行的脚本、以自动执行重复的日常操作任务。这种松散耦合的架构可通过shell脚本触发SnapCenter任务、使他们能够重复使用现有的自动化过程、从而使用羊驼作为端到端自动化的工作流引擎更快地实现所需的结果。</block>
  <block id="3ca92e57dea12993b0c6ac16e5820353" category="paragraph">羊驼和NetApp数据管理技术的结合提供了一个强大的解决方案、可以显著减少与SAP系统管理相关的最复杂和最耗时的任务所需的时间和精力。这种组合还有助于避免人为错误可能导致系统之间的配置偏离。</block>
  <block id="6bf71f730c6c54b2134e90f286791cc7" category="paragraph">由于系统更新、副本、克隆和灾难恢复测试都是非常敏感的过程、因此实施此类解决方案可以节省宝贵的管理时间。它还可以增强业务部门员工对SAP系统管理员的信任。他们将看到可以节省多少故障排除时间、以及复制系统以用于测试或其他目的是多么容易。无论源系统和目标系统运行在内部、公有云、混合云还是混合多云、都是如此。</block>
  <block id="9c87573265b253410a84d81b471a29e1" category="paragraph">要了解有关本文档所含信息的更多信息、请查看以下文档和网站：</block>
  <block id="7c80105b450d2a7097856f0c1a47f684" category="inline-link-macro">羊驼</block>
  <block id="daf59c2df9bdef54e4fcbfb2596f3319" category="list-text"><block ref="daf59c2df9bdef54e4fcbfb2596f3319" category="inline-link-macro-rx"></block></block>
  <block id="897625d5a9449080791ca6991d9163d6" category="list-text"><block ref="897625d5a9449080791ca6991d9163d6" category="inline-link-macro-rx"></block></block>
  <block id="2115d0e1d828c5a28a9742411342fc04" category="inline-link-macro">SnapCenter服务器和插件支持REST API</block>
  <block id="36ac9e3e7c1dda5e31be15c68d614e8a" category="list-text"><block ref="36ac9e3e7c1dda5e31be15c68d614e8a" category="inline-link-macro-rx"></block></block>
  <block id="c2668ce859de558fa49ef70b7eacbb3b" category="cell">版本0.1</block>
  <block id="338602028883e3e3e93d7fad17905696" category="cell">04.2024</block>
  <block id="d40cd11c66986e96040133cd69280e6a" category="cell">初稿。</block>
  <block id="96d7dc7b222d6abde2ea184b5e0fc02b" category="cell">版本0.2</block>
  <block id="b61612a45af76461f6f16d12a1e3a473" category="cell">06.2024</block>
  <block id="8d6c86885133ff76b8d68daf86e29551" category="cell">已转换为html格式</block>
  <block id="2190de7e3e03ad3aa87d37ce1d799634" category="summary">本文档介绍了Avantra如何与NetApp SnapCenter®平台集成。</block>
  <block id="fc437f8a9ad8cff38c5229c700d66600" category="doc">SB-4294：借助Avantra和NetApp SnapCenter自动执行SAP系统复制、刷新和克隆工作流</block>
  <block id="e85e6812e10c0d3ed470223879ee4a2e" category="paragraph">SAP系统和解决方案的操作非常复杂。但是、对于使用SAP的公司、这些系统和服务是其业务流程的核心。通过自动执行重复的日常操作任务(如系统复制和更新操作)、SAP系统管理员可以轻松管理更多系统、生成可重复的结果并减少人为错误。</block>
  <block id="6b040b255b68d643f860cc0c42d60c26" category="paragraph">本文档重点介绍如何将NetApp®Snapshot™和FlexClone®技术集成到Avantra自动化工作流中。Avantra是一个IT管理平台、专注于IT运营和服务的自动化管理。它提供了用于监控、自动化和管理IT基础架构的解决方案、以提高IT系统的效率和可靠性。Avantra支持企业主动监控其IT环境、及早发现问题、并执行自动化操作来排除故障或优化系统性能。该平台通常可与其他IT管理工具集成、并可部署在各种环境中、例如云、内部和混合基础架构。</block>
  <block id="9290f6edd05ab74ce976da8a1bd79627" category="paragraph">本文档介绍了Avantra如何与NetApp SnapCenter®平台集成。NetApp SnapCenter是一款用于编排基于Snapshot的备份、执行还原和创建FlexClone卷的工具。通过这种集成、SAP管理员可以使用NetApp技术显著加快SAP系统的日常运营任务。Snapshot、FlexClone和NetApp SnapRestore®软件可加快备份、还原和克隆操作的速度，因为NetApp存储技术是基于指针的。这种方法很快。此外、它还可以降低克隆操作期间的存储开销、因为无论存储介质是内部NetApp存储系统还是三大云提供商之一的NetApp存储解决方案、都只会向存储介质写入新数据和更改过的数据。</block>
  <block id="d62c5e03ce9e8ec0422f7decd2dfd9bf" category="paragraph">本文档面向以前手动执行过SAP系统副本并希望使用Avantra自动执行此活动的SAP系统管理员。将NetApp快照和FlexClone技术(由NetApp SnapCenter协调)与Avantra工作流相结合的预期目标是、通过完全自动化来加快SAP系统副本的速度。</block>
  <block id="75c0f54f014e4ab6e3f22f5cd507650c" category="paragraph">术语SAP系统副本通常用作三个不同流程的统称：SAP系统克隆、SAP系统副本和SAP系统刷新。区分不同的操作非常重要、因为工作流和用例不同。</block>
  <block id="ed89e0187c6fe54d2628ba3c924c9c94" category="list-text">*SAP系统克隆*。SAP系统克隆是源SAP系统的相同克隆。SAP系统克隆通常用于解决逻辑损坏或测试灾难恢复场景。对于系统克隆操作、主机名、实例编号和安全标识符(SID)保持不变。因此、必须为目标系统建立适当的网络隔离、以确保与生产环境之间不存在通信。</block>
  <block id="29fa3c48f12e6309c32da9e61f69bd28" category="inline-image-macro">显示SAP系统克隆的图像</block>
  <block id="b587c7fd00a525678062695450301092" category="list-text">*SAP系统副本*。SAP系统副本是使用源SAP系统中的数据对新目标SAP系统进行的设置。例如、目标系统可以是一个额外的测试系统、其中包含来自生产系统的数据。源系统和目标系统的主机名、实例编号和SID不同。 新系统不会与源系统隔离。</block>
  <block id="16638dad50a76bca5e7a86dc7294fc2c" category="inline-image-macro">显示SAP系统副本的图像</block>
  <block id="fbd198ef31d57ae3a5f9b9fb5639e948" category="list-text">*SAP系统更新。*SAP系统刷新是使用源SAP系统中的数据对现有目标SAP系统进行的刷新。目标系统通常是SAP传输环境(例如沙盒系统)的一部分、该系统会使用生产系统中的数据进行刷新。源系统和目标系统的主机名、实例编号和SID不同。</block>
  <block id="a7d281aa380b84143ba85c264cace3d9" category="inline-image-macro">显示SAP系统刷新的图像</block>
  <block id="59159350e4004274c8676b9d48b16a41" category="paragraph">尽管我们有三种不同的用例、但数据管理流程保持不变。所有这三种使用情形都在利用相同的底层数据管理技术：NetApp Snapshot和FlexClone。</block>
  <block id="9f502a9c7a5bc34e196821573f56b625" category="list-text">安装了SnapCenter代理和SnapCenter数据库插件的SAP源系统</block>
  <block id="03c806031b59c42ed3e4c7683d699982" category="list-text">安装了SnapCenter代理和SnapCenter数据库插件的SAP目标系统</block>
  <block id="14472d6a98b6c5946fee1bdeaaa9d46d" category="list-text">已配置SAP源系统和SAP目标系统的Avantra系统</block>
  <block id="c287b1e946c387c0a7339a652e03b5ce" category="list-text">物理内部部署硬件：NetApp AFF A系列、AFF C系列、ASA A系列、ASA C系列或FAS系列</block>
  <block id="b0904b80e0af825ba00610ce914a3ac9" category="list-text">内部软件定义的存储：NetApp ONTAP®Select</block>
  <block id="f61f14ca64e865d9739d260389f4af92" category="list-text">AWS、Google Cloud或Azure中的NetApp Cloud Volumes ONTAP®</block>
  <block id="842a4e33040fe08e0af52e5aaf27c55f" category="list-text">Amazon FSx for NetApp ONTAP (AWS)</block>
  <block id="fd559ee283f10c8dbc8f698f620ac779" category="paragraph">下图显示了Avantra服务器、NetApp SnapCenter服务器、NetApp存储系统、SAP源系统和SAP目标系统、以及所有内容的集成方式。其目标是、通过使用SnapCenter REST API最大限度地重复使用现有组件中已完成的配置工作、使集成尽可能灵活。</block>
  <block id="3086cba5137fd0545d778e498d9cd6e2" category="paragraph">为了缩短时间、自动执行运营任务并消除基础架构、数据库和应用程序级别的人为错误、您可以使用Avantra工作流。此集成使用NetApp Snapshot和FlexClone技术、而不是将备份从源系统还原到目标系统、这不仅耗时、而且会占用大量资源。启动数据库所需的所有任务只需几分钟而不是几小时即可完成。克隆过程所需的时间与数据库大小无关；因此、即使是非常大的系统、也只需几分钟即可创建完毕。Avantra可自动执行操作系统和数据库级别以及SAP后处理端的任务、从而进一步缩短运行时间。</block>
  <block id="6a3fec98537c549a047e819f8599d98d" category="paragraph">下图显示了使用自动化时可能会提高的运营效率。</block>
  <block id="7d8c66dbd94dc77e4312c93bd7586097" category="section-title">集成不同的技术组件</block>
  <block id="878da1642730c1593c6b76bdb0d9fda8" category="paragraph">SnapCenter在Avantra工作流中的实际集成包括使用JavaScript访问NetApp SnapCenter REST API。这种基于REST API的集成可创建SAP源系统的Snapshot副本、创建FlexClone卷并将其挂载到SAP目标系统上。</block>
  <block id="f07c14433779a55a296b481246a75c8e" category="paragraph">存储和SAP管理员已投入大量时间和专业知识来开发由SnapCenter触发并由SnapCenter代理执行的脚本、以便自动执行重复的日常操作任务。这种松散耦合的架构使用JavaScript触发SnapCenter任务、使他们能够重复使用现有自动化过程、使用Avantra作为端到端自动化的工作流引擎、更快地实现所需结果。</block>
  <block id="08d13577d2c770db53482bcfe9f627e4" category="paragraph">Avantra和NetApp数据管理技术相结合、提供了一个功能强大的解决方案、可以显著减少执行与SAP系统管理相关的最复杂、最耗时的任务所需的时间和精力。这种组合还有助于避免人为错误可能导致系统之间的配置偏离。</block>
  <block id="cf3525ddd7a64e1adddcca6e929f690e" category="paragraph">由于系统更新、副本、克隆和灾难恢复测试都是非常敏感的过程、因此实施此类解决方案可以节省宝贵的管理时间。它还可以增强业务部门员工对SAP系统管理员的信任：他们将看到可以节省多少故障排除时间、以及复制系统以用于测试或其他目的有多容易。无论源系统和目标系统运行在内部环境、公有云还是混合或混合多云环境中、该解决方案都能提供这些优势。</block>
  <block id="bf0f42271b1628d48d24ff9e96c0a40d" category="paragraph">要了解有关本文档所述信息的更多信息，请查看以下文档和网站：</block>
  <block id="b97f5ca6428e5b00c71db4299dfc3d6f" category="inline-link-macro">Avantra</block>
  <block id="2fc4f84f847c8ac3075ea580dfac45a1" category="list-text"><block ref="2fc4f84f847c8ac3075ea580dfac45a1" category="inline-link-macro-rx"></block></block>
  <block id="bf51eb5d79e16ead1ceda527dda582b6" category="inline-link-macro">SnapCenter 服务器和插件支持的REST API</block>
  <block id="857bb4eb3e8e725c7b53c4c49b9f8f61" category="list-text"><block ref="857bb4eb3e8e725c7b53c4c49b9f8f61" category="inline-link-macro-rx"></block></block>
  <block id="9d04f10ec6d5f74dbca6cec4d7147125" category="cell">03.2024</block>
  <block id="313d8d29b054407c3e1bee8fe2e46793" category="cell">整合NetApp同事的反馈。</block>
  <block id="fb4990156c52dedabc6397ade7e76401" category="cell">版本0.3</block>
  <block id="21a718b5ebef012a391d552cfaa4536e" category="cell">已集成请求的更改、以符合NetApp品牌要求</block>
  <block id="420d57080e1f02fbdb40396ad217482c" category="cell">0.4版</block>
  <block id="e6fe0ae39ed3c7447d6a4da5d99ea3a2" category="summary">本文档重点介绍如何使用NetApp Playbooks和自定义脚本将SAP®存储系统集成到SAP Landscape Management (LAMA)中，无论这些系统是在内部、公共云基础架构即服务(IaaS)环境中运行，还是在混合云中运行。</block>
  <block id="566e3b562a12b1ef1896ee777b47ed0c" category="doc">SB-4292：使用Ansfailed实现SAP自动化</block>
  <block id="1dc246d1e2dc4afc0e866ed9c1e00b34" category="paragraph">本文档重点介绍如何使用NetApp Playbooks和自定义脚本将SAP®存储系统集成到SAP Landscape Management (LAMA)中，无论这些系统是在内部、公共云基础架构即服务(IaaS)环境中运行，还是在混合云中运行。</block>
  <block id="375a68bbd8b09c30759cb49ee66744c6" category="paragraph">SAP系统非常复杂。但是、对于使用SAP的公司来说、这些系统是其业务流程的核心。通过自动执行重复的日常运营任务、SAP系统管理员可以轻松管理更多系统、生成可重复的结果并减少人为错误。</block>
  <block id="a54e766cb8511b4b8768f1ba8fef2b0b" category="paragraph">本文档重点介绍如何使用NetApp Playbooks和自定义脚本将SAP®存储系统集成到SAP Landscape Management (LAMA)中，无论这些系统是在内部、公共云基础架构即服务(IaaS)环境中运行，还是在混合云中运行。通过这种集成，SAP管理员可以使用NetApp SnapSnapshot™和NetApp FlexClone®技术加快SAP系统刷新任务的速度。</block>
  <block id="3ed6d491000fa37ba8451c450195b4d8" category="paragraph">本文档面向在使用Ans得 自动化方面没有太多(或任何)经验的SAP系统管理员。它应有助于您开始使用Ans得、运行第一本操作手册、配置和运行第一个基于SAP Laama的系统刷新操作。</block>
  <block id="0bd125fc3eb80484cd714efb009c33da" category="paragraph">术语SAP系统副本通常用作三个不同过程的同义词：SAP系统克隆、SAP系统副本和SAP系统刷新。区分不同的操作非常重要、因为工作流和用例不同。</block>
  <block id="984d103d2ea6cdfaf50c6458b93d5060" category="list-text">*SAP系统克隆*。SAP系统克隆是源SAP系统的相同克隆。SAP系统克隆通常用于解决逻辑损坏或测试灾难恢复场景。对于系统克隆操作、主机名、实例编号和安全标识符(SID)保持不变。因此、必须为目标系统建立适当的网络隔离、以确保与生产环境之间不存在通信。</block>
  <block id="a06496f6b8f5d994759b94c9bc228c07" category="list-text">*SAP系统副本*。SAP系统副本是使用源SAP系统中的数据对新目标SAP系统进行的设置。例如、新的目标系统可以是一个额外的测试系统、其中包含来自生产系统的数据。源系统和目标系统的主机名、实例编号和SID不同。</block>
  <block id="a4806533200f7204846fc0516880a512" category="list-text">*SAP系统更新*。SAP系统刷新是使用源SAP系统中的数据对现有目标SAP系统进行的刷新。目标系统通常是SAP传输环境(例如、质量保证系统)的一部分、该系统会使用生产系统中的数据进行刷新。源系统和目标系统的主机名、实例编号和SID不同。</block>
  <block id="9e5ec677b1b1648311e97cf94e0b2d0e" category="paragraph">下图显示了与NetApp存储相关的SAP系统克隆、复制和刷新Laama工作流步骤。</block>
  <block id="f74def37972ee4394be8cad5651663f7" category="inline-image-macro">此图显示了与NetApp存储相关的SAP系统克隆、复制和刷新Laama工作流步骤</block>
  <block id="54881e79c7640a505cefd7ba1f3b20cc" category="list-text">SAP Laama系统</block>
  <block id="4eebc5ed40ce93bfc87d749fb237b7a3" category="list-text">NetApp存储系统</block>
  <block id="0bbb1b0fa380975becacfe2ebad8efcb" category="list-text">安装了SAP Host Agent的可变控制节点。我们建议使用Red Hat Ans得 自动化平台、因为它具有其他优势、例如：</block>
  <block id="3a02ab6c19eb5b6b13f624909cbdd908" category="list-text">使用AI为自动化任务生成代码建议</block>
  <block id="9ed57c8ba167159dadbe28961386f0ee" category="list-text">利用事件驱动型自动化减少手动任务</block>
  <block id="585e67e2ba5c513b961c51dd9ccc25fd" category="list-text">定义明确、一致且可移植</block>
  <block id="c2348bd887e6c8f4e4cb3e1ecc4c7168" category="list-text">跨环境扩展自动化</block>
  <block id="ba9d2fdcf1098320fd5ab8e8940c1d46" category="list-text">利用预打包的内容加快自动化速度</block>
  <block id="ea936622c0742d5330429e7e68527d8a" category="list-text">利用丰富的报告和可观察性指标跟踪和管理自动化</block>
  <block id="4db35d276f281c64f50cfa4e820ff070" category="list-text">创建任务、模块和操作手册</block>
  <block id="352646e3f8da3248d7552209da6eab5f" category="paragraph">下图显示了SAP Laama和NetApp存储系统如何通过《溶入手册》在专用的溶入主机上进行集成、该主机是由从SAP主机代理执行的Shell脚本触发的。</block>
  <block id="a4afd73c26d98d43a41848b904c8e361" category="inline-image-macro">此图显示了SAP Laama和NetApp存储系统如何通过《安可通操作手册》在专用的安可通主机上集成、该主机是由从SAP主机代理执行的Shell脚本触发的</block>
  <block id="385f57610e19e7eac92f41a1dc35251b" category="paragraph">要在基础架构和数据库层加快并自动执行所需任务、您可以使用SAP Laama和NetApp克隆工作流。SAP Laama不是将备份从源系统还原到目标系统、而是使用NetApp Snapshot和FlexClone技术、这样启动数据库所需的任务只需几分钟而不是几小时即可完成、如下图所示。克隆过程所需的时间与数据库大小无关；因此、即使是非常大的系统、也可以在几分钟内创建完成。您可以通过自动执行操作系统和数据库层以及SAP后处理端的任务来进一步缩短运行时间。</block>
  <block id="4babb6cd725c24c36d2e3770f6a5f825" category="inline-image-macro">此图显示了使用自动化时可能会提高的运营效率</block>
  <block id="1b99d3bbfb2ea06147cee599d13b4d4d" category="paragraph">要使用NetApp将SAP Laama与SAP存储系统集成、您需要一个可运行Ans得 虚拟手册的节点。我们建议使用"Ans还是 自动化平台"。要在此主机(从SAP Lama启动)上运行shell脚本和Andsent Playbooks、您需要在此服务器上运行一个正在运行的SAP Host Agent。SAP Host Agent接管与SAP Laama的双向通信、并执行Shell脚本、这些脚本将触发实际的操作手册。</block>
  <block id="a1350e44a1de9e3b2a31107d1a80273c" category="paragraph">这种松散耦合的架构让您可以自由地从SAP Lama启动工作流、也可以在SAP Lama外部启动工作流。只需配置一次操作手册和相应逻辑、即可用于不同的场景和使用情形。</block>
  <block id="992397c8c640ca562524a875b68a5b54" category="paragraph">NetApp、SAP Laama和Ans得 自动化平台相结合、提供了一个功能强大的解决方案、可以显著减少与SAP系统管理相关的最复杂、最耗时的任务所需的时间和工作量。这种组合还有助于避免人为错误可能导致系统之间的配置偏离。</block>
  <block id="c28874e4beb098c91d1e1c3be126df41" category="paragraph">由于系统更新、副本、克隆和灾难恢复测试是非常敏感的过程、因此实施此类解决方案可以节省宝贵的管理时间。它还可以增强组织其他成员对SAP系统管理员的信任：他们将看到复制系统以用于测试或其他目的是多么容易、以及可以节省多少故障排除时间。</block>
  <block id="8aadfa67c47b74f799fb7a826a48ba03" category="inline-link-macro">通过使用适用于NetApp ONTAP®的Ans得 可操作手册自动执行日常的第1天和第2天操作</block>
  <block id="9f642d22ffdfa2b795d80b29088d3fb0" category="list-text"><block ref="9f642d22ffdfa2b795d80b29088d3fb0" category="inline-link-macro-rx"></block></block>
  <block id="3ddd20790842649d51a5cc4b6f01db26" category="inline-link-macro">NetApp专用的Ans｝文档</block>
  <block id="f12dd99ccfdacc7ea0c21003056e4741" category="list-text"><block ref="f12dd99ccfdacc7ea0c21003056e4741" category="inline-link-macro-rx"></block></block>
  <block id="fef9e784fccd2c3b2ebf4bfcd80e0305" category="inline-link-macro">NetApp ONTAP的"Ands还是"模块和完整文档</block>
  <block id="0603ed1da71fc41c57bbabf1699bdbde" category="list-text"><block ref="0603ed1da71fc41c57bbabf1699bdbde" category="inline-link-macro-rx"></block></block>
  <block id="bdbdb20cc2fc78414e07344a2494b8a4" category="inline-link-macro">Red Hat Ans授 人自动化平台</block>
  <block id="b4da856a893c686c8e2e2539db5024fe" category="list-text"><block ref="b4da856a893c686c8e2e2539db5024fe" category="inline-link-macro-rx"></block></block>
  <block id="16734dca3a95bfa535c02733aff6eba1" category="cell">03.2023</block>
  <block id="8badbfef801c8224f9c3f8be1ed7b075" category="cell">01.2024</block>
  <block id="30f75d5b61876317b00ce9486a8a0160" category="cell">请查看并进行一些小的更正</block>
  <block id="411b5f626e19bcfe479b7a04afe0a756" category="sidebar">借助Ans还是NetApp SnapCenter实现SAP自动化</block>
  <block id="286f4dd45534d6e8839dc5cb0fc36cee" category="sidebar">采用羊驼和NetApp SnapCenter的SAP自动化</block>
  <block id="314dcde42b7b98639a9e719950095987" category="sidebar">借助Avantra和NetApp SnapCenter实现SAP自动化</block>
  <block id="15a34eec6990a710b230cba1946c00f5" category="admonition">仅支持NFS版本3或4.1。不支持NFS版本1、2、4.0和4.2。</block>
  <block id="d566ef5684ce668e2e233d4eaf1bc9bc" category="summary">用于优化SAP生命周期管理的NetApp解决方案集成到SAP HANA数据库和生命周期管理工具中、将高效的应用程序集成数据保护与SAP测试系统的灵活配置相结合。</block>
  <block id="336f9054ed6c40bfa87995259d52c441" category="list-text">脚本<block ref="d8eec050302627350eb082c264bec8f6" prefix=" " category="inline-code"></block>.sh用于系统刷新和系统克隆工作流、以执行SAP HANA数据库的恢复和关闭操作。</block>
  <block id="aa0032fd81eb09be326e909e196e2530" category="list-text">该脚本<block ref="7475fe06dd4f4cf4edc0c5536fb55aa4" prefix=" " category="inline-code"></block> 用于系统克隆工作流、以便对SAP HANA共享卷执行挂载和卸载操作。</block>
  <block id="49ca516bb882e077657e5caf44f5554c" category="admonition">示例脚本按原样提供、NetApp不支持。您可以通过电子邮件ng-sapcc@netapp.com申请这些脚本。</block>
  <block id="ec86531daff86121e81aad761a9a2690" category="paragraph">示例脚本<block ref="3b7212a09a85af46251eb075db2a1a3f" prefix=" " category="inline-code"></block> 用于执行恢复和关闭操作。该脚本在SnapCenter工作流克隆创建和克隆删除中使用特定命令行选项进行调用、如下图所示。</block>
  <block id="6fb4e29ab144b52fbcda87e4d76c8e72" category="paragraph">该脚本是通用脚本、可读取所有必需参数、例如目标系统中的SID。此脚本必须在系统刷新操作的目标主机上可用。必须为目标系统上的用户&lt;SID&gt;配置hdb用户存储密钥。该密钥必须允许访问SAP HANA系统数据库、并为恢复操作提供权限。该密钥必须名称为&lt;TARGET-SID&gt; Y。</block>
  <block id="3c014f6281927540111102bce68d0558" category="paragraph">该脚本会将日志文件写入到执行该文件<block ref="c05a8d917e2f24fc448cfc8148b37936" prefix=" " category="inline-code"></block>的同一目录中。</block>
  <block id="a080c4899461aaff7b3f15fee991c3ee" category="admonition">此脚本的当前版本支持单主机系统的单租户模式(即、单租户模式)或多租户模式(即、多租户模式)。它不支持SAP HANA多主机系统。</block>
  <block id="cb110c7da4ff7c2a06badbb62ec1653b" category="paragraph">如"SAP HANA系统使用存储快照刷新操作工作流"一节所述、目标系统上可能的租户恢复操作取决于源系统的租户配置。该脚本<block ref="3b7212a09a85af46251eb075db2a1a3f" prefix=" " category="inline-code"></block> 支持所有租户恢复操作、这些操作可能取决于源系统配置、如下表所示。</block>
  <block id="1ef2b56ddfcd99f390770f6561dd39eb" category="cell">SAP HANA系统</block>
  <block id="eb2c4fe5704d6239af3e788b691acb39" category="cell">租户配置+源系统上的</block>
  <block id="be1cf788ffbccce8c3a6384d5c26bda3" category="cell">生成的租户配置+目标系统上的租户配置</block>
  <block id="007b28be8cfeffaa18a794ecdfc270ce" category="cell">所有租户均已恢复、并且与源租户具有相同的名称。</block>
  <block id="86fdcb026a68ce13c9b6d32c97d35e44" category="paragraph">此示例脚本<block ref="7475fe06dd4f4cf4edc0c5536fb55aa4" prefix=" " category="inline-code"></block> 用于对任何卷执行挂载和卸载。该脚本用于通过SAP HANA系统克隆操作挂载SAP HANA共享卷。该脚本在SnapCenter工作流克隆创建和克隆删除中使用特定命令行选项进行调用、如下图所示。</block>
  <block id="c5b136d95c05fafb00b08d1b6de1298f" category="admonition">该脚本支持使用NFS作为存储协议的SAP HANA系统。</block>
  <block id="b09246e75feeec9e487b59536bd8a9f6" category="list-text">脚本变量<block ref="39bd1f4447a9d2f7774d0f0e74e3bdbf" prefix=" " category="inline-code"></block> 用于挂载操作。</block>
  <block id="fc4b53712edbb1a5d2bb0efb910def4f" category="list-text"><block ref="0ac10a7b46d56b5cde60023a9baed25b" prefix="" category="inline-code"></block></block>
  <block id="f59340f31d7d375c72c0b4a9b1d9742d" category="list-text">例如：<block ref="558125a9317a2a85b66f3a4e57d5f2a6" prefix=" " category="inline-code"></block></block>
  <block id="05ebd5b68d560730417ec3a7cebf8f0c" category="paragraph">例如：<block ref="d3214244532fad50dea7d8ad9dd48289" prefix=" " category="inline-code"></block></block>
  <block id="d8936b3ac6f55edd9850b165b9222bd3" category="doc">使用存储快照备份执行SAP HANA系统刷新操作的注意事项</block>
  <block id="99a19cb6edc6f11b19ea813ec205ff66" category="section-title">目标系统上的租户名称</block>
  <block id="57ae5f35f217b1a419a04e5d9c231880" category="paragraph">执行SAP HANA系统刷新所需的步骤取决于源系统租户配置以及目标系统上所需的租户名称、如下图所示。</block>
  <block id="2272aa1a0ba3525f3f73d9547239e789" category="paragraph">由于租户名称是在系统数据库中配置的、因此、在恢复系统数据库后、目标系统也会提供源系统的租户名称。因此、目标系统上的租户只能使用与源租户相同的名称进行恢复、如选项1所示。如果目标系统上的租户名称必须不同、则必须先使用与源租户相同的名称恢复租户、然后将其重命名为所需的目标租户名称。这是选项2。</block>
  <block id="81eb74990998ec7670788a4b5d26b6d5" category="paragraph">此规则的一个例外是具有单个租户的SAP HANA系统、其中租户名称与系统SID相同。此配置是首次安装SAP HANA后的默认配置。SAP HANA数据库会标记此特定配置。在这种情况下、可以使用目标系统的租户名称在目标系统上执行租户恢复、该名称也必须与目标系统的系统SID相同。此工作流显示在选项3中。</block>
  <block id="62b2eae75a95f0f95105ee2a3dd86456" category="admonition">一旦在源系统上执行任何租户创建、重命名或删除操作、SAP HANA数据库就会删除此配置标志。因此、即使已将配置恢复为租户= SID、此标志也不再可用、并且无法再使用工作流3进行租户恢复。在这种情况下、所需的工作流为选项2。</block>
  <block id="590a83044f8275cb44757e91bd9c3b98" category="section-title">启用了SAP HANA加密的系统刷新工作流</block>
  <block id="ed0497f02ad9f417117b309a43ded20a" category="paragraph">启用SAP HANA持久性加密后、需要执行其他步骤、才能在目标系统上恢复SAP HANA数据库。</block>
  <block id="6b8ec54bea4ea8f350ee72bf85d3197e" category="paragraph">在源系统上、您需要为系统数据库以及所有租户数据库创建加密根密钥备份。在执行恢复操作之前、必须将备份文件复制到目标系统、并且必须从备份中导入根密钥。</block>
  <block id="04237ca9906c07207034914aa0a28d82" category="paragraph">另请参见<block ref="359a6667f10cfbec6ec52789f37c6e2a" category="inline-link-rx"></block>。</block>
  <block id="886ad05cbab7f831b411778c068cf8fe" category="section-title">备份根密钥</block>
  <block id="cd171c61a6c45e294f3c2dacc7604931" category="paragraph">如果对根密钥进行了任何更改、则始终需要备份根密钥。backup命令需要使用DBID作为CLI参数。可以使用以下SQL语句来标识DBID。</block>
  <block id="3ce4fd31388596ecdf4aa9f1d9a0dbc4" category="inline-link">备份根密钥| SAP帮助门户</block>
  <block id="f282798b107e6bd69bc9acc72b3efd4f" category="paragraph">《SAP HANA管理指南》中提供了SQL语句和其他文档、<block ref="d8ff24c5498b932cc400dcdc7a192184" category="inline-link-rx"></block> 步骤如下展示了具有单个租户SS1的HANA系统所需的操作、并在源系统上执行。</block>
  <block id="336adde13fb7bcd7ee2cc8512c4e28c1" category="list-text">为系统和租户(SS1)数据库设置备份密码(如果尚未设置)。</block>
  <block id="52a807914c4090676f1da43186acbb62" category="list-text">为系统和租户(SS1)数据库创建备份根密钥。</block>
  <block id="6c6f42bf225663c8095edb7191abafeb" category="list-text">验证根密钥备份(可选)</block>
  <block id="af9e006c18dd68581986b528bd3587ed" category="section-title">在目标系统导入根密钥</block>
  <block id="da9228e0010f7027b69ecf2177e4e0df" category="paragraph">首次执行系统刷新操作时、最初需要导入根密钥。如果源系统上的根密钥未更改、则不需要额外导入。导入命令需要使用DBID作为CLI参数。DBID的标识方式与根密钥备份的标识方式相同。</block>
  <block id="e11644d1968838d5f12339cef8291bb4" category="list-text">在我们的设置中、根密钥会从源系统复制到NFS共享</block>
  <block id="3c23689c9bd2b975721e1135bd6927a6" category="list-text">现在可以使用hdbnsutil导入根密钥。必须使用命令提供系统和租户数据库的DBID。此外、还需要备份密码。</block>
  <block id="9a35e9fdafa89a1bf9716ff9ad8fae50" category="section-title">如果目标上不存在DBID、则导入根密钥</block>
  <block id="2af112c8b5eb82cec7858ff26e1c8899" category="paragraph">如上一章所述、要导入系统和所有租户数据库的根密钥、需要使用DBID。虽然系统数据库始终为DBID=0、但租户数据库可以具有不同的DBID。</block>
  <block id="f04f1954909c57195f4a0f8986e0190c" category="paragraph">以上输出显示了两个租户、其中DBID=3和DBID=4。如果目标系统尚未托管DBID=4的租户、则根密钥导入将失败。在这种情况下、您需要先恢复系统数据库、然后使用DBID=4导入租户的密钥。</block>
  <block id="3733c3274128a83f463e1febad4cb73a" category="paragraph">用于优化SAP生命周期管理的NetApp解决方案已集成到SAP HANA数据库和生命周期管理工具中、将高效的应用程序集成数据保护与灵活配置SAP测试系统相结合、如下图所示。这些解决方案适用于在内部环境中运行的SAP HANA或在云中运行的Azure NetApp Files (ANF)或Amazon FSx for NetApp ONTAP (FSx for ONTAP)。</block>
  <block id="253f7d7cde63d67097785efdf27d8e0c" category="section-title">*应用程序集成的Snapshot备份操作*</block>
  <block id="f695e91ee04884971f5a7436b91e4be8" category="paragraph">在存储层创建应用程序一致的Snapshot备份的能力是本文档所述系统复制和系统克隆操作的基础。基于存储的Snapshot备份是使用适用于SAP HANA的NetApp SnapCenter 插件以及SAP HANA数据库提供的接口创建的。SnapCenter 会将Snapshot备份注册到SAP HANA备份目录中、以便这些备份可用于还原和恢复以及克隆操作。</block>
  <block id="291d1a2808e806584ab1c34cbb1a18c0" category="section-title">*异地备份和/或灾难恢复数据复制*</block>
  <block id="70919c30c9aaacd076b6aad76e43d879" category="paragraph">应用程序一致的Snapshot备份可以在存储层复制到异地备份站点或由SnapCenter 控制的灾难恢复站点。复制基于更改过的块和新块、因此可节省空间和带宽。</block>
  <block id="ba9e50e0a1abcf0eeed3341c8d182a39" category="section-title">*使用任何Snapshot备份执行SAP系统复制或克隆操作*</block>
  <block id="1400c6c3a81a83b42b2e1bfa00b4f08d" category="admonition">内部NetApp系统和Amazon FSx for NetApp ONTAP均支持从异地备份或灾难恢复存储克隆。使用Azure NetApp Files时、只能在源卷上创建克隆。</block>
  <block id="7e22a4a705cb1e44da3a7fa13d9330fb" category="section-title">*集成自动化*</block>
  <block id="86aedb2a5d0e4cc1e18959a121d927a4" category="paragraph">可以使用第三方工具和集成的NetApp功能来执行完全自动化的SAP测试系统端到端配置。有关更多详细信息、请访问：</block>
  <block id="0d3a34f8f2f65da1aab448f0cef55601" category="paragraph"><block ref="0d3a34f8f2f65da1aab448f0cef55601" category="inline-link-rx"></block></block>
  <block id="bcaeb718111fd28a80ff0468446a8cca" category="inline-link">TR-4929：《使用L运营 效率系统复制自动化SAP系统复制操作》(netapp.com)</block>
  <block id="107ac79d952c7eb2bd9be77492e3f580" category="paragraph"><block ref="107ac79d952c7eb2bd9be77492e3f580" category="inline-link-rx"></block></block>
  <block id="b86922f81f8fbdc269eb147c0132320d" category="inline-link">利用羊驼和NetApp SnapCenter自动执行SAP系统复制和放大器；44；刷新和放大器；44；以及克隆工作流</block>
  <block id="e1f1030df08efb36640b5cef2cf335df" category="paragraph"><block ref="d27595d323fd1e6688825ef5f48b58ba" category="inline-link-rx"></block></block>
  <block id="ef9c1ed1eec5b69c3ed64cd0c51e91f5" category="inline-link">借助Avantra和NetApp SnapCenter自动执行SAP系统复制和放大器；#44；刷新和放大器；#44；以及克隆工作流</block>
  <block id="33d46668d501c0fd2d88d560367b301e" category="paragraph"><block ref="612e0940831df733c80bffb77d00a0fb" category="inline-link-rx"></block></block>
  <block id="5e159ddb5310fc1d30282d2680fcae12" category="paragraph">如上一节所述、SnapCenter 可以从任何现有Snapshot备份管理数据集的克隆、并可将这些数据集快速配置到任何目标系统。灵活灵活地将生产数据配置到修复系统以解决逻辑损坏至关重要、因为通常需要重置修复系统并选择不同的生产数据集。FlexClone技术可实现快速配置过程、并可显著节省容量、因为修复系统通常只能在短时间内使用。</block>
  <block id="99f37d6bcbc15f5a2f030419d3a43170" category="paragraph">下图总结了使用SnapCenter执行SAP系统克隆操作所需的步骤。</block>
  <block id="6adc11bc6e0f34c4086c389511eccf77" category="list-text">适用于SAP HANA共享卷的SnapCenter克隆创建工作流。</block>
  <block id="3334a5d45d4ab3ed5e8fac320282f236" category="list-text">适用于SAP HANA数据卷的SnapCenter克隆创建工作流、包括数据库恢复。</block>
  <block id="11733d6a63d8e319f8af4dfdbae0f156" category="list-text">SAP HANA系统现在可用作修复系统。</block>
  <block id="19c1631605a596df1a5aa9b6ada6f550" category="list-text">适用于SAP HANA数据卷的SnapCenter克隆删除工作流、包括数据库关闭(使用自动化脚本时)。</block>
  <block id="2496728194ae81963fd344f8d300397c" category="list-text">适用于SAP HANA共享卷的SnapCenter克隆删除工作流。</block>
  <block id="d9de7f702e8fd112fa358cb13b6860e3" category="admonition">如果必须将系统重置为其他Snapshot备份、则步骤6和步骤4就足以满足要求。不需要刷新SAP HANA共享卷。</block>
  <block id="c46ef19a1340287af560e4a95498efff" category="paragraph">SnapCenter提供的工作流允许您从任何现有Snapshot备份管理数据集的克隆。此克隆数据集是一个FlexClone卷、可用于从源系统快速配置HANA数据卷并将其连接到目标系统。因此、它非常适合对QA、测试、沙盒或培训系统执行系统刷新操作。</block>
  <block id="e33a7ba0a145b92332e5a214da5f0b7e" category="paragraph">SnapCenter 克隆工作流可处理存储层上的所有必需操作、并可使用脚本进行扩展以执行主机特定操作和HANA数据库特定操作。在本文档中、我们将使用脚本执行HANA数据库恢复和关闭操作。使用脚本实现进一步自动化的SnapCenter 工作流可处理所有必需的HANA数据库操作、但不包括任何所需的SAP后处理步骤。SAP后处理必须手动执行或使用第三方工具执行。</block>
  <block id="f58b84023a4279ee2a567eb3c380fb35" category="paragraph">使用SnapCenter的SAP系统刷新工作流包括五个主要步骤、如下图所示。</block>
  <block id="c6fa61b09f8df64b162b460b69ac8069" category="list-text">目标系统的一次性初始安装和准备</block>
  <block id="0158f9b30056021a175e96d4f836415b" category="list-text">SnapCenter HANA插件必须安装在新的目标系统上、并且必须在SnapCenter中配置HANA系统</block>
  <block id="8415b5eee52c3d01b2d370fe398a5951" category="list-text">必须停止目标系统、并且必须卸载HANA数据卷</block>
  <block id="8fe61949b8b56ec8da525f4acbba93de" category="list-text">SnapCenter克隆创建工作流</block>
  <block id="9ebae8e0bfc2f8e5b5b9a6e8a00fca6a" category="list-text">SnapCenter会为源系统的选定Snapshot创建一个FlexClone卷</block>
  <block id="eb273cd7f5324ffbf92aeecff9ff3a97" category="list-text">SnapCenter会将FlexClone卷挂载到目标系统</block>
  <block id="56b43ec1d85e7efde50be2f2d2ead918" category="list-text">可以使用脚本作为后处理脚本来自动恢复目标HANA数据库<block ref="d8eec050302627350eb082c264bec8f6" prefix=" " category="inline-code"></block> 、也可以手动执行</block>
  <block id="937826f7ea9205ca3512d509a6ca8a78" category="list-text">SAP后处理(手动或使用第三方工具)</block>
  <block id="020b657f2ba667b7c8125459d9f08450" category="list-text">该系统现在可用作测试/QA系统。</block>
  <block id="e849346a4770c0465337a49c10973303" category="list-text">请求新系统刷新时、将使用SnapCenter克隆删除工作流删除FlexClone卷</block>
  <block id="8e91d4bf6d06ab88552ea7233f10f6a1" category="list-text">如果目标HANA系统已在SnapCenter中受到保护、则必须先删除保护、然后再启动克隆删除工作流。</block>
  <block id="96888e9c90caae0063e746ed75f814e1" category="list-text">必须手动停止HANA系统、或者使用该脚本作为SnapCenter预处理脚本自动停止HANA系统<block ref="d8eec050302627350eb082c264bec8f6" prefix=" " category="inline-code"></block></block>
  <block id="fb4b6d894aa9bb0e852938feaa8dbd6f" category="list-text">SnapCenter卸载HANA数据卷</block>
  <block id="fc7b39f931e97a5620b60594593a3ded" category="list-text">SnapCenter将删除FlexClone卷</block>
  <block id="01cd3fe546b8551fcb17aab105bfd54d" category="list-text">步骤2将重新启动刷新。</block>
  <block id="29455d0165f5fd37f1ddd0e1acde2d19" category="paragraph">在大多数情况下、目标测试/QA系统的使用时间至少为几周。由于FlexClone卷会阻止源系统卷的Snapshot、因此根据源系统卷上的块更改率、此Snapshot将需要额外的容量。如果生产源系统的平均变更率为每天20%、则被阻止的Snapshot将在5天后达到100%。因此、如果克隆基于生产源系统、NetApp建议立即或几天后拆分FlexClone卷。克隆拆分操作不会阻止使用克隆的卷、因此、可以在使用HANA数据库时随时执行。</block>
  <block id="fec549457b5ca8b6fab2e0ae6d6e75a6" category="admonition">对于SnapCenter和Azure NetApp Files、克隆拆分操作不可用、因为Azure NetApp Files始终会在创建后拆分克隆。</block>
  <block id="6f1539c5dce675aa44b87f7f9f369176" category="paragraph">包括克隆拆分在内的刷新操作包括以下步骤。</block>
  <block id="4fe3df0af2aa4e5f9eacca7e203e19cb" category="list-text">FlexClone卷使用SnapCenter克隆拆分工作流进行拆分。</block>
  <block id="f53badcf937e2258faf81fb846c9c3d4" category="list-text">请求新系统刷新时、可通过以下手动步骤完成清理</block>
  <block id="4d6aae36d78746a9a8fe6767a99cb8e7" category="list-text">如果目标HANA系统已在SnapCenter中受到保护、则必须删除此保护。</block>
  <block id="dc2c5e947a6cab89514335a13dc423e1" category="list-text">必须手动停止HANA系统</block>
  <block id="7c66351a8e30aafa989ed12950bed825" category="list-text">必须卸载HANA数据卷、并且必须删除SnapCenter中的fstab条目(手动任务)</block>
  <block id="69de215ba3fc3f69bd238db63e732bab" category="paragraph">根据SAP HANA数据库配置、系统会执行或需要准备其他步骤。下表提供了一个摘要。</block>
  <block id="48a431e7da72cf4ddb716b44e3bd3022" category="cell">源系统</block>
  <block id="f07b20b3bf641e75d700e21df41afa86" category="cell">源系统配置</block>
  <block id="445749c81622e3f4b55555307ee1b829" category="cell">SnapCenter和SAP HANA操作</block>
  <block id="02d433082554aa78e77702e422da1369" category="cell">单个租户的M委员会+ SID =租户名称</block>
  <block id="4538fddc8b1e4453fc76236736640432" category="cell">标准配置</block>
  <block id="0ab4f55de764dc8394643b349b083994" category="cell">SnapCenter克隆操作和可选的恢复脚本执行。</block>
  <block id="0a65e6a9e8d4b8b7c8582184102df1c5" category="cell">SAP HANA持久性加密</block>
  <block id="014c18a7ee780910ba664b6a0b978c06" category="cell">最初、或者如果源系统更改了根密钥、则必须先在目标系统导入根密钥备份、然后才能执行恢复。</block>
  <block id="89d86b9ec09c7f3b392bb43ea2eb6dd6" category="cell">SAP HANA系统复制源</block>
  <block id="99626cfc8b134a9568590f75a1fa39e9" category="cell">无需执行其他步骤。如果目标系统未配置HSR、则它将保留为独立系统。</block>
  <block id="55e4c24dca21aa659ae4ad4a62764c3a" category="cell">SAP HANA多个分区</block>
  <block id="9045ec7ce843df8f562cdac52976a8ef" category="cell">无需执行其他步骤、但目标系统上必须具有相同命名约定的SAP HANA卷分区挂载点(只有SID不同)。</block>
  <block id="747e7c5207b7c8c7b7c0d19a45e85b9a" category="paragraph">或具有SID &lt;&gt;租户名称的单租户+的移动模组</block>
  <block id="b202c7fafecac4cc268100693b999ff4" category="cell">SnapCenter克隆操作和可选的恢复脚本执行。脚本将恢复所有租户。如果目标系统名称中不存在租户或租户名称、则在SAP HANA恢复操作期间会自动创建所需目录。租户名称将与源名称相同、如果需要、需要在恢复后重命名。</block>
  <block id="fd8ed9109131dae1c0a52003f1f433ad" category="cell">如果目标系统之前不存在源系统的DBID、则必须先恢复系统数据库、然后才能导入此租户的根密钥备份。</block>
  <block id="eda5c3cd479d8bf56791258422f9d2e9" category="cell">HANA系统复制源</block>
  <block id="fee1d7f7b5a29f13c080fff62b1a3b65" category="cell">HANA多个分区</block>
  <block id="c8c7f73988a5c0973f17af8df0cb4dd9" category="list-text">从租户名称等于SID的主存储克隆</block>
  <block id="05590d33a5380f7b50af20fb1efa88b5" category="list-text">从异地备份存储克隆</block>
  <block id="11a5026e03c97eab61a881708b9b49c8" category="list-text">从具有多个租户的主存储克隆</block>
  <block id="3c25d22c9021a2e592956ec113805a27" category="paragraph">以下各节中介绍的工作流在SAP HANA系统架构和SnapCenter配置方面具有一些前提条件和限制。</block>
  <block id="e5e449d642ed48f133072437710b3002" category="list-text">所述工作流仅适用于SnapCenter 5.0或更高版本。</block>
  <block id="2878c2c0b8a2905a221c10c60a633bb9" category="list-text">所述工作流适用于具有单个或多个租户的单主机SAP HANA MDC系统。不涵盖SAP HANA多主机系统。</block>
  <block id="ee1298a4094419180908c6a8f9750843" category="list-text">必须在目标主机上部署SnapCenter SAP HANA插件、才能启用SnapCenter自动发现和执行自动化脚本。</block>
  <block id="831c78892fc4855cb4580e43283bcc00" category="list-text">这些工作流适用于在物理主机上使用NFS或FCP的SAP HANA系统、或者适用于使用子系统内NFS挂载的虚拟主机。</block>
  <block id="82265800899596c16d78fb324ee99ee9" category="paragraph">下图显示了用于不同系统刷新操作选项的实验室设置。</block>
  <block id="c1ccc7a2f7826dbffdffce4e5624e1e7" category="list-text">从主存储或异地备份存储克隆；租户名称等于SID。</block>
  <block id="2392da269b7d67c099f828cb74ad9c1b" category="list-text">源SAP HANA系统：SS1与租户SS1</block>
  <block id="ef01d4b10ea3ed41d87666599cdf399d" category="list-text">目标SAP HANA系统：QS1与租户QS1</block>
  <block id="95cc06694d517f9353d6b698b3b3bdc2" category="list-text">从主存储克隆；多个租户。</block>
  <block id="7c0d7757d3e67c52576fa49494e0d690" category="list-text">源SAP HANA系统：具有租户1和租户2的SM1</block>
  <block id="5d18cafd8986f8849c2f6bc0ff09d24f" category="list-text">目标SAP HANA系统：具有租户1和租户2的QS1</block>
  <block id="8e07dd0a7cef005f474929f3ccd8ab15" category="list-text">SnapCenter 5.0</block>
  <block id="0efafb1fb3d4bc2c365cbbb3af0533af" category="list-text">SAP HANA系统：HANA 2.0 SPS7修订版73</block>
  <block id="f77a693c238b55e124aad6c742f7abd9" category="list-text">SLES 15</block>
  <block id="20e87fcd4bc1712b811d18af13b0e6d6" category="list-text">ONTAP 9.14P1</block>
  <block id="e317060a7d536b1601805ade8ddc6de6" category="paragraph">所有SAP HANA系统都必须根据配置指南进行配置<block ref="dd07d4eccacfe7e5709724c01c4e864d" category="inline-link-rx"></block>。SnapCenter和SAP HANA资源是根据最佳实践指南进行配置的<block ref="bcd43d19ab2603538e662bd52af2d1e8" category="inline-link-rx"></block>。</block>
  <block id="9cf594fe38671c761a0b6e93fb10d913" category="paragraph">作为初始步骤、必须在SnapCenter中配置目标SAP HANA系统。</block>
  <block id="cefc420e25b581b96f90b91e0ff4cce1" category="list-text">安装SAP HANA目标系统</block>
  <block id="1598dcdc48c7cde690d109b2290d0744" category="list-text">在SnapCenter中配置SAP HANA系统、如中所述<block ref="acbd530cb7125fe2d3874791af43931e" category="inline-link-rx"></block></block>
  <block id="e7c20caad0a94652e99b08f067f64ee4" category="list-text">用于SnapCenter备份操作的SAP HANA数据库用户配置此用户在源系统和目标系统上必须相同。</block>
  <block id="628c9d08d98e85f5ed00ff90d451d924" category="list-text">为具有上述备份用户的&lt;sid&gt;配置hdbuserstore密钥。如果使用自动化脚本进行恢复、则密钥名称必须为&lt;SID&gt; Y</block>
  <block id="b0f3533d0b597ddb0a9a7b416ea89e64" category="list-text">在目标主机上部署SnapCenter SAP HANA插件。SnapCenter会自动发现SAP HANA系统。</block>
  <block id="645ee22e308ea0aafb5d3acc44bd0dcf" category="list-text">配置SAP HANA资源保护(可选)</block>
  <block id="3719947e600560be28eef96cf84ecefb" category="list-text">关闭目标SAP HANA系统</block>
  <block id="4a44e0462a55038e478c10bd7443f236" category="list-text">卸载SAP HANA数据卷。</block>
  <block id="db196b5d964c1f53d6294ccf9014b550" category="paragraph">您必须将应在目标系统上执行的脚本添加到SnapCenter允许的命令配置文件中。</block>
  <block id="5a299bcf5b5a9319251be4bb7bfdff03" category="paragraph">本节介绍了SAP HANA系统刷新工作流、其中、源系统和目标系统的租户名称与SID相同。存储克隆在主存储上执行，并使用脚本自动执行恢复<block ref="3b7212a09a85af46251eb075db2a1a3f" prefix=" " category="inline-code"></block>。</block>
  <block id="03f09cb006153d192d8c9fe50e970086" category="inline-link-macro">"使用存储快照备份执行SAP HANA系统刷新操作的注意事项"</block>
  <block id="157deab9bdbae6356460f733c40a755d" category="list-text">如果在源系统上启用了SAP HANA持久性加密、则必须导入一次加密根密钥。如果在源系统上更改了密钥、则还需要导入。请参见第章 <block ref="d89aa6607c9a60fbeb604656c86f4d61" category="inline-link-macro-rx"></block></block>
  <block id="d04adce820ccdbc17e627f19eb666286" category="list-text">如果目标SAP HANA系统已在SnapCenter中受到保护、则必须先删除此保护。</block>
  <block id="0b66e7539f72334708449da2e12d9bea" category="list-text">从源SAP HANA系统SS1中选择Snapshot备份。</block>
  <block id="b7de32cf0e13a0111d1b6c1b89e593ac" category="list-text">选择目标主机并提供目标主机的存储网络接口。</block>
  <block id="82f2589d399b8ea3a554792f2d8df999" category="list-text">提供目标系统的SID、在我们的示例QS1中</block>
  <block id="c9717f36d77a03c5f881f50aaab1f447" category="list-text">(可选)提供用于在克隆后操作中进行恢复的脚本。</block>
  <block id="0917c92ee20b51dab8079504f8afb4d6" category="list-text">根据源SAP HANA系统的选定Snapshot备份创建FlexClone卷。</block>
  <block id="ff94c3eee45cbfae940f9add0b4eb508" category="list-text">将FlexClone卷导出到目标主机存储网络接口或igrou。</block>
  <block id="07ade2cb0f2a92cfb2ee5a43961f3e10" category="list-text">在目标主机上执行挂载FlexClone卷的挂载操作。</block>
  <block id="314c2cce5caa9e6fcd928fc9c35302d1" category="list-text">执行克隆后操作恢复脚本(如果之前已配置)。否则、需要在SnapCenter工作流完成后手动执行恢复。</block>
  <block id="fc37d233917d319533af32bb51dba4ff" category="list-text">(可选)在SnapCenter中保护目标SAP HANA资源。</block>
  <block id="eb4b39872c9b3c2192257f6c1418c394" category="list-text">从源系统SS1中选择Snapshot备份、然后单击克隆。</block>
  <block id="45cb930cdf8bda3887a5e6b8bcf538b8" category="admonition">输入的目标SID用于控制SnapCenter管理克隆资源的方式。如果已在SnapCenter中配置了具有目标SID的资源、并且该资源与插件主机匹配、则SnapCenter只会将克隆分配给该资源。如果未在目标主机上配置SID、SnapCenter 将创建一个新资源。</block>
  <block id="bd49bd38980d1a48b9ac573cdf9cc7fe" category="admonition">在启动克隆工作流之前、请务必在SnapCenter中配置目标系统资源和主机。否则、SnapCenter创建的新资源将不支持自动发现、并且所述工作流将不起作用。</block>
  <block id="6b70c14bef490b5b4a9c096761e1d9ce" category="paragraph">在光纤通道SAN设置中、不需要导出IP地址、但您需要在下一屏幕中提供使用的协议。</block>
  <block id="2b23cdd09cd3ee449ae9f62aa220bc15" category="admonition">屏幕截图显示了使用光纤通道连接的不同实验室设置。</block>
  <block id="0893fd1866670782e0403c79e13cedce" category="paragraph">如果使用Azure NetApp Files和手动QoS容量池、则需要为新卷提供最大吞吐量。请确保容量池具有足够的性能余量、否则克隆工作流将失败。</block>
  <block id="984e3ff8040e7c400c8af9ccde982a58" category="admonition">屏幕截图显示了在Microsoft Azure中使用Azure NetApp Files运行的另一个实验室设置。</block>
  <block id="a246e063e5a58db55d7ef2e1bb5b2753" category="list-text">输入可选的克隆后脚本以及所需的命令行选项。在本示例中、我们使用克隆后脚本执行SAP HANA数据库恢复。</block>
  <block id="4b553d5e2901b3bd5ebdeaeaf95deb09" category="admonition">如前文所述、使用恢复脚本是可选的。也可以在SnapCenter克隆工作流完成后手动执行恢复。</block>
  <block id="180bfaef4a78bba04a268efdcb9583d8" category="admonition">用于恢复操作的脚本会使用清除日志操作将SAP HANA数据库恢复到Snapshot时间点、并且不会执行任何正向恢复。如果需要正向恢复到特定时间点、则必须手动执行恢复。手动前向恢复还要求目标主机可以使用源系统的日志备份。</block>
  <block id="ebfa595f3cfff6397d5505668de0daaf" category="list-text">SnapCenter 中的"作业详细信息"屏幕显示操作的进度。作业详细信息还显示、包括数据库恢复在内的整个运行时间不到3分钟。</block>
  <block id="35ae1427629c6141347a56f0f206a9aa" category="list-text">该脚本的日志文件<block ref="d8eec050302627350eb082c264bec8f6" prefix=" " category="inline-code"></block> 显示了为恢复操作执行的不同步骤。该脚本从系统数据库中读取租户列表、并对所有现有租户执行恢复。</block>
  <block id="484ee70604ccba123df2c8b647e52d46" category="list-text">SAP HANA数据库现在正在运行。</block>
  <block id="85766798d4ef3cbf9aab9706b8710129" category="list-text">如果要保护目标SAP HANA系统、则需要单击目标系统资源来运行自动发现。</block>
  <block id="371c81f2e3f355a3efc6d7a2704e44fe" category="paragraph">自动发现过程完成后、新克隆的卷将列在存储占用空间部分中。</block>
  <block id="93b753d711577984a6f989bbe3b0d5c7" category="paragraph">通过再次单击该资源、可以为刷新的QS1系统配置数据保护。</block>
  <block id="15be6cf7fdcb22e17d63f0e911172b26" category="paragraph">本节介绍了SAP HANA系统刷新工作流、其中、源系统和目标系统的租户名称与SID相同。存储克隆在异地备份存储执行、并使用脚本sc-system-refresh .sh进一步实现自动化。</block>
  <block id="eb60f75b56b459c5a2055a06898489e3" category="paragraph">如果选定备份有多个二级存储位置、则需要选择所需的目标卷。</block>
  <block id="029ffd9a3919273510e46b6290e3b8f7" category="paragraph">所有后续步骤均与从主存储克隆的工作流相同。</block>
  <block id="4962363e29e7acb600c871b9a2e605d7" category="section-title">克隆包含多个租户的SAP HANA系统</block>
  <block id="ed7b7ec143380db464dc6cf992d44bca" category="paragraph">本节介绍使用多个租户的SAP HANA系统刷新工作流。存储克隆在主存储上执行，并使用脚本进一步实现自动化<block ref="3b7212a09a85af46251eb075db2a1a3f" prefix=" " category="inline-code"></block>。</block>
  <block id="af91ea812cfad225a7ca2a1b156b3ce8" category="paragraph">SnapCenter中所需的步骤与"从租户名称等于SID的主存储克隆"一节中所述的步骤相同。唯一的区别是脚本中的租户恢复操作<block ref="3b7212a09a85af46251eb075db2a1a3f" prefix=" " category="inline-code"></block>，所有租户都将恢复。</block>
  <block id="37a2727e344d9facb9435dc33b8e61d4" category="paragraph">如果目标SAP HANA系统已在SnapCenter中受到保护、则必须先删除此保护。在目标系统的拓扑视图中、单击删除保护。</block>
  <block id="9de8473b21ff03236d0c22b8e66fb32b" category="paragraph">现在、可通过以下步骤执行克隆删除工作流。</block>
  <block id="4163c4375ee84108e7464bed795c7892" category="list-text">在源系统的拓扑视图中选择克隆、然后单击删除。</block>
  <block id="307887031775930c6a8e1e3bced427b1" category="list-text">该脚本的日志文件<block ref="d8eec050302627350eb082c264bec8f6" prefix=" " category="inline-code"></block> 显示了关闭和卸载操作步骤。</block>
  <block id="11166cbb1d1517e978936ba177acabdd" category="paragraph">如果计划在较长的时间内使用系统刷新操作的目标系统、则在系统刷新操作中拆分FlexClone卷是有意义的。</block>
  <block id="69b329311d07b607f52569715e798844" category="admonition">克隆拆分操作不会阻止使用克隆的卷、因此可以在使用SAP HANA数据库时随时执行。</block>
  <block id="e92bb8c6f438e94fa791d43bdb4dcbcd" category="admonition">使用Azure NetApp Files时、克隆拆分操作不可用、因为Azure NetApp Files始终会在创建克隆后拆分该克隆。</block>
  <block id="b0418a29ab57c4166b0221cb9ca10482" category="paragraph">现在、在SnapCenter的资源视图中、目标系统QS1不再标记为克隆的资源。返回到源系统的拓扑视图时、克隆不再可见。现在、拆分的卷独立于源系统的Snapshot备份。</block>
  <block id="4a1abc6199d49f198914fd8d148bf5c0" category="paragraph">克隆拆分操作后的刷新工作流看起来与不执行克隆拆分操作的刷新工作流略有不同。执行克隆拆分操作后、无需执行克隆删除操作、因为目标数据卷不再是FlexClone卷。</block>
  <block id="7dfe8874c51c5d084185151f12846337" category="list-text">必须关闭SAP HANA数据库、卸载数据卷、并且必须删除SnapCenter创建的fstab条目。这些步骤需要手动执行。</block>
  <block id="023a58384ef01abf43f481c807b63886" category="list-text">现在、可以按照前面各节所述执行SnapCenter克隆创建工作流。</block>
  <block id="c877627d59d4aabd928b804662a092c9" category="list-text">刷新操作完成后、旧的目标数据卷仍存在、必须使用ONTAP System Manager等手动将其删除。</block>
  <block id="b15c25b8eded6042b31638d675f46bbb" category="paragraph">屏幕输出显示了克隆–delete.ps1 PowerShell脚本的执行情况。</block>
  <block id="c02f461d6bc735814c693a2961f876d0" category="admonition">如果必须将系统重置为其他Snapshot备份、则步骤6和步骤4就足以满足要求。可以继续挂载SAP HANA共享卷。</block>
  <block id="3a76181089e0a4d1760e6aee32bf113f" category="list-text">适用于SAP HANA数据卷的SnapCenter克隆删除工作流、包括数据库关闭。</block>
  <block id="5c1f104318aa49fc440eebd55451b8ee" category="list-text">所述工作流适用于单主机SAP HANA兼容系统。不支持多个主机系统。</block>
  <block id="db2df21a0523790017cef08c7f5c3eaa" category="list-text">要执行自动化脚本、必须在目标主机上部署SnapCenter SAP HANA插件。</block>
  <block id="679aaef31443a5734d1e57a79b042625" category="list-text">此工作流已针对NFS进行验证。用于挂载SAP HANA共享卷的自动化<block ref="9042a1dcfe3f159e3f1da35f8f9052d7" prefix=" " category="inline-code"></block>不支持FCP。此步骤必须手动完成、也可以通过扩展脚本完成。</block>
  <block id="b344b862744c6785533cff671e8e9106" category="list-text">所述工作流仅适用于SnapCenter 5.0或更高版本。</block>
  <block id="f4c86ccde3feda7d831a21fb6b56af67" category="paragraph">下图显示了用于系统克隆操作的实验室设置。</block>
  <block id="b7840bade6da17d016ba5336a5c3aaa7" category="list-text">SAP HANA系统：HANA 2.0 SPS6修订版61</block>
  <block id="af05a28023ad2e8de362143859a247fd" category="paragraph">在正常运行期间、目标主机可能会用于其他目的、例如用作SAP HANA QA或测试系统。因此、在请求系统克隆操作时、必须执行所述的大部分步骤。另一方面，只需复制配置文件，即可准备相关的配置文件(如<block ref="816a3ef77b62ade41c3f936c958aa555" prefix=" " category="inline-code"></block> 和<block ref="32e243072177237fcbc533f525dd494c" prefix=" " category="inline-code"></block>)，然后将其投入生产。</block>
  <block id="e9c407386493da0488ffd728b9d23d75" category="paragraph">目标主机准备工作还包括关闭SAP HANA QA或测试系统。</block>
  <block id="b43670ab546cad4f1187a024f2655141" category="section-title">*目标服务器主机名和IP地址*</block>
  <block id="82c0bd942f14ac535ea2ec3308abb419" category="section-title">*安装所需软件*</block>
  <block id="03471c13e336e3a43d05ecf4cc3b50f1" category="paragraph">SAP 主机代理软件必须安装在目标服务器上。有关完整信息、请参见<block ref="442ac416f46b28c63828de9c422750a6" category="inline-link-rx"></block> SAP帮助门户上的。</block>
  <block id="19de9f5ceba0710bef9910d02b8c00be" category="paragraph">必须使用SnapCenter中的添加主机操作在目标主机上部署SnapCenter SAP HANA插件。</block>
  <block id="8500f355a94e4036a165523b43519009" category="section-title">*配置用户、端口和SAP服务*</block>
  <block id="cbd9861da1634998fdbec0f1674bffaf" category="paragraph">SAP HANA 数据库所需的用户和组必须在目标服务器上可用。通常使用中央用户管理；因此，不需要在目标服务器上执行任何配置步骤。必须在目标主机上配置SAP HANA数据库所需的端口。可以通过将/etc/services文件复制到目标服务器来从源系统复制配置。</block>
  <block id="0fe0a84b026a92619e0b883f8ace7f05" category="section-title">*准备文件系统挂载*</block>
  <block id="6e1bc5bbe01a1cf6f8a91aa5f717dfbd" category="paragraph">在本示例中，必须创建目录<block ref="8d71e4e8f2c69228b36f61ec92ff6e55" prefix=" " category="inline-code"></block>、<block ref="b61595b5b7b716bd6b8bd21e4fa4a3bf" prefix=" " category="inline-code"></block> 和<block ref="f2540a99f8fb2005adffa67040796a39" prefix=" " category="inline-code"></block> 。</block>
  <block id="e1ef880ffbb207865c6448e388da62a2" category="section-title">*准备脚本执行*</block>
  <block id="20f8e33f71e1aadeaebae17a3a593359" category="paragraph">您必须将应在目标系统上执行的脚本添加到SnapCenter允许的命令配置文件中。</block>
  <block id="5c233cde12edcc7cd9a5040d286ad73d" category="list-text">从源系统SS1共享卷中选择一个Snapshot备份、然后单击克隆。</block>
  <block id="6369c2aa65382d97cfb630036e611bc6" category="list-text">选择已准备好目标修复系统的主机。NFS导出IP地址必须是目标主机的存储网络接口。作为目标SID、与源系统保持相同的SID。在我们的示例SS1中。</block>
  <block id="fc85d3d93a940166679a1ff3ce2858c7" category="list-text">SnapCenter 中的"作业详细信息"屏幕显示操作的进度。</block>
  <block id="70bc6b2748946208934f890668f6e3ad" category="list-text">sc-mount-volume.sh脚本的日志文件显示了为挂载操作执行的不同步骤。</block>
  <block id="48a54a3a578b8e3e928361dc37dc0b17" category="list-text">SnapCenter工作流完成后、目标主机上会挂载/usr/SAP/SS1和/HAA/shared文件系统。</block>
  <block id="f5aed610591d8d0f471cd94b9ec0b07b" category="list-text">现在、可以使用/HAA/Shared卷、从而启动SAP HANA服务。</block>
  <block id="e6c84cae702fee0b7de0005e27cafd83" category="list-text">此时将启动SAP Host Agent和sapstartsrv进程。</block>
  <block id="b4570d56ed8039388696e01590c23ef0" category="paragraph">其他SAP应用程序服务的克隆方式与SAP HANA共享卷相同、如"克隆SAP HANA共享卷"一节所述。当然、SAP应用程序服务器所需的存储卷也必须使用SnapCenter进行保护。</block>
  <block id="cd366cfea7a5fb3bf24ebeea8fb49f63" category="paragraph">您必须将所需的服务条目添加到/usr/sap/sapservices中、并且必须准备好端口、用户和文件系统挂载点(例如、/usr/sap/sid)。</block>
  <block id="d0365f13b3672003f3890d0f741af6b6" category="list-text">从源系统SS1中选择SAP HANA Snapshot备份。</block>
  <block id="3aac5dfc2f5dcdace5aa92b15faf9364" category="list-text">选择已准备好目标修复系统的主机。NFS导出IP地址必须是目标主机的存储网络接口。作为目标SID、与源系统保持相同的SID。在我们的示例SS1中</block>
  <block id="49cb46f6fb695d36680d613409cecb98" category="list-text">输入克隆后脚本以及所需的命令行选项。</block>
  <block id="bd56a8d936792c44272149daeaa73c61" category="admonition">用于恢复操作的脚本会将SAP HANA数据库恢复到Snapshot操作的时间点、而不会执行任何正向恢复。如果需要正向恢复到特定时间点、则必须手动执行恢复。手动前向恢复还要求目标主机可以使用源系统的日志备份。</block>
  <block id="30d1c8855084004ff5efd83a1b2ac199" category="paragraph">该脚本的日志文件<block ref="d8eec050302627350eb082c264bec8f6" prefix=" " category="inline-code"></block> 显示了为挂载和恢复操作执行的不同步骤。</block>
  <block id="b9a43783881462b22ed1b9304e93a208" category="paragraph">SAP HANA系统现已推出、可用作修复系统等。</block>
  <block id="1a859eefed9ce4c295aedc96dfafaf4f" category="paragraph">下图说明了在系统刷新、系统复制或系统克隆操作期间必须执行的主要步骤。蓝色框表示可以使用SnapCenter自动执行的步骤、灰色框表示必须在SnapCenter外部手动或使用第三方工具执行的步骤。</block>
  <block id="a7602bcc4a327a853c0bc9244c8d5cf7" category="doc">支持的基础架构和方案</block>
  <block id="000ce6bcdcf462bf4ae7ce71777101b1" category="paragraph">本文档介绍了在内部NetApp系统、适用于NetApp ONTAP系统的Amazon FSx和Azure NetApp Files上运行的SAP HANA系统的SAP系统更新和克隆方案。但是、并非所有功能和方案都可在每个存储平台上使用。下表总结了支持的配置。</block>
  <block id="2186ce34f5e82979ca155ca8a50f154e" category="paragraph">在本文档中、我们使用的是在采用NFS作为存储协议的内部NetApp系统上运行的SAP HANA环境。大多数工作流步骤在不同平台上是相同的、如果存在差异、本文档将重点介绍这些步骤。</block>
  <block id="9dc9e3437e4c7ab520eea0bc890ec77d" category="cell">*内部NetApp系统*</block>
  <block id="dc590521b479337b3c16fdc9b86fa862" category="cell">*AWS FSx for NetApp ONTAP *</block>
  <block id="502138babd0f5b6a19480328fd806740" category="cell">* Azure NetApp Files *</block>
  <block id="9b8bdf7379e889d83ab24e782c87d2ac" category="cell">存储协议</block>
  <block id="0f59ffbf177067a2b43529c379b9a941" category="cell">NFS、光纤通道</block>
  <block id="1d1a594959ec615f56516f5d0f5e8ddb" category="cell">NFS</block>
  <block id="cd390e0f91519da01691549afef00620" category="cell">精简克隆(FlexClone)</block>
  <block id="0255a9cd10f452086da62b59f792a1f2" category="cell">不会、使用当前ANF版本时、克隆的卷始终会拆分</block>
  <block id="382b0f5185773fa0f67a8ed8056c7759" category="cell">不适用</block>
  <block id="9f1d8d71503bb95d72fe41f56c48761a" category="cell">从主系统克隆</block>
  <block id="3f78baa2e72d94c1e4ae14fd035d05aa" category="cell">从异地备份克隆</block>
  <block id="13a880a9528cd60eb10631adb9802946" category="cell">在灾难恢复站点克隆</block>
  <block id="07973f5db801b7bc6b863fe0aae5ee4a" category="cell">是、但未集成到SnapCenter中</block>
  <block id="16fc6bd74d4496ed31fe8ee50e1887ee" category="section-title">对QA、测试、沙盒或培训系统进行数据刷新</block>
  <block id="862c3e3761bf683136ee838de2c0c203" category="paragraph">在设置修复系统时、灵活性和敏捷性至关重要。使用基于NetApp存储的Snapshot备份时、可以使用多个一致的数据库映像来使用NetApp FlexClone技术创建生产系统的克隆。如果使用基于文件的备份的重定向还原来设置修复系统、则只需几秒钟即可创建FlexClone卷、而不是多小时。</block>
  <block id="2792124a69a48ece7030f9b29701007b" category="paragraph">有效的灾难恢复策略需要测试所需的工作流。测试可证明该策略是否有效、以及内部文档是否足以满足要求。它还允许管理员培训所需的过程。</block>
  <block id="0ca7de0d8a3d9d654f0a2d183f1c4aef" category="inline-link">TR-4646：《采用存储复制的SAP HANA灾难恢复》(netapp.com)</block>
  <block id="acbd601ce9bb8719c9759926bade423c" category="paragraph"><block ref="acbd601ce9bb8719c9759926bade423c" category="inline-link-rx"></block></block>
  <block id="4b3309d5f0ac80977c53b53f174cf02b" category="inline-link">SAP业务应用程序和SAP HANA数据库解决方案(netapp.com)</block>
  <block id="3726ec9ff4cd44edb2e6ef5e5bb1d348" category="list-text"><block ref="3726ec9ff4cd44edb2e6ef5e5bb1d348" category="inline-link-rx"></block></block>
  <block id="27dddf76b26ab304508f853d7098db14" category="list-text"><block ref="27dddf76b26ab304508f853d7098db14" category="inline-link-rx"></block></block>
  <block id="86c4432fecfe5c3e73043d258208eaaf" category="list-text"><block ref="86c4432fecfe5c3e73043d258208eaaf" category="inline-link-rx"></block></block>
  <block id="1b9bc9e191e6ba94ef8d56cbe1b56fe0" category="list-text"><block ref="1b9bc9e191e6ba94ef8d56cbe1b56fe0" category="inline-link-rx"></block></block>
  <block id="30faa411b1b825f32746a6c578400e17" category="list-text"><block ref="30faa411b1b825f32746a6c578400e17" category="inline-link-rx"></block></block>
  <block id="13c64b27eec62224a0e9d23f11305c82" category="list-text"><block ref="9784d3fec4562f5e098705a8bd1c3e5c" category="inline-link-rx"></block></block>
  <block id="41c4e889d50776d54c370695fcfa5d29" category="list-text"><block ref="a0b4539ba20396fdc40c0e0863f20241" category="inline-link-rx"></block></block>
  <block id="73018ba6d8f50b92b992ab316f15a0a6" category="paragraph">涵盖SnapCenter 4.3和改进的自动化脚本的完整重写。+用于系统刷新和系统克隆操作的新工作流说明。</block>
  <block id="30dac510a408bf8be8dd4336d96b482f" category="cell">适应SnapCenter 4.6 P1中变更的工作流</block>
  <block id="f66bc2df80ac37f354b591907be92e18" category="cell">2024年7月</block>
  <block id="17fb9a63c15de98fb13578ff5b945b03" category="paragraph">文档涵盖内部部署的NetApp系统、 FSx for ONTAP和Azure NetApp Files +新的SnapCenter 5.0操作在克隆创建和删除工作流期间挂载和卸载+为光纤通道SAN添加了特定步骤+为Azure NetApp Files添加了特定步骤+经过调整和简化的<block ref="d8eec050302627350eb082c264bec8f6" prefix=" " category="inline-code"></block> 脚本+为已启用的SAP HANA提供了所需步骤 卷加密</block>
  <block id="a5cf81e748f3b3e6fad26b2e3470f879" category="list-text"><block ref="a5cf81e748f3b3e6fad26b2e3470f879" category="inline-link-macro-rx"></block></block>
  <block id="87c8349f2562b9df828a79206981328c" category="list-text"><block ref="87c8349f2562b9df828a79206981328c" category="inline-link-macro-rx"></block></block>
  <block id="20a0dcae2f540339bbf69dbaa7f0050a" category="list-text"><block ref="20a0dcae2f540339bbf69dbaa7f0050a" category="inline-link-macro-rx"></block></block>
  <block id="b0be0a2f6c57f7c66aa9ab049763af3a" category="paragraph">有关使用SnapCenter的SAP HANA备份和恢复解决方案的详细信息，请参见<block ref="7d612f806d1e07d1f3292801524311f8" category="inline-link-rx"></block>。</block>
  <block id="c2107d876323ca6269d87dd4ef892a8a" category="paragraph">有关SAP HANA灾难恢复解决方案的详细信息，请参见<block ref="22d31f63af3553980c791e5bf538fbdd" category="inline-link-rx"></block>。</block>
  <block id="78439f11ea8c9762eac371e8475447aa" category="inline-link">《基于VMware vSphere的SAP HANA最佳实践和参考架构指南》</block>
  <block id="52d5e1f1eef3e549b479feffef1c376c" category="list-text"><block ref="52d5e1f1eef3e549b479feffef1c376c" category="inline-link-rx"></block></block>
  <block id="1b70ac0a972fddf1e1a33e6ed9df49c7" category="cell">2022年9月</block>
  <block id="3c3691e44e6ff923dc83662b2f7e1001" category="cell">新的操作系统版本</block>
  <block id="6d6bbe0ff14c220c87649b72d24ad927" category="cell">2023年8月</block>
  <block id="588e591ee2a91af94d3b4c16b18b9baf" category="cell">新存储系统(AFF C系列)</block>
  <block id="c33f6b520ad3c202db9ed1b825ac8b3d" category="cell">2023年12月</block>
  <block id="573a46f547eae3963940bf6d5022971e" category="cell">更新主机设置修订了nconnect设置、增加了有关NFSv4.1会话的信息</block>
  <block id="5b44aad20fbc2491f38bc99fd2eb8086" category="cell">2024年5月</block>
  <block id="0a961d2cbb588be1d5a93b4774cf6ef1" category="cell">新存储系统(AFF A系列)</block>
  <block id="f31f11743f1dfba18e9f008e2956d24e" category="cell">2024年9月</block>
  <block id="e4a9c264a13e2ec5faac7a73cf8d0e8c" category="cell">次要更新</block>
  <block id="6563b589bfb682a295eb4dbf184e1b18" category="inline-link"><block ref="6563b589bfb682a295eb4dbf184e1b18" category="inline-link-rx"></block></block>
  <block id="fa739a180dd6fb933e2dd37f3e1df5fb" category="paragraph"><block ref="fa739a180dd6fb933e2dd37f3e1df5fb" category="inline-link-rx"></block></block>
  <block id="ad4cceb9c7b19c473483b955f4ab9465" category="inline-link"><block ref="ad4cceb9c7b19c473483b955f4ab9465" category="inline-link-rx"></block></block>
  <block id="d63a01df24ee4ea8980a2cdd59f7e8da" category="paragraph"><block ref="d63a01df24ee4ea8980a2cdd59f7e8da" category="inline-link-rx"></block></block>
  <block id="362c26abf7af5442c5d449bb2075123f" category="inline-link"><block ref="362c26abf7af5442c5d449bb2075123f" category="inline-link-rx"></block></block>
  <block id="428b7c3b557c016c4e280ca7305fafbe" category="paragraph"><block ref="428b7c3b557c016c4e280ca7305fafbe" category="inline-link-rx"></block></block>
  <block id="617096ec70226b1decdd03cd7aa674d4" category="list-text">TR-4667：使用SnapCenter 4.0 SAP HANA插件自动执行SAP系统副本</block>
  <block id="e40283d3953ee3d843b92518a02ffe78" category="paragraph"><block ref="e40283d3953ee3d843b92518a02ffe78" category="inline-link-rx"></block></block>
  <block id="44fee80ab2b2a3105ec17b94b206cc8f" category="inline-link"><block ref="44fee80ab2b2a3105ec17b94b206cc8f" category="inline-link-rx"></block></block>
  <block id="55162df4eaa40993b4b04219f5dd5e87" category="paragraph"><block ref="55162df4eaa40993b4b04219f5dd5e87" category="inline-link-rx"></block></block>
  <block id="59298016353cfaad8318719db5cd21c0" category="inline-link"><block ref="59298016353cfaad8318719db5cd21c0" category="inline-link-rx"></block></block>
  <block id="60eff1c8782a5c7cf39a41c25435a428" category="paragraph"><block ref="60eff1c8782a5c7cf39a41c25435a428" category="inline-link-rx"></block></block>
  <block id="b4e4244754290debb9944132a8a13b5a" category="paragraph">有关SAP HANA备份和恢复解决方案的详细信息，请参见<block ref="7d612f806d1e07d1f3292801524311f8" category="inline-link-rx"></block>。</block>
  <block id="3e506f546ee07a96caecb3240e314bd8" category="paragraph">可以通过多种方法将存储连接到虚拟机（ VM ）。首选方法是，将具有 NFS 的存储卷直接从子操作系统中连接起来。<block ref="ca5e92233d54e7d83162f25f0a78384f" category="inline-link-macro-rx"></block>有关此选项的说明，请参见。</block>
  <block id="87d809e67c582d30f01f52b1815397b1" category="admonition">有关SAP HANA备份和恢复解决方案的详细信息，请参见<block ref="7d612f806d1e07d1f3292801524311f8" category="inline-link-rx"></block>。</block>
  <block id="4c3f99597dbfcb425074a87054f88a80" category="paragraph">有关SAP HANA灾难恢复解决方案的详细信息，请参见<block ref="22d31f63af3553980c791e5bf538fbdd" category="inline-link-rx"></block>。</block>
  <block id="b526150fb3e3e29b0a0731441a140c0e" category="paragraph">有关使用SnapCenter的SAP HANA灾难恢复解决方案的详细信息，请参见<block ref="22d31f63af3553980c791e5bf538fbdd" category="inline-link-rx"></block>。</block>
  <block id="292ed8e9851502aa4feb9eef4c6dbb13" category="paragraph">借助 SAP Landscape Management （ SAP LaMa ），客户可以管理内部数据中心以及在云中运行的系统中的复杂 SAP 系统环境。SAP LaMa 与 NetApp 存储服务连接器（ SSC ）可以使用 Snapshot 和 FlexClone 技术为 SAP 系统克隆，复制和刷新用例执行克隆和复制等存储操作。这样，您就可以根据存储克隆技术完全自动执行 SAP 系统副本，同时还可以执行所需的 SAP 后处理。有关NetApp针对SAP Laama的解决方案的详细信息，请参见<block ref="f5cd59812ce597d8b57d775862213a16" category="inline-link-rx"></block>。</block>
  <block id="d5e4b2586a8501ff7c2a392297c5cd32" category="paragraph">从 4.6 版开始， SnapCenter 支持自动发现在 HANA 系统复制关系中配置的 HANA 系统。每个主机都使用其物理 IP 地址（主机名）及其存储层上的单个数据卷进行配置。这两个 SnapCenter 资源组合在一个资源组中， SnapCenter 会自动标识主主机或二级主机，然后相应地执行所需的备份操作。对于使用 SnapCenter 创建的 Snapshot 备份和基于文件的备份，系统会在两台主机上执行保留管理，以确保当前二级主机上也会删除旧备份。下图简要概述了这一情况。有关在SnapCenter中配置和操作已启用HANA系统复制的HANA系统的详细说明<block ref="cfe50e5b56f8a98ece306a69e546da3e" category="inline-link-rx"></block>，请参见。</block>
  <block id="b28e30b0b029ff7eb11d8b2655e78dba" category="paragraph">有关SAP HANA插件部署选项和用户存储配置的详细信息，请参见技术报告TR-4614：<block ref="f70d28502828defa3eb13d3b730673fb" category="inline-link-rx"></block>。</block>
  <block id="74aaeb9485407660c737f5870ea94649" category="paragraph"><block ref="74aaeb9485407660c737f5870ea94649" category="inline-link-rx"></block></block>
  <block id="e5e2a6bf28307550240d9ed91bbb0fa0" category="paragraph"><block ref="e5e2a6bf28307550240d9ed91bbb0fa0" category="inline-link-rx"></block></block>
  <block id="bc83c6be4c9eaece698b7eb18b8517a0" category="paragraph"><block ref="bc83c6be4c9eaece698b7eb18b8517a0" category="inline-link-rx"></block></block>
  <block id="a36cfc2690f8671748f584abb16bdd04" category="cell">新存储系统</block>
  <block id="0fba9f2a3fbb4cfbaed44806cd9933a2" category="cell">新存储系统(ASA A系列)</block>
  <block id="5e8f0f670e38fbdf628b0883f946934f" category="inline-image-macro">图中显示了输入/输出对话框或表示已写入内容</block>
  <block id="085efbf60b3725eeb0ee8ff55a22a221" category="paragraph"><block ref="085efbf60b3725eeb0ee8ff55a22a221" category="inline-image-macro-rx" type="image"></block></block>
  <block id="07d652acdae0a73446e157f933c39530" category="paragraph"><block ref="07d652acdae0a73446e157f933c39530" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2e0e586261702652aa86584fc3f6f7d3" category="paragraph"><block ref="2e0e586261702652aa86584fc3f6f7d3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9f7b545f17ee3f29abc32c6432914443" category="paragraph"><block ref="9f7b545f17ee3f29abc32c6432914443" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b0e45db023a26e4137bc4e65f4e28483" category="paragraph"><block ref="b0e45db023a26e4137bc4e65f4e28483" category="inline-image-macro-rx" type="image"></block></block>
  <block id="eb250eaded5f0165a2ad37e5bfc9f90f" category="paragraph"><block ref="eb250eaded5f0165a2ad37e5bfc9f90f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3d30518549ecc6aed9b4994b6b3630f0" category="paragraph"><block ref="3d30518549ecc6aed9b4994b6b3630f0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="adf4a3f33015499461672af5e91f00cb" category="paragraph"><block ref="adf4a3f33015499461672af5e91f00cb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e317ecdc7c5b6774a42eec2438865d46" category="paragraph"><block ref="e317ecdc7c5b6774a42eec2438865d46" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e2299ebf1c65b4c5359424a5c14af82f" category="paragraph"><block ref="e2299ebf1c65b4c5359424a5c14af82f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0d9b6640f970bc3e0490200165dafaee" category="paragraph"><block ref="0d9b6640f970bc3e0490200165dafaee" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1731b936ec01fb67650cc1f22ee99c8a" category="paragraph"><block ref="1731b936ec01fb67650cc1f22ee99c8a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="674c4972efaf0701f358ebfc8521b4ba" category="paragraph"><block ref="674c4972efaf0701f358ebfc8521b4ba" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e8b9e1f7ba7a71896ac3b27d54b1553a" category="paragraph"><block ref="e8b9e1f7ba7a71896ac3b27d54b1553a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4fe197efb48d951817ec3e6456c8ed86" category="paragraph"><block ref="4fe197efb48d951817ec3e6456c8ed86" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c0d10a2dfbd0d578067510d2f31c2b18" category="paragraph"><block ref="c0d10a2dfbd0d578067510d2f31c2b18" category="inline-image-macro-rx" type="image"></block></block>
  <block id="482082f888a81c29cb607272c8815b25" category="paragraph"><block ref="482082f888a81c29cb607272c8815b25" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c4b2a78f2508fa7b80945f707b3a38cf" category="paragraph"><block ref="c4b2a78f2508fa7b80945f707b3a38cf" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5555e191de64d3b80e23d8c74c86faff" category="paragraph"><block ref="5555e191de64d3b80e23d8c74c86faff" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0983a769f9e2c33bc99e5f0dfaffa995" category="paragraph"><block ref="0983a769f9e2c33bc99e5f0dfaffa995" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1121f7d56f65af16927195028dca2ced" category="paragraph"><block ref="1121f7d56f65af16927195028dca2ced" category="inline-image-macro-rx" type="image"></block></block>
  <block id="052a582be64e1dd71040846dafd74e80" category="paragraph"><block ref="052a582be64e1dd71040846dafd74e80" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7115b058c69a33fcaa134234783500df" category="paragraph"><block ref="7115b058c69a33fcaa134234783500df" category="inline-image-macro-rx" type="image"></block></block>
  <block id="75b60d6e1a77b7c2b4732a1081d4f9bc" category="paragraph"><block ref="75b60d6e1a77b7c2b4732a1081d4f9bc" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1ea5a836e9a4b8204f750abefd838986" category="paragraph"><block ref="1ea5a836e9a4b8204f750abefd838986" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f8849a8f7ca76b3d93c6e7093a41d6cc" category="paragraph">本文档介绍如何使用SnapVault创建备份。</block>
  <block id="0c0acee5da4f998604bb63e426324dc8" category="paragraph"><block ref="0c0acee5da4f998604bb63e426324dc8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8eeb22ac2ec3194a8f4dcd5bf90c5376" category="paragraph"><block ref="8eeb22ac2ec3194a8f4dcd5bf90c5376" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c0fb06f1c756c675a699f04ea39c35cf" category="paragraph"><block ref="c0fb06f1c756c675a699f04ea39c35cf" category="inline-image-macro-rx" type="image"></block></block>
  <block id="665142113d98e378bb0b420d9fbd7847" category="paragraph"><block ref="665142113d98e378bb0b420d9fbd7847" category="inline-image-macro-rx" type="image"></block></block>
  <block id="466dfadfb6a8383efbfec1738e63981d" category="paragraph"><block ref="466dfadfb6a8383efbfec1738e63981d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c5e5c27df6e9b0364fe7f9139baaab8f" category="paragraph"><block ref="c5e5c27df6e9b0364fe7f9139baaab8f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2ed88024658115d5c34da6959d0aa2c0" category="paragraph"><block ref="2ed88024658115d5c34da6959d0aa2c0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="689a14925191468af4abac93ac4bae22" category="paragraph"><block ref="689a14925191468af4abac93ac4bae22" category="inline-image-macro-rx" type="image"></block></block>
  <block id="761e86b208c561be6f1b9504a4ac37c0" category="paragraph"><block ref="761e86b208c561be6f1b9504a4ac37c0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f5b559869d4e5353ee5bf9ba5abbdb8e" category="paragraph"><block ref="f5b559869d4e5353ee5bf9ba5abbdb8e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b43e6002733dc8a9b0a3cc8db3631ce5" category="paragraph"><block ref="b43e6002733dc8a9b0a3cc8db3631ce5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5cfe302d8fd6fb49c656dd6a61219a19" category="paragraph"><block ref="5cfe302d8fd6fb49c656dd6a61219a19" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d69ca1c54c43856fc373948e9036e217" category="paragraph">作者：Nils Bauer、NetApp</block>
  <block id="292062c311206183ebdd6ca3c288b1a2" category="paragraph"><block ref="292062c311206183ebdd6ca3c288b1a2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9ee2e3f66acaae241fb30c6239dafe90" category="paragraph"><block ref="9ee2e3f66acaae241fb30c6239dafe90" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a255f306e8ce7199fafc007c288aa97a" category="paragraph"><block ref="a255f306e8ce7199fafc007c288aa97a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a9e547491b14163fc06d796271102091" category="paragraph"><block ref="a9e547491b14163fc06d796271102091" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f1ca23fdd99c11241abdcac87a788f90" category="paragraph"><block ref="f1ca23fdd99c11241abdcac87a788f90" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c5d68d8e321832c5a6809c03cdeb7d54" category="paragraph"><block ref="c5d68d8e321832c5a6809c03cdeb7d54" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b1ae3730b79e17eb65840598e14cff6e" category="paragraph"><block ref="b1ae3730b79e17eb65840598e14cff6e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1480cb2d8a21d47fd14b5d83279d288d" category="paragraph"><block ref="1480cb2d8a21d47fd14b5d83279d288d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bd51e0317461a4c4ab1c50f23e42ba35" category="paragraph"><block ref="bd51e0317461a4c4ab1c50f23e42ba35" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b88040dfd5321d269e81face489ed592" category="paragraph"><block ref="b88040dfd5321d269e81face489ed592" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6d834903af902328d64086e92b2caa5a" category="paragraph"><block ref="6d834903af902328d64086e92b2caa5a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b4123b8d307798c71349dc904fd7592d" category="paragraph"><block ref="b4123b8d307798c71349dc904fd7592d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f55f824f9e55c7e532cbd044e1c3cd70" category="paragraph"><block ref="f55f824f9e55c7e532cbd044e1c3cd70" category="inline-image-macro-rx" type="image"></block></block>
  <block id="499b2145e1f9a566c2096488a52eef93" category="paragraph"><block ref="499b2145e1f9a566c2096488a52eef93" category="inline-image-macro-rx" type="image"></block></block>
  <block id="725e0c4dd0da2f44dd5e12847ad2aa02" category="paragraph"><block ref="725e0c4dd0da2f44dd5e12847ad2aa02" category="inline-image-macro-rx" type="image"></block></block>
  <block id="49af863f2f6721b62e12fb9ad5b71e6a" category="paragraph"><block ref="49af863f2f6721b62e12fb9ad5b71e6a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="889c04cc63ee856efcd32d8e532d8c2c" category="paragraph"><block ref="889c04cc63ee856efcd32d8e532d8c2c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="371da8e1ec34d2a8f5c5b20f0e720f5d" category="paragraph"><block ref="371da8e1ec34d2a8f5c5b20f0e720f5d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fe787194b4bc9d3f9c9bf659c643f835" category="paragraph"><block ref="fe787194b4bc9d3f9c9bf659c643f835" category="inline-image-macro-rx" type="image"></block></block>
  <block id="22541d7972f26d2e166eb883482f2b6b" category="paragraph"><block ref="22541d7972f26d2e166eb883482f2b6b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6b9ebd1a574cf21289ac3a5496cda4fa" category="paragraph"><block ref="6b9ebd1a574cf21289ac3a5496cda4fa" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b7f859daf0ba8a3409adca386e7fedd4" category="paragraph"><block ref="b7f859daf0ba8a3409adca386e7fedd4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="22231633df8cb3267a20a9ae1197b0cb" category="paragraph"><block ref="22231633df8cb3267a20a9ae1197b0cb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2d85e6ca0f060545a30bc27ba0d0378c" category="paragraph"><block ref="2d85e6ca0f060545a30bc27ba0d0378c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="74b70257e7405ff10b797869cc7b17f6" category="paragraph"><block ref="74b70257e7405ff10b797869cc7b17f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9599d066a3b3f423d2b80efa23d6dabd" category="paragraph"><block ref="9599d066a3b3f423d2b80efa23d6dabd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0dfe2ca2f17a011c65cef6fd64e720ec" category="paragraph"><block ref="0dfe2ca2f17a011c65cef6fd64e720ec" category="inline-image-macro-rx" type="image"></block></block>
  <block id="17c3600ebb7c62e9975c8a3ce664c7d8" category="paragraph"><block ref="17c3600ebb7c62e9975c8a3ce664c7d8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="486fdec5eabff6d515ed0fb47e3aed04" category="paragraph"><block ref="486fdec5eabff6d515ed0fb47e3aed04" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fb9ff2317d1e171c45d58af152d844f1" category="paragraph"><block ref="fb9ff2317d1e171c45d58af152d844f1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8377c9c81420014d537e512eae625abe" category="paragraph"><block ref="8377c9c81420014d537e512eae625abe" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1756aa8abc7f1094f194883a1fac6002" category="paragraph"><block ref="1756aa8abc7f1094f194883a1fac6002" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ee6d8ed0ae31a1c957aff9fae65dbbf5" category="paragraph"><block ref="ee6d8ed0ae31a1c957aff9fae65dbbf5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8ad7e31b1db9900d9fa4df04443e8741" category="paragraph"><block ref="8ad7e31b1db9900d9fa4df04443e8741" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9e0fcd0740c4da9daa5ffd673095ae40" category="paragraph"><block ref="9e0fcd0740c4da9daa5ffd673095ae40" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6d64d26793fadd91b1bc7394658365b0" category="paragraph"><block ref="6d64d26793fadd91b1bc7394658365b0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c31cfaef9364a7790fe4671d2b005ff8" category="paragraph"><block ref="c31cfaef9364a7790fe4671d2b005ff8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f2c6bd6c931cd5dab1f2e1d9c7153264" category="paragraph"><block ref="f2c6bd6c931cd5dab1f2e1d9c7153264" category="inline-image-macro-rx" type="image"></block></block>
  <block id="74fbda49727400c791421c5523bc609b" category="paragraph"><block ref="74fbda49727400c791421c5523bc609b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="182cf1738b45f63dd97bce1b0cd9338d" category="paragraph"><block ref="182cf1738b45f63dd97bce1b0cd9338d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5725087f1926385d0f3f038c97c966c8" category="paragraph"><block ref="5725087f1926385d0f3f038c97c966c8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="457eead26f95ee84b4f5e45a66310db0" category="paragraph"><block ref="457eead26f95ee84b4f5e45a66310db0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a0689e6e0802340b1e177cfa21bc1732" category="paragraph"><block ref="a0689e6e0802340b1e177cfa21bc1732" category="inline-image-macro-rx" type="image"></block></block>
  <block id="59e60a8306676d353bd2961881ac2f75" category="paragraph"><block ref="59e60a8306676d353bd2961881ac2f75" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5aacefe8b2cdf5b953e733d3d6a4c19f" category="paragraph"><block ref="5aacefe8b2cdf5b953e733d3d6a4c19f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1429ce527cf4cd4b50df05f493b91313" category="paragraph"><block ref="1429ce527cf4cd4b50df05f493b91313" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e107febc841d55315bacadea7f0686eb" category="paragraph"><block ref="e107febc841d55315bacadea7f0686eb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9dbd4c807b3ae80f70ef349ef31a1af9" category="paragraph"><block ref="9dbd4c807b3ae80f70ef349ef31a1af9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b24dc7a3a6f2051b81d50ddebc7637bb" category="paragraph"><block ref="b24dc7a3a6f2051b81d50ddebc7637bb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bd62cdc19a7b43b491aebad1b79699a2" category="paragraph"><block ref="bd62cdc19a7b43b491aebad1b79699a2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0936b428194481c8aa469bef1fbe5a2e" category="paragraph"><block ref="0936b428194481c8aa469bef1fbe5a2e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4eb24bf34fba9222605c7e3c856bf8a8" category="paragraph"><block ref="4eb24bf34fba9222605c7e3c856bf8a8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0ae7726ed3ec0b70e84ae1a4f1b71d23" category="paragraph"><block ref="0ae7726ed3ec0b70e84ae1a4f1b71d23" category="inline-image-macro-rx" type="image"></block></block>
  <block id="14397cf778300a82704513944fe2f1ec" category="paragraph"><block ref="14397cf778300a82704513944fe2f1ec" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9e6a6eb10efdb10620a6a3d4bdeb2b88" category="paragraph"><block ref="9e6a6eb10efdb10620a6a3d4bdeb2b88" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5bf509e6d43ff3eb5c07c44c1546ab09" category="paragraph"><block ref="5bf509e6d43ff3eb5c07c44c1546ab09" category="inline-image-macro-rx" type="image"></block></block>
  <block id="55aab77fa5d7f50b7fbedbf0df160938" category="paragraph"><block ref="55aab77fa5d7f50b7fbedbf0df160938" category="inline-link-rx"></block></block>
  <block id="5455f48dc7894a1b2782bb01cf938a86" category="paragraph"><block ref="5455f48dc7894a1b2782bb01cf938a86" category="inline-link-rx"></block></block>
  <block id="6e0b32969c38b1fb3a586b9c8bca6d29" category="inline-image-macro">hana hycl-back-image2、宽度=624、高度=316</block>
  <block id="32ae0c18f23bf987a305e455c9bf4aa0" category="list-text">按*+添加工作环境*。+<block ref="261aee93707d679c8ff49bd45c5fdb36" category="inline-image-macro-rx" type="image"></block></block>
  <block id="04c6fea5cff3e4aa7643ec678d204fdc" category="inline-image-macro">Ein Bild，ds text enthält。自动生成Beschreirug、宽度=624、高度=316</block>
  <block id="39f551b5282050e99060de22a436c58a" category="list-text">选择*内部*。+<block ref="979960cde457e31c17b357bad0bff424" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f533acbef1172572a61dbd78994f609f" category="list-text">选择*发现内部部署ONTAP *。+<block ref="fcff6ce23c328c34a47627af2e770b21" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e67b31693fccd64a3bacc0e55452cae2" category="inline-image-macro">hana hycl-back-image5、宽度=624、高度=316</block>
  <block id="c7be70f13b9e16d991fdbdcbd9c13aa3" category="list-text">添加ONTAP集群的IP地址和密码，然后按*Discover。+<block ref="d3f7db40d516cd6e5bc8ac0f9f7c0499" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bea671570e246847e20efc713c53c69e" category="inline-image-macro">Ein Bild, ds Diagramm enthält自动生成Beschreirug、宽度=624、高度=316</block>
  <block id="6f11afbe1eadae3cfe974f3dac60ace1" category="list-text">ONTAP集群现已可用。+<block ref="3fa4376934b792a48a60395e9737c899" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dd78ee4baa00b09244d3a2f25c867ae5" category="inline-image-macro">hana hycl-back-image7、宽度=624、高度=308</block>
  <block id="e8467bba6a91bfb07a8de17e1fb2cd69" category="list-text">通过*保护*导航到*备份和恢复*并选择*卷*。+<block ref="11225c971b652ee3b6db7fe087c3aa5c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="271dec539afcefba0b81c99e084b109c" category="inline-image-macro">hana hycl-back-image8、宽度=624、高度=309</block>
  <block id="2789767e88a7ffe9c50b702781a0ea67" category="list-text">按*激活备份*按钮。+<block ref="21f0cf6e7ffcc8ef5c72c49515645074" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b0ea90440a1c4c0ce85aa8e6a6798323" category="inline-image-macro">hana hycl-back-image9、宽度=624、高度=304</block>
  <block id="1d5ec2816de19fe1e154731ece2a18c2" category="list-text">选择所需的内部存储系统，然后单击*激活备份*。+<block ref="ca1f10e2c0934df1cc8bd3f38035f292" category="inline-image-macro-rx" type="image"></block></block>
  <block id="16c981d74d1a7a65432b0b676f94b05d" category="inline-image-macro">hana hycl-back-image10、宽度=624、高度=307</block>
  <block id="f11118f4d924111b34e3aa24dcf3a6c7" category="list-text">选择*Backup*。+<block ref="304f4799d1ba6c0574d1c6d6e8bac1d9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3fe7bd8162333cf5226079e598f88f63" category="inline-image-macro">hana hycl-back-image12、宽度=624、高度=305</block>
  <block id="9853cba2a4b299bcb8180627181cd39d" category="list-text">选择与SAP HANA数据文件存储在同一SVM中的卷、然后按*下一步*。在此示例中、选择了/HAA/Shared的卷。+<block ref="a2dec4d3c1cfb1e66bf38e166a0ccbbc" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8de11028ada12771254470b000810e23" category="inline-image-macro">hana hycl-back-image11、宽度=624、高度=304</block>
  <block id="d99dcd56dcb9bfa5a2be73d532bb75b9" category="list-text">*继续*(如果存在现有策略)。+<block ref="a6f49816c4334d116e033f526097271b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="eb54efc82bc89a6f6a8a311be7a01d24" category="inline-image-macro">Ein Bild、ds Text、Software、ComputerSymbol、Webseite enthält。自动生成Beschreirug、宽度=624、高度=306</block>
  <block id="e65dfed1df8f650235807ccb35c69140" category="list-text">选中*备份选项*并选择所需的备份提供程序。在本示例中、AWS。+保持选中已有策略的选项。+取消选中不想使用的选项。+<block ref="e7bd64d80c923ffe89ab853777796206" category="inline-image-macro-rx" type="image"></block></block>
  <block id="75e71600dc8b519173f07bb53132cfea" category="inline-image-macro">hana hycl-back-image14、宽度=624、高度=306</block>
  <block id="d32f8e0d0c2a754313935c326e667d2a" category="list-text">创建新存储分段或选择现有存储分段。请提供您的AWS帐户设置、配置、访问密钥和机密密钥。按*Next*。+<block ref="7ab51ec82c986777ece3aa7e7dd51a3b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="844815fed3e149f6fc8998b67459b8a9" category="inline-image-macro">hana hycl-back-image15、宽度=624、高度=304</block>
  <block id="e7e7cef436617079061e00d3adade148" category="list-text">为内部存储系统选择正确的IP空间，选择*Privat Endpoint Configuration*，然后选择S3的VPC端点。按*Next*。+<block ref="d4748032644bb23292416ca8e3798ab6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a8520b5a7e60b78ae1f8faf41e825735" category="inline-image-macro">hana hycl-back-image16、宽度=624、高度=304</block>
  <block id="53f0db32002266ed051793d338134242" category="list-text">查看您的配置并按*激 活备份*。+<block ref="c6e8f010da631bcf99f948b0ec287f89" category="inline-image-macro-rx" type="image"></block></block>
  <block id="46694ff89d2e1049db53b085f808204b" category="inline-image-macro">hana hycl-back-image17、宽度=624、高度=304</block>
  <block id="b17076bafc8f7c7433ee7a9ba697bdef" category="list-text">备份已成功启动。+<block ref="b8c64b043d8234c9a1901ca3cab2d202" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6b1682473b222d2b053e1f829a4dfa26" category="inline-image-macro">图形用户界面，自动生成应用程序问题描述，宽度=604，高度=156</block>
  <block id="ec949205c32b4dcbf3d33ae3d2653d23" category="list-text">检查是否已通过集群添加存储SAP HANA系统的SVM (在此示例中为HANA)。如果仅添加了SVM、请添加此集群。+<block ref="a21a8efefc66cab38c485ab2857055c4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fa2838d19a717f2eaaa40e2f1f725b14" category="inline-image-macro">图形用户界面，自动生成应用程序问题描述，宽度=604，高度=140</block>
  <block id="015b0ff295262d8372bb8eaf0e7007fa" category="inline-image-macro">hana hycl-back-image20、宽度= 167、高度= 167</block>
  <block id="25317da79c7424177b6fe7b2dd75dbe4" category="list-text">定义计划类型为每日、每周或每月的计划策略。+<block ref="4053c2b580ac63fbd3aca168d4d20e18" category="inline-image-macro-rx" type="image"></block> <block ref="4bafb2763ffed71cdbba1adf60ba7416" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fc770d11db32177599ce06cc7a281439" category="inline-image-macro">图形用户界面，自动生成应用程序问题描述，宽度=604，高度=215</block>
  <block id="84c8d37516c033f0c33377c3d5233ad4" category="list-text">将新策略添加到SAP HANA系统并分配每日计划。+<block ref="7adbf922feb3d32be59867cb2db85d53" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f306bf0a63220090651328d0787ebdef" category="inline-image-macro">自动生成图形用户界面、应用程序、团队问题描述、宽度=604、高度=193</block>
  <block id="8b7d9c683eee25ba85d1f605aa5bfc73" category="list-text">配置此策略后、在根据定义的计划执行此策略后、可以使用此策略进行新备份。<block ref="4cdd66955f0a12d8fd4b6c1593da46ce" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9a74817b35b4d995ea09e91b80d35939" category="inline-image-macro">hana hycl-back-image23、宽度=624、高度=316</block>
  <block id="6264d10e208ef10b481b09a42fe5a86f" category="list-text">从下拉菜单中选择*Hybrid。+<block ref="fcf6021fe8ae5bbeb957a47b5d9b9c56" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8bb77bc23ab3ed07edf78138920094ec" category="list-text">在“设置”菜单中选择SnapCenter Server*。+<block ref="8902dcae1fb3265083b9eb7674b0b6be" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ae22ae0a7f45fd03327c250b60b315e5" category="list-text">注册SnapCenter服务器。+<block ref="30a1a24e8f5b2901c8651c4be47ed542" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f1fa07b4f7836783fffe714d5a32befc" category="inline-image-macro">hana hycl-back-image26、宽度=624、高度=315</block>
  <block id="b99ce945467ef31e44140a5ce69f55c8" category="list-text">添加SnapCenter服务器凭据。+<block ref="fabd6e441ab3d52fb0678f20864f7565" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4d57087fb6eb4ef48dd81d74b0599e61" category="inline-image-macro">hana hycl-back-image27、宽度=624、高度=316</block>
  <block id="176b8df3a4f7e0f5f93da577ced34744" category="list-text">已添加SnapCenter服务器、将发现数据。+<block ref="e01a765e34911c9cc45ebf375691f3ad" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f7080c828def0f5f421c804a6a9411cc" category="list-text">发现作业完成后、SAP HANA系统将可用。+<block ref="fc9d404e0e78b01038565097a3352a8e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="649a9b7aadbc8a5543b6a50f4b67635f" category="inline-image-macro">hana hycl-back-image29、宽度=624、高度=316</block>
  <block id="85c328360dc7dca3cde755a63dfc19da" category="list-text">在设置菜单中选择*Policies*。+<block ref="185326f0812872280f0adf0e04773ab1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="349ab45b449e8c58be43aa51b5414b97" category="inline-image-macro">hana hycl-back-image30、宽度=624、高度=316</block>
  <block id="ade97387220d3076bec4d7eac0ac1e25" category="list-text">如果需要，单击*Create Policy*创建新策略。+<block ref="8975d915951e905f053bb8fc4a552e7e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="62a3ac1a1f8d319fbc334f7bb626e92f" category="inline-image-macro">hana hycl-back-image31、宽度=624、高度=315</block>
  <block id="8558fcfb15dbf7f72676ae9e31d472a0" category="list-text">提供策略名称和所需的SnapMirror标签、选择所需选项、然后按*创建*。+<block ref="c347360112b9c6b6f7e94dade1749c17" category="inline-image-macro-rx" type="image"></block></block>
  <block id="56a584207272fdc3949d5cfbeddc6890" category="inline-image-macro">hana hycl-back-image32、宽度=624、高度=315</block>
  <block id="4f5cb79b576ac4420d5ab8df8d9b073f" category="list-text">新策略可用。+<block ref="2171b65bf9649c04f971325f1509e436" category="inline-image-macro-rx" type="image"></block></block>
  <block id="76e2dedbbcb80bd757e7f109e362eddf" category="inline-image-macro">宽度=624、高度=316</block>
  <block id="5e0cc03833db7c0576f7d24096566189" category="list-text">为SAP HANA系统选择*激活备份*。+<block ref="2c48b27f819c1f6dce464959272cc8fe" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7f25f783d0e4d4d1fddc6c9c315fd2b5" category="list-text">选择先前创建的策略，然后单击*Next*。+<block ref="c0254b63c0fb085b036886dfba6ccb39" category="inline-image-macro-rx" type="image"></block></block>
  <block id="301e715cc01e45bb423cb6a66ee55bd7" category="list-text">存储系统和连接器已预先配置、备份将被激活。+<block ref="ad1fce9dd6ef995031c85dd49fe04071" category="inline-image-macro-rx" type="image"></block></block>
  <block id="659017308b6b80ebac0dc21912936c14" category="inline-image-macro">宽度=624、高度=337</block>
  <block id="d9835ac927f5890b5c4fa24f03635dbf" category="list-text">作业完成后、系统将会列出。+<block ref="681e1ec310d70e08717a083b855d482a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a852f184953f796252263a558df2db56" category="inline-image-macro">hana hycl-back-image37、宽度=624、高度=316</block>
  <block id="f8573bf4cb07bcf6ef97ab079e1bb247" category="list-text">一段时间后、备份将在SAP HANA系统的详细信息视图中列出。+第二天将列出每日备份。+<block ref="dbaf7b11b6fc3181ec1d45bd0df20947" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c7fbbf7c043fddfe22030f95f982786c" category="summary">此部分列出了可从何处查找其他信息并显示版本历史记录。</block>
  <block id="41bb765509308cdc44c413e512e52e34" category="inline-image-macro">Ein Bild、dis text、Screenshot、Diagramm、Kreis enthält。自动生成Beschreirug、宽度=624、高度=450</block>
  <block id="796b2f89ad255115d9dff26e3177a467" category="paragraph"><block ref="796b2f89ad255115d9dff26e3177a467" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7bff1872092b4daae129c007c84cd996" category="inline-image-macro">hana hycl-back-image38、宽度=624、高度=305</block>
  <block id="14a2a4f505cd6a440ad11540cab0ac21" category="list-text">单击  与要还原的数据库对应的*查看详细信息*。+<block ref="6f8d75fb488649758851cccdb2cccf08" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a50aa712257968ee6554358d180aeec3" category="inline-image-macro">宽度=624、高度=308</block>
  <block id="25a498f9a461fac6930b9d847d3a31de" category="list-text">选择所需的备份、然后选择存储导出。+<block ref="7b0ca447499fc4df8de2cc9ab6e63840" category="inline-image-macro-rx" type="image"></block></block>
  <block id="75f1821bffac2198de5f906db81d5550" category="list-text">提供所需选项：+<block ref="498181ee050d357f4660daf5619ff189" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c2dc9045e50399390c48484b265865e6" category="inline-image-macro">hana hycl-back-image41、宽度=624、高度=309</block>
  <block id="4be067965fe33fc45487470a504acc33" category="list-text">查看详细信息，然后单击 *Restore*。+++<block ref="3d53ce2d67869523c0b4d4e2b8793ead" category="inline-image-macro-rx" type="image"></block>此操作仅会为给定主机导出已还原备份的存储。您必须在主机上手动挂载文件系统并启动数据库。使用此卷后、存储管理员可以从ONTAP 集群中删除此卷。</block>
  <block id="20dd6e2f8deed2b25c9752f435df96b4" category="paragraph"><block ref="20dd6e2f8deed2b25c9752f435df96b4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="607e9caaefc803f1d39242ad4334a766" category="paragraph"><block ref="607e9caaefc803f1d39242ad4334a766" category="inline-image-macro-rx" type="image"></block></block>
  <block id="46f88568036f8d70f81f56eb754440ba" category="paragraph"><block ref="46f88568036f8d70f81f56eb754440ba" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0e84b80d2a5f8afd1eeb5f706b957809" category="paragraph"><block ref="0e84b80d2a5f8afd1eeb5f706b957809" category="inline-image-macro-rx" type="image"></block></block>
  <block id="76cbf45b1f9a3af3dab99afdd9102f57" category="paragraph"><block ref="76cbf45b1f9a3af3dab99afdd9102f57" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a2ceed083413904bb97cfc22c026b2af" category="paragraph"><block ref="a2ceed083413904bb97cfc22c026b2af" category="inline-image-macro-rx" type="image"></block></block>
  <block id="509edc00e360dcd0c183c1487937703d" category="paragraph"><block ref="509edc00e360dcd0c183c1487937703d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e8679b7fce4de17eedbac19a9c747487" category="paragraph"><block ref="e8679b7fce4de17eedbac19a9c747487" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5149a69616444893c44f06dc15b741e8" category="paragraph"><block ref="5149a69616444893c44f06dc15b741e8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dc1f0638cdbb609889f95d7ea5de91f0" category="paragraph"><block ref="dc1f0638cdbb609889f95d7ea5de91f0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="213000344b9f5937ee0ab5022fb38fe1" category="paragraph"><block ref="213000344b9f5937ee0ab5022fb38fe1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1e06dc81d31ce49e4c49bf35b686e256" category="paragraph"><block ref="1e06dc81d31ce49e4c49bf35b686e256" category="inline-image-macro-rx" type="image"></block></block>
  <block id="81a6dbd112e9acc96063544263cd4407" category="paragraph"><block ref="81a6dbd112e9acc96063544263cd4407" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f77ab94949d12edf3f679eeafaff08f1" category="paragraph"><block ref="f77ab94949d12edf3f679eeafaff08f1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9569b07c4fa020d453c61f6bebb105ca" category="paragraph"><block ref="9569b07c4fa020d453c61f6bebb105ca" category="inline-image-macro-rx" type="image"></block></block>
  <block id="cc06afe51498262662d697fbde47e748" category="paragraph">此操作将启动备份作业。拓扑视图下方的活动区域将显示前五个作业的日志。备份完成后，拓扑视图中将显示一个新条目。备份名称遵循与一节中定义的Snapshot名称相同的命名约定<block ref="8fdc6e44a3c442cc41da5e1b7d9bcaa4" category="inline-link-macro-rx"></block></block>
  <block id="6b98bb01e05466370ca465f334758c7b" category="paragraph"><block ref="6b98bb01e05466370ca465f334758c7b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f36bfceb38e6d87d048d602306b8acbb" category="paragraph"><block ref="f36bfceb38e6d87d048d602306b8acbb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3b9e76dd31d87682580ad0cd4ae926ee" category="paragraph"><block ref="3b9e76dd31d87682580ad0cd4ae926ee" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6a8431ddb99271c6c2a394be7d8fdf13" category="paragraph"><block ref="6a8431ddb99271c6c2a394be7d8fdf13" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8c84aab356bf27cc726fae5845bca884" category="list-text">备份完成后，拓扑视图中将显示一个新条目。备份名称遵循与一节中定义的Snapshot名称相同的命名约定<block ref="8fdc6e44a3c442cc41da5e1b7d9bcaa4" category="inline-link-macro-rx"></block></block>
  <block id="f8f40e030fc3a293f9182520e7bf9778" category="paragraph"><block ref="f8f40e030fc3a293f9182520e7bf9778" category="inline-image-macro-rx" type="image"></block></block>
  <block id="88bc4c29ce686e50d213ba7ad5a20db8" category="paragraph"><block ref="88bc4c29ce686e50d213ba7ad5a20db8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4c6a493a9ccd77d86a4be748edbfdbc9" category="paragraph"><block ref="4c6a493a9ccd77d86a4be748edbfdbc9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="97a4633a8756f5cb371d3439d3bcb6fb" category="paragraph"><block ref="97a4633a8756f5cb371d3439d3bcb6fb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="75523f1a0e977636bc96cc9d1d4d0841" category="paragraph"><block ref="75523f1a0e977636bc96cc9d1d4d0841" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6c2f3808a3d3fab64305716667e3ee5e" category="paragraph"><block ref="6c2f3808a3d3fab64305716667e3ee5e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6ffcd1c596f830f8e72c9e5094447626" category="paragraph"><block ref="6ffcd1c596f830f8e72c9e5094447626" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bd0c8a6c113f22fd66826518dd76e047" category="paragraph"><block ref="bd0c8a6c113f22fd66826518dd76e047" category="inline-image-macro-rx" type="image"></block></block>
  <block id="10ce9a188fb42d2f2e42a0e4b110ec58" category="paragraph"><block ref="10ce9a188fb42d2f2e42a0e4b110ec58" category="inline-image-macro-rx" type="image"></block></block>
  <block id="cf1dde6f502faeaf69d6ed5e5d4d286c" category="paragraph"><block ref="cf1dde6f502faeaf69d6ed5e5d4d286c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="67f0b6f8ea0341b32bbc62ada2f2835b" category="paragraph"><block ref="67f0b6f8ea0341b32bbc62ada2f2835b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9fec60ab27fae802dd74bd4c41edc521" category="paragraph"><block ref="9fec60ab27fae802dd74bd4c41edc521" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f3e52d43d89f6fcdcfd642fc3ae1be74" category="paragraph"><block ref="f3e52d43d89f6fcdcfd642fc3ae1be74" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b4b76acec06128c0b8027bfaec9e4efd" category="paragraph"><block ref="b4b76acec06128c0b8027bfaec9e4efd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ce8f77d71cf66a8a5b8dc84d9d7247e1" category="paragraph"><block ref="ce8f77d71cf66a8a5b8dc84d9d7247e1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5bc0a4ea41e4dd6446daac80c75b6285" category="paragraph"><block ref="5bc0a4ea41e4dd6446daac80c75b6285" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ad47737e5317a468731032ba4583dc06" category="paragraph"><block ref="ad47737e5317a468731032ba4583dc06" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8480ccc856cccf9e0731d039a39d2eb5" category="paragraph"><block ref="8480ccc856cccf9e0731d039a39d2eb5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b9bc79829aa9fc1c48f9fdbb93c04fd9" category="paragraph"><block ref="b9bc79829aa9fc1c48f9fdbb93c04fd9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="695c571700b169d6a339f1dd5f2f882c" category="paragraph"><block ref="695c571700b169d6a339f1dd5f2f882c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7e2da0bf7ed0bcc1e03f8d93bc3024d0" category="paragraph"><block ref="7e2da0bf7ed0bcc1e03f8d93bc3024d0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9a65f4509dbeacb95be90baf19f0e2d4" category="paragraph"><block ref="9a65f4509dbeacb95be90baf19f0e2d4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5745ea93c728dda67de8288de2bc36f6" category="paragraph"><block ref="5745ea93c728dda67de8288de2bc36f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="aa4851d9c80e8ee496311dfd26fbdcb8" category="paragraph"><block ref="aa4851d9c80e8ee496311dfd26fbdcb8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bf00a08e154ad0e4fddb73fb9da56257" category="paragraph"><block ref="bf00a08e154ad0e4fddb73fb9da56257" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ef3a7196cbb2d1daab72705808b947d5" category="paragraph"><block ref="ef3a7196cbb2d1daab72705808b947d5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fbcac1c11ccc8e801efe2bbf2acf143d" category="paragraph"><block ref="fbcac1c11ccc8e801efe2bbf2acf143d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c6d7d8114f2a343a4e7c04602a69227a" category="paragraph"><block ref="c6d7d8114f2a343a4e7c04602a69227a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8dd6243b1463fbbb4e16bf54334f2640" category="paragraph"><block ref="8dd6243b1463fbbb4e16bf54334f2640" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b3f277dd697470b66c1f2190244c54d2" category="paragraph"><block ref="b3f277dd697470b66c1f2190244c54d2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e7501802c681ec1f47cd912c86b3bd9e" category="paragraph"><block ref="e7501802c681ec1f47cd912c86b3bd9e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="61df5eceeb903c66813a8653651a1fc7" category="paragraph"><block ref="61df5eceeb903c66813a8653651a1fc7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="39eb57804690563a191dfa1190966d73" category="paragraph"><block ref="39eb57804690563a191dfa1190966d73" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2cb625187749843bebb4e6401cc5b84a" category="paragraph"><block ref="2cb625187749843bebb4e6401cc5b84a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1cd0ad1c95f31a9fe03790e1f2b2f647" category="paragraph"><block ref="1cd0ad1c95f31a9fe03790e1f2b2f647" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3c6c6629c213de910296218d125350f7" category="paragraph"><block ref="3c6c6629c213de910296218d125350f7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f217e06b2f5e63f5ce7c9782fe45e0c7" category="paragraph"><block ref="f217e06b2f5e63f5ce7c9782fe45e0c7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9cf5ed7cea49e42512c5250ba7e05032" category="paragraph"><block ref="9cf5ed7cea49e42512c5250ba7e05032" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d9c5fc076375ef8a1a5f08cba7be5801" category="paragraph"><block ref="d9c5fc076375ef8a1a5f08cba7be5801" category="inline-image-macro-rx" type="image"></block></block>
  <block id="942b1ef3e197f6f65e33b3a4a84f80b1" category="paragraph"><block ref="942b1ef3e197f6f65e33b3a4a84f80b1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3d70362fd6eea1b2d5597e45e213ba76" category="paragraph"><block ref="3d70362fd6eea1b2d5597e45e213ba76" category="inline-image-macro-rx" type="image"></block></block>
  <block id="385c63b17908d38dddf10ae4033ef478" category="paragraph"><block ref="385c63b17908d38dddf10ae4033ef478" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f8cadf0861791dd858d7b79a8bc58881" category="paragraph"><block ref="f8cadf0861791dd858d7b79a8bc58881" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6ac724fb8986b98e6e85034df7770698" category="paragraph"><block ref="6ac724fb8986b98e6e85034df7770698" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7b1e890b361a4751180d81a2c44aca27" category="paragraph"><block ref="7b1e890b361a4751180d81a2c44aca27" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6122c430d0be02491954b9c7c2af8bd7" category="paragraph"><block ref="6122c430d0be02491954b9c7c2af8bd7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9b95cb56a3a264d39c3953aab74d1daa" category="paragraph"><block ref="9b95cb56a3a264d39c3953aab74d1daa" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9a250d7a6069f1d1fbb482060a0232f0" category="paragraph"><block ref="9a250d7a6069f1d1fbb482060a0232f0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="76939726b98a889d506989deb9341103" category="paragraph"><block ref="76939726b98a889d506989deb9341103" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7216f6ef9e8c4aca1ef8fa2296148bdf" category="paragraph"><block ref="7216f6ef9e8c4aca1ef8fa2296148bdf" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2dbf47a4d55d423ce21c24522f7b1574" category="paragraph"><block ref="2dbf47a4d55d423ce21c24522f7b1574" category="inline-image-macro-rx" type="image"></block></block>
  <block id="27885829bda7c02ed136f0cf60d94136" category="paragraph"><block ref="27885829bda7c02ed136f0cf60d94136" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9796177deb9c126116fcf994b5040617" category="paragraph"><block ref="9796177deb9c126116fcf994b5040617" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ba987cf0ba6c5b030b65a08d26406095" category="paragraph"><block ref="ba987cf0ba6c5b030b65a08d26406095" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7e5a1cf5ffd1105de263b9ce83bc4c0d" category="paragraph"><block ref="7e5a1cf5ffd1105de263b9ce83bc4c0d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="248dcdd614770532cf092fb13e8cb6e5" category="paragraph"><block ref="248dcdd614770532cf092fb13e8cb6e5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e292f2d79c8a90bebfddbd410ab5feca" category="paragraph"><block ref="e292f2d79c8a90bebfddbd410ab5feca" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b59196896409702b7619c9f466e93a96" category="paragraph"><block ref="b59196896409702b7619c9f466e93a96" category="inline-image-macro-rx" type="image"></block></block>
  <block id="12070fd7c7bf14b0d48eca672da868cc" category="paragraph"><block ref="12070fd7c7bf14b0d48eca672da868cc" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e41d9c3d5fa367b3bfcf9ae7c3286930" category="paragraph"><block ref="e41d9c3d5fa367b3bfcf9ae7c3286930" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d74c29ce0fce3db7e0cb88e0c0dd7354" category="paragraph"><block ref="d74c29ce0fce3db7e0cb88e0c0dd7354" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3e40111348d81f6a8f8c325b1d729b1e" category="paragraph"><block ref="3e40111348d81f6a8f8c325b1d729b1e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8c793658e962487f4c8a6f7b4bd13e9a" category="paragraph"><block ref="8c793658e962487f4c8a6f7b4bd13e9a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9389dbbe2ed5738acc253d6aeccd4285" category="paragraph"><block ref="9389dbbe2ed5738acc253d6aeccd4285" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4acf49c37725eff3d1e1647f59444563" category="paragraph"><block ref="4acf49c37725eff3d1e1647f59444563" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d401c96972cf4872497867c8813dd0c4" category="paragraph"><block ref="d401c96972cf4872497867c8813dd0c4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="df1b32232287f7077cc8ea06d4067aba" category="paragraph"><block ref="df1b32232287f7077cc8ea06d4067aba" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d927ea73390d1073b251d0ab8e1c4f29" category="paragraph"><block ref="d927ea73390d1073b251d0ab8e1c4f29" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b841c815b314786330d9bb2cf3ac71ef" category="admonition">在 HANA 数据库主机上部署 HANA 插件时，默认情况下会自动发现资源。可以为单个主机禁用自动发现，以便可以部署此插件；例如，在已激活 HANA 系统复制且 SnapCenter 版本小于 4.6 的数据库主机上，不支持自动发现。有关详细信息、请参见一节<block ref="522e0ada2e957f3b39057afe327085c3" category="inline-link-macro-rx"></block></block>
  <block id="49aea0eb02cf6c45f892c1968f4be5e4" category="paragraph"><block ref="49aea0eb02cf6c45f892c1968f4be5e4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ed753725e82825ea0717a079ace3f412" category="paragraph"><block ref="ed753725e82825ea0717a079ace3f412" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a226af60009f8254abee0e79c0cfefcb" category="paragraph"><block ref="a226af60009f8254abee0e79c0cfefcb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="45d79d69ac1d7220193d0c8affd7d9a8" category="paragraph"><block ref="45d79d69ac1d7220193d0c8affd7d9a8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="077917c9df911c71a158d740302e512d" category="paragraph"><block ref="077917c9df911c71a158d740302e512d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="633bcbcfe96ab07323708da2788530fe" category="paragraph"><block ref="633bcbcfe96ab07323708da2788530fe" category="inline-image-macro-rx" type="image"></block></block>
  <block id="23b1e85ca318b7c394cdfb37cf779a84" category="paragraph"><block ref="23b1e85ca318b7c394cdfb37cf779a84" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0834dce0aa1a2d0809955c3925129489" category="paragraph"><block ref="0834dce0aa1a2d0809955c3925129489" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e130b90a161004441971b7778cd4c752" category="paragraph">有关如何调整清理作业计划或如何触发手动刷新的详细信息、请参阅一节<block ref="5c7644418d0c6535792b7dcb1553a3ec" category="inline-link-macro-rx"></block></block>
  <block id="00622b5e04bd3c50d6baa6da06bdd5ef" category="paragraph">默认情况下，日志备份保留管理处于启用状态。如果需要、可以按一节所述禁用它<block ref="522e0ada2e957f3b39057afe327085c3" category="inline-link-macro-rx"></block></block>
  <block id="b64bc38243e4b017acd60936979040ba" category="paragraph"><block ref="b64bc38243e4b017acd60936979040ba" category="inline-image-macro-rx" type="image"></block></block>
  <block id="03d7b4ceaff2906c7ae18429532e7b6e" category="paragraph"><block ref="03d7b4ceaff2906c7ae18429532e7b6e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3db6ab2fafae9e697382cb69b35cb26c" category="paragraph"><block ref="3db6ab2fafae9e697382cb69b35cb26c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a9ed22a3c9e174cb71b8c3f6d4666cd8" category="paragraph"><block ref="a9ed22a3c9e174cb71b8c3f6d4666cd8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9786c27aaf0b69122f76ff37da013171" category="paragraph"><block ref="9786c27aaf0b69122f76ff37da013171" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f89b5e800d7219f5c70ff5cb9df2071f" category="paragraph"><block ref="f89b5e800d7219f5c70ff5cb9df2071f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="154813b4920e9b720e9d5f15705ccebc" category="paragraph"><block ref="154813b4920e9b720e9d5f15705ccebc" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e65dcbc8d4ba6e6fc232aa49bcfd185e" category="paragraph"><block ref="e65dcbc8d4ba6e6fc232aa49bcfd185e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="09370ef617197ffd6612a29d78e374fa" category="paragraph"><block ref="09370ef617197ffd6612a29d78e374fa" category="inline-image-macro-rx" type="image"></block></block>
  <block id="221de9d5155a2d0b97df79adfc91ebc2" category="paragraph"><block ref="221de9d5155a2d0b97df79adfc91ebc2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="652b0bd267da45fc4baf7581b1e9dfdc" category="paragraph"><block ref="652b0bd267da45fc4baf7581b1e9dfdc" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b827b5e63fb204b72559cd49e8cbcb0a" category="paragraph"><block ref="b827b5e63fb204b72559cd49e8cbcb0a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="97979c8cc8ed0bb377db069e4501a3ad" category="paragraph"><block ref="97979c8cc8ed0bb377db069e4501a3ad" category="inline-image-macro-rx" type="image"></block></block>
  <block id="16494477d3a123e941b6ff45c69cf723" category="paragraph"><block ref="16494477d3a123e941b6ff45c69cf723" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3fec478f2aa80a942d362849454f49f6" category="paragraph"><block ref="3fec478f2aa80a942d362849454f49f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ee854e7031d8466ca89ef6b0a031257b" category="paragraph"><block ref="ee854e7031d8466ca89ef6b0a031257b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="67a2a2d69a95fb29f0d671fe8bd03a93" category="paragraph"><block ref="67a2a2d69a95fb29f0d671fe8bd03a93" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b90d2babb8f18a211e72aa916075a6f9" category="paragraph"><block ref="b90d2babb8f18a211e72aa916075a6f9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7d505d74f1e8db6a8c3a7b4effd93c03" category="paragraph"><block ref="7d505d74f1e8db6a8c3a7b4effd93c03" category="inline-image-macro-rx" type="image"></block></block>
  <block id="eb42e84bdd458b863b6d5668842a6244" category="paragraph"><block ref="eb42e84bdd458b863b6d5668842a6244" category="inline-image-macro-rx" type="image"></block></block>
  <block id="818e8d9b9c866af7a74140a2e73171a2" category="paragraph"><block ref="818e8d9b9c866af7a74140a2e73171a2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="36e9d30b5a88eb8d1212a4a88853343a" category="paragraph"><block ref="36e9d30b5a88eb8d1212a4a88853343a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9108e12773fdbc41d3dad3146c5e34d5" category="paragraph"><block ref="9108e12773fdbc41d3dad3146c5e34d5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="693150dd042d78f1eb9da59f5b5d7f49" category="paragraph"><block ref="693150dd042d78f1eb9da59f5b5d7f49" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a170df0ea0568c142cb25b08a3a3762b" category="paragraph"><block ref="a170df0ea0568c142cb25b08a3a3762b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c3c9dd76d97c11ad455c0d89b35face9" category="paragraph"><block ref="c3c9dd76d97c11ad455c0d89b35face9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d48d3297a2157610b962a8b5e45d4b7b" category="paragraph"><block ref="d48d3297a2157610b962a8b5e45d4b7b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="37a837af1f6c53e70f87fc2a348a1f13" category="paragraph"><block ref="37a837af1f6c53e70f87fc2a348a1f13" category="inline-image-macro-rx" type="image"></block></block>
  <block id="674375a017dced04e6158b45943a19c2" category="paragraph"><block ref="674375a017dced04e6158b45943a19c2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="73cebd5a1227e44927be7ce4e2058a0a" category="paragraph"><block ref="73cebd5a1227e44927be7ce4e2058a0a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="58e6f26a1d92ca5189c3e094b4b87a5e" category="paragraph"><block ref="58e6f26a1d92ca5189c3e094b4b87a5e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e4746ad00011ec5decb7bd58b32e4118" category="paragraph"><block ref="e4746ad00011ec5decb7bd58b32e4118" category="inline-image-macro-rx" type="image"></block></block>
  <block id="60f024e4f5fc54f83cb9397e48c097bf" category="paragraph"><block ref="60f024e4f5fc54f83cb9397e48c097bf" category="inline-image-macro-rx" type="image"></block></block>
  <block id="55c28d7c8eb2db7e68ee228debca9909" category="paragraph"><block ref="55c28d7c8eb2db7e68ee228debca9909" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4f2bd4164b2d594a347258d12c41de82" category="paragraph"><block ref="4f2bd4164b2d594a347258d12c41de82" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3a6dd499d879b53282054958d67fa8d6" category="paragraph"><block ref="3a6dd499d879b53282054958d67fa8d6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1d31d347e600eb28d9478ede18fc8411" category="paragraph"><block ref="1d31d347e600eb28d9478ede18fc8411" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4334eb8cd2e8039ba334b71fc06d8db8" category="paragraph"><block ref="4334eb8cd2e8039ba334b71fc06d8db8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="116dc38e3581c8a4641891cd3f0d8658" category="paragraph"><block ref="116dc38e3581c8a4641891cd3f0d8658" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ff7f21a9491010b81cd869281cdceb9c" category="admonition">要创建的策略中的 SnapMirror 标签必须与 SnapCenter 策略配置中定义的标签匹配。有关详细信息，请参见 <block ref="b91cafa10b6f944249ed1c7aa74fde0b" category="inline-link-macro-rx"></block>。</block>
  <block id="f67733e89d0b5d732c1fd344cbb7105f" category="paragraph"><block ref="f67733e89d0b5d732c1fd344cbb7105f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="effb4b9effe8b2ac6af9b7bbeedc81aa" category="paragraph"><block ref="effb4b9effe8b2ac6af9b7bbeedc81aa" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6af3b4279a45fee0176779ad97e6127a" category="paragraph"><block ref="6af3b4279a45fee0176779ad97e6127a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c916b4f33090fb713c3626bab9d40dc0" category="paragraph"><block ref="c916b4f33090fb713c3626bab9d40dc0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7a393612bb12dacd45725bfcf1dc07d6" category="paragraph"><block ref="7a393612bb12dacd45725bfcf1dc07d6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5b43f7198e92454b11807399b4cba06b" category="paragraph"><block ref="5b43f7198e92454b11807399b4cba06b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ff7fec0d972ffd5e095c317752e7cfd2" category="list-text">完成资源配置后，按照一节中所述执行资源保护配置<block ref="cc224d6e58b33e21d7605953b166f2bc" category="inline-link-macro-rx"></block>。</block>
  <block id="71ae6283c1cddf71f46c95dd5f742941" category="paragraph"><block ref="71ae6283c1cddf71f46c95dd5f742941" category="inline-image-macro-rx" type="image"></block></block>
  <block id="064c12d44f5dc3e4d5e0c8d8968a464c" category="paragraph"><block ref="064c12d44f5dc3e4d5e0c8d8968a464c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c97782ef9e4ce23ec2d0a66d5fe18206" category="paragraph"><block ref="c97782ef9e4ce23ec2d0a66d5fe18206" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c360813f37faca7cfe33ddf674507002" category="paragraph"><block ref="c360813f37faca7cfe33ddf674507002" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5b42ec286951308db9609b18b9ba618e" category="paragraph"><block ref="5b42ec286951308db9609b18b9ba618e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="05d88dd9fb94513b5c307c3dacc9428f" category="paragraph"><block ref="05d88dd9fb94513b5c307c3dacc9428f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b1c986927364892bf2ad5b69d4d7169b" category="paragraph"><block ref="b1c986927364892bf2ad5b69d4d7169b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="659b0717a77e312a3b42c4d3bf436071" category="paragraph"><block ref="659b0717a77e312a3b42c4d3bf436071" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d7ec1f350783981b5864d754a684c22a" category="paragraph"><block ref="d7ec1f350783981b5864d754a684c22a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4ac8e14391df6273f3df23512b83e54f" category="paragraph"><block ref="4ac8e14391df6273f3df23512b83e54f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2e1d682874989f057e3b73e6c34b2dca" category="paragraph"><block ref="2e1d682874989f057e3b73e6c34b2dca" category="inline-image-macro-rx" type="image"></block></block>
  <block id="14d0de324edbfcb89462ebddf1ce52e0" category="paragraph"><block ref="14d0de324edbfcb89462ebddf1ce52e0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7426e6396c17ca706788d1a4298aebe3" category="paragraph"><block ref="7426e6396c17ca706788d1a4298aebe3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b0809e1508f7549a38a780b779a4d889" category="paragraph"><block ref="b0809e1508f7549a38a780b779a4d889" category="inline-image-macro-rx" type="image"></block></block>
  <block id="12b7d639d9a4e784f5ff18c9c2d82b2b" category="paragraph"><block ref="12b7d639d9a4e784f5ff18c9c2d82b2b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="50182d1212e6e13b880fae3290b3f229" category="paragraph"><block ref="50182d1212e6e13b880fae3290b3f229" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4eeaf2497bf1e78eff048404e175af1c" category="paragraph"><block ref="4eeaf2497bf1e78eff048404e175af1c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c4730908778321c1c43883f74e6a2290" category="paragraph"><block ref="c4730908778321c1c43883f74e6a2290" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e3c0940db2450101287ffe6b7064a54d" category="paragraph"><block ref="e3c0940db2450101287ffe6b7064a54d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="170e3ae89d6261851ff484a8e771649e" category="paragraph">作者：NetApp公司Marco主持；CommvaultSystems公司的Tristan Daude博士</block>
  <block id="477777d7db9a7b53d5e478c5db17b758" category="paragraph">本文档介绍了使用SAP HANA进行ANF跨区域复制的内容。</block>
  <block id="47aaf8de67485357e92e6a9f240d8259" category="paragraph">有关跨区域复制的不受应用程序限制的信息、请访问以下位置。</block>
  <block id="c4b92d3c1a1f3068ee30be1e0c67b874" category="paragraph"><block ref="703da3602eb8895f5ab46f3e581967de" category="inline-link-macro-rx"></block>在概念和操作指南部分。</block>
  <block id="be11a09e4ce4c0d4bf97388fc53cc41f" category="paragraph"><block ref="be11a09e4ce4c0d4bf97388fc53cc41f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6b117eb2890fb70e2258b6dcd5cb0135" category="paragraph"><block ref="6b117eb2890fb70e2258b6dcd5cb0135" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b17ba34677395ede8c6cbaf3db2a3a1a" category="paragraph"><block ref="b17ba34677395ede8c6cbaf3db2a3a1a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="af58c6e0baa91053f65764beb2329580" category="paragraph"><block ref="af58c6e0baa91053f65764beb2329580" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0d8b535b651621de879b4aa099b76a23" category="paragraph"><block ref="0d8b535b651621de879b4aa099b76a23" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e5de95bcc37400cfd56a76e05c8141ad" category="paragraph"><block ref="e5de95bcc37400cfd56a76e05c8141ad" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f675098f46d311d3782e270959ca5ffb" category="paragraph"><block ref="f675098f46d311d3782e270959ca5ffb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="06ae7353ed1f5039442397f2b2ea525f" category="paragraph"><block ref="06ae7353ed1f5039442397f2b2ea525f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5bd384ec367fabe3f59dd536d87d59be" category="paragraph"><block ref="5bd384ec367fabe3f59dd536d87d59be" category="inline-image-macro-rx" type="image"></block></block>
  <block id="707ccff1ec6eac1c4cf26ca3bee5bda1" category="paragraph"><block ref="707ccff1ec6eac1c4cf26ca3bee5bda1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c35077811ee736b1e8448fb3db61871d" category="paragraph"><block ref="c35077811ee736b1e8448fb3db61871d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="013edc7081d08436bfc61b35ad959f46" category="paragraph"><block ref="013edc7081d08436bfc61b35ad959f46" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6c292597f00bd08bdf83748dd93948e1" category="paragraph"><block ref="6c292597f00bd08bdf83748dd93948e1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3e4acfdc602088f9c71301dc58910590" category="paragraph"><block ref="3e4acfdc602088f9c71301dc58910590" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5e79f9aa23bdb0ed964a063bf531adc4" category="paragraph"><block ref="5e79f9aa23bdb0ed964a063bf531adc4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="065981f3f6e55d32323dcd986071c284" category="paragraph"><block ref="065981f3f6e55d32323dcd986071c284" category="inline-image-macro-rx" type="image"></block></block>
  <block id="74124997276f5a6feec42bb6bd3feccc" category="paragraph">本节概述了Azure NetApp Files (ANF)中SAP HANA的数据保护。</block>
  <block id="e97f6d7a7344486294c33d6f977eeac9" category="paragraph">作者：Nils Bauer、NetApp Ralf Klhr、Microsoft</block>
  <block id="623fe9adf48a40688e6ff6b4dbc86391" category="paragraph">除了财务影响之外，停机还会损害公司的声誉，员工士气和客户忠诚度。令人惊讶的是，并非所有公司都制定了全面的灾难恢复策略。</block>
  <block id="3df64b394b3dd5715841673864cabf41" category="paragraph"><block ref="3df64b394b3dd5715841673864cabf41" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fab33777c49ea1ad98df5195e304ce49" category="paragraph">本节概述了Azure NetApp Files (ANF)中SAP HANA的灾难恢复。</block>
  <block id="1ea8b5f06505efaf09d410c5e2da5fa7" category="paragraph"><block ref="1ea8b5f06505efaf09d410c5e2da5fa7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a540511c7182e4ca19f0c146ab4549f6" category="paragraph"><block ref="a540511c7182e4ca19f0c146ab4549f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="04f1e2de3476b55892265c003b6854dd" category="paragraph"><block ref="04f1e2de3476b55892265c003b6854dd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c0d15875dfde37ac63eb786976ca73e2" category="paragraph">有关不同配置选项的详细信息，请参见第章<block ref="0b9d85c6a55fac21d976fc5cfd172665" category="inline-link-macro-rx"></block>。</block>
  <block id="47702125a3af734377218735a751bcbb" category="paragraph"><block ref="47702125a3af734377218735a751bcbb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5e57f6f4d0c511dfbe046b491728ad18" category="paragraph">本节概述了在Azure NetApp Files中对SAP HANA进行灾难恢复测试(ANF)。</block>
  <block id="ab9dbf2083578b44a472ea9e4be86bc8" category="paragraph"><block ref="ab9dbf2083578b44a472ea9e4be86bc8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="85591ea875aef47b04117d05480a19b6" category="paragraph"><block ref="85591ea875aef47b04117d05480a19b6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9a38316ac2ef898c9b4a6bf665e78a56" category="paragraph"><block ref="9a38316ac2ef898c9b4a6bf665e78a56" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c8bd9fa63d68091ab344661ded1d084d" category="paragraph"><block ref="c8bd9fa63d68091ab344661ded1d084d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="30084c3bfe907010024e87ab013aa9e9" category="paragraph"><block ref="30084c3bfe907010024e87ab013aa9e9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1597c090ca92637dc7c87369385ae4ae" category="paragraph"><block ref="1597c090ca92637dc7c87369385ae4ae" category="inline-image-macro-rx" type="image"></block></block>
  <block id="232d09bce830ff435ff855ae867e7612" category="paragraph"><block ref="232d09bce830ff435ff855ae867e7612" category="inline-image-macro-rx" type="image"></block></block>
  <block id="411ab2cdf07ad3f27defc79e892f1431" category="paragraph"><block ref="411ab2cdf07ad3f27defc79e892f1431" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fd39a5c32ee6690549ac30ea245401aa" category="paragraph">作者：</block>
  <block id="cc396fc030ef4980e68d8d063e3bcd5a" category="paragraph">Nil Bauser ， Roland Wartenberg ， Darryl Clinkscales ， Daniel Hohman ， Marco Schöen Steve Botkin ， Michael Peppers ， Vidula Ayer ， Steve Collins ， Pavan JHamnani ， Lee Dorrier ， NetApp Jim Zucchero ， Naem Saafein 博士， Broadcom Brocade</block>
  <block id="f831bc1385f211f6c5893e60a78f7edd" category="paragraph"><block ref="f831bc1385f211f6c5893e60a78f7edd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9eee47fd34fc6b04956fd9a405203870" category="paragraph"><block ref="9eee47fd34fc6b04956fd9a405203870" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4101bf3ece6b2883b54788c3db328556" category="paragraph"><block ref="4101bf3ece6b2883b54788c3db328556" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6862c0de21b3b1f69dd5d17d1ca71674" category="paragraph"><block ref="6862c0de21b3b1f69dd5d17d1ca71674" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0793c41e221d987cd28b69479802ca0f" category="paragraph"><block ref="0793c41e221d987cd28b69479802ca0f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4185d7ef0fa279ea3a511196a6fec9af" category="paragraph"><block ref="4185d7ef0fa279ea3a511196a6fec9af" category="inline-image-macro-rx" type="image"></block></block>
  <block id="733fdb7f97f71e69890c36070b776f4d" category="paragraph"><block ref="733fdb7f97f71e69890c36070b776f4d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b622d9c2556018d5a1c5cf296c80dfcb" category="paragraph">为HANA系统数据库创建了一个数据库用户“SnapCenter”，该用户具有执行备份和恢复操作所需的Privileges (请参见<block ref="e41a761215847f1954526581a9b27fed" category="inline-link-macro-rx"></block>)。必须使用上述数据库用户在两台主机上配置 HANA 用户存储密钥。</block>
  <block id="a8ed0b8c8d32b15e6fc1572db0c8f48e" category="paragraph"><block ref="a8ed0b8c8d32b15e6fc1572db0c8f48e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c3cd03a132712864a3f205a261a367a0" category="paragraph"><block ref="c3cd03a132712864a3f205a261a367a0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b5e6d39d6ec4da44b47f8a00e90c5a90" category="paragraph"><block ref="b5e6d39d6ec4da44b47f8a00e90c5a90" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4f59ab534fc94a035a9becf56da748a3" category="paragraph"><block ref="4f59ab534fc94a035a9becf56da748a3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0c59c6e251456b278007120a47900369" category="paragraph"><block ref="0c59c6e251456b278007120a47900369" category="inline-image-macro-rx" type="image"></block></block>
  <block id="60e4fc4a93b8b978c5da7ae35f18915c" category="paragraph"><block ref="60e4fc4a93b8b978c5da7ae35f18915c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b8c1d0e538d07726bb2a3789788890a3" category="paragraph"><block ref="b8c1d0e538d07726bb2a3789788890a3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f401057efa629c640bf715ba315b7913" category="paragraph"><block ref="f401057efa629c640bf715ba315b7913" category="inline-image-macro-rx" type="image"></block></block>
  <block id="cf1de9c715b2a8b6aa770689688ad7db" category="paragraph"><block ref="cf1de9c715b2a8b6aa770689688ad7db" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e4d1c212c314a6a2dda14e5a20be3c65" category="paragraph"><block ref="e4d1c212c314a6a2dda14e5a20be3c65" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ad326a8f9bef32e7dba45e5d9b6aad8f" category="paragraph"><block ref="ad326a8f9bef32e7dba45e5d9b6aad8f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1f5a5d1c478390a93e5af02b571888e9" category="paragraph"><block ref="1f5a5d1c478390a93e5af02b571888e9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2c22e3a90c4fca8a5cb858ca36706c26" category="paragraph"><block ref="2c22e3a90c4fca8a5cb858ca36706c26" category="inline-image-macro-rx" type="image"></block></block>
  <block id="abbf55aa91020e0bf9cb4a8990a21585" category="paragraph"><block ref="abbf55aa91020e0bf9cb4a8990a21585" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5fd0bc2d8579914f332abdc440f20b13" category="paragraph"><block ref="5fd0bc2d8579914f332abdc440f20b13" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2424a8c3863c52896548d419748e580c" category="paragraph"><block ref="2424a8c3863c52896548d419748e580c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="398ea5018be91458ba81a72e923d493a" category="paragraph"><block ref="398ea5018be91458ba81a72e923d493a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2383c7a036f0732ff3580d36a951a656" category="paragraph"><block ref="2383c7a036f0732ff3580d36a951a656" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ac5ad4a0ae8e627e2f3c2a12c0fff05f" category="paragraph"><block ref="ac5ad4a0ae8e627e2f3c2a12c0fff05f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9cebaed070e7174613ece1f474ee0561" category="paragraph"><block ref="9cebaed070e7174613ece1f474ee0561" category="inline-image-macro-rx" type="image"></block></block>
  <block id="97190cc0cb5ed4bb0aaaa0aa25a3187e" category="inline-link-macro">SnapVault复制</block>
  <block id="927d1129cd74d49cd508b054408f783e" category="paragraph">如果SnapVault复制是数据保护策略的一部分、则在特定场景下需要手动交互、如一节所述<block ref="ea12e55fd902665a5f91f6ad71303561" category="inline-link-macro-rx"></block></block>
  <block id="5892f64a984e3831714926d1d2ff42d8" category="paragraph"><block ref="5892f64a984e3831714926d1d2ff42d8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="25c8a88d0a0c77deaaad38feaf89298f" category="paragraph">SnapCenter 4.6 资源组配置的还原和恢复操作与自动发现的非系统复制设置相同。所有还原和自动恢复选项均可用。有关详细信息，请参见技术报告<block ref="c9a3872548e4312fbdc4182e9dbfeaef" category="inline-link-macro-rx"></block>。</block>
  <block id="3a36e4a9f8e29b1b70cbfaaaf5e5ddde" category="paragraph"><block ref="3a36e4a9f8e29b1b70cbfaaaf5e5ddde" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e1c1974d031eaf0719cec6ace3eea10d" category="paragraph"><block ref="e1c1974d031eaf0719cec6ace3eea10d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="807d7f5e50a9f6922b56d8d961f2dda6" category="paragraph"><block ref="807d7f5e50a9f6922b56d8d961f2dda6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e847c644316c370dfd813e219de5d11d" category="paragraph"><block ref="e847c644316c370dfd813e219de5d11d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="817002b2c8fa8c5a6546fb55840f6b34" category="paragraph"><block ref="817002b2c8fa8c5a6546fb55840f6b34" category="inline-image-macro-rx" type="image"></block></block>
  <block id="01182ea8b83ed9f7eb8a36a89e5a1026" category="paragraph"><block ref="01182ea8b83ed9f7eb8a36a89e5a1026" category="inline-image-macro-rx" type="image"></block></block>
  <block id="23418f52a3a6930931815e387ff025fe" category="paragraph"><block ref="23418f52a3a6930931815e387ff025fe" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8a0d8a27f6742187cd8f99299d70e021" category="paragraph"><block ref="8a0d8a27f6742187cd8f99299d70e021" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fadcf0f76dee035327c90347953239be" category="paragraph"><block ref="fadcf0f76dee035327c90347953239be" category="inline-image-macro-rx" type="image"></block></block>
  <block id="cae956850a011894c308d0409418b30f" category="paragraph"><block ref="cae956850a011894c308d0409418b30f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7bb0dde17fbe3ab4080823274e64ab98" category="paragraph"><block ref="7bb0dde17fbe3ab4080823274e64ab98" category="inline-image-macro-rx" type="image"></block></block>
  <block id="302cc5fdbbdeea7eb9611dda9151b197" category="paragraph"><block ref="302cc5fdbbdeea7eb9611dda9151b197" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f6a0665230e1e72e8aed753e6363e901" category="paragraph"><block ref="f6a0665230e1e72e8aed753e6363e901" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e90a7bd2cc19c236b6114c186643dd93" category="paragraph"><block ref="e90a7bd2cc19c236b6114c186643dd93" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3fb66457e92819a1f279716b95613a23" category="paragraph"><block ref="3fb66457e92819a1f279716b95613a23" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7253509f805066b30ccf8aed6ffd413c" category="paragraph"><block ref="7253509f805066b30ccf8aed6ffd413c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="49556731c4ef8b16ff1d4cf83bab41aa" category="paragraph"><block ref="49556731c4ef8b16ff1d4cf83bab41aa" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dad5a2a61738b4f53ce8ea3e45c16107" category="paragraph"><block ref="dad5a2a61738b4f53ce8ea3e45c16107" category="inline-image-macro-rx" type="image"></block></block>
  <block id="823fb6ab3b8e68a12ff217e49415622a" category="paragraph"><block ref="823fb6ab3b8e68a12ff217e49415622a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7c02071adedf3bbf5aac4d094485fd3e" category="paragraph"><block ref="7c02071adedf3bbf5aac4d094485fd3e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="12c70128b1bbdaa03a9899f8d26be08e" category="paragraph"><block ref="12c70128b1bbdaa03a9899f8d26be08e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="589b851f407d78c290592aacc331a232" category="paragraph"><block ref="589b851f407d78c290592aacc331a232" category="inline-image-macro-rx" type="image"></block></block>
  <block id="35c46d1308ad1dcdfdb1cdc8aa5c6bb3" category="paragraph"><block ref="35c46d1308ad1dcdfdb1cdc8aa5c6bb3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3bcc285c555f1a917d23761e04d98e2c" category="paragraph"><block ref="3bcc285c555f1a917d23761e04d98e2c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="adf2d4c62bc39518d50fe4a1329307e4" category="paragraph">版本历史记录：</block>
  <block id="b6dd7e76887eb00cfd6d1dfadf3e9af4" category="paragraph">Bernd Herth ， Tobias Brandl ， Nil Bauser ， NetApp Will Bratton ， Geert Van Teylingen ， Microsoft</block>
  <block id="a18f633370bb64e078d12a48f11cbae1" category="paragraph"><block ref="a18f633370bb64e078d12a48f11cbae1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="28682dfe19b53338674ca2d24021bf06" category="paragraph"><block ref="28682dfe19b53338674ca2d24021bf06" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8240368381d84a1673985aea9400d105" category="paragraph"><block ref="8240368381d84a1673985aea9400d105" category="inline-image-macro-rx" type="image"></block></block>
  <block id="61ad85d9e6c0ed3d8e1d56df415ecb87" category="paragraph"><block ref="61ad85d9e6c0ed3d8e1d56df415ecb87" category="inline-image-macro-rx" type="image"></block></block>
  <block id="88ddebca33313b9dadb1612d8450743c" category="paragraph"><block ref="88ddebca33313b9dadb1612d8450743c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="19ab93657e4a9bc1330618ad5896efa9" category="paragraph"><block ref="19ab93657e4a9bc1330618ad5896efa9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="55d5dfa50d04891918fe3ea9ad00059b" category="paragraph"><block ref="55d5dfa50d04891918fe3ea9ad00059b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="762fea8d2405197b39e9cd41b76d320c" category="paragraph"><block ref="762fea8d2405197b39e9cd41b76d320c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e6aabe615d4f04cff649751db99a960f" category="paragraph">本文档讨论NetApp FAS系统和NFS的基础架构设置和配置。</block>
  <block id="43eddd188c3e76947dbca863365a0183" category="paragraph"><block ref="43eddd188c3e76947dbca863365a0183" category="inline-image-macro-rx" type="image"></block></block>
  <block id="47fe5a641384ba3150a9df792aafd860" category="paragraph"><block ref="47fe5a641384ba3150a9df792aafd860" category="inline-image-macro-rx" type="image"></block></block>
  <block id="399433f50673d4d62275116d60f7bb80" category="paragraph"><block ref="399433f50673d4d62275116d60f7bb80" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b7be9b3ca8485885afa5f9250455d21d" category="paragraph"><block ref="b7be9b3ca8485885afa5f9250455d21d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0937ed7cc435379f8de3fc08658990ba" category="paragraph"><block ref="0937ed7cc435379f8de3fc08658990ba" category="inline-image-macro-rx" type="image"></block></block>
  <block id="60b486631d0e94399c0d3352ca21fa00" category="paragraph"><block ref="60b486631d0e94399c0d3352ca21fa00" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0295da9e9d8f6cc887cd3e6b7b62db45" category="paragraph"><block ref="0295da9e9d8f6cc887cd3e6b7b62db45" category="inline-image-macro-rx" type="image"></block></block>
  <block id="708ee2701a62d0193a0d448abd2836fb" category="paragraph"><block ref="708ee2701a62d0193a0d448abd2836fb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3da12c4b1c08f1968a473684382e3818" category="paragraph"><block ref="3da12c4b1c08f1968a473684382e3818" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9056e1d7d0f2fbe50281478aa271e1f6" category="paragraph"><block ref="9056e1d7d0f2fbe50281478aa271e1f6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="859c9b7b61e8fbf58a5ec7d140af17d5" category="paragraph"><block ref="859c9b7b61e8fbf58a5ec7d140af17d5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1645b6f0a7adb1dc7df46dc7fec9625a" category="paragraph">IBM 公司 NetApp Carsten Dieterle 的托比亚斯 · 布兰特</block>
  <block id="b3ed4b37e21fee2e164f97668ea1afae" category="paragraph">NetApp Erik Rieger ， Bhumik Patel ， VMware</block>
  <block id="07397aed3c54bc123c1ac9d7e62210bb" category="paragraph"><block ref="07397aed3c54bc123c1ac9d7e62210bb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="56feb2a3bde8bfd9fd5f4d856110111a" category="paragraph"><block ref="56feb2a3bde8bfd9fd5f4d856110111a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="114aa3b87567a503a34d94f9c3271f76" category="paragraph"><block ref="114aa3b87567a503a34d94f9c3271f76" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9d449c98e7d5cb84b96d8125d9b4f912" category="paragraph"><block ref="9d449c98e7d5cb84b96d8125d9b4f912" category="inline-image-macro-rx" type="image"></block></block>
  <block id="884c54810f47177e088c6210909f9a82" category="paragraph"><block ref="884c54810f47177e088c6210909f9a82" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ff1ff7796487085544033f19362a1d77" category="paragraph"><block ref="ff1ff7796487085544033f19362a1d77" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d8e5cd74c27d4d7983b9d2c8bdeca1a1" category="paragraph"><block ref="d8e5cd74c27d4d7983b9d2c8bdeca1a1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b7842d6a27abd5170ad4d41cb2353297" category="paragraph">本文档讨论NetApp AFF系统和光纤通道的基础架构设置和配置。</block>
  <block id="265ae4ad07ae6dd3140cd976e6e96a15" category="paragraph"><block ref="265ae4ad07ae6dd3140cd976e6e96a15" category="inline-image-macro-rx" type="image"></block></block>
  <block id="df25c29fe304d621328adc844c5cd0b3" category="paragraph">可以通过多种方法将存储连接到虚拟机（ VM ）。首选方法是，将具有 NFS 的存储卷直接从子操作系统中连接起来。<block ref="f5dc5aad2d2f4cc08999d09836f8c4b2" category="inline-link-macro-rx"></block>有关此选项的说明，请参见。</block>
  <block id="d15ad4b07c5673286f82b8c9b4fccc92" category="inline-xref">卷、并将LUN映射到启动程序组</block>
  <block id="1b04aaa74da094dd7c2677d2996e8bc4" category="list-text">在聚合中创建启动程序组、卷和LUN、如创建""中所述<block ref="c8187094a239e1291b967555c8a5ba6c" category="inline-xref-macro-rx"></block>。</block>
  <block id="017e522349a0ff07067400d6b880e9df" category="paragraph">=:hard休息:::noofootter::ICONES: font :linkattrs::imagesdir:../media/</block>
  <block id="2267b0943e951c31d5f31c288b6bfbe6" category="paragraph">基于采用NFS协议的NetApp AFF的SAP HANA。</block>
  <block id="a0988dbd97f9cd1d119f39a16c3e8fe2" category="paragraph"><block ref="a0988dbd97f9cd1d119f39a16c3e8fe2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="168753ba1c857224e6d2c4d6e7832d22" category="paragraph"><block ref="168753ba1c857224e6d2c4d6e7832d22" category="inline-image-macro-rx" type="image"></block></block>
  <block id="80d1a2a3304ad91fb33c08a071649f65" category="paragraph"><block ref="80d1a2a3304ad91fb33c08a071649f65" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b9dfea2f38da456216fb821bdace0099" category="paragraph"><block ref="b9dfea2f38da456216fb821bdace0099" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1061c8a586da3d6a249f18df930dc33a" category="paragraph">本文档讨论NetApp AFF系统和NFS的基础架构设置和配置。</block>
  <block id="c0c285f4d23d22653eba8dc9a75078b0" category="paragraph"><block ref="c0c285f4d23d22653eba8dc9a75078b0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5238942ad77c3b1f94a61d3640c23e97" category="paragraph"><block ref="5238942ad77c3b1f94a61d3640c23e97" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bc6f4f64c41295649568c9b08222f2c3" category="paragraph"><block ref="bc6f4f64c41295649568c9b08222f2c3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c55f68c7fa3064bc905d3ae3a6a0a59d" category="list-text">在聚合中创建卷、如"和"<block ref="886d8674ea6944dd32bd390cb48bc80e" category="inline-xref-macro-rx"></block>中所述<block ref="7f2f76d537cb5c15ae301f069af9489f" category="inline-xref-macro-rx"></block>。</block>
  <block id="0f067126ab39c0af9790685c5bc83bf3" category="paragraph"><block ref="0f067126ab39c0af9790685c5bc83bf3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b726daf8a2adf210c59b7ef834090339" category="paragraph"><block ref="b726daf8a2adf210c59b7ef834090339" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c8ad86db51ea3fec014b3b92b80c4f2e" category="paragraph"><block ref="c8ad86db51ea3fec014b3b92b80c4f2e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="11d1bfe72e7d4b529d02954640fd4149" category="paragraph"><block ref="11d1bfe72e7d4b529d02954640fd4149" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6230407404042e9d526a4955f60f283b" category="paragraph"><block ref="6230407404042e9d526a4955f60f283b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d64ce1ec53ddbb70221c0732f05697a6" category="paragraph"><block ref="d64ce1ec53ddbb70221c0732f05697a6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c0561b288a8933b1a53451f7c71e958e" category="paragraph"><block ref="c0561b288a8933b1a53451f7c71e958e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c1d3336a3b90b25bb5842d360b2e1b47" category="list-text"><block ref="c1d3336a3b90b25bb5842d360b2e1b47" category="inline-link-macro-rx"></block></block>
  <block id="16e4c7c1b782ca8c1d599ae8962ef280" category="list-text"><block ref="16e4c7c1b782ca8c1d599ae8962ef280" category="inline-link-macro-rx"></block></block>
  <block id="7f090e151321d629b7467e11a649d3ef" category="list-text"><block ref="7f090e151321d629b7467e11a649d3ef" category="inline-link-macro-rx"></block></block>
  <block id="57f3c3545cf78dda99e9898c26f43005" category="paragraph"><block ref="57f3c3545cf78dda99e9898c26f43005" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1deb57201efcb61a71ad406c8fc5c40a" category="paragraph">可通过多种方法将存储连接到虚拟机（ VM ）。首选方法是，将具有 NFS 的存储卷直接从子操作系统中连接起来。<block ref="7f090e151321d629b7467e11a649d3ef" category="inline-link-macro-rx"></block>有关此选项的说明，请参见。</block>
  <block id="87c981e26acc223a7d0dba3d39b42d11" category="paragraph"><block ref="87c981e26acc223a7d0dba3d39b42d11" category="inline-image-macro-rx" type="image"></block></block>
  <block id="286a02ac976f208a41714fb1b31d5563" category="paragraph"><block ref="286a02ac976f208a41714fb1b31d5563" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f354441147ead38889b9adc2d2ebc209" category="paragraph"><block ref="f354441147ead38889b9adc2d2ebc209" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3b3a2ed3db2363af1fc4a4d9670fd4f1" category="paragraph"><block ref="3b3a2ed3db2363af1fc4a4d9670fd4f1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="17170cd9736b0e2a3d8f78d16953b327" category="paragraph"><block ref="17170cd9736b0e2a3d8f78d16953b327" category="inline-image-macro-rx" type="image"></block></block>
  <block id="09f7121854e4295fd6f96bdc2d4acb8c" category="paragraph"><block ref="09f7121854e4295fd6f96bdc2d4acb8c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9a54eb14eb1b0ca1cf8ecb90dd6622cf" category="paragraph"><block ref="9a54eb14eb1b0ca1cf8ecb90dd6622cf" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b1c9f17a28c7142387820fd5a82c9b6e" category="paragraph"><block ref="b1c9f17a28c7142387820fd5a82c9b6e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="333255d2c26de498b8eb10dcfa6381fb" category="paragraph"><block ref="333255d2c26de498b8eb10dcfa6381fb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0f4ac82fd0de794eae50e4e7545b6b84" category="paragraph"><block ref="0f4ac82fd0de794eae50e4e7545b6b84" category="inline-image-macro-rx" type="image"></block></block>
  <block id="90b7952d58371e6e80dd8de6a3fdfbe3" category="paragraph"><block ref="90b7952d58371e6e80dd8de6a3fdfbe3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2822f342ff1cb87976a56cf25e779720" category="paragraph"><block ref="2822f342ff1cb87976a56cf25e779720" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3a407eeb3893336fec56bf117effa682" category="paragraph"><block ref="3a407eeb3893336fec56bf117effa682" category="inline-image-macro-rx" type="image"></block></block>
  <block id="19cc205454278321478fd56e121c7e64" category="paragraph"><block ref="19cc205454278321478fd56e121c7e64" category="inline-image-macro-rx" type="image"></block></block>
  <block id="134e0717b473bfec3645ee01fc4a8ac8" category="paragraph"><block ref="134e0717b473bfec3645ee01fc4a8ac8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="acf62ff4ff0cbb8add92380207b42eab" category="paragraph"><block ref="acf62ff4ff0cbb8add92380207b42eab" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a288ecd6c12c39c5e25b0ff9e03d9781" category="paragraph"><block ref="a288ecd6c12c39c5e25b0ff9e03d9781" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9aa9c82f479fb021778c193743374792" category="paragraph"><block ref="9aa9c82f479fb021778c193743374792" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4895fae809dc9415884ff295e6dc343c" category="paragraph"><block ref="4895fae809dc9415884ff295e6dc343c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="82020173d38ee27d458fbdf847bfc42e" category="paragraph"><block ref="82020173d38ee27d458fbdf847bfc42e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1b937a8a58ab58bc1c61e59ac1b52925" category="paragraph"><block ref="1b937a8a58ab58bc1c61e59ac1b52925" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3f8fbc4328976ab1bb4502f3763520b2" category="paragraph"><block ref="3f8fbc4328976ab1bb4502f3763520b2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="942f47e7ef3ead6cb8f92c69276f36c3" category="paragraph"><block ref="942f47e7ef3ead6cb8f92c69276f36c3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a58f060b570a241814715299c91f3fad" category="inline-image-macro">此图显示了羊驼服务器、NetApp SnapCenter服务器、NetApp存储系统、SAP源系统和SAP目标系统、以及所有内容的集成方式</block>
  <block id="f4ca65fb5c61e96bb0d6eed9c0ca8715" category="paragraph"><block ref="f4ca65fb5c61e96bb0d6eed9c0ca8715" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4c6eb0132e4ccfcc9ed228d27e5cfc29" category="paragraph"><block ref="4c6eb0132e4ccfcc9ed228d27e5cfc29" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fb37eef62a9f3eb5c99bffedd0024c1f" category="paragraph"><block ref="fb37eef62a9f3eb5c99bffedd0024c1f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6393f88818ef94108486ce2601a4732e" category="paragraph"><block ref="6393f88818ef94108486ce2601a4732e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1036db93beffe95b80fff8d0ba735af9" category="paragraph"><block ref="1036db93beffe95b80fff8d0ba735af9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f6482dcb2b1a382097c11d3774a029ac" category="inline-image-macro">显示Avantra服务器、NetApp SnapCenter服务器、NetApp存储系统、SAP源系统和SAP目标系统以及一切集成方式的图像</block>
  <block id="32f81f33d6e774f336864df9e87bc44f" category="paragraph"><block ref="32f81f33d6e774f336864df9e87bc44f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4c7048f952442b8f6d998ab516777056" category="paragraph"><block ref="4c7048f952442b8f6d998ab516777056" category="inline-image-macro-rx" type="image"></block></block>
  <block id="26fa64ddac14c561cb8700ddd04d2768" category="paragraph"><block ref="26fa64ddac14c561cb8700ddd04d2768" category="inline-image-macro-rx" type="image"></block></block>
  <block id="209692e856fceee655a52e1abaa65592" category="paragraph"><block ref="209692e856fceee655a52e1abaa65592" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e9bcb357a56a02c9bd8533df7d0dd0ca" category="paragraph"><block ref="e9bcb357a56a02c9bd8533df7d0dd0ca" category="inline-image-macro-rx" type="image"></block></block>
  <block id="52009bb7ee17227f566cd26a02caee56" category="inline-link-macro"><block ref="52009bb7ee17227f566cd26a02caee56" category="inline-link-rx"></block></block>
  <block id="a1a9afcf552a769c282769271829889a" category="paragraph"><block ref="a1a9afcf552a769c282769271829889a" category="inline-link-macro-rx"></block></block>
  <block id="f99aa604031e5049799e73b5c3748a98" category="inline-link-macro"><block ref="f99aa604031e5049799e73b5c3748a98" category="inline-link-rx"></block></block>
  <block id="5d545fe5152641e2ebe654e336e520e5" category="paragraph"><block ref="5d545fe5152641e2ebe654e336e520e5" category="inline-link-macro-rx"></block></block>
  <block id="88e5eabd3917048b6927c42496b98f86" category="inline-link-macro"><block ref="88e5eabd3917048b6927c42496b98f86" category="inline-link-rx"></block></block>
  <block id="dd38f906b37d412de7d1c1dcf4cbf31c" category="paragraph"><block ref="dd38f906b37d412de7d1c1dcf4cbf31c" category="inline-link-macro-rx"></block></block>
  <block id="8acb58cbd50ef1b468a020ee0bd351d3" category="inline-link-macro"><block ref="8acb58cbd50ef1b468a020ee0bd351d3" category="inline-link-rx"></block></block>
  <block id="2352c4e1f4d0024ade0869e00e6243f4" category="paragraph"><block ref="2352c4e1f4d0024ade0869e00e6243f4" category="inline-link-macro-rx"></block></block>
  <block id="723f124924d36131e143a569b9d5e681" category="paragraph">此主机上也安装了SAP主机代理。NetApp提供程序脚本和Ans得 游戏手册已在Ans得 控制节点上配置、如中所述<block ref="de749663bfaee1352d55d95bd90d80fa" category="inline-link-macro-rx"></block></block>
  <block id="d0f0f43af738b26d182641cb7c12254e" category="paragraph"><block ref="d0f0f43af738b26d182641cb7c12254e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="08c5b98069920bf5ac7b4961005b5056" category="paragraph"><block ref="08c5b98069920bf5ac7b4961005b5056" category="inline-image-macro-rx" type="image"></block></block>
  <block id="54c6354a212b8f91f2ff043d95c8a94e" category="paragraph"><block ref="54c6354a212b8f91f2ff043d95c8a94e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="70f474aab1616506d03d24a8657ae910" category="paragraph"><block ref="70f474aab1616506d03d24a8657ae910" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7f23aeaaf119e1c77839ccb7a26f572a" category="paragraph"><block ref="7f23aeaaf119e1c77839ccb7a26f572a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="18ed31da1adaccc57dd6543fc9b26c8f" category="paragraph"><block ref="18ed31da1adaccc57dd6543fc9b26c8f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="baaa9a167a827541388c50135103e4fd" category="paragraph"><block ref="baaa9a167a827541388c50135103e4fd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f2e7523bdd169ca65eca0147bca8fff1" category="inline-image-macro">"Delete NetAppClone General "屏幕的屏幕截图、其中突出显示了"Use Mount Data XML yes "。</block>
  <block id="8a8dd4fc02cb2cf28f0b93868a12473e" category="paragraph"><block ref="8a8dd4fc02cb2cf28f0b93868a12473e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d574b7c12d0ffbf3da10d882088b0cef" category="paragraph"><block ref="d574b7c12d0ffbf3da10d882088b0cef" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0f9f630eca85dbbe04a442a7a696930c" category="inline-image-macro">"SAP Laama Configuration &amp;gt；Systems&amp;gt；System Details"屏幕的屏幕截图。"使用自定义配置过程"复选框将突出显示。</block>
  <block id="032c2a456234741b329b07d476cc4d1a" category="paragraph"><block ref="875d532bdc997e1002f70ac7b667645e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="254514cf830e6feaf160e3ec53e3f18f" category="paragraph">作者：Michael Schlerser、Nils Bauer、NetApp</block>
  <block id="e066a9a52290d370f53ecf456c5be0f4" category="paragraph"><block ref="e066a9a52290d370f53ecf456c5be0f4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2c49f1c2b6cf2a413b781562e94f51c9" category="paragraph"><block ref="2c49f1c2b6cf2a413b781562e94f51c9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="be134f57e81ec33622cfc4840b1b0b96" category="paragraph"><block ref="be134f57e81ec33622cfc4840b1b0b96" category="inline-image-macro-rx" type="image"></block></block>
  <block id="22dd11876567037f3dce168aca90a55d" category="inline-image-macro">此屏幕截图显示了打开的SAP Laama图形用户界面、此图形用户界面可用于打开"系统&amp;gt；配置系统"视图、您可以使用此视图打开"销毁系统"下拉列表。</block>
  <block id="c29f9ca5d936c517167eb4d17112544a" category="paragraph"><block ref="cd60d04f86fbd91a9f493108cae035e8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="80e4ac8363c4bb43c3e0be2319263403" category="paragraph"><block ref="80e4ac8363c4bb43c3e0be2319263403" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ed02cb72288b1d82c109e6809814b6d8" category="paragraph"><block ref="ed02cb72288b1d82c109e6809814b6d8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c9e5185c4873df6611b8dfbcf745108e" category="paragraph"><block ref="c9e5185c4873df6611b8dfbcf745108e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="665bbfd6b563f38b5fe08024fd11bd2a" category="paragraph"><block ref="665bbfd6b563f38b5fe08024fd11bd2a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9337347d6d92fec3b5156bcc5bb61fdb" category="paragraph"><block ref="9337347d6d92fec3b5156bcc5bb61fdb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="43c1e12c4de1117893166b4d61a58800" category="paragraph"><block ref="43c1e12c4de1117893166b4d61a58800" category="inline-image-macro-rx" type="image"></block></block>
  <block id="11be0398e50f67b0d6de3c0d5065d86d" category="paragraph"><block ref="11be0398e50f67b0d6de3c0d5065d86d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="92e855188fcadbee0c81d0aef8797e36" category="paragraph"><block ref="92e855188fcadbee0c81d0aef8797e36" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5d15a1dd9a1e0efc6857b74627bf9a71" category="paragraph"><block ref="5d15a1dd9a1e0efc6857b74627bf9a71" category="inline-image-macro-rx" type="image"></block></block>
  <block id="942813ee3bf3e2e859a1cad799510176" category="paragraph"><block ref="942813ee3bf3e2e859a1cad799510176" category="inline-image-macro-rx" type="image"></block></block>
  <block id="47a8e72c82c913fb5ec4254dfdc296d9" category="paragraph"><block ref="47a8e72c82c913fb5ec4254dfdc296d9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d2131ff1c4a2e5d26bf0b2cb33f5c8eb" category="paragraph"><block ref="d2131ff1c4a2e5d26bf0b2cb33f5c8eb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="78a4d37e4d6724327721d85ef21012d9" category="paragraph"><block ref="78a4d37e4d6724327721d85ef21012d9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9326b2ac6972353a648e8ebac728915c" category="paragraph"><block ref="9326b2ac6972353a648e8ebac728915c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1d8e554fbc28ed599fa3b330903e7d0b" category="paragraph"><block ref="1d8e554fbc28ed599fa3b330903e7d0b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7a46bc035ec735ffe93788d32e556ee4" category="paragraph"><block ref="7a46bc035ec735ffe93788d32e556ee4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a118fa5c9c9accd7643ffad4342eaf35" category="paragraph"><block ref="a118fa5c9c9accd7643ffad4342eaf35" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6721ceca95a36e6e11baced7869c395e" category="paragraph"><block ref="6721ceca95a36e6e11baced7869c395e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="55ca9b09ad1ce9c38941c90c88767f7e" category="paragraph"><block ref="55ca9b09ad1ce9c38941c90c88767f7e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="441425b2f5b62ff29a43ee5c4a2ca207" category="paragraph"><block ref="441425b2f5b62ff29a43ee5c4a2ca207" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1fd4abb2e9e4644dca0b00cc5564ae7d" category="paragraph"><block ref="1fd4abb2e9e4644dca0b00cc5564ae7d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0ee7ebf271ff2743b8f544bbfeb81691" category="paragraph"><block ref="0ee7ebf271ff2743b8f544bbfeb81691" category="inline-image-macro-rx" type="image"></block></block>
  <block id="675714232d181513a4eeff22a3b0db21" category="paragraph"><block ref="675714232d181513a4eeff22a3b0db21" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0e5538f491798b42e37ed0f1c413963d" category="paragraph"><block ref="0e5538f491798b42e37ed0f1c413963d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fd186e381af91342321d2f87740110a9" category="paragraph"><block ref="fd186e381af91342321d2f87740110a9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d6c61f59b9d13174e1e29f1881cb383a" category="paragraph"><block ref="d6c61f59b9d13174e1e29f1881cb383a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7413e2537a132edd12589463531e2bcd" category="paragraph"><block ref="7413e2537a132edd12589463531e2bcd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3692e43b127e4974805821bedcf7b7af" category="paragraph"><block ref="3692e43b127e4974805821bedcf7b7af" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ea9e8adaeb644dd10fe0cff853bb61c9" category="paragraph"><block ref="ea9e8adaeb644dd10fe0cff853bb61c9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9c922d24ae362be7b4b207796c78fc80" category="paragraph"><block ref="9c922d24ae362be7b4b207796c78fc80" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f66bd4318b3bbbdefc2a05b723e920b8" category="paragraph"><block ref="f66bd4318b3bbbdefc2a05b723e920b8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6940d83e659b53fe2828f35b5691fab4" category="paragraph"><block ref="6940d83e659b53fe2828f35b5691fab4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dfbc93639d1067b24f414457d7eb84e4" category="paragraph"><block ref="dfbc93639d1067b24f414457d7eb84e4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="50e1d44f2792b680cc4c690f57736241" category="paragraph"><block ref="50e1d44f2792b680cc4c690f57736241" category="inline-image-macro-rx" type="image"></block></block>
  <block id="27a88cfd40f9f876e71c77f4b3ebce5b" category="paragraph"><block ref="27a88cfd40f9f876e71c77f4b3ebce5b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a0519aa55a3128b6d977868b191a4c9b" category="paragraph"><block ref="a0519aa55a3128b6d977868b191a4c9b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0fd3fed7a6654b610a5215582f3890df" category="paragraph"><block ref="0fd3fed7a6654b610a5215582f3890df" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8dda9dbd415a90ebdecd67562ff62647" category="paragraph"><block ref="8dda9dbd415a90ebdecd67562ff62647" category="inline-image-macro-rx" type="image"></block></block>
  <block id="49af0825272af5b55efb29d6e627295a" category="paragraph"><block ref="49af0825272af5b55efb29d6e627295a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4e06893830d915ce3e5944cc4a806a70" category="paragraph"><block ref="4e06893830d915ce3e5944cc4a806a70" category="inline-image-macro-rx" type="image"></block></block>
  <block id="814ac3ceb59872d05a2261dbcb6762c4" category="paragraph"><block ref="814ac3ceb59872d05a2261dbcb6762c4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a252d2b5bd54720415ff0f1bbcd3bfe5" category="paragraph"><block ref="a252d2b5bd54720415ff0f1bbcd3bfe5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="91cda59c1c41ab362256a803dd6e9aaa" category="paragraph"><block ref="91cda59c1c41ab362256a803dd6e9aaa" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ea03a38ab10e6dd8a884dadd6c248ff3" category="paragraph"><block ref="ea03a38ab10e6dd8a884dadd6c248ff3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f5d16c8339f5fcab67de96988b089d35" category="paragraph"><block ref="f5d16c8339f5fcab67de96988b089d35" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c30622a0d9b9e9fc1d3b481798046eab" category="paragraph"><block ref="c30622a0d9b9e9fc1d3b481798046eab" category="inline-image-macro-rx" type="image"></block></block>
  <block id="dde08e4dbd65e38cf8c94344865319a6" category="paragraph"><block ref="dde08e4dbd65e38cf8c94344865319a6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b9ef63850cdae5713442b73fea24f7ca" category="paragraph"><block ref="b9ef63850cdae5713442b73fea24f7ca" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6b83a2067fb9cb4aebab3a7c52c0b117" category="paragraph"><block ref="6b83a2067fb9cb4aebab3a7c52c0b117" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6c031517806d421df56e91fae6d41fcc" category="paragraph"><block ref="6c031517806d421df56e91fae6d41fcc" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2899de25ac95c30065654b9bca3dd63e" category="paragraph"><block ref="2899de25ac95c30065654b9bca3dd63e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1e4b9e5ed61db78e751ef2010c05eef2" category="paragraph"><block ref="1e4b9e5ed61db78e751ef2010c05eef2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3e381d90e52cc57b4182f2b25b231bb0" category="paragraph"><block ref="3e381d90e52cc57b4182f2b25b231bb0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="16a90d82d3a5e8f44b521e3bcd30b920" category="paragraph"><block ref="16a90d82d3a5e8f44b521e3bcd30b920" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5aba32e6cc2e39cf2467043718262695" category="paragraph"><block ref="5aba32e6cc2e39cf2467043718262695" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6e7a877dc2387d8faa54362255e76495" category="paragraph"><block ref="6e7a877dc2387d8faa54362255e76495" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6e18efc193d0f3a7f6848d6be60867b3" category="paragraph"><block ref="6e18efc193d0f3a7f6848d6be60867b3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a199e55ed8eb37606428746d6f10d147" category="paragraph"><block ref="a199e55ed8eb37606428746d6f10d147" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e4d4a0dc2ca0c2797ae8ae1ea2a1b82c" category="paragraph"><block ref="e4d4a0dc2ca0c2797ae8ae1ea2a1b82c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="678bcd2f08c5337d0222e9bfde1b5844" category="paragraph"><block ref="678bcd2f08c5337d0222e9bfde1b5844" category="inline-image-macro-rx" type="image"></block></block>
  <block id="605799b9f9a950727f602913d090cd4f" category="paragraph"><block ref="605799b9f9a950727f602913d090cd4f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ec235bf2d8184a1756901c3c16298822" category="paragraph"><block ref="ec235bf2d8184a1756901c3c16298822" category="inline-image-macro-rx" type="image"></block></block>
  <block id="41468c4909b503f2f8450403348438d1" category="paragraph"><block ref="41468c4909b503f2f8450403348438d1" category="inline-image-macro-rx" type="image"></block></block>
  <block id="58ab23d5a0e0f21a7077556a4a2aeccb" category="paragraph">我们首先定义了LSC中涉及的所有系统、如下图所示：</block>
  <block id="5fdad469293cb215921d36afbda617a9" category="paragraph"><block ref="5fdad469293cb215921d36afbda617a9" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c3b8765a4980907a8866739e8902f29d" category="paragraph"><block ref="c3b8765a4980907a8866739e8902f29d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a1c34f80a501b5f0967b004c78c0ff8e" category="paragraph"><block ref="a1c34f80a501b5f0967b004c78c0ff8e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f327d46bfc411de47abf4b30419f2e71" category="paragraph"><block ref="f327d46bfc411de47abf4b30419f2e71" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5cbbd62b6aa5194964f15bc6eb899167" category="paragraph"><block ref="5cbbd62b6aa5194964f15bc6eb899167" category="inline-image-macro-rx" type="image"></block></block>
  <block id="21eac00966acf4b2a72bf91167f30ebf" category="paragraph"><block ref="21eac00966acf4b2a72bf91167f30ebf" category="inline-image-macro-rx" type="image"></block></block>
  <block id="47a802a2fc87ab9dc509a5196ce212ed" category="paragraph"><block ref="47a802a2fc87ab9dc509a5196ce212ed" category="inline-image-macro-rx" type="image"></block></block>
  <block id="331bcc5b2de814edbfdb7a4ed55aca83" category="paragraph"><block ref="331bcc5b2de814edbfdb7a4ed55aca83" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e025797ef76ec523c2fbdc913acd1b8d" category="paragraph"><block ref="e025797ef76ec523c2fbdc913acd1b8d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6d33e0da817a0c4581511187861113a2" category="paragraph"><block ref="6d33e0da817a0c4581511187861113a2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ac934736a221fb880f1f184f450b3b84" category="paragraph"><block ref="ac934736a221fb880f1f184f450b3b84" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d9ab7555999c5d8ff45ee59f2901274e" category="paragraph"><block ref="d9ab7555999c5d8ff45ee59f2901274e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8e4eb73ef43a1f9303efb9aacfa9fb54" category="paragraph"><block ref="8e4eb73ef43a1f9303efb9aacfa9fb54" category="inline-image-macro-rx" type="image"></block></block>
  <block id="fa50f5934ab4a86ba7d21d9282a4ae83" category="paragraph"><block ref="fa50f5934ab4a86ba7d21d9282a4ae83" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c7015b3891214599aa77ef61934d48e7" category="paragraph"><block ref="c7015b3891214599aa77ef61934d48e7" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1481209059a8c176a74f364ded8717f3" category="paragraph"><block ref="1481209059a8c176a74f364ded8717f3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="431660b7246559c07729890a342868c6" category="paragraph"><block ref="431660b7246559c07729890a342868c6" category="inline-image-macro-rx" type="image"></block></block>
  <block id="eac376c625b17cbfe1ce4dc53801ef84" category="paragraph"><block ref="eac376c625b17cbfe1ce4dc53801ef84" category="inline-image-macro-rx" type="image"></block></block>
  <block id="479c484cab176977b9085c7442252d55" category="paragraph"><block ref="479c484cab176977b9085c7442252d55" category="inline-image-macro-rx" type="image"></block></block>
  <block id="354953ecdb34e2ea0a14730090c02b5d" category="paragraph"><block ref="354953ecdb34e2ea0a14730090c02b5d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="174ef09bcd66f149e8f3d48b9c27d084" category="paragraph"><block ref="174ef09bcd66f149e8f3d48b9c27d084" category="inline-image-macro-rx" type="image"></block></block>
  <block id="33d725d287734490bd3cf2cbc2610e77" category="paragraph"><block ref="33d725d287734490bd3cf2cbc2610e77" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a52149656c8f2abac5c009c9b7bd0e3a" category="paragraph"><block ref="a52149656c8f2abac5c009c9b7bd0e3a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="01f138b89b76c271eaaf0dbe6b566876" category="paragraph"><block ref="01f138b89b76c271eaaf0dbe6b566876" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3c4df2993c5eadacc25e3c3baae96002" category="paragraph"><block ref="3c4df2993c5eadacc25e3c3baae96002" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8e23696742acf0fa9bb7c2286b3e5f59" category="paragraph"><block ref="8e23696742acf0fa9bb7c2286b3e5f59" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c243eb4e919916e473a72dccd4fbfe1b" category="paragraph"><block ref="c243eb4e919916e473a72dccd4fbfe1b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8fd04f11688ea4f9308b54658b7dd1b2" category="paragraph"><block ref="8fd04f11688ea4f9308b54658b7dd1b2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="9f261b42439047d072eb3c7e9b4b87db" category="paragraph"><block ref="9f261b42439047d072eb3c7e9b4b87db" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7c607c15b167925298ee59c7b9b536a2" category="paragraph"><block ref="7c607c15b167925298ee59c7b9b536a2" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e8c94f21bb3442dbbfc3e795c932d333" category="paragraph"><block ref="e8c94f21bb3442dbbfc3e795c932d333" category="inline-image-macro-rx" type="image"></block></block>
  <block id="b611762afdd13630ec29f6cdb763085a" category="paragraph"><block ref="b611762afdd13630ec29f6cdb763085a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="52846a5050d653763f3cd3243f72d0a4" category="paragraph"><block ref="52846a5050d653763f3cd3243f72d0a4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="e9b147ad6cc71607ab8a105a00546bdb" category="paragraph"><block ref="e9b147ad6cc71607ab8a105a00546bdb" category="inline-image-macro-rx" type="image"></block></block>
  <block id="7fbd33f7b46ab179e85bc49b99a762af" category="paragraph"><block ref="7fbd33f7b46ab179e85bc49b99a762af" category="inline-image-macro-rx" type="image"></block></block>
  <block id="319b428c387de4fee05b987babf39455" category="paragraph"><block ref="319b428c387de4fee05b987babf39455" category="inline-image-macro-rx" type="image"></block></block>
  <block id="a51a61213f6795503ed5e5f0666ed276" category="paragraph"><block ref="a51a61213f6795503ed5e5f0666ed276" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8af50f5f42c2479f67f027cb7263e038" category="paragraph"><block ref="a6b0e1abc31c1512868a62f35c9a7070" category="inline-image-macro-rx" type="image"></block> 主备份存储克隆与异地备份存储克隆之间的SAP HANA系统刷新工作流的唯一区别是在SnapCenter中选择Snapshot备份。对于异地备份存储克隆、必须先选择二级备份、然后再选择Snapshot备份。</block>
  <block id="b95eabd6551d0cecc533e863bd612859" category="paragraph"><block ref="b95eabd6551d0cecc533e863bd612859" category="inline-image-macro-rx" type="image"></block></block>
  <block id="8947252def4e010b81da6bad251c30c8" category="paragraph"><block ref="8947252def4e010b81da6bad251c30c8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="bd7e803f5ed70720d795c6e599f3b1f3" category="paragraph"><block ref="bd7e803f5ed70720d795c6e599f3b1f3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="468d6a4b81fd97dcd919ddb062cfad9b" category="paragraph"><block ref="468d6a4b81fd97dcd919ddb062cfad9b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2697c3732578c70f48d3e1413167069a" category="paragraph"><block ref="2697c3732578c70f48d3e1413167069a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="da0d785f35be51c61538b9b7ef61ec2f" category="paragraph"><block ref="da0d785f35be51c61538b9b7ef61ec2f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3295f6a56df5dfbe6d8979d65e00cda4" category="paragraph"><block ref="3295f6a56df5dfbe6d8979d65e00cda4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="748f98c77c761c744d8667ba2bfeb19d" category="paragraph"><block ref="748f98c77c761c744d8667ba2bfeb19d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="09176130239d5894263c4ed91014305a" category="paragraph"><block ref="09176130239d5894263c4ed91014305a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6f4d0149ab4a4edbbee5e661be99483a" category="paragraph"><block ref="6f4d0149ab4a4edbbee5e661be99483a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5b87f73078b80ca4368d0366f224cbef" category="paragraph"><block ref="5b87f73078b80ca4368d0366f224cbef" category="inline-image-macro-rx" type="image"></block></block>
  <block id="1f88af7db6ddf1c30d5eaf785280d094" category="paragraph"><block ref="1f88af7db6ddf1c30d5eaf785280d094" category="inline-image-macro-rx" type="image"></block></block>
  <block id="902958adb563d46c054b6534faccb079" category="paragraph"><block ref="902958adb563d46c054b6534faccb079" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2d860cf77350224351ea2dc03dff69f4" category="paragraph"><block ref="2d860cf77350224351ea2dc03dff69f4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d0f67cae2ea526980d7b8ff6fc6e6a1b" category="admonition">SAP HANA系统会使用一个卷作为<block ref="b61595b5b7b716bd6b8bd21e4fa4a3bf" prefix=" " category="inline-code"></block>和作为<block ref="332a4b8a50d2a34eacd47a3800f13b64" prefix=" " category="inline-code"></block>，并按照配置指南中的建议在子目录中分隔<block ref="b2b8b2b1fc6d62d4069546f9282a44e0" category="inline-link-macro-rx"></block>。该脚本<block ref="7475fe06dd4f4cf4edc0c5536fb55aa4" prefix=" " category="inline-code"></block> 使用一个特殊的命令行选项对挂载路径支持此配置。如果挂载路径命令行选项等于usr－sap-and-shared，则该脚本会相应地将共享的子目录和usr－sap挂载到卷中。</block>
  <block id="381b5f7026618027af2bcab45f168245" category="paragraph"><block ref="381b5f7026618027af2bcab45f168245" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5bd721f9ee4385ac6cc588d739aef8b5" category="paragraph"><block ref="5bd721f9ee4385ac6cc588d739aef8b5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4bb2c1fe93a605d54cdd64b4a9d5e008" category="paragraph"><block ref="4bb2c1fe93a605d54cdd64b4a9d5e008" category="inline-image-macro-rx" type="image"></block></block>
  <block id="310350ac09043bc6ffaddd203d00cdee" category="paragraph"><block ref="310350ac09043bc6ffaddd203d00cdee" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ae96409347532f67bebd16667d20fd2d" category="paragraph"><block ref="ae96409347532f67bebd16667d20fd2d" category="inline-image-macro-rx" type="image"></block></block>
  <block id="10c565f3aabb68bc914db1d5bbd769a5" category="paragraph"><block ref="10c565f3aabb68bc914db1d5bbd769a5" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c035e71f6f70515cd48a1af9cbd896ae" category="paragraph"><block ref="c035e71f6f70515cd48a1af9cbd896ae" category="inline-image-macro-rx" type="image"></block></block>
  <block id="3b7159fc1bb313286db7554a84bc8ebb" category="paragraph"><block ref="8308411e5b8a4f498b77fa40cd42c44e" category="inline-image-macro-rx" type="image"></block> SnapCenter克隆工作流可用于在基础架构层和数据库层加快和自动执行所需任务。SnapCenter不会将备份从源系统还原到目标系统、而是使用NetApp Snapshot副本和NetApp FlexClone技术、这样、直到启动SAP HANA数据库所需的任务都可以在几分钟内完成、而不是几小时。克隆过程所需的时间与数据库大小无关、因此即使是非常大的系统也可以在几分钟内创建完毕。启动时间仅取决于数据库大小以及数据库服务器和存储系统之间的连接。</block>
  <block id="0b756a2b837b399a76855dd2c7ad462c" category="paragraph"><block ref="0b756a2b837b399a76855dd2c7ad462c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="71363724384f11e567c31d8b03a9c2dd" category="paragraph"><block ref="71363724384f11e567c31d8b03a9c2dd" category="inline-image-macro-rx" type="image"></block></block>
  <block id="099298864cff6077c45112acbd241aa8" category="paragraph"><block ref="bac0a60e872e73e9fd7d2ef7ad8b195c" category="inline-image-macro-rx" type="image"></block> 详细的分步说明可在技术报告中找到</block>
  <block id="f40dc9037165f19e7398327fc2ea1803" category="list-text"><block ref="f40dc9037165f19e7398327fc2ea1803" category="inline-link-macro-rx"></block></block>
  <block id="d09fb591366cc5646f4cbcbad9e5d9cb" category="list-text"><block ref="d09fb591366cc5646f4cbcbad9e5d9cb" category="inline-link-macro-rx"></block></block>
  <block id="b2c04c2b30542ab2c34654ceffe46e97" category="list-text"><block ref="b2c04c2b30542ab2c34654ceffe46e97" category="inline-link-macro-rx"></block></block>
  <block id="f3ba50f9922c89d4b36c50fe66685be2" category="list-text"><block ref="f3ba50f9922c89d4b36c50fe66685be2" category="inline-link-macro-rx"></block></block>
  <block id="7ac1c0d7efdd5bfa24d4e579673e3de4" category="list-text"><block ref="7ac1c0d7efdd5bfa24d4e579673e3de4" category="inline-link-macro-rx"></block></block>
  <block id="273ade22ee82ef60099b9d4c39bb9dc0" category="list-text"><block ref="273ade22ee82ef60099b9d4c39bb9dc0" category="inline-link-macro-rx"></block></block>
  <block id="526eb260d8cd870801391fead2b6a810" category="admonition">如果将nconnect与NFSv4.x结合使用、则应根据以下规则调整NFSv4.x会话插槽的数量：会话插槽的数量等于&lt;nconnect value&gt; x 64。在主机上、此操作将经过重新启动后进行处理<block ref="1f544d9bef8ddb99793e0436d6362920" prefix=" " category="inline-code"></block>。此外、还必须调整服务器端值、并按照中所述设置会话插槽的数量<block ref="ab5c20669050c73ba24d89c4b271e9e7" category="inline-link-macro-rx"></block></block>
  <block id="d315ad62620c6c170565a626312e362d" category="cell">将NFS TCP最大传输大小设置为1MB</block>
  <block id="8a92011f99cb9f446b19032c2d76f759" category="admonition">在工作负载不同的共享环境中、将最大NFS TCP传输大小设置为262144</block>
  <block id="42a7703e0bc31f6ec72a6e40780ff36a" category="cell">更改NFSv4.x会话插槽的数量(可选)</block>
  <block id="cae93577fd94d0fe06d63305e6bfbe50" category="admonition">可以启用和使用pNFS。</block>
  <block id="924eac7fb01f1080c8a2e57261e50702" category="admonition">如果将nconnect与NFSv4.x结合使用、则应根据以下规则调整NFSv4.x会话插槽的数量：会话插槽的数量等于&lt;nconnect value&gt; x 64。在主机上、此操作将经过重新启动后进行处理<block ref="1f544d9bef8ddb99793e0436d6362920" prefix=" " category="inline-code"></block>。此外、还必须调整服务器端值、并按照中所述设置会话插槽的数量 <block ref="f5e012a6f36bf833f75aec36ff8eee0f" category="inline-link-macro-rx"></block></block>
  <block id="dface3e0fc3485feea995027b8e0fd8a" category="cell">设置 advanced nfs modify -vserver &lt;vserver_name&gt; -tcp-max-xfer-size 1048576 set admin</block>
  <block id="9adaadfddff33c2daa546229f2809747" category="list-text">使用SAP<block ref="b0aa3e7cad7b6222087aedbd4c799832" prefix=" " category="inline-code"></block>安装工具、通过在一个工作主机上运行以下命令来启动安装。使用<block ref="9676c5ff8ed94e9d3ceba55f16dde62f" prefix=" " category="inline-code"></block>选项添加第二个工作<block ref="d6075976fde6718b25d21e4894d5d07d" prefix="(" category="inline-code"></block>台()和备用主机<block ref="7e4282317c0dcc7ce1f24f047b09f466" prefix="(" category="inline-code"></block>()。</block>
  <block id="dc6dd758c7cbed933fdee36ba03835f9" category="admonition">命令行界面选项中包含了用于存储准备文件的<block ref="09c9689230344c41364f0fa22da928c6" prefix=" " category="inline-code"></block>目录<block ref="1611b9881f1a590d33bbbcfdd9c55ca7" prefix=" " category="inline-code"></block><block ref="1b723e0f23eac7863dadd5b0b02436e4" prefix="(" category="inline-code"></block>)。</block>
  <block id="b5b2eafc66ebc94cfb50a26c15cf1f52" category="paragraph">使用SAP<block ref="e57381f2a2aa941f8d88ba956c77d978" prefix=" " category="inline-code"></block>安装工具、通过在一个工作主机上运行以下命令来启动安装。使用<block ref="9676c5ff8ed94e9d3ceba55f16dde62f" prefix=" " category="inline-code"></block>选项添加第二个工作空间(sapcc-hana TST-06)和备用主机(sapcc-hana TST-07)。CLI选项中包含了已准备文件的存储<block ref="09c9689230344c41364f0fa22da928c6" prefix=" " category="inline-code"></block>目录<block ref="1611b9881f1a590d33bbbcfdd9c55ca7" prefix=" " category="inline-code"></block><block ref="1b723e0f23eac7863dadd5b0b02436e4" prefix="(" category="inline-code"></block>)。根据所使用的操作系统版本，可能需要先安装 phyton 2.7 ，然后再安装 SAP HANA 数据库。</block>
  <block id="1a808aae97e904d2d0d8b853c60fa475" category="list-text">AFF A150、AFF A20、AFF A250、AFF A30、AFF A400、AFF A50、AFF A900、AFF A1K、AFF A90、AFF A70、AFF A800</block>
  <block id="19fe8eb256f35b3d5110d29e652ce432" category="list-text">AFF C250、AFF C30、AFF C400、AFF C60、AFF C800、AFF C80</block>
  <block id="968cad2bf5c711dad5ccd0efa3e1ff9f" category="list-text">AFF A150、AFF A20、AFF A250、AFF A30、AFF A400、AFF A50、AFF A90、AFF A1K、AFF A900、AFF A70、AFF A800</block>
  <block id="54652d040ebb810c360684ca8e231a52" category="paragraph">此外，还支持 NFS 数据存储库或采用 NFS 的 VVol 数据存储库。对于这两个选项，数据存储库中只能存储一个 SAP HANA 数据或日志卷，以用于生产用例。</block>
  <block id="7d631f41ea82e4581ac749b6874d885a" category="paragraph">此外，还支持原始设备映射（ RDM ）， FCP 数据存储库或具有 FCP 的 VVol 数据存储库。对于这两个数据存储库选项，数据存储库中只能存储一个 SAP HANA 数据或日志卷，以便在高效使用情形下使用。</block>
  <block id="efd1d0d586a27578c98f10496d441cd4" category="paragraph">此外，还支持 NFS 数据存储库和采用 NFS 的 VVol 数据存储库。对于这两个选项，数据存储库中只能存储一个 SAP HANA 数据或日志卷，以用于生产用例。</block>
  <block id="cb1774d583cd49c1e7fc03a9172f09d9" category="list-text">FAS2750、FAS2820、FAS8300、FAS50、FAS8700、FAS70、FAS9500、FAS90有关适用于SAP HANA的NetApp认证存储解决方案的完整列表，请访问<block ref="b94cf00a6e18ec3712e81f808581c042" category="inline-link-rx"></block>。</block>
  <block id="68a4c90b9b4251c2e6c62854e0f0e383" category="cell">新存储系统和次要更新</block>
  <block id="6cc5c9e930ea3d3b8bff4367c60ceea4" category="cell">2025年2月</block>
  <block id="15cd132980dad32e9c3c529955721df9" category="cell">新存储系统</block>
  <block id="4433e4b3b7ec2b20f062036b1b011af7" category="list-text">ASA A250、ASA A20、ASA A30、ASA A400、ASA A50、ASA A70、ASA A800、ASA A900、ASA A90、ASA A1K</block>
  <block id="2134d42f2b0f54791bb238214fdc5110" category="list-text">ASA C250、ASA C30、ASA C400、ASA C60、ASA C800、ASA C80</block>
  <block id="a10922577a9bcbf85b1a7a9d8e7de5aa" category="cell">2024年11月</block>
  <block id="53bab281b7eb6692b17a4b65d99e2188" category="list-text">FAS2750、FAS2820、FAS8300、FAS50、FAS8700、 FAS70、FAS9500、FAS90</block>
  <block id="eccbc87e4b5ce2fe28308fd9f2a7baf3" category="cell">3</block>
  <block id="c9f0f895fb98ab9159f51fd0297e236d" category="cell">8</block>
  <block id="34173cb38f07f89ddbebc2ac9128303f" category="cell">30</block>
  <block id="c2be09c4548a0a3d6590431051156ecc" category="inline-image-macro">八个连接到一个存储HA对的SAP HANA主机</block>
  <block id="57b2c63155fecfb21c53a82e0a192a2b" category="paragraph"><block ref="57b2c63155fecfb21c53a82e0a192a2b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="445dc01d838477256a3f7c6ec4051a70" category="inline-image-macro">连接到存储HA对的其他SAP HANA主机</block>
  <block id="2aeef15c3419fd9cc9d6690eb125715e" category="paragraph"><block ref="2aeef15c3419fd9cc9d6690eb125715e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="6119ba4f9580ccfa3f0a3d3f871870ff" category="inline-image-macro">正在添加其他存储HA对</block>
  <block id="0349c380e002d982103ec0fc460cd07f" category="paragraph"><block ref="0349c380e002d982103ec0fc460cd07f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c4d3f7817a7843faa1dc4bee9f2303ff" category="list-text">SID=SS3的HANA系统</block>
  <block id="d6b8648b9a763d4fa670f413b105dec7" category="list-text">使用Linux逻辑卷管理器(LVM)的SID=FC5的HANA系统</block>
  <block id="238ec08371f09e874d0f1002aee0caeb" category="inline-image-macro">连接到两个存储控制器的SAP HANA主机</block>
  <block id="74f3ad2825ea13022492793fb7f63a79" category="paragraph"><block ref="74f3ad2825ea13022492793fb7f63a79" category="inline-image-macro-rx" type="image"></block></block>
  <block id="15e40c72ba936fd4cbb64210e15725a1" category="paragraph">最多可以将一个磁盘架连接到一个 SAS 堆栈，以提供 SAP HANA 主机所需的性能，如下图所示。每个磁盘架中的磁盘必须在 HA 对的两个控制器之间平均分布。ADPv2 可用于 ONTAP 9 和 DS224C 磁盘架。</block>
  <block id="2f4edbf818ed882e067d16f9f1c932da" category="inline-image-macro">DS224C磁盘架连接</block>
  <block id="ddb7d2fa5d4fd45c1a6001d8cbba792c" category="paragraph"><block ref="ddb7d2fa5d4fd45c1a6001d8cbba792c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f8c9ad3e9065af52a42b05407f475c98" category="paragraph">每个NS224 NVMe磁盘架都通过每个控制器两个100GbE端口进行连接、如下图所示。每个磁盘架中的磁盘必须平均分布到 HA 对的两个控制器。NS224 磁盘架也使用 ADPv2 。</block>
  <block id="39b270995b65c0f50a8535f49f84aa61" category="inline-image-macro">NS224 NVMe磁盘架连接</block>
  <block id="dac87f657c075eb6a448486fda4b18e4" category="paragraph"><block ref="dac87f657c075eb6a448486fda4b18e4" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0dee623c3a47708547aff95df6dc16df" category="paragraph">通常，您必须为每个控制器配置两个聚合，而与使用的磁盘架或磁盘技术（ SSD 或 HDD ）无关。要使用所有可用的控制器资源，必须执行此步骤。</block>
  <block id="6f1ace73b19ea95862049cef5bc4fabb" category="admonition">2024年8月之后发布的ASA系统不需要执行此步骤、因为它会自动完成</block>
  <block id="f4c9620796b063803a52bf4cb0bdc63b" category="paragraph"><block ref="f4c9620796b063803a52bf4cb0bdc63b" category="inline-image-macro-rx" type="image"></block></block>
  <block id="c63c34bc75852acd26eac087d69564e1" category="inline-image-macro">逻辑接口覆盖</block>
  <block id="442b4694b4e23c4c8aab5817606d4a8f" category="paragraph"><block ref="442b4694b4e23c4c8aab5817606d4a8f" category="inline-image-macro-rx" type="image"></block></block>
  <block id="775282e39d26408a21d5eaa1c485e361" category="paragraph">在使用ONTAP系统管理器创建SVM期间、您可以选择所有必需的物理FCP端口、系统会自动为每个物理端口创建一个LIF。</block>
  <block id="ca4b4ab28b402042c5530cc0059c6af3" category="inline-image-macro">创建 SVM</block>
  <block id="bc0b4db5e6b23fdaed6f5246d05d6ef8" category="paragraph"><block ref="bc0b4db5e6b23fdaed6f5246d05d6ef8" category="inline-image-macro-rx" type="image"></block></block>
  <block id="0c2fd995ece5cfe7704d5109986e3b0e" category="paragraph"><block ref="0c2fd995ece5cfe7704d5109986e3b0e" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2376775a32e0fa313efe0917b1bd9cfc" category="paragraph"><block ref="2376775a32e0fa313efe0917b1bd9cfc" category="inline-image-macro-rx" type="image"></block></block>
  <block id="062ce9ed8e9b3c25669e46aba83faa4c" category="admonition">2024年8月之后发布的ASA系统不需要执行此步骤、因为它会在_LUN cre同时 自动完成</block>
  <block id="962f559368bb8c770c0eb510490d6a70" category="admonition">请仅提供LUN名称作为2024年8月之后启动的ASA系统的路径。这也适用于下面的_LUN map_命令。此外、选项--space-re储备_和--space-分配_不可用。</block>
  <block id="871d39fd458463703004f24c503c7812" category="paragraph">一个NVMe SSD (数据)最多支持2/5个SAP HANA主机、具体取决于所使用的特定NVMe磁盘。SSD 和 SAP HANA 主机必须在两个存储控制器之间平均分布。这同样适用于AFF和ASA系统的内部NVMe磁盘。</block>
  <block id="b80edeac5a9d51784b1a139f183acc83" category="inline-image-macro">SAP HANA大小评估流程</block>
  <block id="4bb4fae3b6ea53d3f376bbd619714543" category="paragraph"><block ref="4bb4fae3b6ea53d3f376bbd619714543" category="inline-image-macro-rx" type="image"></block></block>
  <block id="f2ed1b2a99c0f64ca0cfcd6111d7ec4c" category="inline-image-macro">八个连接到存储高可用性(HA)对的SAP HANA主机</block>
  <block id="831843b9e12aadd42880c9ec56bd509a" category="paragraph"><block ref="831843b9e12aadd42880c9ec56bd509a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d788d47338c59792d717e9540a6664ef" category="inline-image-macro">将其他SAP HANA主机连接到现有存储控制器HA对</block>
  <block id="1630763019d92de5939da85faf4ad16c" category="paragraph"><block ref="1630763019d92de5939da85faf4ad16c" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4f056ce2074ba16ee637d64fdef647a7" category="inline-image-macro">已添加其他HA对</block>
  <block id="afd2c3367e4b9e93007759798ae8b0c0" category="paragraph"><block ref="afd2c3367e4b9e93007759798ae8b0c0" category="inline-image-macro-rx" type="image"></block></block>
  <block id="4d9c2ddc20521fa24e033c096807f43d" category="paragraph">下图显示了一个示例，其中四个 SAP HANA 主机使用 10GbE 网络连接到一个存储控制器 HA 对。每个SAP HANA主机都与冗余网络结构建立了主动-主动连接。</block>
  <block id="e7c118cc09590a9a288c67a4b302b904" category="paragraph">在存储层，配置了四个活动连接，可为每个 SAP HANA 主机提供 10 Gb 吞吐量。在存储层，将配置 MTU 大小为 9000 的广播域，并将所有必需的物理接口添加到此广播域。此方法会自动将这些物理接口分配给同一故障转移组。分配给这些物理接口的所有逻辑接口（ LIF ）都会添加到此故障转移组中。</block>
  <block id="fa9e73ef22bb3dbfc0d7dfadf5b21281" category="inline-image-macro">网络概述</block>
  <block id="1f4afde3d41b82108694e4fb06f46b87" category="paragraph"><block ref="1f4afde3d41b82108694e4fb06f46b87" category="inline-image-macro-rx" type="image"></block></block>
  <block id="5cc69351dc44fc813914fdaa909dbc3e" category="paragraph">通常、建议在服务器(绑定)和存储系统上使用HA接口组(例如链路聚合控制协议[LACP]和ifgroups)。使用 HA 接口组，验证负载是否在组内的所有接口之间平均分布。负载分布取决于网络交换机基础架构的功能。</block>
  <block id="6c3a3847a37cd097bd01d4da5604f5ec" category="inline-image-macro">SAS磁盘架连接</block>
  <block id="9a0eda3f9d8233b1fa9f3da649f3f69a" category="paragraph"><block ref="9a0eda3f9d8233b1fa9f3da649f3f69a" category="inline-image-macro-rx" type="image"></block></block>
  <block id="ad5e5ab57510595b28c8e0eccf58ded8" category="inline-image-macro">MVMe磁盘架连接</block>
  <block id="a1868e70c540a5e45ad58185a99b3769" category="paragraph"><block ref="a1868e70c540a5e45ad58185a99b3769" category="inline-image-macro-rx" type="image"></block></block>
  <block id="06622e356c3be6dc8c45370761d20660" category="paragraph">通常，您必须为每个控制器配置两个聚合，而不受所使用的磁盘架或驱动器技术（ SAS SSD 或 NVMe SSD ）的影响。</block>
  <block id="91e0d52ee3c1820ee8386d18f6a91bd0" category="inline-image-macro">聚合配置</block>
  <block id="da814dd6671cb64a7483f4c29eac56a3" category="paragraph"><block ref="da814dd6671cb64a7483f4c29eac56a3" category="inline-image-macro-rx" type="image"></block></block>
  <block id="d63145bc3309abf0009436530805ac13" category="inline-image-macro">卷配置SAP HANA单个主机</block>
  <block id="4e37fc2061f3eb4a5c883256f7abd270" category="paragraph"><block ref="4e37fc2061f3eb4a5c883256f7abd270" category="inline-image-macro-rx" type="image"></block></block>
  <block id="2f57ad2489363e64804b354244f0c7b8" category="inline-image-macro">卷配置SAP HANA多个主机</block>
  <block id="67723885e8b8dec5641fd9b65c05a445" category="paragraph"><block ref="67723885e8b8dec5641fd9b65c05a445" category="inline-image-macro-rx" type="image"></block></block>
  <block id="de3a0b5c28d9158410e205fdf4dd72f2" category="paragraph">一个NVMe SSD (数据)最多支持2/5个SAP HANA主机、具体取决于使用的NVMe磁盘。SSD 和 SAP HANA 主机必须在两个存储控制器之间平均分布。这同样适用于AFF系统的内部NVMe磁盘。</block>
  <block id="a1498fba486158dfd616e2bc1f205275" category="admonition">添加更多磁盘架不会增加存储控制器可支持的最大SAP HANA主机数量。</block>
  <block id="57c187411855aa330625e6e0331a74b7" category="paragraph"><block ref="57c187411855aa330625e6e0331a74b7" category="inline-image-macro-rx" type="image"></block></block>
</blocks>